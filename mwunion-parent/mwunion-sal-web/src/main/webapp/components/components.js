var Horn=Horn||{debug_:false,fixed_:true,debug:function(b,a){if(Horn.debug_&&typeof console!="undefined"&&typeof console.log!="undefined"){console.log(b,a)}}};(function(h){var e=null,a=null;var g=0;var d=[],f=[];var j=[];var c={};h.cachedDicts={};h.apply=function(m,n,l){if(l){h.apply(m,l)}if(m&&n&&typeof n=="object"){for(var k in n){m[k]=n[k]}}return m};function b(){var k=$('<div style="display:none;position:fixed;z-index:100;"></div>');$("body").append(k);return k.css("position")=="fixed"}function i(){Horn.fixed_=b();Horn.debug("Horn.init","regist...");for(var l=0;l<f.length;l++){f[l]()}Horn.debug("Horn.init","ready...");while(d.length>0){var k=d.shift();k()}}h.apply(h,{id:function(k){if(!k){k="horn-comp-"}return k+(g++)},extend:(function(){var l=function(p){for(var n in p){this[n]=p[n]}};var k=Object.prototype.constructor;return function(r,o,q){if(typeof o=="object"){q=o;o=r;r=q.constructor!=k?q.constructor:function(){o.apply(this,arguments)}}var n=function(){},p,m=o.prototype;n.prototype=m;p=r.prototype=new n();p.constructor=r;r.superclass=m;if(m.constructor==k){m.constructor=o}r.override=function(s){h.override(r,s)};p.superclass=p.supr=(function(){return m});p.override=l;h.override(r,q);r.extend=function(s){return h.extend(r,s)};return r}})(),override:function(k,m){if(m){if(k){var l=k.prototype;h.apply(l,m)}}},getCurrent:function(){if(e){return e}return $(document.body)},setCurrent:function(k){if(k){e=k}},createComp:function(l,k){if(typeof l=="function"){var m=new l(k);if(m instanceof h.Base){this.data(m);return m}}return null},_guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(m){var l=Math.random()*16|0,k=m=="x"?l:(l&3|8);return k.toString(16)})},data:function(n,l){if(!a){var o=this.getCurrent().find("form");if(o.length>0){a=o.first()}else{a=this.getCurrent()}}if($.type(n)=="object"){if(!a.data("_id_comp_cache")){a.data("_id_comp_cache",{})}if(!a.data("_el_comp_cache")){a.data("_el_comp_cache",{})}var k=a.data(n.getQID());if(!k){k=new Array()}k.push(n);if(k.length>1){Horn.debug("出现重复组件名：",n.getQID())}if(n.params&&n.params.id&&n.params.id!=""){a.data("_id_comp_cache")[n.params.id]=n}if(n.el){var m=this._guid();n.el.data("comp_el_id",m);a.data("_el_comp_cache")[m]=n}return a.data(n.getQID(),k)}else{if($.type(n)=="string"&&l){return a.data(n,l)}else{if($.type(n)=="string"&&!l){return a.data(n)}}}return a.data()},destroy:function(r,q){var l=a.data();for(var o in l){var n=o.indexOf(r);var k=o.lastIndexOf(q);if((o.length==k+q.length)&&(n==0)){if(l[o]){var p=l[o][0].el.data("comp_el_id");var m=l[o][0].name;delete l._el_comp_cache[p];delete l._id_comp_cache[m];delete l[o]}}}},getQID:function(k,l){return k+"$"+(l||"_")},getComp:function(m,l){var k=this.data(this.getQID(m,l));if(!k){return}for(var n=0;n<k.length;n++){if(k[n].params.id&&k[n].params.id!=""){return k[n]}}return k[k.length-1]},getCompByEl:function(k){return h.Base.getCompByEl(k)},register:function(k){f.push(k)},ready:function(k){d.push(k)},getCompById:function(k){return Horn.Base.getCompById(k)},submitHandler:function(m,l){var n=$.type(l)=="string"?this.getComp(l):l;if(n&&n instanceof h.Base){n.on("beforesubmit",m)}else{var k=h.getCurrent().find("form");k.each(function(o,q){var p=h.getCompByEl(q);if(!p){h.ready(function(){var r=h.getCompByEl(q);r.on("beforesubmit",m)})}else{p.on("beforesubmit",m)}})}},render:function(l,k){if(k.indexOf("Redirect:")>-1){window.location=k.substr(9)}else{$("#"+l).append(k)}},init:function(){i()},regUI:function(k,l){var m={};m.selector=k;m.type=l;j.push(m)},getUIReady:function(){return function(p,n){p=p||h.getCurrent();function m(s,r){var q=new Array;s.each(function(t,u){q.push(h.createComp(r,u))});if(r.DATANAME){h.data(r.DATANAME,n?q.concat(h.data(r.DATANAME)):q)}}for(var l=0;l<j.length;l++){var o=j[l];var k=p.find(o.selector);m(k,o.type)}}},enterToTab:function(k){var l=k.find("input:text:visible,input:password:visible");var m=function(p){var n=p.which;if(n==13){p.preventDefault();var o=l.index(this)+1;l.eq(o).focus()}};l.unbind("keydown",m);l.bind("keydown",m)},getDict:function(o,m){if(!h.cachedDicts[o]){var n=$(".hc_checkboxdiv[ref_target="+o+"_s]");if(!n.get(0)){n=$(".hc_checkboxdiv[ref_target="+o+"_m]")}var l=n.find("li"),k={};l.each(function(q,p){p=$(p);var r=p.attr("title");var s=p.attr("value");if(!s){s=p.attr("key")}k[s]=r});c[o]=k;h.cachedDicts[o]=k}if(m){return h.Util.getDicts(o,m)}return c[o]}});h.register(h.getUIReady());$(document).ready(function(){i()});h.Base=function(){this.init.apply(this,arguments)};h.Base=h.extend(h.Base,{COMPONENT_CLASS:"Base",name:null,alias:null,el:null,params:{},REG_FUNCTION_NAME:[],regFuncs:function(l){this.REG_FUNCTION_NAME=this.REG_FUNCTION_NAME.concat(l);var o=this,n=this.el;if(this.REG_FUNCTION_NAME.length!=0){for(var m=0;m<this.REG_FUNCTION_NAME.length;m++){var k=this.REG_FUNCTION_NAME[m];if(typeof k=="string"){n[k]=function(){o[k].apply(o,arguments)}}else{n[k.src]=function(){o[k.tgt].apply(o,arguments)}}}}},regEvents:[],init:function(){this.el=$(arguments[0]);this.alias=this.alias||this.el.attr("alias");this.name=this.name||this.el.attr("name");if(this.el&&this.el.attr("paramcacheid")){if(Horn.paramCaches){this.params=Horn.paramCaches[this.el.attr("paramcacheid")];if(!(this.params)){this.params={}}Horn.debug("Horn.UI["+this.COMPONENT_CLASS+"]:params",this.params)}}if((!this.name)&&this.params&&this.params.name&&!this.el.attr("nonamebyparams")){this.name=this.params.name}if((!this.alias)&&this.params&&this.params.alias){this.alias=this.params.alias}var k;if(this.params&&this.params.name1){k=this.params.name1}this.name=this.name||k||h.id();this.initCompEvnets();this.initStandardEvents();this.el.data("QID",this.getQID())},customEvents:"",initStandardEvents:function(){var l=this.getEventTarget&&this.getEventTarget();var k=this.params&&this.params.events;if(!k||!l||!l.length){return}var m=this;$.each(k,function(p,t){var n=t.event.toLowerCase();if(m.customEvents==""||m.customEvents.indexOf(n)==-1){var q=t["function"]||function(){};var s=null;if($.type(q)==="string"){var r=Horn.Util.getFunObj(q);q=r.fn;s=r.params}if(n.indexOf("on")==0&&$.type(q)==="function"){l.bind(n.substring(2),s,function(v){var o=[];if(s){$.each(s,function(w,x){o.push(x)})}var u=m;v.comp=u;o.push(v);return q.apply(this,o)})}}})},initCompEvnets:function(){this.events={};if(this.params&&this.params.events){var m=this.params.events;if(!$.isPlainObject(this.params.events)){return}for(var l in m){var k=Horn.Util.getFunObj(m[l]||"");this.on(l,k.fn)}}},getQID:function(){return h.getQID(this.name,this.alias)},events:null,on:function(l,k){if(!this.events[l]){this.events[l]=[]}this.events[l].push(k)},un:function(o,n){var m=this.events[o];if(!m){return}var k=false;for(var l=0;l<m.length;l++){var p=m[l];if(p==n){k=true}if(k&&l<m.length-1){m[l]=m[l+1]}}if(k){m.length-=1}},fire:function(o){var m=this.events[o];if(!m){return true}var k=[];$(arguments).each(function(q,p){if(q!=0){k.push(p)}});for(var l=0;l<m.length;l++){var n=m[l];if(n.apply(this,k)===false){return false}}return true}});$.extend(h.Base,{COMPMENTOBJECT:"COMPMENTOBJECT",getCompByEl:function(n){if(n instanceof Horn.Base){return n}var m=$(n);var l=m.data("comp_el_id");var k=a.data("_el_comp_cache")[l];return k},getCompById:function(l){var k=a.data("_id_comp_cache")[l];if(k){return k}else{return}}});jQuery.fn.comp=function(){return Horn.Base.getCompByEl(this)}})(Horn);
var Horn=Horn||{};(function(H){Horn.Util={dictCache:{},apply:function(fn,scope){return(function(){return fn.apply(scope,arguments)})},getFunObj:function(event){if(event==""||!event){return{}}var name=event;var params=[];if(event.indexOf("(")>-1){name=event.substring(0,event.indexOf("("));var ps=event.substring(event.indexOf("(")+1,event.indexOf(")")).split(",");for(var i=0;i<ps.length;i++){if(ps[i]){params.push(eval("("+ps[i]+")"))}}}return{fn:eval("(window."+name+")"),params:params}},stopPropagation:function(e){if(e&&e.stopPropagation){e.stopPropagation()}else{window.event.cancelBubble=true}},obj2Arr:function(obj){var arr=[];if($.type(obj)=="object"){for(var i in obj){if("string,number,boolean".indexOf($.type(obj[i]))>-1){arr.push({name:i,value:obj[i]})}}}return arr},arr2Obj:function(serValues){var values={};for(var i=0;i<serValues.length;i++){var name=serValues[i]["name"];var value=serValues[i]["value"];if(values[name]!==undefined&&values[name]!==""&&values[name]!==null){values[name]=values[name]+"";if(values[name]){values[name]=values[name]+","+value}else{values[name]=value}}else{values[name]=value}}return values},getValues:function(form){var serValues=$(form).serializeArray();var values=this.arr2Obj(serValues);return values},encode:function(object){return(function(){var _this=this;if(_this===null||_this===undefined){return""}if(_this instanceof Function||_this instanceof RegExp){return _this.toString()}if(_this instanceof String){return'"'+_this.toString()+'"'}if(_this instanceof Boolean||_this instanceof Number){return _this.toString()}if(_this instanceof Date){return _this.getTime()}if(_this instanceof Object||_this instanceof Array){var tempArr=new Array;if(_this instanceof Array){for(var i=0;i<_this.length;i++){tempArr.push(arguments.callee.call(_this[i]))}}else{for(var fieldname in _this){if(_this[fieldname]==null||_this[fieldname]==undefined){tempArr.push(arguments.callee.call(fieldname)+':""');continue}if(jQuery.type(_this[fieldname])=="function"||jQuery.type(_this[fieldname])=="regexp"){continue}if(_this[fieldname] instanceof Object){tempArr.push(arguments.callee.call(fieldname)+":"+arguments.callee.call(_this[fieldname]));continue}tempArr.push(arguments.callee.call(fieldname)+":"+arguments.callee.call(_this[fieldname]))}}var retString=tempArr.join("");if(_this instanceof Array){retString="["+tempArr.join(",")+"]"}else{retString="{"+tempArr.join(",")+"}"}return retString}else{return _this.toString()}}).call(object)},decode:function(string){return jQuery.parseJSON(string)},getParamValue:function(name){var value=location.search.match(new RegExp("[?&]"+name+"=([^&]*)(&?)","i"));return value?value[1]:value},loadBp:function(d,url,data,method,callback){function render(obj,bp){obj.children().remove();BigPipe.onArrive(bp);BigPipe.start();H.getUIReady()(obj);if(callback){callback.call(obj,obj,bp)}}data=data||{};var id=d;var dom=d;if(typeof d=="object"){dom=$(d);if(!dom.attr("id")){dom.attr("id",H.id())}id=dom.attr("id")}else{if(typeof d=="string"){dom=$("#"+id)}else{return}}url=(url.indexOf("?")===-1?url+"?":url+"&")+"pagelet="+id;if(url.indexOf("http")==-1){url=context_path+url}if(method=="get"){$.get(url,data,function(result){render(dom,eval("("+result+")"))})}else{$.post(url,data,function(result){render(dom,eval("("+result+")"))})}},serializeObject:function(param){function serArray(per,p){var arr=per[p];for(var i=0;i<arr.length;i++){var obj=arr[i];for(var prop in obj){if("string,boolean,number".indexOf(jQuery.type(obj[prop]))>-1){per[p+"["+i+"]."+prop]=obj[prop]}}}}if(param&&typeof param=="object"){for(var p in param){if(jQuery.type(param[p])=="array"){serArray(param,p);delete param[p]}}}return param},loadCss:function(url){BigPipe.onArrive({html:"",id:H.id(),css:[url],js:[],jsCode:""})},loadScript:function(url){BigPipe.onArrive({html:"",id:H.id(),css:[],js:[url],jsCode:""});BigPipe.start()},jump:function(url,reload){if(Horn.TabScreen){this.loadBp(Horn.getCurrent(),url,{},"get")}else{if(reload){url=(url.indexOf("?")===-1?url+"?":url+"&")+"_="+new Date().getTime()}window.location=url}},getDicts:function(dictName,keys){Horn.Util.dictCache=Horn.cachedDicts;if(!Horn.Util.dictCache[dictName]){Horn.getDict(dictName);Horn.Util.dictCache=Horn.cachedDicts}if(keys){if(keys.indexOf(",")!=-1){var ks=keys.split(",");var values="";$.each(ks,function(i,key){if(key){values+=","+Horn.Util.dictCache[dictName][key]}});return values&&(values.indexOf(",")!=-1?values.substring(1):values)}else{return Horn.Util.dictCache[dictName][keys]}}else{return Horn.Util.dictCache[dictName]}}}})(Horn);String.prototype.toCharArray=function(){return this.split("")};String.prototype.repeat=function(b){var a=[];for(var c=0;c<b;c++){a.push(this)}return a.join("")};String.prototype.reverse=function(){return this.split("").reverse().join("")};String.prototype.isNumeric=function(){var b=parseFloat(this);if(isNaN(b)){return false}var a=this.length-b.toString().length;return b+"0".Repeat(a)==this};String.prototype.isInt=function(){if(this=="NaN"){return false}return this==parseInt(this).toString()};String.prototype.resetBlank=function(){return this.replace(/\s+/g," ")};String.prototype.ltrim=function(){return this.replace(/^\s+/g,"")};String.prototype.rtrim=function(){return this.replace(/\s+$/g,"")};String.prototype.trim=function(){return this.replace(/(^\s+)|(\s+$)/g,"")};String.prototype.getNum=function(){return this.replace(/[^\d]/g,"")};String.prototype.getEn=function(){return this.replace(/[^A-Za-z]/g,"")};String.prototype.getCn=function(){return this.replace(/[^\u4e00-\u9fa5\uf900-\ufa2d]/g,"")};String.prototype.getRealLength=function(){return this.replace(/[^x00-xff]/g,"--").length};String.prototype.left=function(a){return this.slice(0,a)};String.prototype.right=function(a){return this.slice(this.length-a)};String.prototype.HTMLEncode=function(){var c=this;var a=[/x26/g,/x3C/g,/x3E/g,/x20/g];var d=["&","<",">"," "];for(var b=0;b<a.length;b++){c=c.replace(a[b],d[b])}return c};String.prototype.ascW=function(){var a="";for(var b=0;b<this.length;b++){a+="&#"+this.charCodeAt(b)+";"}return a};String.prototype.firstUp=function(){return this.replace(/(^|\s+)\w/g,function(a){return a.toUpperCase()})};String.leftPad=function(c,b,a){if(!c){return c}if(b!==undefined&&b!==""&&a>0){c=c+"";b=b+"";while(c.length<a){c=b+c}}return c};if(!Array.indexOf){Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++){if(this[b]==a){return b}}return -1}};
var Horn=Horn||{};(function(a){Horn.Tip=new (function(){function b(d,c){d.click(function(){$(this).remove()});$(d).delay(2000).fadeOut(c)}this.init=function(c){var d=$("div.h_tips");var e=d.children("div").first();b(e,c?c:Horn.Tip.AUTO_HIDE_DELAY_SEC)};this.clear=function(){var c=$("div.h_tips");c.children("div:hidden").remove()};this.addTip=function(j,o,f){var k=null;var m=null;var e=null;if(f&&f.pos){k=f.pos}if(f&&f.height){m=f.height}if(f&&f.width){e=f.width}if(arguments.length==1){return this.addTip(Horn.Tip.TYPES.INFO,j)}var i="";if(j==Horn.Tip.TYPES.INFO){i=Horn.Tip.CSS.INFO}else{if(j==Horn.Tip.TYPES.WARNING){i=Horn.Tip.CSS.WARNING}else{if(j==Horn.Tip.TYPES.SUCCESS){i=Horn.Tip.CSS.SUCCESS}}}var l=$("div.h_tips");var h=false;if(l.length==0){h=true;l=$('<div class="h_tips"></div>');l.appendTo($(document.body))}if(o){var d="";if(h){if(Horn.fixed_){l.css("position","fixed")}}if(!h){}l.html("");if(f&&f.width){l.css("width",e+"px")}else{l.css("width","450px")}l.removeClass("h_tips_right");l.removeClass("h_tips_left");if(f&&f.pos){if(k=="left"){l.addClass("h_tips_left")}if(k=="right"){l.addClass("h_tips_right")}}var g=i.split(";");var c=g[0];var n=g[1];l.prepend($('<div class="m-tip-box '+c+'" '+d+'><span><i class="fa '+n+'"></i></span> '+o+"</div>"));if(f&&f.height){l.children("div.m-tip-box").css("height",m+"px")}}};this.addTips=function(d,e){if(arguments.length==1){return this.addTips(Horn.Tip.TYPES.INFO,d)}if(e&&e.length){for(var c=0;c<e.length;c++){this.addTip(d,e[c])}}}});Horn.apply(Horn.Tip,{TYPES:{INFO:"C",WARNING:"W",SUCCESS:"S"},CSS:{INFO:"m-tip-warning;fa-exclamation",WARNING:"m-tip-error;fa-close",SUCCESS:"m-tip-success;fa-check"},AUTO_HIDE_DELAY_SEC:500,info:function(c,b,d){if(!d){d={}}this.show(this.TYPES.INFO,c,b,d)},warn:function(c,b,d){if(!d){d={}}this.show(this.TYPES.WARNING,c,b,d)},success:function(c,b,d){if(!d){d={}}this.show(this.TYPES.SUCCESS,c,b,d)},show:function(c,d,b,e){this.clear();this.addTip(c,d,e);this.init(b)},shows:function(d,b){this.clear();if(d&&d.length){for(var c=0;c<d.length;c++){this.addTip(d[c].type,d[c].message)}}this.init(b)}});Horn.register(Horn.Tip.init)})(Horn);
Horn.Util.Format={Patterns:{YEAR:/y/g,MONTH:/M/g,DAY:/d/g,HOUR:/H/g,MINUTE:/m/g,SECOND:/s/g,MILSECOND:/f/g},FormatPatterns:function(format){return eval("/"+format.replace(this.Patterns.YEAR,"[0-9]").replace(this.Patterns.MONTH,"[0-9]").replace(this.Patterns.DAY,"[0-9]").replace(this.Patterns.HOUR,"[0-9]").replace(this.Patterns.MINUTE,"[0-9]").replace(this.Patterns.SECOND,"[0-9]").replace(this.Patterns.MILSECOND,"[0-9]")+"/g")},DateISO:function(a,c){var b="";if(a==""||c==""){return false}b=this.FormatPatterns(c);return b.test(a)},number:function(q,o){if(!o){return q}q=Number(q===null||typeof q=="boolean"?NaN:q);if(isNaN(q)){return""}var s=",",f=".",r=false,g=q<0;q=Math.abs(q);if(o.substr(o.length-2)=="/i"){o=o.substr(0,o.length-2);r=true;s=".";f=","}var b=o.indexOf(s)!=-1,a=(r?o.replace(/[^\d\,]/g,""):o.replace(/[^\d\.]/g,"")).split(f);if(1<a.length){q=q.toFixed(a[1].length)}else{if(2<a.length){throw ("NumberFormatException: invalid format, formats should have no more than 1 period: "+o)}else{q=q.toFixed(0)}}var p=q.toString();if(b){a=p.split(".");var l=a[0],e=[],h=l.length,d=Math.floor(h/3),c=l.length%3||3;for(var k=0;k<h;k+=c){if(k!=0){c=3}e[e.length]=l.substr(k,c);d-=1}p=e.join(s);if(a[1]){p+=f+a[1]}}return(g?"-":"")+o.replace(/[\d,?\.?]+/,p)},date:function(g,a){var c=g;if((typeof g)=="number"){g=g.toString()}if(g==""||g==null){return""}if((typeof g)=="string"){g=g.trim();var d=g;var f=function(h){h=h||"";if(h.indexOf("/")==-1&&h.indexOf("-")==-1){return h.substring(0,4)+"/"+h.substring(4,6)+"/"+h.substring(6)||""}return h.replace(/\D+/g,"/")};g=f(g);var e=g.split("/");while(e.length<3){e.push("01")}g=e.join("/")}var b=new Date(g)=="Invalid Date"?new Date(Number(c)):new Date(g);if(b=="Invalid Date"||isNaN(b)){return d}else{return b.format(a)}},all:function(b,c,d){if(b=="DATE"){if(c==null||c==undefined||c.length==0){c="yyyy-MM-dd HH:mm:ss"}var a=Horn.Util.Format.date(d,c);return a}else{if(b=="AMOUNT"){if(c==null||c==undefined||c.length==0){c="0,000.00"}return Horn.Util.Format.number(d,c)}else{return d}}},validateFmt:function(f,b){var a="^\\d{4}\\d{1,2}\\d{1,2}$";var e=true;if(b){if(b.length>10){e=Horn.Util.Format.DateISO(f,b)}else{if(b.length>8){var d=b.charAt(4);var c=b.charAt(7);var a="^\\d{4}"+d+"\\d{1,2}"+c+"\\d{1,2}$";e=(new RegExp(a)).test(f)}else{if(b.length==7){var d=b.charAt(4);var a="^\\d{4}"+d+"\\d{1,2}$";e=(new RegExp(a)).test(f)}else{e=(new RegExp(a)).test(f)}}}}else{e=false}return e}};Date.prototype.format=function(a){var d={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};var c={"0":"/u65e5","1":"/u4e00","2":"/u4e8c","3":"/u4e09","4":"/u56db","5":"/u4e94","6":"/u516d"};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var b in d){if(new RegExp("("+b+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(d[b]):(("00"+d[b]).substr((""+d[b]).length)))}}return a};

Horn.Validate={REQUIRED:"required",CHECK:"check",CHECKSEP:";",init:function(b){var a=Horn.getCurrent();if(b){a=$(b)}else{a=a.find("form")}var c=this},isFormValidate:function(l,d){if(arguments.length==1){if(typeof arguments[0]=="boolean"){return this.isFormValidate(null,arguments[0])}}var i=Horn.Validate;var a=null;if($(this).length>0&&$(this).prop("tagName")){a=$(this)}else{if($(l).length>0&&$(l).prop("tagName")){a=$(l)}else{a=Horn.getCurrent().find("form")}}var e=a.find("div.h_formgridtitle").nextAll("div.g-panel");var g=Horn.Field.findFieldsIn(e);var h=Horn.Field.findFieldsIn(a).not(g);var k=true;var c=[];setTimeout(function(){i.removeError(g)},100);var f;h.each(function(m,n){var o=Horn.getCompByEl(n);o.validate();if(!o.isValid()){if(!f){f=o}k=false;if(d!=undefined){c.push(o.name)}}});if(f){var j=f.getEventTarget();if(f instanceof Horn.CalendarGroup){var b=f.getInValidEle();if(b){b.focus()}}else{if(f instanceof Horn.Combox||f instanceof Horn.Select||f instanceof Horn.Calendar){j.data("isFromOuter",true);j.blur()}else{j.focus()}}f=null}if(k===false){return d?c:false}return k},validateAreaByGroup:function(d,c){var a=Horn.Field.findFieldsIn(d);var b=true;a.each(function(e,f){var g=Horn.getCompByEl(f);if(g&&g.inGroup(c)){g.validate();if(!g.isValid()){b=false}}});return b},onValid:function(d){var g=d.data[0];var a=d.data[1];var c=a.field;var b=c.prev("input[type='hidden']").size()>0?c.prev():c;var f=g.getRules.call(g,b);if(f&&f.length>0&&c.attr("disabled")==undefined){g.isValide.call(g,f,a,b.val())}else{g.removeError.call(g,a)}},regexEFn:function(b){var a={intege:"^-?[1-9]\\d*$|^0$",intege1:"^[1-9]\\d*$",intege2:"^-[1-9]\\d*$",num:"^\\d+$",num1:"^[1-9]\\d*$|^0$",num2:"^-[1-9]\\d*$|^0$",decmal:"^(-?\\d+)(\\.\\d+)?$",decmal1:"^(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*))$",decmal2:"^-([1-9]\\d*.\\d*|0.\\d*[1-9]\\d*)$",decmal3:"^-?([1-9]\\d*.\\d*|0.\\d*[1-9]\\d*|0?.0+|0)$",decmal4:"^\\d+(\\.\\d+)?$",decmal5:"^(-([1-9]\\d*.\\d*|0.\\d*[1-9]\\d*))|0?.0+|0$",email:"^(\\w+((-\\w+)|(\\.\\w+))*\\@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z0-9]+){0,1}$",color:"^[a-fA-F0-9]{6}$",url:"^http[s]?:\\/\\/([\\w-]+\\.)+[\\w-]+([\\w-./?%&=]*)?$",chinese:"^[\\u4E00-\\u9FA5\\uF900-\\uFA2D]+$",ascii:"^[\\x00-\\xFF]+$",zipcode:"^\\d{6}$",mobile:"^(13|15|18|17)[0-9]{9}$",ip4:"^(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)$",notempty:"^\\S+$",picture:"(.*)\\.(jpg|bmp|gif|ico|pcx|jpeg|tif|png|raw|tga)$",rar:"(.*)\\.(rar|zip|7zip|tgz)$",date:"^\\d{4}\\d{1,2}\\d{1,2}$",qq:"[1-9][0-9]{4,11}",tel:"^(([0\\+]\\d{2,3}-)?(0\\d{2,3})-)?(\\d{7,8})(-(\\d{3,}))?$",username:"^\\w+$",letter:"^[A-Za-z]+$",letter_u:"^[A-Z]+$",letter_l:"^[a-z]+$",required:"^\\s*\\S[\\S\\s]*$",Message:"输入格式不正确",integeMessage:"输入的不是整数格式",intege1Message:"输入的不是正整数格式",intege2Message:"输入的不是负整数格式",requiredMessage:"当前输入不能为空",emailMessage:"邮件地址不正确",zipcodeMessage:"邮编输入格式不正确",dateMessage:"日期格式不正确",qqMessage:"QQ号码格式不正确",telMessage:"电话号码格式不正确",mobileMessage:"移动电话格式不正确",decmalMessage:"只能输入浮点数格式",decmal1Message:"只能输入正浮点数格式",decmal2Message:"只能输入负浮点数格式",decmal3Message:"只能输入浮点数格式",decmal4Message:"只能输入非负浮点数格式",decmal5Message:"只能输入非正浮点数格式",colorMessage:"只能输入颜色格式",urlMessage:"只能输入url格式",chineseMessage:"只能输入中文格式",asciiMessage:"只能输入ACSII字符格式",ip4Message:"只能输入ip4地址格式",pictureMessage:"只能输入图片格式",rarMessage:"只能输入压缩文件格式",numMessage:"只能输入数字格式",num1Message:"只能输入非负整数数字格式",num2Message:"只能输入非正整数数字格式",letterMessage:"只能输入字母格式",letter_uMessage:"只能输入大写字母格式",letter_lMessage:"只能输入小写字母格式",usernameMessage:"只能输入由数字、26个英文字母或者下划线组成的字符串"};var c={intege:"^-?[1-9]\\d*$|^0$",intege1:"^[1-9]\\d*$",intege2:"^-[1-9]\\d*$",num:"^\\d+$",num1:"^[1-9]\\d*$|^0$",num2:"^-[1-9]\\d*$|^0$",decmal:"^(-?\\d+)(\\.\\d+)?$",decmal1:"^(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*))$",decmal2:"^-([1-9]\\d*.\\d*|0.\\d*[1-9]\\d*)$",decmal3:"^-?([1-9]\\d*.\\d*|0.\\d*[1-9]\\d*|0?.0+|0)$",decmal4:"^\\d+(\\.\\d+)?$",decmal5:"^(-([1-9]\\d*.\\d*|0.\\d*[1-9]\\d*))|0?.0+|0$",email:"^(\\w+((-\\w+)|(\\.\\w+))*\\@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z0-9]+){0,1}$",color:"^[a-fA-F0-9]{6}$",url:"^http[s]?:\\/\\/([\\w-]+\\.)+[\\w-]+([\\w-./?%&=]*)?$",chinese:"^[\\u4E00-\\u9FA5\\uF900-\\uFA2D]+$",ascii:"^[\\x00-\\xFF]+$",zipcode:"^\\d{6}$",mobile:"^(13|15|18|17)[0-9]{9}$",ip4:"^(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)$",notempty:"^\\S+$",picture:"(.*)\\.(jpg|bmp|gif|ico|pcx|jpeg|tif|png|raw|tga)$",rar:"(.*)\\.(rar|zip|7zip|tgz)$",date:"^\\d{4}\\d{1,2}\\d{1,2}$",qq:"[1-9][0-9]{4,11}",tel:"^(([0\\+]\\d{2,3}-)?(0\\d{2,3})-)?(\\d{7,8})(-(\\d{3,}))?$",username:"^\\w+$",letter:"^[A-Za-z]+$",letter_u:"^[A-Z]+$",letter_l:"^[a-z]+$",required:"^\\s*\\S[\\S\\s]*$",Message:"Format is not correct",integeMessage:"Not integer format",intege1Message:"Not a positive integer format",intege2Message:"Not negative integer format",requiredMessage:"Not empty",emailMessage:"Mail is not correct",zipcodeMessage:"ZIP format error",dateMessage:"Date format error",qqMessage:"QQ number format error",telMessage:"Telephone format error",mobileMessage:"Mobile format error",decmalMessage:"Enter floating point",decmal1Message:"Only enter positive floating-point",decmal2Message:"Negative float can only be entered",decmal3Message:"Can only enter floating point",decmal4Message:"Enter the non negative floating point number",decmal5Message:"Enter non positive floating point",colorMessage:"Enter the color format",urlMessage:"Enter the URL",chineseMessage:"Enter Chinese format",asciiMessage:"Enter ACSII character format",ip4Message:"Enter the IP4 address format",pictureMessage:"Enter the picture format",rarMessage:"Input file format",numMessage:"Enter the digital format",num1Message:"Enter only non negative integer numeric",num2Message:"Enter non positive integer numbers",letterMessage:"Only input letter format",letter_uMessage:"Capital letters only",letter_lMessage:"Input lowercase letters",usernameMessage:"You can only enter a string of numbers, 26 English letters, or an underscore"};if(Horn.Validate.language&&Horn.Validate.language=="en_US"){return c[b]}else{return a[b]}},regexEnum:{intege:"^-?[1-9]\\d*$|^0$",intege1:"^[1-9]\\d*$",intege2:"^-[1-9]\\d*$",num:"^\\d+$",num1:"^[1-9]\\d*$|^0$",num2:"^-[1-9]\\d*$|^0$",decmal:"^(-?\\d+)(\\.\\d+)?$",decmal1:"^(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*))$",decmal2:"^-([1-9]\\d*.\\d*|0.\\d*[1-9]\\d*)$",decmal3:"^-?([1-9]\\d*.\\d*|0.\\d*[1-9]\\d*|0?.0+|0)$",decmal4:"^\\d+(\\.\\d+)?$",decmal5:"^(-([1-9]\\d*.\\d*|0.\\d*[1-9]\\d*))|0?.0+|0$",email:"^(\\w+((-\\w+)|(\\.\\w+))*\\@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z0-9]+){0,1}$",color:"^[a-fA-F0-9]{6}$",url:"^http[s]?:\\/\\/([\\w-]+\\.)+[\\w-]+([\\w-./?%&=]*)?$",chinese:"^[\\u4E00-\\u9FA5\\uF900-\\uFA2D]+$",ascii:"^[\\x00-\\xFF]+$",zipcode:"^\\d{6}$",mobile:"^(13|15|18|17)[0-9]{9}$",ip4:"^(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)$",notempty:"^\\S+$",picture:"(.*)\\.(jpg|bmp|gif|ico|pcx|jpeg|tif|png|raw|tga)$",rar:"(.*)\\.(rar|zip|7zip|tgz)$",date:"^\\d{4}\\d{1,2}\\d{1,2}$",qq:"[1-9][0-9]{4,11}",tel:"^(([0\\+]\\d{2,3}-)?(0\\d{2,3})-)?(\\d{7,8})(-(\\d{3,}))?$",username:"^\\w+$",letter:"^[A-Za-z]+$",letter_u:"^[A-Z]+$",letter_l:"^[a-z]+$",required:"^\\s*\\S[\\S\\s]*$",Message:"输入格式不正确",integeMessage:"输入的不是整数格式",intege1Message:"输入的不是正整数格式",intege2Message:"输入的不是负整数格式",requiredMessage:"当前输入不能为空",emailMessage:"邮件地址不正确",zipcodeMessage:"邮编输入格式不正确",dateMessage:"日期格式不正确",qqMessage:"QQ号码格式不正确",telMessage:"电话号码格式不正确",mobileMessage:"移动电话格式不正确",decmalMessage:"只能输入浮点数格式",decmal1Message:"只能输入正浮点数格式",decmal2Message:"只能输入负浮点数格式",decmal3Message:"只能输入浮点数格式",decmal4Message:"只能输入非负浮点数格式",decmal5Message:"只能输入非正浮点数格式",colorMessage:"只能输入颜色格式",urlMessage:"只能输入url格式",chineseMessage:"只能输入中文格式",asciiMessage:"只能输入ACSII字符格式",ip4Message:"只能输入ip4地址格式",pictureMessage:"只能输入图片格式",rarMessage:"只能输入压缩文件格式",numMessage:"只能输入数字格式",num1Message:"只能输入非负整数数字格式",num2Message:"只能输入非正整数数字格式",letterMessage:"只能输入字母格式",letter_uMessage:"只能输入大写字母格式",letter_lMessage:"只能输入小写字母格式",usernameMessage:"只能输入由数字、26个英文字母或者下划线组成的字符串"},funcEnum:{range:function(c,b,a){if(b!==undefined){if(c<b){return false}}if(a!==undefined){if(c>a){return false}}return true},rangeMessage:"{0}不在{1}-{2}范围内",compare:function(b,a){var c=Horn.Field.getField(a);if(c.val()!=b){return false}return true},compareMessage:"校验不匹配",length:function(c,b,a){if(c){if(c.length>a||c.length<b){return false}}return true},lengthMessage:"输入的长度{1}-{2}字符之间",past:function(e){var g=new Date();var c=g.getFullYear(),f=String.leftPad(g.getMonth()+1+"","0",2),b=String.leftPad(g.getDate()+"",2,"0");var a=c+""+f+""+b;if(e){if(e>=a){return false}}return true},pastMessage:"输入的日期{0}必须小于当前日期",future:function(e){var g=new Date();var c=g.getFullYear(),f=String.leftPad(g.getMonth()+1+"","0",2),b=String.leftPad(g.getDate()+"","0",2);var a=c+""+f+""+b;if(e){if(e<=a){return false}}return true},futureMessage:"输入的日期{0}必须大于当前日期",idcard:function(g){var b={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};function f(k){var j=k;if(j===""){return false}if(e(j)===false){return false}if(c(j)===false){return false}if(i(j)===false){return false}if(d(j)===false){return false}return true}function e(j){var k=/(^\d{15}$)|(^\d{17}(\d|X)$)/;if(k.test(j)===false){return false}return true}function c(k){var j=k.substr(0,2);if(b[j]==undefined){return false}return true}function i(j){var k=j.length;if(k=="15"){var r=/^(\d{6})(\d{2})(\d{2})(\d{2})(\d{3})$/;var m=j.match(r);var n=m[2];var l=m[3];var o=m[4];var p=new Date("19"+n+"/"+l+"/"+o);return a("19"+n,l,o,p)}if(k=="18"){var q=/^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X)$/;var m=j.match(q);var n=m[2];var l=m[3];var o=m[4];var p=new Date(n+"/"+l+"/"+o);return a(n,l,o,p)}return false}function a(m,p,j,n){var k=new Date();var l=k.getFullYear();if(n.getFullYear()==m&&(n.getMonth()+1)==p&&n.getDate()==j){var o=l-m;if(o>=0&&o<=120){return true}return false}return false}function d(n){n=h(n);var k=n.length;if(k=="18"){var m=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2);var j=new Array("1","0","X","9","8","7","6","5","4","3","2");var p=0,o,l;for(o=0;o<17;o++){p+=n.substr(o,1)*m[o]}l=j[p%11];if(l==n.substr(17,1)){return true}return false}return false}function h(l){if(l.length=="15"){var k=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2);var j=new Array("1","0","X","9","8","7","6","5","4","3","2");var n=0,m;l=l.substr(0,6)+"19"+l.substr(6,l.length-6);for(m=0;m<17;m++){n+=l.substr(m,1)*k[m]}l+=j[n%11];return l}return l}return f(g)},idcardMessage:"{0}身份证格式不正确",Message:"{0}验证未通过"},applyString:function(a,b){return a.replace(/\{(\d+)\}/g,function(c,d){return b[d]})},isValide:function(rules,display,value){var _this=this;if(!rules){alert("fun.isValide 方法校验规则为空，请检查");return false}var ruleTypes="string,array,function";if(ruleTypes.indexOf($.type(rules))==-1){alert("fun.isValide 方法校验规则类型不正确，应为："+ruleTypes);return false}var isValid=true;if((typeof rules)=="string"){rules=[{name:rules,params:[value]}]}if((typeof rules)=="function"){rules=[{name:rules,params:[value]}]}for(var index=0;index<rules.length;index++){var item=rules[index];var name=item.name;if(!Horn.Calendar.USE_CONFIG){var format=item.format;if(format=="yesConfig"){return}}if(name===undefined||name===""){return"name 校验规则为空请检查"}if(name!="required"&&!value){continue}var msg="";if(this.regexEFn(name)){isValid=(new RegExp(this.regexEFn(name),item.regexparam)).test(value);msg=item.message||this.regexEFn(name+"Message")||this.regexEFn("Message")}else{if(this.funcEnum[name]){isValid=this.funcEnum[name].apply(display,item.params);msg=item.message||this.funcEnum[name+"Message"]||this.funcEnum.Message}else{if($.type(eval(name))=="function"){var tArr=item.params.slice(0);isValid=eval(name).apply(display,tArr);msg=isValid}else{alert("错误的校验类型");return false}}}if(isValid!==true){var params=item.params;msg=($.type(msg)=="boolean"||!msg)?msg:_this.applyString.apply(value,[msg,params]);_this.addError.call(_this,display,msg);return msg}}if(display.isValid!=Horn.Field.prototype.isValid){setTimeout(function(){var msg=display.isValid();if(msg!==true){_this.addError.call(_this,display,msg)}else{_this.removeError.call(_this,display,msg)}},1);return}_this.removeError.call(_this,display);return isValid},getRules:function(c){var g=this;var e=Horn.Field.getField(c);var a=e.attr(this.CHECK);var d=e.attr("format");if(a){var b=a.split(this.CHECKSEP);var f=[];$.each(b,function(h,j){var i=g.getRule(e,j);if(i){i.format=d;f.push(i)}});return f}},getRule:function(field,rule){if(rule){var name=rule;var value=field.val();var params=[value];if(rule.indexOf("(")>-1){name=rule.substring(0,rule.indexOf("("));var ps=rule.substring(rule.indexOf("(")+1,rule.indexOf(")")).split(",");for(var i=0;i<ps.length;i++){if(ps[i]){params.push(eval("("+ps[i]+")"))}}}return{name:name,params:params}}return null},addError:function(d,a){var c=(typeof d=="string")?Horn.getComp(d):d;function b(e){if(e instanceof Horn.Field){e.showError(a)}else{Horn.Tip.addTip(a)}}if(!c){Horn.ready(function(){var e=(typeof d=="string")?Horn.getComp(d):d;b(e)})}else{b(c)}},removeError:function(a){a=(typeof a=="string")?Horn.getComp(a):a;$(a).each(function(b,c){try{c=Horn.getCompByEl(c)||c;c.removeError()}catch(d){if(window.console){window.console.warn("批量消除错误失败"+c)}}})},validateFmt:function(f){if(f==""){return true}var a="^\\d{4}\\d{1,2}\\d{1,2}$";var b=Horn.Calendar.DEFAULT_FORMAT;var e=true;if(b){if(b.length>8){var d=b.charAt(4);var c=b.charAt(7);var a="^\\d{4}"+d+"\\d{1,2}"+c+"\\d{1,2}$";e=(new RegExp(a)).test(f)}else{e=(new RegExp(a)).test(f)}if(!e){e="日期格式不正确,格式："+b}}else{e="没有配置Horn.Calendar.DEFAULT_FORMAT格式参数"}return e}};
Horn.ButtonPanel=Horn.extend(Horn.Base,{COMPONENT_CLASS:"ButtonPanel",init:function(){Horn.ButtonPanel.superclass.init.apply(this,arguments)},setEnable:function(c,b,a){var e=a+"";if(typeof b!="boolean"){Horn.Tip.info("enabled属性只能是布尔型！");return}var d=e=="true"?this.el.find("button[id="+c+"]"):this.el.find("button[name="+c+"]");if(d.length==0){Horn.Tip.info(c+",不存在！");return}if(typeof b=="undefined"||b){d.removeClass("disabled");d.removeAttr("disabled")}else{d.addClass("disabled");d.attr("disabled","disabled")}},showButton:function(b,a){var c=a+"";this.el.children("button").each(function(d,e){var f=c=="true"?$(this).attr("id"):$(this).attr("name");if(f==b){$(this).show()}})},hideButton:function(b,a){var c=a+"";this.el.children("button").each(function(d,e){var f=c=="true"?$(this).attr("id"):$(this).attr("name");if(f==b){$(this).hide()}})}});Horn.regUI("div.h_btndiv",Horn.ButtonPanel);Horn.regUI("div.hc_button-group",Horn.ButtonPanel);
var optGridId=null;Horn.DataGrid=Horn.extend(Horn.Base,{COMPONENT_CLASS:"DataGrid",id:"dyncGrid",name:"dyncGrid",title:"",data:null,selectModel:"normal",autoLoad:false,baseParams:{},items:[],url:"",emptyMsg:"",numbercolumn:false,rowSelect:false,hasPage:false,toolbar:null,pagebar:null,frozen:null,frozenObj:null,clickFlag:null,td_number:'<td style="width:40px;"><div style="TEXT-aLIGN: center;width:40px;" class="h_numbercolumn">{count}</div></td>',td_check:'<td style="width:36px;"><div class="hc-datagrid-cell-check" style="TEXT-aLIGN: center;width:36px;"><input type="{CHECK_TYPE}"  id="{CHECKBOX_ID}"></div></td>',td:'<td style="display:{XDATAGRID_TD_HIDDEN};WIDTH:{XDATAGRID_TD_WIDTH}"><div  style="TEXT-ALIGN:{XDATAGRID_TD_ALIGN};WIDTH:{XDATAGRID_DIV_WIDTH};overflow: visible;{WORD_IS_WRAP};{WORD_NOT_WRAP};{FROZEN_CSS};">{XDATAGRID_TD_VAL}</div></td>',tr:'<tr id="{TR_ID}"  class="{TR_CLASS}" style="height:{TR_HEIGHT}px;">',tr_end:"</tr>",row_class:"u-table-bg",pageinfo:{totalPagesText:"页，每页{pagesize}条,共{pages}页",displayMsg:"当前显示{from}到{to}，共{total}条记录"},reqPageNo:1,reqPageSize:10,delimiter:",",selecteds:[],useDictCode:false,lastSelect:null,allCheckboxId:"allcb_datagrid_id",numberColWidth:40,bindFormName:null,isBackSort:false,initParams:function(c){var e=setDefaultValue;e(c,"numbercolumn",false);e(c,"selectModel","normal");e(c,"items",[]);e(c,"hasPage",false);e(c,"rowSelect",false);e(c,"autoLoad",false);Horn.apply(this,c);if(!c.frozen){c.frozen=[]}if(typeof c.frozen=="object"){this.frozenObjs=[];for(var b=0;b<c.frozen.length;b++){for(var d=0;d<c.items.length;d++){var a=c.items[d];if(a.name==c.frozen[b]){this.frozenObjs.push(a)}}}this.frozenObj=this.frozenObjs[0]}else{for(var d=0;d<c.items.length;d++){var a=c.items[d];if(a.name==c.frozen){this.frozenObj=a;this.frozenObjs=[this.frozenObj];break}}}if(!this.params.pageConfig){this.params.pageConfig={}}if(this.params.bindFormName){this.bindFormName=this.params.bindFormName}if(this.params.id&&this.params.id!=""){this.id=this.params.id}else{if(this.params.name&&this.params.name!=""){this.id=this.params.name}}if(this.params.useDictCode&&this.params.useDictCode!=""){this.useDictCode=this.params.useDictCode}if(this.hasPage&&this.hasPage==true){this.createPagebar()}if(c.width){this.setWidth(c.width)}if(c.height){this.setHeight(c.height)}},init:function(c){this.name=this.params.name||this.name;Horn.DataGrid.superclass.init.apply(this,arguments);this.initParams(this.params);var j=this;this.arr=[];$.each(this.params.events||[],function(h,l){j[l.event.toLowerCase()]=l["function"]});this.dataTable=$("#data_"+this.id).children("table");this.head_dataTable=$("#head_"+this.id);this.title=this.params.title||null;this.titleEl=null;if(this.title){this.titleEl=$("#wrap_"+this.id).children("div.u-datagrid-header").children("h4")}if((this.params.frozen&&this.params.frozen!="")||this.params.frozenHead){this.sortColums=this.head_dataTable.find(".u-datagrid-sorting")}else{this.sortColums=this.dataTable.find(".u-datagrid-sorting")}this.sortItem=[];this.sortCache=[];if(this.sortColums.length>0){this.sortColums.on("click",function(h){j.sortClick(h)})}if((this.params.frozen&&this.params.frozen!="")||this.params.frozenHead){this.ths=this.head_dataTable.children("tbody").find("td")}else{this.ths=this.dataTable.children("thead").find("td")}this.trs=this.dataTable.children("tbody").children("tr");this.frozenTable=$("#freeze_data_"+this.id).children("table");this.fro_trs=this.frozenTable.children("tbody").children("tr");this.fro_ths=$("#freez_head_"+this.id).children("tbody").find("td");var b=$("#freez_head_"+this.id);var f=$("#head_"+this.id);for(var g=1;this.frozenObjs&&g<this.frozenObjs.length;g++){var d=this.frozenObjs[g];var a=f.find("div[name="+d.name+"]").parent();a.appendTo(b.find("tr"));f.find("[flag=frozen]").after(a.clone().attr("flag","frozen")).removeAttr("flag")}b.find("tr").children("td").each(function(){if($(this).children("div")){$(this).children("div").removeClass("hc-datagrid-cell")}});this.fro_header=b;this.header=f;var j=this;var k=this.params.autoHeight+"";if(this.params.autoHeight&&k=="true"){$(window).resize(function(){j.autoDataHeight()})}this.processReqConf();this.initToolbarEvents();if(this.params.autoLoad&&this.params.autoLoad==true){this.autoLoad=this.params.autoLoad;this.load()}else{if(this.data){this.loadFlag="staticData";this.storgedData=this.data.rows?this.data.rows:this.data;this.reqPage(this.reqPageNo,this.reqPageSize)}else{j.headerLastWidth();this.pageBtnDisabled(true)}}var e=this.params.isDrag+"";if(e!="false"){this.el.find(".hc-datagrid-cell").resizable({autoHide:true,minHeight:35,maxHeight:35,resize:function(n,o){var m=o.size.width;var p=$(o.element[0]).parent().parent().find("td");$(o.element[0]).parent().css("width",m);var l=p.index($(o.element[0]).parent());var h=$("[name='"+j.name+"']").find("#body_"+j.id).children("tr");h.each(function(r,q){var s=$(q);$(s.children("td").get(l)).css("width",m);$(s.children("td").get(l)).children("div").css("width",m)})}})}},processReqConf:function(){var b=this.params.pageConfig["pageNo"];var a=this.params.pageConfig["pageSize"];var c=$("#pageSize_"+this.id);if(a){c.val(a)}this.reqPageNo=this.reqPageNo?this.reqPageNo:b;this.reqPageSize=this.reqPageSize?this.reqPageSize:a},setButtonDisabled:function(a,b){var c=$("#wrap_"+this.id).children("div.u-datagrid-toolbar").children("ul").children("li");c.each(function(f,d){var e=$(this).children("a");var g=e.attr("name");if(g==a){if(b){e.addClass("f-disabled");e.attr("onclick","javascript:return false;")}else{e.removeClass("f-disabled");e.attr("onclick",e.attr("event"))}return}})},initToolbarEvents:function(){var a=$("#wrap_"+this.id).children("div.u-datagrid-toolbar").children("ul").children("li");a.each(function(d,b){var c=$(this).children("a");if(c.hasClass("f-disabled")){c.attr("onclick","javascript:return false;")}})},staticInitPagebar:function(){if(this.hasPage){var a=this.storgedData.length;if(this.pagebar){this.pagebar.setTotalCount(a);this.pagebar.calPage_(this.reqPageNo,this.reqPageSize,a);this.setPageInfo()}this.reqPageNo=this.reqPageNo+1}},reCalRowHeight:function(){var c=22;var b=this.params.height;if(!b){return}var a=this.currentPageSize;var d=c*a<b?b/a:22;this.setHeight(b)},initSelectEvents:function(){var a=1;var c=this;var b=$("#"+this.allCheckboxId);this.trs.each(function(f,d){var h=$(d),e=h.find("#cb_"+c.id+"_"+a);a++;if(c.rowSelect==false){e.change(function(){if(this.checked){c.selectRow(f+1,h,false)}else{c.unSelectRow(f+1,h)}})}else{var g=this.clickFlag;h.bind("click",function(j){var k=j.ctrlKey;clearTimeout(g);g=setTimeout(function(){if($.isEmptyObject(c.selecteds)){if(c.frozenObj){$(c.fro_trs[f]).find("#cb_"+c.id+"_"+(f+1)).prop("checked",true);$(c.fro_trs[f]).addClass("u-table-selected")}c.selectRow(f+1,h,k)}else{if(!c.selecteds.hasOwnProperty(f+1)){if(c.frozenObj){$(c.fro_trs[f]).find("#cb_"+c.id+"_"+(f+1)).prop("checked",true);$(c.fro_trs[f]).addClass("u-table-selected")}c.selectRow(f+1,h,k)}else{if(c.frozenObj){$(c.fro_trs[f]).find("#cb_"+c.id+"_"+(f+1)).prop("checked",false);$(c.fro_trs[f]).removeClass("u-table-selected")}c.unSelectRow(f+1,h)}}if(b&&c.selectModel=="multi"){c.stateTest()}var o=j.shiftKey;var m=c.arr;m.push(f);if(o){c.dataTable.addClass("user-select-none");c.frozenTable.addClass("user-select-none");var n=Math.min(m[m.length-2],m[m.length-1]);var l=Math.max(m[m.length-2],m[m.length-1]);if($(c.trs[n+1]).hasClass("u-table-selected")){for(i=n;i<=l;i++){if(c.frozenObj){$(c.fro_trs[i]).find("#cb_"+c.id+"_"+(i+1)).prop("checked",false);$(c.fro_trs[i]).removeClass("u-table-selected")}c.unSelectRow(i+1,$(c.trs[i]))}}else{for(i=n;i<=l;i++){if(c.frozenObj){$(c.fro_trs[i]).find("#cb_"+c.id+"_"+(i+1)).prop("checked",true);$(c.fro_trs[i]).addClass("u-table-selected")}c.selectRow(i+1,$(c.trs[i]),k)}}}else{c.dataTable.removeClass("user-select-none");c.frozenTable.removeClass("user-select-none")}},10)})}});if(this.frozenObj){a=1;this.fro_trs.each(function(f,d){var h=$(d);var e=h.find("#cb_"+c.id+"_"+a);a++;if(c.rowSelect==false){e.change(function(){if(this.checked){e.checked=true;h.addClass("u-table-selected");c.selectRow(f+1,$(c.trs[f]),false)}else{e.checked=false;h.removeClass("u-table-selected");c.unSelectRow(f+1,$(c.trs[f]))}if(b&&c.selectModel=="multi"){c.stateTest()}})}else{var g=this.clickFlag;h.bind("click",function(j){clearTimeout(g);g=setTimeout(function(){if($.isEmptyObject(c.selecteds)){e.prop("checked",true);h.addClass("u-table-selected");c.selectRow(f+1,$(c.trs[f]),false)}else{if(!c.selecteds.hasOwnProperty(f+1)){e.prop("checked",true);h.addClass("u-table-selected");c.selectRow(f+1,$(c.trs[f]),false)}else{e.prop("checked",false);h.removeClass("u-table-selected");c.unSelectRow(f+1,$(c.trs[f]))}}if(b&&c.selectModel=="multi"){c.stateTest()}var n=j.shiftKey;var o=j.ctrlKey;var l=c.arr;l.push(f);if(n){c.dataTable.addClass("user-select-none");c.frozenTable.addClass("user-select-none");var m=Math.min(l[l.length-2],l[l.length-1]);var k=Math.max(l[l.length-2],l[l.length-1]);if($(c.trs[m+1]).hasClass("u-table-selected")){for(i=m;i<=k;i++){if(c.frozenObj){$(c.fro_trs[i]).find("#cb_"+c.id+"_"+(i+1)).prop("checked",false);$(c.fro_trs[i]).removeClass("u-table-selected")}c.unSelectRow(i+1,$(c.trs[i]))}}else{for(i=m;i<=k;i++){if(c.frozenObj){$(c.fro_trs[i]).find("#cb_"+c.id+"_"+(i+1)).prop("checked",true);$(c.fro_trs[i]).addClass("u-table-selected")}c.selectRow(i+1,$(c.trs[i]),o)}}}else{c.dataTable.removeClass("user-select-none");c.frozenTable.removeClass("user-select-none")}},10)})}})}if(b&&this.selectModel=="multi"){this.el.find(".h_datagrid_select_all").change(function(){if(this.checked){c.selectAll()}else{c.unSelectAll()}if(c.selectallclick){var e=c.el.find(".h_datagrid_select_all");if(e.length>0){var d=Horn.Util.getFunObj(c.selectallclick);return d.fn.apply(c)}}});this.dataTable.find(".hc-datagrid-cell-check").each(function(e,d){var f=$(d);f.children("input:checkbox").change(function(){c.stateTest()})})}},initHignLightEvent:function(){var a=this;if(this.frozenObj){this.fro_trs.each(function(c,b){var d=$(b);d.mouseover(function(){d.addClass("hc-datagrid-row-over");$(a.trs[c]).addClass("hc-datagrid-row-over")});d.mouseout(function(){d.removeClass("hc-datagrid-row-over");$(a.trs[c]).removeClass("hc-datagrid-row-over")})});this.trs.each(function(c,b){var d=$(b);d.mouseover(function(){d.addClass("hc-datagrid-row-over");$(a.fro_trs[c]).addClass("hc-datagrid-row-over")});d.mouseout(function(){d.removeClass("hc-datagrid-row-over");$(a.fro_trs[c]).removeClass("hc-datagrid-row-over")})})}else{this.trs.each(function(c,b){var d=$(b);d.mouseover(function(){d.addClass("hc-datagrid-row-over")});d.mouseout(function(){d.removeClass("hc-datagrid-row-over")})})}},stateTest:function(){var b=this;var a=true;this.dataTable.find(".hc-datagrid-cell-check").each(function(d,c){var g=$(c);var f=g.children("input:checkbox");var e=f.prop("id");if(!f.prop("checked")&&e!="allcb_datagrid_id"){a=false}});if(a){b.el.find(".h_datagrid_select_all").prop("checked",true)}else{b.el.find(".h_datagrid_select_all").prop("checked",false)}},load:function(a,d){d=d||{};this.selecteds=null;if(this.loadFlag&&this.loadFlag!="autoLoad"){this.reqPageNo=1}this.loadFlag="autoLoad";if($.type(d)=="array"){d=Horn.Util.arr2Obj(d)}this.reqPageNo=d.pageNo||this.reqPageNo;this.reqPageSize=d.pageSize||this.reqPageSize;if(this.hasPage){d.pageNo=this.reqPageNo;d.pageSize=this.reqPageSize}if(this.sortItem.length>0&&this.isBackSort){d.sortItem=this.sortItem.attr("name");d.sortMode=this.sortMode}if(this.bindFormName!=null){var c=$("form[name="+this.bindFormName+"]").serializeArray();var b=Horn.Util.arr2Obj(c);$.each(b,function(e,f){d[e]=f})}this.execute(a,d);$("#head_"+this.id).css("margin-left",0);$("#freez_body_"+this.id).css("margin-top",0)},loadData:function(c){this.loadFlag="loadData";var d=this;var b=this.params.pageConfig["pageNo"];var a=this.params.pageConfig["pageSize"];this.reqPageNo=b?b:1;this.reqPageSize=a?a:10;if(c!=null){this.data=c;this.resultData=c;this.storgedData=c.rows?c.rows:c;this.reqPage(this.reqPageNo,this.reqPageSize);d.el.find("#data_"+d.id).css("height","");d.el.find("#data_"+d.id).find("table").css("border-bottom","1px solid #e2e7eb");if(d.frozenObj){$("#freez_body_"+d.id).css("border-bottom","1px solid #e2e7eb")}this.pageBtnDisabled(false)}this.reCalRowHeight();this.resetTdContent();this.headerLastWidth()},updateRow:function(e,d){var h=this;var r="";var q="";var o=false;for(var g in d){r=g;q=d[g];if(!r){Horn.Msg.alert("提示","行唯一标识符格式不正确！");return false}}var k="";for(var f=0;f<this.data.length;f++){var m=this.data[f][r];if(q==this.data[f][r]){k=f;this.data[f]=e;break}}if(!k.toString()){Horn.Msg.alert("提示","没找到需要更新的条目！");return false}for(var c in this.selecteds){if(c=="indexOf"){continue}var b=this.selecteds[c];if(b&&q==b[r]){this.selecteds[c]=e;break}}if(e!=null){var l="";if((this.params.frozen&&this.params.frozen!="")||this.params.frozenHead){l=this.head_dataTable.children("tbody").find("tr")}else{l=this.dataTable.children("thead").find("tr")}var s=this.dataTable.children("tbody").children("tr");var p=$(s.get(k));l.children("td").each(function(j,t){if($(this).attr("name")){var n=$(this).attr("name");p.children("td:eq("+j+")").children("div").text(e[n]);o=true}});if(h.frozenObj){var a="";var p=$(h.fro_trs[k]);a=$("#freez_head_"+this.id).children("tbody").find("tr");a.children("td").each(function(n,t){if($(this).attr("name")){var j=$(this).attr("name");p.children("td:eq("+n+")").children("div").text(e[j]);o=true}})}}else{Horn.Msg.alert("提示","没有传入数据！")}return o},sortClick:function(b){var a=$(b.target).closest("td");if(this.sortCache.length>0){if(this.sortItem.attr("name")!=a.attr("name")){this.sortItem.removeClass().addClass("u-datagrid-sorting");this.sortCache=this.sortItem}}else{this.sortCache=a}this.sortItem=a;this.doSort()},doSort:function(){var e=this;var c;this.setSortStatus();this.sortName=this.sortItem.attr("name");if(this.resultData){c=this.resultData.rows}else{c=[]}if(!c||c.length==0){return}if(this.isBackSort){this.load()}else{var b=this.sortName;if(this.sortMode=="ASC"){c.sort(function(g,f){return g[b]==f[b]?0:(g[b]<f[b]?-1:1)})}else{c.sort(function(g,f){return g[b]==f[b]?0:(g[b]<f[b]?1:-1)})}this.loadRecords(c);this.initSelect();this.bindClickEvent(this.rowclick,"click");this.bindClickEvent(this.rowdblclick,"dblclick");this.initSelectEvents();this.initHignLightEvent();this.columnRender();if(this.params.height==undefined){}this.setTHHidden();this.resetTdContent();if(e.loadsuccess){var d=Horn.Util.getFunObj(e.loadsuccess),a;if($.type(d.fn)=="function"){a=d.fn}if(a){e.resultData.rows=c}a.apply(e,[e.el,e.resultData])}e.headerLastWidth()}},setSortStatus:function(){if(this.sortItem.hasClass("u-datagrid-sorting")){this.sortItem.removeClass().addClass("u-datagrid-sorting-asc");this.sortMode="ASC"}else{if(this.sortItem.hasClass("u-datagrid-sorting-asc")){this.sortItem.removeClass().addClass("u-datagrid-sorting-desc");this.sortMode="DESC"}else{this.sortItem.removeClass().addClass("u-datagrid-sorting-asc");this.sortMode="ASC"}}},clearSort:function(){if(this.sortItem&&this.sortItem.lenght>0){this.sortItem.removeClass().addClass("u-datagrid-sorting");this.sortCache=[]}},getId:function(){return this.id},getSelecteds:function(){var b=[];for(var a in this.selecteds){if(a=="indexOf"){continue}if(isNaN(a)){continue}var c=this.selecteds[a];if(c){b.push(c)}}return b},unSelectAll:function(){var a=this;this.dataTable.find("div.hc-datagrid-cell-check input:checkbox").each(function(b,c){c.checked=false;if(a.rowSelect==false){if(a.frozenObj){$(c).trigger("change")}else{a.unSelectRow(b+1,$(c.parentNode.parentNode.parentNode))}}else{a.unSelectRow(b+1,$(c.parentNode.parentNode.parentNode))}});if(this.frozenObj){this.frozenTable.find("div.hc-datagrid-cell-check input:checkbox").each(function(b,c){c.checked=false;$(c.parentNode.parentNode.parentNode).removeClass("u-table-selected")})}a.el.find(".h_datagrid_select_all").prop("checked",false)},selectAll:function(){var c=this;this.dataTable.find("div.hc-datagrid-cell-check input:checkbox").each(function(d,e){e.checked=true;if(c.rowSelect==false){if(c.frozenObj){$(e).trigger("change")}else{c.selectRow(d+1,$(e.parentNode.parentNode.parentNode),false)}}else{c.selectRow(d+1,$(e.parentNode.parentNode.parentNode),false)}});if(!this.params.frozen||this.params.frozen==""){this.dataTable.children("thead").children("tr").removeClass("u-table-selected")}if(this.frozenObj){this.frozenTable.find("div.hc-datagrid-cell-check input:checkbox").each(function(d,e){e.checked=true;$(e.parentNode.parentNode.parentNode).addClass("u-table-selected")})}var b=this.head_dataTable.find("#allcb_datagrid_id");if(b.length>0){b.prop("checked",true)}var a=this.fro_ths.find("#allcb_datagrid_id");if(a.length>0){a.prop("checked",true)}},setBaseParams:function(a){a=a||{};if(a){this.baseParams=a}else{this.baseParams={}}},setSize:function(f,a){var c=this.getId();var b=f?Number(f):null;var e=a?Number(a):null;if(b&&!isNaN(b)){$("#wrap_"+c).width(b);this.width=b}if(e&&!isNaN(e)){var d=$("#freeze_data_"+c);if(d.size!=0){d.height(e-16)}$("#data_"+c).height(e);this.height=e}},setWidth:function(a){this.setSize(a,null)},setHeight:function(a){this.setSize(null,a)},select:function(b,a){var c=this,b=Number(b);index=b,tr=$(c.trs[index]),f_tr=$(c.fro_trs[index]),_allCheck=$("#"+this.allCheckboxId);if($.isEmptyObject(c.selecteds)){if(c.frozenObj){f_tr.find("#cb_"+c.id+"_"+(index+1)).prop("checked",true);f_tr.addClass("u-table-selected")}c.selectRow(index+1,tr,false)}else{if(!c.selecteds.hasOwnProperty(index+1)){if(c.frozenObj){f_tr.find("#cb_"+c.id+"_"+(index+1)).prop("checked",true);f_tr.addClass("u-table-selected")}c.selectRow(index+1,tr,false)}}if(_allCheck&&c.selectModel=="multi"){c.stateTest()}if(a&&a.stopPropagation){a.stopPropagation()}},unselect:function(b,a){this.unSelectRow(b+1,$(this.trs[b]));if(a&&a.stopPropagation){a.stopPropagation()}},selectRow:function(h,b,f){var e=b;if(!e){e=$("#tr_"+this.id+"_"+h)}var d=this.getRowData(h-1);this.selecteds[h]=d;if(this.selectModel=="multi"){e.find("input:checkbox").get(0).checked=true}else{if(this.selectModel=="single"){var c=this.lastSelect;if(c&&c.rowidx!==undefined&&c.rowidx!=h){c.tr.find("#cb_"+this.id+"_"+c.rowidx).prop("checked",false);this.unSelectRow(c.rowidx,c.tr)}e.find("input:radio").get(0).checked=true}else{if(!f){var g=this;var a=$("#body_"+this.id).children("tr");a.each(function(k,j){var l=k+1;if(l!=h){$(j).find("#cb_"+g.id+"_"+l).prop("checked",false);g.unSelectRow(l,$(j))}})}}}this.lastSelect={rowidx:h,tr:e};e.addClass("u-table-selected")},getRowData:function(a){return this.result[a]},unSelectRow:function(e,b){var d=b;if(!d){d=$("#tr_"+this.id+"_"+e)}this.selecteds[e]=null;delete this.selecteds[e];d.removeClass("u-table-selected");d.find("#cb_"+this.id+"_"+e).prop("checked",false);if(this.frozenObj){$(this.fro_trs[e-1]).find("#cb_"+this.id+"_"+e).prop("checked",false);$(this.fro_trs[e-1]).removeClass("u-table-selected")}var c=true;for(var a in this.selecteds){c=false;break}if(c){this.el.find(".h_datagrid_select_all").prop("checked",false)}},execute:function(d,c){c=c||{};var f=true;if(this.beforeload){var b=Horn.Util.getFunObj(this.beforeload),h;if($.type(b.fn)=="function"){h=b.fn}if(h){try{f=h.apply(this,[this.el,c])}catch(g){}}}if(f!=false){var a=Horn.apply({},this.baseParams,c);this.doAjax(d,a)}return f},autoPageSizeFn:function(e){var m=this.params.autoHeight+"";if(this.params.autoHeight&&m=="true"){var d=this.params.autoPageSize+"";if(this.params.autoPageSize&&d=="true"){var g=this.el.children(".hc-datagrid-body");var j=this.el.children(".u-datagrid-page");var n=$(window).height();var c=j.outerHeight(true);var k=g.offset().top;var f=n-k-c;var b=33;var a=this.params.trHeight;if(a&&a!=""&&a>b){b=this.params.trHeight}var l=f/b;var o=parseInt(l)+1;if(o>10){e.pageSize=o;this.reqPageSize=o}}}},doAjax:function(a,b){var e=this;var a=a?a:e.url;if(a&&a.indexOf("http:")==-1){a=context_path+a}var c=this.dataTable.children("tbody"),j=this.frozenTable.children("tbody"),h=this.ths.length;var g="请求失败";var f="错误信息";var d="暂无数据";if((e.params.language&&e.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){g="request was aborted";f="error message";d="no data"}this.autoPageSizeFn(b);$.ajax(a,{async:true,beforeSend:function(k){if(e.frozenObj){e.frozenTable.children("tbody").html("")}e.dataTable.children("tbody").html("");c.html('<tr><td style="border-right:0px;padding:15px;" colspan=\''+h+"'><img src='"+context_path+"/components/datagrid/img/hc_onLoad.gif'></img></td></tr>");c.parent().css("width","100%");c.parent().css("text-align","center");c.parent().css("padding","15px")},type:"POST",data:Horn.Util.obj2Arr(b),dataType:"json",error:function(m,n,l){var k=m.status;c.parent().css("width","");c.parent().css("text-align","");c.parent().css("padding","");if(e.frozenObj){e.frozenTable.children("tbody").html("");j.html('<tr><td style="border-right:0px;padding:15px;" colSpan=\''+h+"'><p>"+g+"</p><p>"+f+"："+k+"；"+f+"："+n+"</p></td></tr>")}c.html('<tr><td style="border-right:0px;padding:15px;" colSpan=\''+h+"'><p>"+g+"</p><p>"+f+"："+k+"；"+f+"："+n+"</p></td></tr>")},success:function(m,n,s){c.html("");c.parent().css("width","");c.parent().css("text-align","");c.parent().css("padding","");if(!m||$.isEmptyObject(m)){e.data=null;if(e.frozenObj){e.frozenTable.css("border-bottom","0 solid #e2e7eb");e.frozenTable.children("tbody").html("");j.html('<tr><td style="border-right:0px;padding:15px;" colSpan=\''+h+"'><p>"+d+"</p></td></tr>")}e.clearSort();e.dataTable.css("border-bottom","0 solid #e2e7eb");e.dataTable.children("tbody").html("");c.html('<tr><td style="border-right:0px;padding:15px;" colSpan=\''+h+"'><p>"+d+"</p></td></tr>");if(e.loaderror){var p=Horn.Util.getFunObj(e.loaderror),u;if($.type(p.fn)=="function"){u=p.fn}if(u){u.apply(e,[e.el,m])}return}}else{var t="";var l="";if(m){var o=m.rows;t=m.redirectUrl;l=m.target;e.resultData=m;if(o==null||o=="null"){if(t&&t!=""){if(l=="top"){top.location.href=t}else{if(l=="parent"){parent.location.href=t}else{window.location.href=t}}return}}this.result=o?o:m}if(!o||$.isEmptyObject(o)||o==""||o.length==0){e.data=null;if(e.frozenObj){e.frozenTable.css("border-bottom","0 solid #e2e7eb");e.frozenTable.children("tbody").html("");j.html('<tr><td style="border-right:0px;padding:15px;" colSpan=\''+h+"'><p>"+d+"</p></td></tr>");e.headerLastWidth()}e.dataTable.css("border-bottom","0 solid #e2e7eb");e.dataTable.children("tbody").html("");c.html('<tr><td style="border-right:0px;padding:15px;" colSpan=\''+h+"'><p>"+d+"</p></td></tr>");e.initPagebar(m)}else{e.dataTable.attr("style","");e.data=m.rows;e.params.data=m.rows;e.loadRecords(m);e.initPagebar(m);e.initSelect();e.bindClickEvent(e.rowclick,"click");e.bindClickEvent(e.rowdblclick,"dblclick");e.initSelectEvents();e.initHignLightEvent();e.columnRender();if(!e.isBackSort&&e.sortItem.length>0){e.clearSort()}if(e.params.height==undefined){}e.setTHHidden();e.resetTdContent();e.headerLastWidth()}}try{if(e.loadsuccess){var k=Horn.Util.getFunObj(e.loadsuccess),r;if($.type(k.fn)=="function"){r=k.fn}if(r){r.apply(e,[e.el,m])}}}catch(q){Horn.debug(q)}}});e.autoDataHeight()},autoDataHeight:function(){var b=this.params.autoHeight+"";if(this.params.autoHeight&&b=="true"){var f=this.el.children(".hc-datagrid-body");var e=this.el.children(".u-datagrid-page");var a=$(window).height();var d=e.outerHeight(true);var g=f.offset().top;var c=a-g-d;this.setHeight(c-5)}},initPagebar:function(a){if(this.hasPage){var b=a.total;if(this.pagebar){if(a!=null){$("#toPage_"+this.id).attr("disabled",false);$("#pageSize_"+this.id).attr("disabled",false)}var c=a.rows;if(!c||$.isEmptyObject(c)||c==""||c.length==0){b=0}this.pagebar.setTotalCount(b);this.pagebar.calPage_(this.reqPageNo,this.reqPageSize,b);this.setPageInfo()}}},pageBtnDisabled:function(a){if(a){$("#toPage_"+this.id).attr("disabled",true);$("#pageSize_"+this.id).attr("disabled",true);$("#page_"+this.id).find(".first_page_btn,.pre_page_btn").addClass("disabled");$("#page_"+this.id).find(".next_page_btn,.last_page_btn").addClass("disabled");$("#page_"+this.id).find(".refresh_btn").addClass("disabled")}else{$("#toPage_"+this.id).attr("disabled",false);$("#pageSize_"+this.id).attr("disabled",false);$("#page_"+this.id).find(".first_page_btn,.pre_page_btn").removeClass("disabled");$("#page_"+this.id).find(".next_page_btn,.last_page_btn").removeClass("disabled");$("#page_"+this.id).find(".refresh_btn").removeClass("disabled")}},loadRecords:function(a){this.currentPageSize=a.length||(a.rows&&a.rows.length);this.result=a.rows||a;Horn.debug("init datagrid data...",this.result);this.createDataTable();this.initScroll();this.trs=this.dataTable.children("tbody").children("tr");this.fro_trs=this.frozenTable.children("tbody").children("tr");this.loaded=true;Horn.debug("init datagrid data success ...")},calMaxLength:function(){var d,f,e,g=this;for(var c=0;c<g.params.items.length;c++){d=g.params.items[c];var a=d.text.getWidth(12);if(g.params.autoWidth||d.autoWidth){for(var b=0;b<g.result.length;b++){f=g.result[b];e=(""+f[d.name]||"0").getWidth(12);a=e>a?e:a}}d._maxLength=a}},createDataTable:function(){var o=this;var g="false";var k=this.params.isWordwrap+"";if(k=="true"){g="true"}var n=[];var d=[];var m=this.ths.length;if(this.frozenObj){var c=$("#freez_head_"+this.id).children("tbody").children("tr").length}if(this.result&&this.result.length>0){var q=1;for(var s=0;s<this.result.length;s++){var t=this.result[s];if(this.frozenObj||this.params.frozenHead){this.createFrozenTableTr(t,q,d)}var u=this.tr.replace("{TR_ID}","tr_"+this.id+"_"+q);u=u.replace("{TR_CLASS}",(q%2==0)?this.row_class:"");if(this.params.trHeight&&this.params.trHeight!=""){u=u.replace("{TR_HEIGHT}",this.params.trHeight)}n.push(u);if(this.numbercolumn&&this.numbercolumn==true){var a=this.td_number.replace("{count}",q).replace("{numberColumnWidth}",this.numberColWidth);n.push(a)}if(this.selectModel&&this.selectModel=="multi"){var a=this.td_check.replace("{CHECKBOX_ID}","cb_"+this.id+"_"+q);a=a.replace("{CHECK_TYPE}","checkbox");n.push(a)}else{if(this.selectModel&&this.selectModel=="single"){var a=this.td_check.replace("{CHECKBOX_ID}","cb_"+this.id+"_"+q);a=a.replace("{CHECK_TYPE}","radio");n.push(a)}}for(var p=0;p<this.frozenObjs.length;p++){this.frozenObj=this.frozenObjs[p];if(this.frozenObj||this.params.frozenHead){var a=this.td.replace("{XDATAGRID_TD_ALIGN}",this.setAlign(this.frozenObj.tAlign));var f=this._getItemWidth(this.frozenObj);a=a.replace("{XDATAGRID_TD_WIDTH}",this.frozenObj.width?this.frozenObj.width+"px":f);a=a.replace("{XDATAGRID_DIV_WIDTH}",this.frozenObj.width?this.frozenObj.width+"px":f);if(this.frozenObj.hidden&&this.frozenObj.hidden==true){a=a.replace("{XDATAGRID_TD_HIDDEN}","none")}var l=this.getCellValue(t,this.frozenObj.name);l=this.formatData(this.frozenObj.dataType,this.frozenObj.format,l);if(l!=""&&(l=="null"||l=="NULL"||l=="undefined")){l=""}a=a.replace("{XDATAGRID_TD_VAL}",l);n.push(a)}}this.frozenObj=this.frozenObjs[0];var h=this.items.length;for(var p=0;p<h;p++){var e=this.items[p];if(e.name!=this.params.frozen&&this.params.frozen.indexOf(e.name)<0){var a=this.td.replace("{XDATAGRID_TD_ALIGN}",this.setAlign(e.tAlign));if((this.params.frozen&&this.params.frozen!="")||this.params.frozenHead){var f=this._getItemWidth(e);var r=e.hidden+"";if((p==h-1)&&r!="true"){a=a.replace("{XDATAGRID_TD_WIDTH}","auto");a=a.replace("{XDATAGRID_DIV_WIDTH}",e.width?e.width+"px":f)}else{a=a.replace("{XDATAGRID_TD_WIDTH}",e.width?e.width+"px":f);a=a.replace("{XDATAGRID_DIV_WIDTH}",e.width?e.width+"px":f)}}else{if(e.width&&e.width!=""){a=a.replace("{XDATAGRID_TD_WIDTH}",e.width+"px");a=a.replace("{XDATAGRID_DIV_WIDTH}",e.width+"px")}}if(e.hidden&&e.hidden==true){a=a.replace("{XDATAGRID_TD_HIDDEN}","none")}var l=this.getCellValue(t,e.name);if(e.dataType&&e.dataType!=null){l=this.formatData(e.dataType,e.format,l)}if(l!=""&&(l=="null"||l=="NULL"||l=="undefined")){l=""}if(g=="false"){a=a.replace("{WORD_NOT_WRAP}","overflow: hidden")}else{if(o.params.frozen&&o.params.frozen!=""){a=a.replace("{WORD_IS_WRAP}","overflow: visible")}else{a=a.replace("{WORD_NOT_WRAP}","white-space: normal;text-overflow: initial;;word-wrap:break-word; word-break:break-all")}}if(g=="true"){if(o.params.frozen&&o.params.frozen!=""){if(o.getStrlen(l)>40){var b=20;if(o.params.trHeight&&o.params.trHeight!=""){b=o.params.trHeight}l='<textarea   readonly style="height: '+b+'px;width: 100%;border: 0;background: transparent;line-height: 15px;outline: none;" class="div-textarea">'+l+"</textarea>";a=a.replace("{FROZEN_CSS}","height:"+b+"px;line-height;"+b+"px;padding:0")}}}a=a.replace("{XDATAGRID_TD_VAL}",l);n.push(a)}}n.push(this.tr_end);q++}}if(this.frozenObj){this.frozenTable.children("tbody").html("");this.frozenTable.children("tbody").append(d.join(""))}this.dataTable.children("tbody").html("");this.dataTable.children("tbody").append(n.join(""));this.reCalRowHeight()},resetTdContent:function(){},headerLastWidth:function(){var a=this.head_dataTable.children("tbody").children("tr");var b=this;if((b.params.frozen&&b.params.frozen!="")||this.params.frozenHead){b.header.children("tbody").children("tr").children("td").each(function(d,c){var e=$(this).attr("oldWidth");if(e){e=$.trim(e);$(this).css("width",e)}});a.each(function(e,d){var g=$(d);var f=g.find("td");for(var c=0;c<f.length;c++){var j=$(f[c]);var h=j.css("display");if((c==f.length-1)&&h!="none"){j.css("width","auto")}}})}},getStrlen:function(e){var b=2;var a=0;for(var d=0;d<e.length;d++){var f=e.charCodeAt(d);if((f>=1&&f<=126)||(65376<=f&&f<=65439)){a++}else{a+=b}}return a},formatData:function(e,d,f){return Horn.Util.Format.all(e,d,f)},createFrozenTableTr:function(e,c,l){l=l||[];var f="false";var a=this.params.isWordwrap+"";if(a=="true"){f="true"}var h=this.tr.replace("{TR_ID}","tr_"+this.id+"_"+c);h=h.replace("{TR_CLASS}",(c%2==0)?this.row_class:"");if(this.params.trHeight&&this.params.trHeight!=""){h=h.replace("{TR_HEIGHT}",this.params.trHeight)}l.push(h);if(this.numbercolumn&&this.numbercolumn==true){var b=this.td_number.replace("{count}",c).replace("{numberColumnWidth}",this.numberColWidth);l.push(b)}if(this.selectModel&&this.selectModel=="multi"){var b=this.td_check.replace("{CHECKBOX_ID}","cb_"+this.id+"_"+c);b=b.replace("{CHECK_TYPE}","checkbox");l.push(b)}else{if(this.selectModel&&this.selectModel=="single"){var b=this.td_check.replace("{CHECKBOX_ID}","cb_"+this.id+"_"+c);b=b.replace("{CHECK_TYPE}","radio");l.push(b)}}for(var g=0;g<this.frozenObjs.length;g++){this.frozenObj=this.frozenObjs[g];if(this.frozenObj){var b=this.td.replace("{XDATAGRID_TD_ALIGN}",this.setAlign(this.frozenObj.tAlign));var d=this._getItemWidth(this.frozenObj);b=b.replace("{XDATAGRID_TD_WIDTH}",this.frozenObj.width?this.frozenObj.width+"px":d);b=b.replace("{XDATAGRID_DIV_WIDTH}",this.frozenObj.width?this.frozenObj.width+"px":d);if(this.frozenObj.hidden&&this.frozenObj.hidden==true){b=b.replace("{XDATAGRID_TD_HIDDEN}","none")}var k=this.getCellValue(e,this.frozenObj.name);k=this.formatData(this.frozenObj.dataType,this.frozenObj.format,k);if(f!="true"){b=b.replace("{WORD_NOT_WRAP}","overflow: hidden")}b=b.replace("{XDATAGRID_TD_VAL}",k);l.push(b)}}this.frozenObj=this.frozenObjs[0];l.push(this.tr_end)},_getItemWidth:function(d){var c=d;for(var b=0;b<this.params.items.length;b++){if(d.name==this.params.items[b]["name"]){c=this.params.items[b];break}}if((this.params.frozen&&this.params.frozen!="")||this.params.frozenHead){var a=c.width||100;return a+"px"}else{return""}},initScroll:function(){var a="#data_"+this.id;var c="#head_"+this.id;var b="#freez_body_"+this.id;$(a).scroll(function(){var e=$(a).scrollLeft();var d=$(a).scrollTop();$(c).css("margin-left",-e);$(b).css("margin-top",-d)})},getCellValue:function(g,f){g=g||{};f=f||"";var c=this.params.items;for(var e=0;e<c.length;e++){if(c[e]["name"]==f&&c[e]["items"]){var a=c[e]["items"];for(var d=0;d<a.length;d++){if(a[d]["value"]==g[f]){var b=a[d]["label"];if(this.useDictCode.toString()=="true"){g[f]=a[d]["value"]}else{g[f]=a[d]["label"]}return b}}}}if(g[f]||g[f]==0){return g[f]}else{return""}},createPagebar:function(){if(this.params.pageConfig){var a=this;this.pagebar=new Horn._Pagebar(this.params.pageConfig,this.id,a)}},setPageInfo:function(){$("#toPage_"+this.id).val(this.pagebar.currentPage);$("#pageSize_"+this.id).val(this.pagebar.pageSize);$("#totalPages_"+this.id).html(this.pagebar.pages);if((this.pagebar.pageSize%5)==0){var c=this.pagebar.pageSize/5;if(c==20){c=11}else{if(c==40){c=12}else{if(c==100){c=13}else{if(c==200){c=14}}}}var a=$($(".dropdown-menu-datagrid").find("li").get(c-1));a.addClass("active");this.pagebar.activeLi=a}var b=this.params.isNotTotal?this.params.isNotTotal+"":"false";if(b!="true"){$("#pageInfo_"+this.id).html(this.pagebar.getPageInfo())}if(1==this.pagebar.currentPage){$("#page_"+this.id).find(".first_page_btn,.pre_page_btn").addClass("disabled")}else{$("#page_"+this.id).find(".first_page_btn,.pre_page_btn").removeClass("disabled")}if(this.pagebar.pages==this.pagebar.currentPage){if(b!="true"){$("#page_"+this.id).find(".next_page_btn,.last_page_btn").addClass("disabled")}}else{$("#page_"+this.id).find(".next_page_btn,.last_page_btn").removeClass("disabled")}$("#page_"+this.id).find(".refresh_btn").removeClass("disabled")},reqPage:function(b,a){this.reqPageNo=b?b:this.reqPageNo;this.reqPageSize=a?a:this.reqPageSize;if(this.loadFlag!="autoLoad"&&this.storgedData){this.result=this.storgedData.slice((this.reqPageNo-1)*this.reqPageSize,this.reqPageNo*this.reqPageSize);if(!this.hasPage){this.result=this.storgedData}this.loadRecords(this.result);this.setTHHidden();this.initScroll();this.staticInitPagebar();this.initSelect();this.bindClickEvent(this.rowclick,"click");this.bindClickEvent(this.rowdblclick,"dblclick");this.initSelectEvents();this.initHignLightEvent();this.columnRender()}else{this.load()}},initSelect:function(){var b=this;$("#"+this.allCheckboxId).prop("checked",false);var a=$("#"+this.allCheckboxId);if(a&&this.selectModel=="multi"){a.prop("checked",false);if(this.frozenObj){this.fro_trs.each(function(c,d){$(d).find("#cb_"+b.id+"_"+(c+1)).prop("checked",false)})}this.trs.each(function(c,d){$(d).find("#cb_"+b.id+"_"+(c+1)).prop("checked",false)})}this.selecteds=[];this.lastSelect={}},bindClickEvent:function(b,f){var j=undefined;var a=undefined;if(b){j=Horn.Util.getFunObj(b);if($.type(j.fn)=="function"){a=j.fn}}if(a){var g=this.trs;var e=this.clickFlag;for(var d=0;d<g.length;d++){var h=$(g[d]);var c=j.params.slice(0);c.push(this.result[d],this.result);h.bind(f,c,function(l){var k=l.data;var m=this;if(f=="click"){clearTimeout(e);e=setTimeout(function(){return j.fn.apply(m,k)},300)}else{return j.fn.apply(m,k)}})}}},setAlign:function(a){a=a||"left";return a},setTHHidden:function(){var a=this;this.ths.each(function(b,f){var e=$(f);var g=e.find("div.hc-datagrid-cell");if(g.size()>0){for(var c=0;c<a.items.length;c++){var d=a.items[c];if(g.attr("name")==d.name){g.css("textalign",d.hAlign?d.hAlign:"center");g.css("width",a._getItemWidth(d));if(d.hidden&&d.hidden==true){e.hide()}break}}}});if(this.frozenObj){this.fro_ths.each(function(b,f){var e=$(f);var g=e.find("div.hc-datagrid-cell");if(g.size()>0){for(var c=0;c<a.items.length;c++){var d=a.items[c];if(g.attr("name")==d.name){g.css("textalign",d.hAlign?d.hAlign:"center");g.css("width",a._getItemWidth(d));if(d.hidden&&d.hidden==true){e.hide()}break}}}})}},dictColRender:function(e,d,b){e.attr("key",e.text());var a=e.children("div").text();var c=Horn.getDict(d);if(c){if(a==""||c[a]==undefined){e.children("div").html("");e.children("div").attr("title","")}else{e.children("div").html(c[a]||a);if(b==false||b=="false"){e.children("div").attr("title","")}else{e.children("div").attr("title",c[a]||a)}}}},buttonsColRender:function(c,h,a,f,g,b,j,l){c.find("div").attr("title","");var e=h;var k=$("<span></span>");$(e).each(function(q,n){var o=Horn.Util.getFunObj(n.event);if(!o.fn){return}var m=$("<a href='javascript:void(0)'>"+n.label+"</a>"),p=c.children("div").text();m.click(function(){o.fn.call(m,{val:p,rowdata:l,alldata:j,table:b,rowidx:a,tdidx:f,tr:g,td:c})});m.css("color","#3366CC");m.hover(function(){$(this).css("color","#CC3300");$(this).css("text-decoration","underline")},function(){$(this).css("color","#3366CC");$(this).css("text-decoration","none")});k.append(m);if(q!=(e.length-1)){k.append(" | ")}});c.children("div").html("");c.children("div").append(k);if(this.frozenObj){var d=$(this.fro_trs[a]).find("td")[f];$(d).children("div").html("");$(d).children("div").append(k)}},colRendererFunc:function(a,e,h,d,f,a){var c=this;a.attr("key",a.find("div").text());a.find("div").attr("title","");var g=Horn.Util.getFunObj(e);var j=a.find("div").html();if(!g.fn){return}var b=g.fn.call($(this),{val:j,rowdata:c.result[h],alldata:c.result,table:c,rowidx:h,tdidx:d,tr:f,td:a});if(b instanceof $){a.find("div").html("");a.find("div").append(b)}else{a.find("div").html(b)}},columnRender:function(){var e=this;var b=this.ths;function d(f){for(var g=0;g<e.params.items.length;g++){if(f==e.params.items[g]["name"]){return e.params.items[g]}}}var a=this.fro_header;var c=this.header;a.find("td").each(function(f,j){var k=$(j).find("div").attr("name");if(k){var h=d(k),g=e._getItemWidth(h);$(j).find("div").width(g)}});c.find("td").each(function(f,j){var k=$(j).find("div").attr("name");if(k){var h=d(k),g=e._getItemWidth(h);$(j).find("div").width(g)}});this.trs.each(function(g,f){var k=$(f);var h=$(e.fro_trs[g]),j=h.find("td");k.find("td").each(function(t,o){var q=$(o);var n=$(b.get(t));var u=n.find("div").attr("dictname"),v=n.find("div").attr("renderer"),l=n.find("div").attr("name"),w=n.find("div").attr("buttons"),m,x;var r=$(j.get(t));var p=true;for(var s=0;s<e.params.items.length;s++){if(e.params.items[s].name==l){p=e.params.items[s]["isShowTitle"];if(p==false||p=="false"){q.find("div").attr("title","");r.find("div").attr("title","")}else{q.find("div").attr("title",q.find("div").text());r.find("div").attr("title",r.find("div").text())}}}for(var s=0;s<e.params.items.length;s++){if(e.params.items[s].name==l){w=e.params.items[s]["buttons"];m=e.params.items[s]["width"];x=e.params.items[s];if(x.autoWidth||e.params.autoWidth){}else{if(!m){}}break}}if(u){e.dictColRender(q,u,p);if(e.frozenObj){e.dictColRender(r,u,p)}}else{if(w){e.buttonsColRender(q,w,g,t,k,e,e.result,e.result[g])}}if(v){e.colRendererFunc(q,v,g,t,k,q);if(e.frozenObj){e.colRendererFunc(r,v,g,t,h,r)}}})})},setTitle:function(a){this.title=a;this.titleEl.text(a)},getTitle:function(){return this.title},addButton:function(b){var a={name:"",cls:"",event:""};b=$.extend(a,b);if(!b||!b.label){return}var d=$("#wrap_"+this.id).children("div.u-datagrid-toolbar").children("ul");var c=$('<li><a name="'+b.name+'" href="JavaScript:void(0)" class="hc-datagrid-a hc_datagrid-alink" onclick="'+b.event+'"><i class="fa '+b.cls+'"></i>'+b.label+"</a></li>");d.append(c)},hideButton:function(a,c){var e=$("#wrap_"+this.id).children("div.u-datagrid-toolbar").children("ul");var d=e.children("li").children("a");for(var b=0;b<d.length;b++){if($(d[b]).attr("name")==a){if(c){$(d[b]).hide()}else{$(d[b]).show()}}}}});$.extend(Horn.DataGrid,{DATANAME:"h_datagrid"});Horn.regUI("div.xdatagrid",Horn.DataGrid);function setDefaultValue(c,b,a){if(c[b]===undefined){c[b]=a}else{if(c[b]=="true"){c[b]=true}else{if(c[b]=="false"){c[b]=false}}}}Horn._Pagebar=function(d,c,a){var b={gridId:null,INDEX_PAGE:1,currentPage:1,pageSize:10,pageCount:0,pages:0,startRow:0,isNotTotal:false,selectPageSize:false,language:null,init:function(g,f,e){if(g){setDefaultValue(g,"pageSize",10);setDefaultValue(g,"pageNo",1);setDefaultValue(g,"startRow",0);setDefaultValue(g,"pageCount",0);setDefaultValue(g,"currentPage",0);this.currentPage=parseInt(g.currentPage);this.pageCount=parseInt(g.pageCount);this.pageSize=parseInt(g.pageSize);this.pageNo=parseInt(g.pageNo);this.startRow=parseInt(g.startRow);this.pages=0}this.language=e.params.language;this.gridId=f;this.grid=e;this.grid.reqPageSize=this.pageSize;this.grid.reqPageNo=this.pageNo;this.el=$("#page_"+this.gridId);var h=this.el.attr("isNotTotal");if(h=="true"){this.isNotTotal=true}var j=this.el.attr("selectPageSize");if(j=="true"){this.selectPageSize=true}},initEvents:function(){var f=this;$("#page_"+this.gridId).children("li").find("a").each(function(h,j){var k=$(j);var l=function(n,o,m){n.click(function(){if(n.hasClass("disabled")){return}m=m||[];o.apply(f,m)})};if(!k.hasClass("disabled")){if(k.hasClass("first_page_btn")){l(k,f.first)}else{if(k.hasClass("pre_page_btn")){l(k,f.pre)}else{if(k.hasClass("next_page_btn")){l(k,f.next)}else{if(k.hasClass("last_page_btn")){l(k,f.last)}else{if(k.hasClass("refresh_btn")){l(k,f.refresh)}}}}}}});this.perPage=false;$("#_recPerPage"+this.gridId).on("click",function(){optGridId=$(this).attr("id");optGridId=optGridId.substring(11);var h=$(this).children("strong").text();if(f.perPage){$(this).next().hide();f.perPage=false}else{$(this).next().show();$(this).next().find("li").each(function(j,k){var l=$(this).children("a").text();if(h==l){$(this).addClass("active")}else{$(this).removeClass("active")}});f.perPage=true}});$("#_recPerPage"+this.gridId).bind("blur",function(j){var h=j;if(f.perPage){$(".dropdown-menu-datagrid").hide();f.perPage=false;return true}});$(".dropdown-menu-datagrid").bind("mouseover",function(){$("#_recPerPage"+f.gridId).unbind("blur")});$(".dropdown-menu-datagrid").bind("mouseout",function(){$("#_recPerPage"+f.gridId).bind("blur",function(j){var h=j;if(f.perPage){$(".dropdown-menu-datagrid").hide();f.perPage=false;return true}})});this.activeLi=$(".dropdown-menu-datagrid").find("li.active");var g=this.grid;$("#toPage_"+g.id).on("blur",function(){f.callToPage($(this))});if(this.selectPageSize){$("#pageSize_"+g.id).find("option[text='"+this.grid.reqPageSize+"']").attr("selected",true)}var e=this.selectPageSize?"change":"blur";$("#pageSize_"+g.id).on(e,function(){f.callToPageSize($(this))});$("#toPage_"+g.id).bind("keypress",function(h){if(h.keyCode=="13"){f.callToPage($(this))}});$("#pageSize_"+g.id).bind("keypress",function(h){if(h.keyCode=="13"){f.callToPageSize($(this))}})},callToPage:function(g){var f=this.grid;var e=g.val();if(!e||isNaN(e)){e=f.reqPageNo}e=parseInt(e,10);if(e<=0){e=1}else{if(e>f.pagebar.pages){e=1}}g.val(e);f.reqPage(g.val(),$("#pageSize_"+f.id).html())},callToPageSize:function(h){var g=this;var e=h.val();if(e==""){var f=g.pageSize;if(f&&f!=""){e=f}else{e=10}}if(!e||isNaN(e)){e=thatgrid.pageSize}e=parseInt(e,10);if(e<=0){e=1}h.val(e);g.grid.reqPage(parseInt($("#toPage_"+g.grid.id).val()),e)},calPage_:function(g,f,e){this.pageSize=parseInt(f);this.pageCount=parseInt(e);this.pages=Math.ceil(this.pageCount/this.pageSize);if(!this.isNotTotal){if((g*this.pageSize)>this.totalCount){this.currentPage=this.pages}else{this.currentPage=g}}else{if(this.currentPage==0){this.currentPage=1}}},pre:function(){if(this.isNotTotal){var e=this.currentPage-1;this.currentPage=e;this.grid.reqPage(e,this.pageSize)}else{if(this.currentPage<=1||this.pageCount==0){this.grid.reqPage(1,this.pageSize)}else{this.grid.reqPage((this.currentPage-1),this.pageSize)}}},next:function(){if(!this.isNotTotal){if(this.pages==this.currentPage){return}}var e=0;if(this.currentPage!=""){e=parseInt(this.currentPage)+1}if(this.isNotTotal){e=this.currentPage+1;this.currentPage=e}this.grid.reqPage(e,this.pageSize)},last:function(){if(this.pages==0){return}else{this.grid.reqPage(this.pages,this.pageSize)}},first:function(){this.grid.reqPage(this.INDEX_PAGE,this.pageSize)},refresh:function(){var e=this.grid.reqPageNo-1;if(this.grid.loadFlag=="autoLoad"){e=this.grid.reqPageNo}this.grid.reqPage(e,this.pageSize)},getPageInfo:function(){var f;var g=0,e=0;if(this.pageCount>0){g=this.pageSize*(this.currentPage-1)+1;if((this.pageSize*this.currentPage)>=this.pageCount){e=this.pageCount}else{e=this.pageSize*this.currentPage}}if((this.language&&this.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){f="Displaying "+g+" to "+e+" of "+this.pageCount+" items"}else{f="显示"+g+"到"+e+"条,共"+this.pageCount+"条记录"}return f},setTotalCount:function(e){this.totalCount=parseInt(e)}};b.init(d,c,a);b.initEvents();return b};String.prototype.getWidth=function(b){var a=document.getElementById("__getwidth");if(a==null){a=document.createElement("span");a.id="__getwidth";document.body.appendChild(a);a.style.visibility="hidden";a.style.whiteSpace="nowrap"}a.innerHTML=this.toString();a.style.fontSize=b+"px";return a.offsetWidth};
Horn.DocView=Horn.extend(Horn.Base,{COMPONENT_CLASS:"DocView",id:"docViewId",height:500,width:800,url:null,filePath:null,fileName:null,officeHome:null,swfToolsHome:null,appServer:null,type:"media",SUBFFIX:".txt,.doc,.docx,.xls,.xlsx,.pdf,.ppt,.pptx",init:function(e){Horn.DocView.superclass.init.apply(this,arguments);var f=this;this.url=this.params.url?this.params.url:null;this.officeHome=this.params.officeHome?this.params.officeHome:null;this.swfToolsHome=this.params.swfToolsHome?this.params.swfToolsHome:null;this.filePath=this.params.filePath?this.params.filePath:null;this.fileName=this.params.fileName?this.params.fileName:null;this.id=this.params.id?this.params.id:this.id;this.width=this.params.width?this.params.width:this.width;this.height=this.params.height?this.params.height:this.height;this.type=this.params.type?this.params.type:this.type;this.appServer=this.el.attr("appServer");if(this.url==null){Horn.Msg.alert("提示","url必须配置，请检查");return}if(this.officeHome==null){Horn.Msg.alert("提示","officeHome必须配置，请检查");return}if(this.swfToolsHome==null){Horn.Msg.alert("提示","swfToolsHome必须配置，请检查");return}if(f.fileName!=null){var c=f.fileName.substring(f.fileName.lastIndexOf("."));if(c){c=c.toLowerCase()}if(f.SUBFFIX.indexOf(c)==-1){Horn.Msg.alert("提示","只支持文档格式如："+f.SUBFFIX);return}var b=$("div.doc_header_mod").children("h2").children("em");if(c==".doc"||c==".docx"){b.addClass("fa fa-file-word-o word")}else{if(c==".xls"||c==".xlsx"){b.addClass("fa fa-file-excel-o xls")}else{if(c==".ppt"||c==".pptx"){b.addClass("fa fa-file-powerpoint-o ppt")}else{if(c==".txt"){b.addClass("fa fa-file-archive-o txt")}else{if(c==".pdf"){b.addClass("fa fa-file-pdf-o pdf")}else{}}}}}var d="filePath="+f.filePath+"&fileName="+encodeURI(encodeURIComponent(f.fileName))+"&officeHome="+f.officeHome+"&swfToolsHome="+f.swfToolsHome+"&width="+this.width+"&height="+this.height+"&type="+this.type;var a=f.url+"?"+d;Horn.Msg.load("正在载入文档，请稍后...");$("#view_"+f.id).attr("src",a);$("#view_"+f.id).load(function(){Horn.Msg.unload()})}},load:function(f,a,d,k,c){var g=this;if(f&&f!=""){var b=f.substring(f.lastIndexOf("."));if(b){b=b.toLowerCase()}if(g.SUBFFIX.indexOf(b)==-1){Horn.Msg.alert("提示","只支持文档格式如："+g.SUBFFIX);return}var h=$("div.doc_header_mod").children("h2").children("em");var i=$("div.doc_header_mod").children("h2").children("span");h.removeClass();if(b==".doc"||b==".docx"){h.addClass("fa fa-file-word-o word")}else{if(b==".xls"||b==".xlsx"){h.addClass("fa fa-file-excel-o xls")}else{if(b==".ppt"||b==".pptx"){h.addClass("fa fa-file-powerpoint-o ppt")}else{if(b==".txt"){h.addClass("fa fa-file-archive-o txt")}else{if(b==".pdf"){h.addClass("fa fa-file-pdf-o pdf")}else{}}}}}i.html(f)}else{Horn.Msg.alert("提示","fileName必须配置");return}if(!a){if(this.url){a=this.url}else{Horn.Msg.alert("提示","url必须配置");return}}if(!d){if(this.filePath){d=this.filePath}else{Horn.Msg.alert("提示","filePath文件的所在路径必填");return}}if(!k){if(this.officeHome){k=this.officeHome}else{Horn.Msg.alert("提示","officeHome根目录必须配置");return}}if(!c){if(this.swfToolsHome){c=this.swfToolsHome}else{Horn.Msg.alert("提示","swfToolsHome根目录必须配置");return}}var e="filePath="+d+"&fileName="+encodeURI(encodeURIComponent(f))+"&officeHome="+k+"&swfToolsHome="+c+"&width="+this.width+"&height="+this.height+"&type="+this.type;var j=a+"?"+e;Horn.Msg.load("正在载入文档，请稍后...");$("#view_"+g.id).attr("src",j);$("#view_"+g.id).load(function(){Horn.Msg.unload()})}});Horn.regUI("div.hc_docview",Horn.DocView);
function registeSelfHtml(a){var b=$(a);Horn.getUIReady()(b,true)}function uuid(){var a="",c;for(var b=1;b<=32;b++){c=Math.floor(Math.random()*16).toString(16);a+=c;if((b==8)||(b==12)||(b==16)||(b==20)){a+="-"}}return a}Horn.EditGrid=Horn.extend(Horn.Base,{COMPONENT_CLASS:"EditGrid",id:"dyncEditGrid",name:"dyncEditGrid",url:"",title:"",alias:null,maxRowSize:null,numbercolumn:false,rowSelect:false,selectModel:"",skipValid:false,init:function(a){Horn.EditGrid.superclass.init.apply(this,arguments);var b=this;b.alias=this.el.attr("alias");b.pagesize=b.params.pagesize;b.maxRowSize=b.params.maxRowSize;b.compaddedsize=b.params.pagesize;if(b.params.id&&b.params.id!=""){b.id=b.params.id}else{b.id="dyncEditGrid"}b.name=b.params.name;b.firsttableid="first_"+b.id;b.gridtableid="table_"+b.id;b.tbody=$("#"+b.gridtableid);b.thead=$("#"+b.id).find("thead");b.copytable=$("#"+b.gridtableid+"_copytab");b.copytableCell=$("#"+b.gridtableid+"_copytab").find("td");b.editingCell=[];b.selectIndex=[];b.cacheData=[];if(b.params.selectedcolor){b.selectedcolor=b.params.selectedcolor}if(b.params.selectmode){b.selectmode=b.params.selectmode}$.each(b.params.events||[],function(c,d){b[d.event.toLowerCase()]=d["function"]});b.initEvent();b.initTableEvent();if(b.params.url!=""&&b.params.url!=undefined){b.load(b.params.url)}},initEvent:function(){var a=this;a.addbtn=a.el.find("#addBTN_"+a.id);a.deletebtn=a.el.find("#deleteBTN_"+a.id);a.savebtn=a.el.find("#saveBTN_"+a.id);a.refreshbtn=a.el.find("#refreshBTN_"+a.id);$(a.addbtn).on("click",function(){var b=a.el.find("#noResult");if(b.is(":visible")){b.hide()}a.addRow();a.stopEventBubble()});$(a.deletebtn).on("click",function(){var e;e=a.cacheData.length-1;var d=a.tbody.find("tr.u-editgrid-selected");if(d.length>0&&a.params.selectModel=="single"){var b=a.tbody.find("tr.u-editgrid-selected");var e=$(b[0]).index();var c=$(b[0]).attr("rownum");a.deleteRow(e,c);return}if(d.length>0&&a.params.selectModel=="multi"){a.deleteSelectedRows();return}if(e<0){return}a.deleteRow(e)});$(a.savebtn).on("click",function(){a.saveData();if(a.save){var b=Horn.Util.getFunObj(a.save),c;if($.type(b.fn)=="function"){c=b.fn}if(c){c.apply(a,[a.data])}}});$(a.copytableCell).each(function(){$(this).on("dblclick",function(b){a.editCell(b)})});$(a.refreshbtn).on("click",function(){a.reload()});if(a.params.rowevents){a.rowevents=this.params.rowevents}},stopEventBubble:function(a){var b=a||window.event;if(b&&b.stopPropagation){b.stopPropagation()}else{b.cancelBubble=true}},initTableEvent:function(){var a=this;a.tbody.unbind("dblclick");a.tbody.bind("dblclick",function(b){a.editCell(b)})},initSelectEvents:function(){var a=1;var b=this;b.trs=b.tbody.children("tr");if(b.params.selectModel=="single"){b.trs.each(function(e,c){var f=$(c);var d=f.find('input[type="radio"]');a++;if(b.params.rowSelect==false){d.change(function(){if(this.checked){b.selectRow(e+1,f)}else{b.unSelectRow(e+1,f)}})}else{f.bind("click",function(g){if(f.hasClass("u-editgrid-selected")){b.unSelectRow(e+1,f)}else{b.selectRow(e+1,f)}})}})}if(b.params.selectModel=="multi"){b.el.find("#editgrid_selectall").change(function(){if(this.checked){b.selectAll()}else{b.unSelectAll()}});if(b.params.rowSelect==false){b.tbody.find(".hc-datagrid-cell-check").each(function(d,c){var e=$(c);e.children("input:checkbox").change(function(){if(this.checked){b.selectRow(d+1,$(e).closest("tr"));var f=b.tbody.find("input:checked").length;if(b.cacheData.length==f){b.el.find("#editgrid_selectall").prop("checked",true)}}else{b.unSelectRow(d+1,$(e).closest("tr"));b.el.find("#editgrid_selectall").prop("checked",false)}})})}else{b.trs.each(function(d,c){var e=$(c);e.bind("click",function(g){if(e.hasClass("u-editgrid-selected")){b.unSelectRow(d+1,e);b.el.find("#editgrid_selectall").prop("checked",false)}else{var f=b.tbody.find("input:checked").length;if(b.cacheData.length==f){b.el.find("#editgrid_selectall").prop("checked",true)}b.selectRow(d+1,e)}})})}}},initHignLightEvent:function(){var b=this;var a=this.tbody.find("tr");a.each(function(d,c){var e=$(c);e.mouseover(function(){e.addClass("hc-editgrid-row-over")});e.mouseout(function(){e.removeClass("hc-editgrid-row-over")})})},stateTest:function(){var b=this;var a=true;b.el.find(".hc-datagrid-cell-check").each(function(d,c){var f=$(c);var e=f.children("input:checkbox")});if(a){b.el.find(".h_datagrid_select_all").prop("checked",true)}else{b.el.find(".h_datagrid_select_all").prop("checked",false)}},unSelectAll:function(){var a=this;a.tbody.find("div.hc-datagrid-cell-check input:checkbox").each(function(b,c){c.checked=false;a.unSelectRow(b+1,$(c).closest("tr"))});a.el.find("#editgrid_selectall").prop("checked",false)},selectAll:function(){var a=this;a.tbody.find("div.hc-datagrid-cell-check input:checkbox").each(function(b,c){c.checked=true;a.selectRow(b+1,$(c).closest("tr"))})},editCell:function(g){var i=this;var f=$(g.target).closest("td");if(i.params.numbercolumn&&f.index()==0){return}var d=f.find(".showvalue").text();var a=f.attr("compid");var h=Horn.getComp(a).getValue();var c=f.attr("fieldtype");if(d!=""&&h==""){if(c=="6"||c=="5"){var b=f.find(".showvalue").attr("key");Horn.getComp(a).setValue(b)}else{Horn.getComp(a).setValue(d)}}if(i.editingCell.length==0){i.editingCell=f;f.find(".content").show();f.find(".showvalue").hide()}if(i.editingCell.attr("id")==f.attr("id")){return}else{i.changeCelldata(i.editingCell);f.find(".content").show();f.find(".showvalue").hide();i.editingCell=f}},load:function(a,b){var c=this;b=b||{};this.selecteds=null;if($.type(b)=="array"){b=Horn.Util.arr2Obj(b)}c.editingCell=[];c.destroyUI();this.execute(a,b)},loadData:function(c){this.loadFlag="loadData";var d=this;var b=this.params.pageConfig["pageNo"];var a=this.params.pageConfig["pageSize"];this.reqPageNo=b?b:1;this.reqPageSize=a?a:10;if(c!=null){this.data=c;this.storgedData=c.rows?c.rows:c;this.reqPage(this.reqPageNo,this.reqPageSize);d.el.find("#data_"+d.id).css("height","");this.pageBtnDisabled(false)}},execute:function(d,c){c=c||{};var f=true;if(this.beforeload){var b=Horn.Util.getFunObj(this.beforeload),h;if($.type(b.fn)=="function"){h=b.fn}if(h){try{f=h.apply(this,[this.el,c])}catch(g){}}}if(f!=false){var a=Horn.apply({},this.baseParams,c);this.doAjax(d,a)}return f},doAjax:function(b,c){var d=this;var b=b?b:d.url;if(b&&b.indexOf("http:")==-1){b=context_path+b}var a=d.thead.find("tr").children().length;$.ajax(b,{async:true,type:"POST",data:Horn.Util.obj2Arr(c),dataType:"json",error:function(g,h,f){var e=g.status;d.tbody.empty().html("<tr id='noResult'><td style=\"border-right:0px;padding:15px;\" colSpan='"+a+"'><p>暂时无数据</p><p>错误状态："+e+";错误信息："+h+"</p></td></tr>")},success:function(g,h,m){if(!g||$.isEmptyObject(g)){d.tbody.empty().html("<tr id='noResult'><td style=\"border-right:0px;padding:15px;\" colSpan='"+a+"'><p>暂时无数据</p></td></tr>");if(d.loaderror){var j=Horn.Util.getFunObj(d.loaderror),n;if($.type(j.fn)=="function"){n=j.fn}if(n){n.apply(d,[d.el,g])}return}}else{if(g){var i=g.rows;this.result=i?i:g}if(this.result&&(this.result.length==0||$.isEmptyObject(this.result))){d.tbody.empty().html("<tr id='noResult'><td style=\"border-right:0px;padding:15px;\" colSpan='"+a+"'><p>暂时无数据</p></td></tr>")}else{d.data=g.rows;d.cacheData=[];$.extend(true,d.cacheData,d.data);d.createTable(d.data);d.initTableEvent()}}try{if(d.loadsuccess){var f=Horn.Util.getFunObj(d.loadsuccess),l;if($.type(f.fn)=="function"){l=f.fn}if(l){l.apply(d,[d.el,g])}}}catch(k){Horn.debug(k)}}})},createTable:function(c){var j="",l=[],g=this,a=$("#"+g.gridtableid+"_copyrow").children(),e=$('<tbody id="'+g.gridtableid+'" class="datatable"></tbody>');var k=g.thead.find("tr").children().length;if(c&&c.length>0){for(var d=0,f=c.length;d<f;d++){var b=c[d];var h=$("<tr rownum="+d+"></tr>");a.each(function(o){var s=$(this).clone();if(g.params.numbercolumn&&o==0){s.children("div").text(d+1)}else{var r=s.attr("factorcode");var i=uuid();s.attr({id:"td_"+r+d+i+o,compid:"field"+r+d+i+o+"ID"});var t=s.html();var q="field"+r+d+i+o+"ID";var n=s.attr("fieldtype");s.html(t.replace(new RegExp(("field"+r+"0ID"),"g"),q));s.find("div.showvalue").text(b[r]).show();if(n=="6"){var m=$(g.thead.find("td")[o]);var p=m.attr("dictName");g.dictColRender(s,p,b[r])}if(n=="5"){g.staticDict(s,o,b[r])}}h.append(s)});e.append(h)}this.tbody.empty().html(e.html());this.initHignLightEvent();if(this.params.selectModel!=""&&this.params.selectModel!=undefined){this.initSelectEvents()}registeSelfHtml(this.tbody)}else{g.tbody.empty().html("<tr  id='noResult'><td style=\"border-right:0px;padding:15px;\" colSpan='"+k+"'><p>暂时无数据</p></td></tr>")}},dictColRender:function(d,c,a){var b=Horn.getDict(c);if(b){if(b[a]!=undefined){d.children("div.showvalue").text(b[a]).attr("key",a)}}},staticDict:function(b,e,h){if(this.params.numbercolumn){e=e-1}if(this.params.selectModel!=""&&this.params.selectModel!=undefined){e=e-1}var k=this.params.columns[e];var a=k.items;if(h){var l=h.toString().split(",");var m=[];for(var c=0;c<l.length;c++){var f=l[c];for(var d=0;d<a.length;d++){if(a[d]["code"]==f){m.push(a[d]["text"])}}}var g=m.join(",");b.children("div.showvalue").text(g);b.children("div.showvalue").attr("key",h)}else{b.children("div.showvalue").text("")}},changeCelldata:function(i){var c=this;if(i.length==0){return}i.find(".content").hide();var f=i.attr("compid");var h=i.attr("factorcode");var b=Horn.getComp(f);if(b==undefined){return}var g=Horn.getComp(f).getValue(true);var e=i.attr("fieldtype");i.find(".showvalue").text(g).show();var d=parseInt(i.parent().attr("rownum"));if(e=="5"||e=="6"){var a=Horn.getComp(f).getValue();i.find(".showvalue").attr("key",a);c.cacheData[d][h]=a}else{c.cacheData[d][h]=g}},getData:function(){return this.data},saveData:function(){var a=this;a.changeCelldata(a.editingCell);a.data=$.extend(true,[],a.cacheData);a.editingCell=[];return a.data},reload:function(){var a=this;a.cacheData=[];a.editingCell=[];$.extend(true,a.cacheData,a.data);a.destroyUI();a.createTable(a.data);a.initTableEvent()},selectRow:function(d,a){var c=a;if(this.params.selectModel=="single"){var b=this.lastSelect;if(b&&b.rowidx!==undefined&&b.rowidx!=d){this.unSelectRow(b.rowidx,b.tr)}c.find("input:radio").get(0).checked=true;this.lastSelect={rowidx:d,tr:c}}else{if(this.params.selectModel=="multi"){c.find("input:checkbox").get(0).checked=true;this.selectIndex.push(d)}}c.addClass("u-editgrid-selected")},destroyUI:function(){Horn.destroy("field","ID$_")},isRowSelected:function(a){if(!this.selectedIndex){return false}if(this.selectedIndex[a]||this.selectedIndex[a]==0){return true}return false},unSelectRow:function(d,a){var c=a;c.removeClass("u-editgrid-selected");if(this.params.selectModel=="single"){c.find("input[type='radio']").prop("checked",false)}else{c.find("input[type='checkbox']").prop("checked",false);var b=this.selectIndex.indexOf(d);this.selectIndex.splice(b,1)}},unSelectedRow:function(a){$("#"+this.firsttableid+" tr:eq("+(a+1)+") td").css("background-color",this.unselectedcolor);$("#"+this.gridtableid+" tr:eq("+(a+1)+") td").css("background-color",this.unselectedcolor);if(this.isRowSelected(a)){delete this.selectedIndex[a]}},getSelectedIndex:function(){var a=[];if(this.selectedIndex){for(var b in this.selectedIndex){if($.isNumeric(b)){a.push(parseInt(b))}}}return a},getRowCount:function(){return this.pagesize},getColCount:function(){return this.params.columns.length},getColIndexByColName:function(b){for(var a=0;a<this.params.columns.length;a++){if(this.params.columns[a].factorcode==b){return a}}return -1},getSelecteds:function(){var b=[];for(var a in this.selecteds){if(a=="indexOf"){continue}var c=this.selecteds[a];if(c){b.push(c)}}return b},deleteSelectedRows:function(){var l=this;var h=l.tbody.find("tr.u-editgrid-selected");for(var f=0;f<h.length;f++){var n=$(h[f]).index();var k=$(h[f]).attr("rownum");if(this.params&&l.params.columns){for(var g=0;g<l.params.columns.length;g++){var e=l.getCellTd(k,g);var m=e.attr("compid");var b=e.attr("fieldtype");if(b=="4"){Horn.getComp(m).destroy()}var d=Horn.getComp(m);if(d){var c=null;var a=Horn.getCurrent().find("form");if(a.length>0){for(var g=0;g<a.length;g++){c=$(a[g]);if(c.data("_el_comp_cache")){delete c.data("_el_comp_cache")[d.el.data("comp_el_id")]}if(c.data("_id_comp_cache")){delete c.data("_id_comp_cache")[m]}c.data(m+"$_",null)}}else{c=Horn.getCurrent();if(c.data("_el_comp_cache")){delete c.data("_el_comp_cache")[d.el.data("comp_el_id")]}if(c.data("_id_comp_cache")){delete c.data("_id_comp_cache")[m]}delete c.data(m+"$_")}}}}$("#"+this.gridtableid+" tr:eq("+n+")").remove();l.deleteData(n)}l.reSetRowNumber()},deleteRow:function(j,g){this.unSelectedRow(j);if(this.params&&this.params.columns){for(var f=0;f<this.params.columns.length;f++){if(g){var e=this.getCellTd(g,f)}else{var e=this.getCellTd(j,f)}var h=e.attr("compid");var b=e.attr("fieldtype");if(b=="4"){Horn.getComp(h).destroy()}var d=Horn.getComp(h);if(d){var c=null;var a=Horn.getCurrent().find("form");if(a.length>0){for(var f=0;f<a.length;f++){c=$(a[f]);if(c.data("_el_comp_cache")){delete c.data("_el_comp_cache")[d.el.data("comp_el_id")]}if(c.data("_id_comp_cache")){delete c.data("_id_comp_cache")[h]}c.data(h+"$_",null)}}else{c=Horn.getCurrent();if(c.data("_el_comp_cache")){delete c.data("_el_comp_cache")[d.el.data("comp_el_id")]}if(c.data("_id_comp_cache")){delete c.data("_id_comp_cache")[h]}delete c.data(h+"$_")}}}}$("#"+this.gridtableid+" tr:eq("+j+")").remove();this.deleteData(j);this.reSetRowNumber()},deleteData:function(a){var b=this;b.cacheData.splice(a,1)},reSetRowNumber:function(){var c=this,b=c.trs.length;for(var a=0;a<b;a++){$("#"+c.gridtableid+" tr:eq("+a+")").attr("rownum",a);$("#"+c.gridtableid+" tr:eq("+a+") td").attr("rownum",a)}},addRow:function(e){var h=this;if(h.maxRowSize&&h.maxRowSize>0&&h.pagesize>=h.maxRowSize){Horn.Tip.info("该表格最多能添加 "+h.maxRowSize+" 行，不允许继续增加！");return}var f=$("#"+h.gridtableid+"_copyrow").html();var l=h.cacheData.length;if(h.params&&h.params.columns){var q="0";for(var g=0;g<h.params.columns.length;g++){var k=h.params.columns[g];var a=uuid();var n="field"+k.factorcode+l+a+g+"ID";f=f.replace(new RegExp(("field"+k.factorcode+q+"ID"),"g"),n);if((k.fieldtype=="6"||k.fieldtype=="9"||k.fieldtype=="17")&&k.valuebound){var c=$("div.hc_hide_div > div.hc_checkboxdiv[ref_target^="+k.valuebound+"]");var p=$("div.hc_checkboxdiv[ref_target^="+k.valuebound+"]");if(c.length==0&&p.length>0){$("div.hc_hide_div").append(p)}}}}var j=$("<tr></tr>");$("#"+h.gridtableid).append($(j));$(j).attr("rownum",l);if(h.params.numbercolumn){$(j)}j.append($(f));for(var g=0;g<h.getColCount();g++){var d=h.getCellTd(l,g);if(h.params.numbercolumn&&g==0){d.children("div").text(l+1)}d.attr("rownum",l);d.attr("colnum",g)}registeSelfHtml(j);h.addData();var o=$("#"+h.gridtableid).find("tr:last");o.children("td").on("dblclick",function(i){h.editCell(i)});if(h.params.selectModel!=""){if(h.params.selectModel=="single"){var m=o.find('input[type="radio"]');if(h.rowSelect==false){m.change(function(){if(this.checked){h.selectRow(o.index()+1,$(this).closest("tr"))}else{h.unSelectRow(o.index()+1,$(this).closest("tr"))}})}else{o.bind("click",function(i){if(o.hasClass("u-editgrid-selected")){h.unSelectRow(o.index()+1,o)}else{h.selectRow(o.index()+1,o)}})}}else{var b=o.find(".hc-datagrid-cell-check");if(h.rowSelect==false){b.children("input:checkbox").change(function(){if(this.checked){h.selectRow(o.index()+1,$(b).closest("tr"));var i=h.tbody.find("input:checked").length;if(h.cacheData.length==i){h.el.find("#editgrid_selectall").prop("checked",true)}}else{h.unSelectRow(o.index()+1,$(b).closest("tr"));h.el.find("#editgrid_selectall").prop("checked",false)}})}else{o.bind("click",function(r){if(o.hasClass("u-editgrid-selected")){h.unSelectRow(o.index()+1,o);h.el.find("#editgrid_selectall").prop("checked",false)}else{var i=h.tbody.find("input:checked").length;if(h.cacheData.length==i){h.el.find("#editgrid_selectall").prop("checked",true)}h.selectRow(o.index()+1,o)}})}}}},addData:function(){var b=this;var a=function(){var d={};for(var c=0;c<b.params.columns.length;c++){var e=b.params.columns[c];d[e.factorcode]=""}return d};b.cacheData.push(new a())},setRowValue:function(d,e){if(d>=this.pagesize){this.addRow(e);return}var a=this.getColCount();for(var c=0;c<a;c++){var g=this.getCellTd(d,c);var f=$(g).attr("factorcode");var b=g.attr("fieldtype");if(b=="7"){this.setCellValue(d,c,{label:e[f+"_display"],key:e[f]})}else{this.setCellValue(d,c,e[f])}}},setCellValue:function(c,f,d){var g=this.getCellTd(c,f);var a=g.attr("compid");var e=g.attr("factorcode");var b=g.attr("fieldtype");if(a==""||e==""||b==""){return}},getCellComp:function(b,c){var a=this.getCellCompId(b,c);return getCmp(a)},getCellCompId:function(a,b){var c=this.getCellTd(a,b);return c.attr("compid")},getValue:function(){var c=[];for(var a=0;a<this.pagesize;a++){var b=this.getRowValue(a);c.push(b)}return c},getRowValue:function(d){var e={};for(var b=0;b<this.getColCount();b++){var f=this.getCellData(d,b);for(var a in f){e[a]=f[a]}}return e},getCellValue:function(b,d){var c=this.getCellData(b,d);for(var a in c){return c[a]}return""},getCellData:function(c,f){var g=this.getCellTd(c,f);var a=g.attr("compid");var e=g.attr("factorcode");var b=g.attr("fieldtype");if(a==""||e==""||b==""){return{}}var d={};return d},getCellTd:function(a,b){return $("#"+this.gridtableid+" tr[rownum]:eq("+(parseInt(a))+") td:eq("+b+")")},isValid:function(){var a=this.el.find("input.m-verify-error");if(a&&a.size()>0){return false}else{return true}},isVisible:function(){return $("#"+this.name).css("display")=="none"?false:true},setVisible:function(a){if(a==true){$("#"+this.name).show()}else{$("#"+this.name).hide()}}});Horn.regUI("div.xeditgrid",Horn.EditGrid);
Horn.Field=Horn.extend(Horn.Base,{COMPONENT_CLASS:"Field",field:null,hidden:null,checkGroup:null,defValue:"",defHiddenValue:"",init:function(d){Horn.Field.superclass.init.apply(this,arguments);if(this.field==undefined){this.hidden=this.el.children("input[type='hidden']");if(this.hidden.length){this.field=this.hidden.next("input[type]")}else{this.field=this.el.children("input[type]");if(this.field.length==0){this.field=this.el.children("textarea")}}}this.name=this.field.attr("name")||this.name;this.checkGroup={};var j=this,i=this.field.attr("group");if(i){var f=i.split(";");$(f).each(function(l,m){j.checkGroup[m]=true})}this.initEvents();this.defHiddenValue="";this.defValue="";$.each(j.params.events||[],function(l,m){j[m.event.toLowerCase()]=m["function"]});if(this.hidden.length>0){this.defHiddenValue=this.params.defValue||this.hidden.val()||""}if(this.field.length>0){this.defValue=this.params.defValue||this.field.val()||""}if(this.params.hidden&&this.params.hidden==true){this.hide()}if(this.params.maxlength){var g=parseInt(this.params.maxlength,10);if(g>0){if(this.field.val()!=undefined&&j.getStrlen(this.field.val())>g){var c=this.field.val().substr(0,g);this.field.val(c);var k=this.field.prev(":hidden");if(k){k.val(c)}this.params.value=c}}}var b=this.getIEVersion();if(b!=-1&&b<10){if(this.params.emptyText&&this.params.emptyText!=""){if(this.params.value&&this.params.value!=""){this.field.val(this.params.value)}else{this.field.val(this.params.emptyText)}}}var h=this.params.id?this.params.id:this.params.name;this.field.keyup(function(q){var m=$(this);var s=parseInt(j.params.maxlength,10);if(s>0){if(j.getStrlen(m.val())>s){m.val(j.getSubstring(m.val(),s))}}var p={};p.value=this.value;p.name=this.name;var l=j.params.url;var r=j.params.isSearch;if(r){if(l!=""&&l!=undefined){if(this.value.length>0){if(l.length>0){j.doAjax(l,p)}}else{var o=$("#hc_hide-textfield").children("div.hc_checkboxdiv[ref_target='"+h+"']");if(o.children().length>0){j.hideList(j.field,o)}}}}if(j.keyup&&!$(q.target).hasClass("u-typefield")){var t=Horn.Util.getFunObj(j.keyup),n;var p=t.params;if($.type(t.fn)=="function"){n=t.fn}if(n){n.apply(j,p)}}});if(j.keydown){this.field.keydown(function(){var l=Horn.Util.getFunObj(j.keydown),n;var m=l.params;if($.type(l.fn)=="function"){n=l.fn}if(n){n.apply(j,m)}})}if(j.keypress){this.field.keypress(function(){var l=Horn.Util.getFunObj(j.keypress),m;var n=l.params;if($.type(l.fn)=="function"){m=l.fn}if(m){m.apply(j,n)}})}if(j.click){this.field.click(function(){var l=Horn.Util.getFunObj(j.click),n;var m=l.params;if($.type(l.fn)=="function"){n=l.fn}if(n){n.apply(j,m)}})}if(j.dblclick){this.field.dblclick(function(){var n=Horn.Util.getFunObj(j.dblclick),l;var m=n.params;if($.type(n.fn)=="function"){l=n.fn}if(l){l.apply(j,m)}})}this.field.focus(function(){var r=j.getIEVersion();if(r!=-1&&r<10){if(j.params.emptyText&&j.params.emptyText!=""){if(j.field.val()==j.params.emptyText){j.field.val("")}}}var l=j.params.url;var n=j.params.isSearch;if(n){if(l!=""&&l!=undefined){$("#hc_hide-textfield").children("div.hc_checkboxdiv").hide();var p=$("#hc_hide-textfield").children("div.hc_checkboxdiv[ref_target='"+h+"']");if(p.children().length>0){j.showList(j.field,p)}}}if(j.focus){var m=Horn.Util.getFunObj(j.focus),o;var q=m.params;if($.type(m.fn)=="function"){o=m.fn}if(o){o.apply(j,q)}}});this.field.blur(function(){var p=$(this);var l=parseInt(j.params.maxlength,10);var o=$(this).parent("div.typefield");if(l>0){if(o&&o.length>0){if($(this).attr("inputType")=="cardNo"){if(j.getStrlen(p.val())>(l+2)){p.val(j.getSubstring(p.val(),l+2))}}else{}}else{if(j.getStrlen(p.val())>l){p.val(j.getSubstring(p.val(),l))}}}var r=j.getIEVersion();if(r!=-1&&r<10){if(j.params.emptyText&&j.params.emptyText!=""){if(p.val()==""){j.field.val(j.params.emptyText)}}}if(j.blur){var n=Horn.Util.getFunObj(j.blur),m;var q=n.params;if($.type(n.fn)=="function"){m=n.fn}if(m){m.apply(j,q)}}});this.field.bind("paste",function(m){var l=$(this);setTimeout(function(){var p=$(l).val();var n=parseInt(j.params.maxlength,10);var o=$(this).parent("div.typefield");if(n>0){if(!o||o.length==0){if(j.getStrlen(l.val())>n){l.val(j.getSubstring(l.val(),n))}}}},100)});var a=j.params.url;var e=j.params.isSearch;if(e){if(a!=""&&a!=undefined){this.el.mouseover(function(){j.el.find(".u-select-down").show()});this.el.mouseout(function(){j.el.find(".u-select-down").hide()})}}},doAjax:function(a,b){var c=this;var a=a?a:c.url;if(a&&a.indexOf("http:")==-1){a=context_path+a}$.ajax(a,{async:true,type:"POST",data:Horn.Util.obj2Arr(b),dataType:"json",error:function(){alert("没有找到对应的url")},success:function(e,k,h){var g=c.params.id?c.params.id:c.params.name;var d=$("#hc_hide-textfield").children("div.hc_checkboxdiv[ref_target='"+g+"']");if(d.length==0){$("#hc_hide-textfield").append('<div class="hc_checkboxdiv" ref_target="'+g+'"></div>');d=$("#hc_hide-textfield").children("div.hc_checkboxdiv[ref_target='"+g+"']")}if(e&&e!="undefined"){if(e.rows.length>0){var i=[];i=e.rows;d.empty();d.append("<ul></ul>");var f=d.children("ul");$.each(i,function(n,o){var l=f.children("li[key='"+n+"']");if(l.length==0){var l=$("<li key='"+n+"' title='"+o[c.name]+"'></li>");var m=$("<label>"+o[c.name]+"</label>");l.append(m);f.append(l)}});var j=$("div.h_floatdiv-con");if(j){j.mousewheel(function(){c.hideList(c.field,d)});j.scroll(function(){c.hideList(c.field,d)})}c.showList(c.field,d)}else{d.empty();d.hide()}}}})},bodyClick:function(f){var d=this.getEventTarget();if(f.target==f.data.inputEl.get(0)||d.data("isFromOuter")||$(f.target).prev()[0]==f.data.inputEl.get(0)){d.data("isFromOuter",false);var c=f.data.listEl;var b=f.data.inputEl;this.showList(b,c);$(document).one(this.bodyclicktype,f.data,Horn.Util.apply(this.bodyClick,this))}else{var c=f.data.listEl;var b=f.data.inputEl;c.hide();var a=$("li[key]",c);a.unbind("click.li")}},showList:function(h,e){var f=this;if(this.readonly==true){return false}var d={inputEl:h,listEl:e};var g=h.offset(),c=h.outerHeight();e.css("left",g.left+"px");e.css("z-index",9999);e.css("top",(g.top+c)+"px");var b=this.getIEVersion();if(b=="9"){var i=e.children("ul").children("li");if(i.length>3){e.css("width",(h.outerWidth()*(this.longerList?2:1)-2)+18+"px")}else{e.css("width",(h.outerWidth()*(this.longerList?2:1)-2)+"px")}}else{e.css("width",(h.outerWidth()*(this.longerList?2:1)-2)+"px")}e.css("display","block");$(document).one("click.ul",d,Horn.Util.apply(f.bodyClick,f));var a=$("li[key]",e);a.bind("click.li",d,Horn.Util.apply(f.listClick,f))},hideList:function(c,b){b.hide();var a=$("li[key]",b);a.unbind("click.li")},listClick:function(c){var d=this;var b=$(c.currentTarget);b.addClass("h_cur");b.siblings().removeClass("h_cur");this.setValue(b.attr("title"),true,true);this.field.trigger("blur");var a=d.field.parent().next();a.hide()},getStrlen:function(e){var b=Horn.Field.DEFAULT_CH_NUM;var a=0;for(var d=0;d<e.length;d++){var f=e.charCodeAt(d);if((f>=1&&f<=126)||(65376<=f&&f<=65439)){a++}else{a+=b}}return a},getSubstring:function(g,f){var e="";var b=Horn.Field.DEFAULT_CH_NUM;var a=0;for(var d=0;d<g.length;d++){var h=g.charCodeAt(d);if((h>=1&&h<=126)||(65376<=h&&h<=65439)){a++}else{a+=b}if(a<=f){e=e+g[d]}}return e},getIEVersion:function(){var c=-1;if(navigator.appName=="Microsoft Internet Explorer"){var a=navigator.userAgent;var b=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(b.exec(a)!=null){c=parseFloat(RegExp.$1)}}else{if(navigator.appName=="Netscape"){var a=navigator.userAgent;var b=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");if(b.exec(a)!=null){c=parseFloat(RegExp.$1)}}}return c},getEventTarget:function(){this.hidden=this.el.children("input[type='hidden']");if(this.hidden.length){this.field=this.hidden.next("input[type]")}else{this.field=this.el.children("input[type]");if(this.field.length==0){this.field=this.el.children("textarea")}}return this.field},checkRegx:null,initEvents:function(){var a=this;a.checkRegx=[];var b=this.field.attr("checkstr");if(b){a.checkRegx=b.split(";")}this.field.blur(function(){a.validate();var d=a.field.val();if(d!=null&&d!=""){d=d+"";d=d.replace(/(^\s*)|(\s*$)/g,"")}if(a.COMPONENT_CLASS=="Field"||a.COMPONENT_CLASS=="Password"){a.field.val(d)}var c=a.el.attr("class");if(c!="hc_password"&&c!="hc_passwordgroup"){a.field.attr("title",d)}})},validate:function(){if(this.disabled){return}var a=this;var b=a.getIEVersion();if(b!=-1&&b<10){if(a.params.emptyText&&a.params.emptyText!=""&&a.field.val()==a.params.emptyText){a.field.val("")}}if(!this.skipValid){Horn.Validate.onValid({data:[Horn.Validate,a]})}},addGroup:function(a){this.checkGroup[a]=true},removeGroup:function(a){this.checkGroup[a]=false},inGroup:function(a){return !!this.checkGroup[a]},get:function(){if(this.hidden&&this.hidden.length){return this.hidden}return this.field},addRule:function(f){var c=this.get();var b=c.attr(Horn.Validate.CHECK);if(b){if(b.indexOf(f)>-1){return}b+=Horn.Validate.CHECKSEP+f}else{b=f}c.attr(Horn.Validate.CHECK,b);if(f&&f.indexOf(Horn.Validate.REQUIRED)>-1){var a=this.el.parent().parent(".g-unit-wrap");var d=a.children("label");var e=$("span.m-verify-symbol",d);if(!e.length){e=$("<span>",{"class":"m-verify-symbol",html:"*"});d.prepend(e)}else{e.html("*")}}this.removeError();this.field.removeClass("m-verify-success")},removeRule:function(d){var b=this.get();var a=b.attr(Horn.Validate.CHECK);if(a&&a.indexOf(d)>-1){var c=a.split(Horn.Validate.CHECKSEP);c=$.grep(c,function(f,e){return f&&f!=d});b.attr(Horn.Validate.CHECK,c.join(";"));this.removeError();if(d&&d.indexOf(Horn.Validate.REQUIRED)>-1){this.setNotRequired()}}},skipValid:false,show:function(){this.skipValid=false;var a=this.el.parent().parent(".g-unit-wrap");if(this.el.attr("type")=="hidden"){return}if(a.css("display")=="none"){a.css("display","block")}if(a.css("visibility")=="hidden"){a.css("visibility","visible")}},hide:function(b){this.skipValid=true;b=b||"display";var a=this.el.parent().parent(".g-unit-wrap");if(b=="display"){a.css("display","none")}else{a.css("visibility","hidden")}if(this.err){this.removeError()}},setLabel:function(b){var a=this.el.parent().parent();var c=a.find("label:first");var d=$("span.m-verify-symbol",c);c.attr("title",b);if(!d.length){c.html(b)}else{c.html('<span class="m-verify-symbol">*</span>'+b)}},getLabel:function(){var a=this.el.parent().parent();var b=a.find("label:first");var c=b.attr("title");if(c==undefined){c=""}return c},setRequired:function(a){if(a===false){this.setNotRequired();return}this.addRule(Horn.Validate.REQUIRED)},setNotRequired:function(){var a=this.el.parent().parent(".g-unit-wrap");var b=$("label",a);var c=$("span.m-verify-symbol",b);this.removeRule(Horn.Validate.REQUIRED);this.field.removeClass("m-verify-error");c.html("")},setEnable:function(b){var a=this.field;var c=this.hidden;var d=a.next("input[type='text']");if(b){a.removeAttr("disabled");d.removeAttr("disabled");if(c){c.removeAttr("disabled")}}else{a.attr("disabled","disabled");d.attr("disabled","disabled");if(c){c.attr("disabled","disabled")}}},setDisabled:function(a){if(a===false){this.setEnable(true);this.disabled=false}else{this.setEnable(false);this.disabled=true;this.removeError();this.field.removeClass("m-verify-success")}},setReadonly:function(a){if(a===false){this.field.removeAttr("readonly");this.readonly=false}else{this.field.attr("readonly","readonly");this.readonly=true}},setValue:function(a){if(a=="null"||a=="NULL"||a=="undefined"){a=""}if(a!=null&&a!=""){a=a+"";a=a.replace(/(^\s*)|(\s*$)/g,"")}this.field.val(a);this.hidden.val(a);this.validate();var d=this.getIEVersion();if(d!=-1&&d<10){var c=this.field.val();var b=this.field.attr("placeholder");if(c==""&&b!=""){this.field.val(b)}}this.clearOrResetTitle()},getValue:function(){var a=this.get();var b=a.val();var c=this.getIEVersion();if(c!=-1&&c<10){if(this.params.emptyText&&this.params.emptyText!=""){if(b==this.params.emptyText){b=""}}}if(b!=null&&b!=""){b=b+"";b=b.replace(/(^\s*)|(\s*$)/g,"")}return b},reset:function(a){var b="";if(this.hidden&&this.hidden.length>0){b=a?"":this.defHiddenValue}else{b=a?"":this.defValue}this.setValue(b);this.clearOrResetTitle()},clearValue:function(){if(this.cal1){var b=this.name1;var a=this.name2;this.setValue({name1:null,name2:null})}else{this.setValue("");this.clearOrResetTitle()}},clearOrResetTitle:function(){var b=this;var c=b.field.val();if(c!=null&&c!=""){c=c+"";c=c.replace(/(^\s*)|(\s*$)/g,"")}if(b.COMPONENT_CLASS=="Field"||b.COMPONENT_CLASS=="Password"){b.field.val(c)}var a=b.el.attr("class");if(a!=null&&a!=""){a=a.replace(/(^\s*)|(\s*$)/g,"")}if(a!="hc_password"&&a!="hc_passwordgroup"){b.field.attr("title",c)}},bind:function(c,d,b){var a=this.get();if($.type(d)=="function"){a.bind(c,d)}else{a.bind(c,d,b)}},isValid:function(){if(this.disabled){return true}return !this.err},err:false,msgDiv:null,showError:function(c){var d=this.field;var a=this.params.msgInBody+"";d.removeClass("m-verify-success");d.addClass("m-verify-error");c=$.type(c)=="boolean"?"校验错误":c;if(!this.msgDiv){if(a=="true"){this.msgDiv=$('<div class="m-verify-tip bottom" role="m-verify-tip" msgInBody="true" style="display: none;"></div>');$("body").append(this.msgDiv)}else{this.msgDiv=$('<div class="m-verify-tip bottom" role="m-verify-tip"  style="display: none;"></div>');this.el.after(this.msgDiv)}}var e=this.msgDiv;e.html('<div class="verify-tip-arrow"></div><div class="verify-tip-inner">'+c+"</div>");e.css("display","block");this.err=true;if(a=="true"){var f=this;var b=Horn.Window.getNextZIndex();if(top.Horn&&top.Horn.Window){top.Horn.Window.MAX_ZINDEX=top.Horn.Window.MAX_ZINDEX-1}else{Horn.Window.MAX_ZINDEX=Horn.Window.MAX_ZINDEX-1}f.positionError(b);$(".h_floatdiv-con").bind("scroll",function(){f.positionError(b)});$(".h_floatdiv-con").bind("mousewheel",function(){f.positionError(b)});$(".h_tabpanel-contents").bind("scroll",function(){f.positionError(b)});$(".h_tabpanel-contents").bind("mousewheel",function(){f.positionError(b)});$(".m-message-title").mousemove(function(g){f.positionError(b)})}},removeError:function(){this.field.removeClass("m-verify-error");var b=this.get();var a=b.attr(Horn.Validate.CHECK);if(a){if(this.isValid){this.field.addClass("m-verify-success")}}this.err=false;var c=this.msgDiv;if(c){c.remove()}delete this.msgDiv},positionError:function(b){var c=this.field;var d=this.msgDiv;if(d){var e=c.offset();if(e&&e.top==0){e=this.el.offset()}if(e&&e.top>0){var a=c.outerHeight();d.css("left",e.left+"px");d.css("z-index",b);d.css("top",(e.top+a)+"px")}}},mutiName:function(){return false}});$.extend(Horn.Field,{get:function(a,b){if(jQuery.type(a)!="string"){var c=$(a);a=c.attr("name");b=c.attr("alias");if(!a){var d=c.prev("input[type='hidden'][name]");a=d.attr("name");b=d.attr("alias")}}var e=Horn.getComp(a,b);return e},addRule:function(a,d,b){var c=this.get(a,b);c.addRule(d)},removeRule:function(a,d,b){var c=this.get(a,b);c.removeRule(d)},show:function(a,b){var c=this.get(a,b);c.show()},hide:function(a,b){var c=this.get(a,b);c.hide("display")},hidden:function(a,b){var c=this.get(a,b);c.hide("visibility")},setRequired:function(a,b){var c=this.get(a,b);c.setRequired()},setNotRequired:function(a,b){var c=this.get(a,b);c.setNotRequired()},setEnable:function(b,a,c){var d=this.get(b,c);d.setEnable(a)},setReadonly:function(a,d,b){var c=this.get(a,b);c.setReadonly(d)},setLabel:function(b,a,c){var d=this.get(b,c);d.setLabel(a)},getLabel:function(a,b){var c=this.get(a,b);return c.getLabel()},setValue:function(a,c,b){var d=this.get(a,b);if(d){d.setValue(c)}else{this.getField(a,b).val(c)}},getValue:function(a,b,c){var d=this.get(a,b);if(d){return d.getValue()}else{return this.getField(a,b,c).val()}},reset:function(a,b){var c=this.get(a,b);if(c){c.reset()}else{this.getField(a,b).each(function(){this.reset()})}},clearValue:function(a,b){var c=this.get(a,b);if(c){c.clearValue()}else{this.getField(a,b).val("")}},bind:function(a,b,d,e,c){var f=this.get(a,b);f.bind(d,e,c)},getSelector:function(b,c){var a="";if(b){a+="[name='"+b+"']"}if(c){a+="[alias='"+c+"']"}return"input"+a+",textarea"+a},getField:function(b,c,d){var f=Horn.getCurrent();c=c||"";var e=null;if(!d){d=f.find("form");if(jQuery.type(b)=="string"){var a=Horn.Field.getSelector(b,c);e=$(a,d)||$(a);if(!c){e=e.not(":disabled")}}else{e=$(b,d)}return e}else{return d.findField(b,c)}},findFieldCompsIn:function(b){var a=[];this.findFieldsIn(b).each(function(c,d){var e=Horn.getCompByEl($(d));if(e){a.push(e)}});return $(a)},findFieldsIn:function(a){return $(a).find(this.TYPES.join(","))},findInputComp:function(a){return $(a).parents(this.TYPES.join(",")).first().comp()},TYPES:[],regFieldType:function(a,b){Horn.regUI(a,b);this.TYPES.push(a)}});Horn.apply(Horn.Field,{DEFAULT_CH_NUM:2});Horn.Field.regFieldType("div.hc_textfield._text",Horn.Field);Horn.Field.regFieldType("div.hc_textarea",Horn.Field);
Horn.FieldSet=Horn.extend(Horn.Base,{COMPONENT_CLASS:"FieldSet",hidden:null,params:null,init:function(a){Horn.FieldSet.superclass.init.apply(this,arguments);Horn.apply(this,this.params);if(this.params.hidden&&this.params.hidden==true){this.hide()}},show:function(){var a=this.el;a.css("display","block")},hide:function(){var a=this.el;a.css("display","none")}});Horn.regUI(".h_fieldset",Horn.FieldSet);
Horn.Form=Horn.extend(Horn.Base,{COMPONENT_CLASS:"Form",form:null,ajax:false,ajaxCallback:false,onSuccessObj:null,baseParams:null,init:function(){Horn.Form.superclass.init.apply(this,arguments);this.form=this.el;var i=this.form.attr("ajax");var j=this;this.baseParams={};this.beforeSubmit=this.params.beforeSubmit;var b=this;$.each(this.params.events||[],function(e,l){b[l.event]=l["function"]});if(this.beforeSubmit){var c=Horn.Util.getFunObj(this.beforeSubmit);if(c&&$.type(c.fn)=="function"){this.on("beforesubmit",c.fn)}}var a=function(){return j.fire("beforesubmit")};var h=j.toAjaxForm;j.toAjaxForm=function(){j.el.unbind("submit",a);h.call(j)};if(!i){j.el.submit(a)}else{try{var k=Horn.Util.decode(i);if($.isPlainObject(k)){var g=k.onSuccess;if(g){var f=Horn.Util.getFunObj(g);if(f&&$.type(f.fn)=="function"){this.on("ajaxsuccess",f.fn)}}}}catch(d){}j.toAjaxForm()}j.on("beforesubmit",j.isValid);this.form.bind("reset",function(){j.reset(false);return false});if(j.el.find(":file").get(0)){j.el.attr("enctype","multipart/form-data")}},customEvents:"beforesubmit",getEventTarget:function(){return this.el},toAjaxForm:function(){var a=this;if(this.ajax===true){return}this.ajax=true;this.el.submit(function(){if(a.fire("beforesubmit")==true){a.doPost()}return false})},setBaseParams:function(a){this.baseParams=a},doPost:function(){var values=this.getValues();var url=this.form.attr("action");Horn.apply(values,this.baseParams);url=(url.indexOf("?")===-1?url+"?":url+"&")+"pagelet="+(values.pagelet||new Date().getTime());function onAjaxComplate(result){var data=eval("("+result+")");BigPipe.onArrive(data);BigPipe.start();Horn.init()}$.post(url,values,onAjaxComplate)},submit:function(){this.form.submit()},reset:function(a){if(!a===false){this.form.get(0).reset()}Horn.Field.findFieldCompsIn(this.form).each(function(){if($.isFunction(this.reset)){this.reset()}});var b=this.form.find("div.hc_label[name]");b.each(function(c,e){var f=$(e);var d=Horn.getCompByEl(f);d.setValue("")});this.removeError()},clearValue:function(){Horn.Field.findFieldCompsIn(this.form).each(function(){this.clearValue()});var a=this.form.find("div.hc_label[name]");a.each(function(b,d){var e=$(d);var c=Horn.getCompByEl(e);c.setValue("")});this.removeError()},getIEVersion:function(){var c=-1;if(navigator.appName=="Microsoft Internet Explorer"){var a=navigator.userAgent;var b=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(b.exec(a)!=null){c=parseFloat(RegExp.$1)}}else{if(navigator.appName=="Netscape"){var a=navigator.userAgent;var b=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");if(b.exec(a)!=null){c=parseFloat(RegExp.$1)}}}return c},getValues:function(){var b=this.getIEVersion();if(b!=-1&&b<10){this.getFieldComps().each(function(c,d){var f=d.el.children("input").val();var e=d.el.children("input").attr("placeholder");var h=d.el.children("textarea").val();var g=d.el.children("textarea").attr("placeholder");if(e&&e==f){d.el.children("input").val("")}if(g&&g==h){d.el.children("textarea").val("")}})}var a=this.form.serializeArray();var b=this.getIEVersion();if(b!=-1&&b<10){this.getFieldComps().each(function(c,d){var f=d.el.children("input").val();var e=d.el.children("input").attr("placeholder");var h=d.el.children("textarea").val();var g=d.el.children("textarea").attr("placeholder");if(e!=""&&f==""){d.el.children("input").val(e)}if(g!=""&&h==""){d.el.children("textarea").val(g)}})}return Horn.Util.arr2Obj(a)},getFieldComps:function(){return Horn.Field.findFieldCompsIn(this.el)},setValues:function(c,d,a){var b=c;if(!d){d=""}if($.isArray(c)){b=Horn.Util.arr2Obj(c)}this.getFieldComps().each(function(f,j){var g=j.mutiName();if(g){var k={};var h=0;$(g).each(function(i,l){k[l]=b[l.replace(new RegExp("^"+d+""),"")];if(k[l]){h++}});if(h!=0){j.setValue(k||"")}else{if(!(a==false)){j.setValue("")}}}else{var k=b[j.name.replace(new RegExp("^"+d+""),"")];if(k){k=$.trim(k);j.setValue(k)}else{if(!(a==false)){if(k==0){j.setValue(k)}else{j.setValue("")}}}}});var e=this.form.find("div.hc_label");e.each(function(f,h){var j=$(h);var g=Horn.getCompByEl(j);var i=b[g.name.replace(new RegExp("^"+d+""),"")];if(i){g.setValue(i)}else{if(!(a==false)){g.setValue("")}}})},removeError:function(){this.getFieldComps().each(function(a,b){b.removeError()})},removeSuccess:function(){this.getFieldComps().each(function(a,b){if(b&&b.field){b.field.removeClass("m-verify-success")}})},isValid:function(){return Horn.Validate.isFormValidate(this.form)},serializeArray:function(){return this.form.serializeArray()},serialize:function(){return this.form.serialize()},findField:function(b,f){var c=f||"";var e=null;var d=this.el;if(jQuery.type(b)=="string"){var a=Horn.Field.getSelector(b,c);e=$(a,d);if(!c){e=e.not(":disabled")}}else{e=$(b,d)}return e}});$.extend(Horn.Form,{DATANAME:"h_form",get:function(b){var a=Horn.data(Horn.Form.DATANAME);var c=a[0];return c}});Horn.regUI("form",Horn.Form);
Horn.FormGrid=Horn.extend(Horn.Base,{COMPONENT_CLASS:"FormGrid",init:function(c){Horn.FormGrid.superclass.init.apply(this,arguments);var e=this;var f=this.el;var a=f.children("a.h_btn-confirm");var i=a.next("a.h_btn-add");var g=$("div.h_formtable").first().children("table").first();var b=e.firstPanel(f);var h=g.attr("uniqueKey");a.bind({click:function(){var m=$(".hc_formtable-cur").nextAll("tr").size();var o=f.nextAll("div.g-panel");var k=null;for(var n=0;n<o.size();n++){var p=$(o.get(n));if(p.css("display")=="block"||p.css("display")==""){k=p;break}}if(h!=""){var q=[];var j=e.getUniqueValue(k,h,g,q,m);var l=e.check_repeat(g,q,j);if(l!=null){Horn.Msg.alert("提示",l+"已经存在,请重新输入");return false}}if(k&&Horn.Validate.isFormValidate(k)){if(!e.fire("beforechange",k)){return false}e.rest_panel.call(e,f,"edit")}}});i.bind({click:function(){if(h!=""){var l=[];var j=e.getUniqueValue(b,h,g,l,null);var k=e.check_repeat(g,l,j);if(k!=null){Horn.Msg.alert("提示",k+"已经存在,请重新输入");return false}}if(b&&!e.fire("beforechange",b)){return false}e.add_panel.call(e,f,"add");if(b&&!e.fire("afterchange",b)){return false}}});var d=f.nextAll(".h_formtable").find("tbody").children("tr");d.each(function(j,k){var l=b.clone(false,true);l.attr("index",b.parent().children("div.g-panel").size()-1);Horn.Field.findFieldsIn(l).each(function(m,n){var o=$(n);if(this.params){o.attr("nonamebyparams",true);o.name=this.params.name}});l.find("input,textarea").each(function(o,p){var n=$(p).attr("name");if(n){var m=n.indexOf(".")!=-1?n.replace(".","["+j+"]."):n+"["+j+"]";$(p).attr("name",m);$(p).val($(k).find('span[ref="'+m+'"]').text().trim())}});b.after($(l));l.css("display","none");Horn.getUIReady()(l,true);e.rest_panel($(f),"init");e.cls_panel(b)});e.rest_panel(f,"init")},getUniqueValue:function(a,h,d,f,e){var i=[];var g=h.split(",");if(g!=null&&g.length>0){i=g}d.find("th").each(function(j,k){if($(this).attr("ref")!="del"){var l=$(this).attr("ref");if(i!=null&&i.length>0){if(i.indexOf(l)!=-1){f.push(j)}}}});var c=[];Horn.Field.findFieldsIn(a).each(function(n,o){var p=$(o);var m=p.attr("name");var q=m;if(e!=null){if(m&&m.indexOf(".")>-1){m=m.replace(".","["+e+"].")}else{m=m+"["+e+"]"}}var k=$("input[name='"+m+"']");if(!k){k=$("textarea[name='"+m+"']")}if(q&&g.indexOf(q)!=-1){if(e!=null){var j=$("span[ref='"+m+"']").text();var l=k.val();if(l!=j){c.push(k.val())}}else{c.push(k.val())}}});var b=c.join("#");return b},rest_panel:function(e,d){var f=this;var b=-1;var c=$(e).nextAll("div.h_formtable").first().children("table").first();c.children("tbody").children("tr").remove();var a=this.firstPanel(e);while(a.hasClass("g-panel")){if(b==-1){a.css("display","block")}else{a.css("display","none");f.update_name(a,b)}if(a.css("display")=="none"){c.children("tbody").prepend("<tr></tr>").children("tr").first().bind({click:function(){f.show_panel.call(f,e,$(this))}});c.find("th").each(function(m,j){var i=$(this).attr("width");if($(this).attr("ref")=="del"){$('<td><a style="cursor: pointer;">删除</a></td>').appendTo(c.children("tbody").children("tr").first())}else{var k=$(this).attr("ref");var g=k;if(k.indexOf(".")>-1){g=k.replace(".","["+b+"].")}else{g=k+"["+b+"]"}var n=$("[name='"+g+"']",a);if(n.attr("type")=="hidden"){n=n.next()}var p=Horn.Field.findInputComp(n);var o=n.val();if(d=="init"){if(n.attr("type")=="radio"){n.each(function(r,s){var q=$(this).attr("initval");var t=$(this).val();if(q&&t==q){o=$(this).parent("label").text().trim();$(this).attr("checkVal",o)}})}if(n.attr("type")=="checkbox"){var l=[];n.each(function(r,t){var q=$(this).attr("initval");var v=$(this).val();if(q){var u=q.split(",");if(u!=null&&u.length>0){for(var s=0;s<u.length;s++){if(v==u[s]){l.push($(this).parent("label").text().trim())}}}}});o=l.join(",")}}else{if(n.attr("type")=="checkbox"){var h=[];n.each(function(q,r){if($(this).attr("checked")){h.push($(this).parent("label").text().trim())}$(this).attr("initval","")});o=h.join(",")}if(n.attr("type")=="radio"){n.each(function(q,r){var s=$(this).attr("checkVal");if($(this).attr("checked")){o=$(this).parent("label").text().trim();$(this).attr("checkVal",o)}else{if(s){o=s}}})}}if(o==""){if(n.attr("title")){o=n.attr("title")}}$("<td style='width:"+i+"px;'><div style='width:"+i+"px;'><span ref='"+g+"'>"+o+"</span></div></td>").appendTo(c.children("tbody").children("tr").first())}})}b=b+1;a=a.next()}$(c).children("tbody").children("tr").each(function(){var g=$(this);$(this).children("td").last().children("a").bind({click:function(){f.del_panel.call(f,e,$(g).nextAll("tr").size())}})});$(e).children("a.h_btn-confirm").hide().next("a.h_btn-add").show()},check_repeat:function(a,m,b){var c=null;var h=a.children("tbody");var l=h.children("tr");var f={};loop:for(var g=0;g<l.length;g++){var e=l[g].cells;var n=[];for(var d=0;d<e.length;d++){if(m.indexOf(d)!=-1){var k=e[d].outerText.trim();n.push(k)}}var o=n.join("#");if(!f[o]&&o!=b){f[o]=o}else{c=o;break loop}}return c},update_name:function(b,a){$(b).find("input,textarea").each(function(){if($(this).attr("name")){var c=$(this).attr("name");if(c.indexOf("[")<0){if(c.indexOf(".")>-1){c=c.replace(".","["+a+"].")}else{c=c+"["+a+"]"}}else{c=c.substr(0,(c.indexOf("[")+1))+a+c.substr(c.indexOf("]"))}$(this).attr("name",c)}})},add_panel:function(c){var a=this.firstPanel(c);if(Horn.Validate.isFormValidate(a)){var b=a.clone(false,true);b.attr("index",a.parent().children("div.g-panel").size()-1);a.after($(b));b.css("display","none");Horn.getUIReady()(b,true);this.rest_panel($(c));this.cls_panel(a)}},firstPanel:function(a){return $(a).next("div.g-panel").first()},cls_panel:function(a){Horn.Field.findFieldCompsIn(a).each(function(b,c){c.removeError()})},del_panel:function(d,b){var c=0;var a=this.firstPanel(d).next("div");while($(a).hasClass("g-panel")){if(c==b){$(a).remove()}a=$(a).next();c=c+1}this.rest_panel(d)},show_panel:function(f,e){var d=this.firstPanel(f);$(e).parent("tbody").children("tr").removeClass("hc_formtable-cur");var b=$(e).addClass("hc_formtable-cur").nextAll("tr").size();d.hide();var c=0;var a=d.next("div");while($(a).hasClass("g-panel")){if(c==b){$(a).show()}else{$(a).hide()}a=$(a).next();c=c+1}$(f).children("a.h_btn-confirm").show().next("a.h_btn-add").hide()},size:function(){return $("div.h_formtable").children("table").children("tbody").children("tr").length}});Horn.regUI("div.h_formgridtitle",Horn.FormGrid);
Horn.Grid=Horn.extend(Horn.Base,{COMPONENT_CLASS:"Grid",titleEl:null,id:"staticGridId",name:"staticGridName",data:null,curData:null,curTr:null,rowSelect:false,keyAttr:"label",valueAttr:"value",init:function(e){Horn.Grid.superclass.init.apply(this,arguments);this.ths=this.el.find("th");var f=this;var d=this.params.data||{};this.data=d;if(this.params.id&&this.params.id!=""){this.id=this.params.id}else{if(this.params.name&&this.params.name!=""){this.id=this.params.name}}if(this.params.name&&this.params.name!=""){this.name=this.params.name}if(this.params.selectModel=="muti"||this.params.selectModel=="multi"){this.mutiSelect=true}this.curTr=this.el.find("tr.u-table-selected");var a=this.el.children("table").children("tbody").children("tr");this.curData=this.data[a.index(this.curTr)-1];this.rowSelect=Boolean(this.params.rowSelect);this.textOverHidden=this.params.textOverHidden+"";this.ths.each(function(l,h){var j=h.attributes.hidden;h=$(h);var m=h.attr("dictName"),n=h.attr("colno"),g;var i=h.attr("width");var k,o;if(n){k=f.params.items[n-1].items;o=f.params.items[n-1].buttons}if(m){g={};var p=$(".hc_checkboxdiv[ref_target="+m+"_s]").find("li");p.each(function(r,q){q=$(q);var s=q.attr("title");var t=q.attr("key");g[t]=s})}else{if(k){g={};$(k).each(function(q,r){g[r[f.keyAttr]]=r[f.valueAttr]})}else{if(i){}}}h.data("staticDict",g);h.data("buttons",o)});this.el.find(".h_querytable_select_all").change(function(){if(this.checked){f.selectAll()}else{f.unSelectAll()}});this.selecteds={};this.dictTrans();this.initEvents();var c=this.params.isDrag+"";if(c!="false"){this.el.find(".hc-datagrid-cell").resizable({autoHide:true,minHeight:35,maxHeight:35,resize:function(j,k){var i=k.size.width;$(k.element[0]).parent().css("width",i);var h=$(k.element[0]).parent().parent().find("th").index($(k.element[0]).parent());var g=$("[name='"+f.name+"']").find("#body_"+f.id).children("tr");g.each(function(m,l){var n=$(l);$(n.children("td").get(h)).css("width",i);$(n.children("td").get(h)).children("div").css("width",i)})}})}if(this.textOverHidden=="false"){this.resetTdContent()}var b=this.params.autoHeight+"";if(this.params.autoHeight&&b=="true"){$(window).resize(function(){f.autoDataHeight()});f.autoDataHeight()}},customEvents:"rowclick,rowdblclick",getEventTarget:function(){return this.el},autoDataHeight:function(){var b=this.params.autoHeight+"";if(this.params.autoHeight&&b=="true"){var f=this.el.children(".u-datagrid");var e=this.el.next(".u-datagrid-page");var a=$(window).height();var d=e.outerHeight(true);var g=f.offset().top;var c=a-g-d;f.css("height",c-5)}},setButtonDisabled:function(a,b){var c=this.el.children("div.u-datagrid-toolbar").children("ul").children("li");c.each(function(f,d){var e=$(this).children("a");var g=e.attr("name");if(g==a){if(b){e.addClass("f-disabled");e.attr("onclick","javascript:return false;")}else{e.removeClass("f-disabled");e.attr("onclick",e.attr("event"))}return}})},initToolbarEvents:function(){var a=this.el.children("div.u-datagrid-toolbar").children("ul").children("li");a.each(function(d,b){var c=$(this).children("a");if(c.hasClass("f-disabled")){c.attr("onclick","javascript:return false;")}c.bind("click",function(f){if($(this).hasClass("f-disabled")){$(this).attr("onclick","javascript:return false;")}else{$(this).attr("onclick",$(this).attr("event"))}})})},initEvents:function(){var c=this.el.children("div.u-datagrid").children("table");var l=c.children("tbody");var j=this;var d=j.el.find(".h_querytable_select_all").length>0?true:false;if(d){this.el.find("input:checkbox.h_querytable_select").change(function(){j.stateTest()})}if(this.rowSelect==true){l.children("tr").each(function(q,s){var t=q;var p=$(s),r=j.mutiSelect?p.find("input:checkbox.h_querytable_select"):p.find("input:radio.h_querytable_select");var o=p.attr("line");if(!o||o==undefined){return}p.bind("click",function(i){if($.isEmptyObject(j.selecteds)){j.selectRow(t,p)}else{if(!j.selecteds.hasOwnProperty(t)){j.selectRow(t,p)}else{j.unSelectRow(t,p)}}if(d){j.stateTest()}})})}var n=undefined;var k=undefined;var b=undefined;var a=undefined;var g=this.data;$.each(this.params.events||[],function(p,q){j[q.event.toLowerCase()]=q["function"]});if(this.rowclick){n=Horn.Util.getFunObj(this.rowclick);if($.type(n.fn)=="function"){b=n.fn}}if(this.rowdblclick){k=Horn.Util.getFunObj(this.rowdblclick);if($.type(k.fn)=="function"){a=k.fn}}if(b||a){var h=l.children("tr");for(var f=0;f<g.length;f++){var m=$(h.get(f));if(b){var e=n.params.slice(0);e.push(g[f],g);m.bind("click",e,function(o){var i=o.data;return n.fn.apply(this,i)})}if(a){var e=k.params.slice(0);e.push(g[f],g);m.bind("dblclick",e,function(o){var i=o.data;return k.fn.apply(this,i)})}}}},resetTdContent:function(){var h=true;var b=this.params.textOverHidden+"";if(b=="false"){h=false}if(h){return}var e=this;var g=this.el.children("div.u-datagrid").children("table").children("tbody").children("tr");var a=this.el.children("div.u-datagrid").children("table").children("thead").children("tr").children("th");var f=[];if(this.data&&this.data.length>0){for(var d=0;d<this.data.length;d++){var c=this.data[d];$.each(c,function(i,k){f.push(i)});break}}var j=[];g.each(function(r,m){var o=$(m);var k=o.find("td");for(var n=0;n<k.length;n++){var i=$(k[n]);var l=i.attr("width");var q=i.children("div");var p=q.text();if(e.getStrlen(p)>40){if(j.indexOf(n)==-1){j.push(n)}if(!l){q.css("width",300);i.css("width",300)}}}})},getStrlen:function(e){var b=2;var a=0;for(var d=0;d<e.length;d++){var f=e.charCodeAt(d);if((f>=1&&f<=126)||(65376<=f&&f<=65439)){a++}else{a+=b}}return a},setTitle:function(a){this.el.children("div.u-datagrid-header").children("h4").text(a)},onRowSelect:function(){},selecteds:null,stateTest:function(){var b=this;var a=true;b.el.find("input:checkbox.h_querytable_select").each(function(c,d){if(!$(d).prop("checked")){a=false}});if(a){b.el.find(".h_querytable_select_all").prop("checked",true)}else{b.el.find(".h_querytable_select_all").prop("checked",false)}},selectAll:function(){var a=this;this.el.find("input:checkbox.h_querytable_select").each(function(b,c){c.checked=true;if(a.rowSelect==false){$(c).trigger("change")}else{a.selectRow(b)}});a.lastSelect={rowidx:"all"};this.el.find(".h_querytable_select_all").attr("checked",true)},unSelectAll:function(){var a=this;this.el.find("input:checkbox.h_querytable_select").each(function(b,c){c.checked=false;if(a.rowSelect==false){$(c).trigger("change")}else{a.unSelectRow(b)}});this.el.find(".h_querytable_select_all").prop("checked",false)},lastSelect:null,mutiSelect:false,selectRow:function(b,d){var c=this;var g=d;if(!g){g=$(this.el.find("tr").has("td").get(b))}if(g.size()==0){Horn.debug("Grid["+this.name+"]","选择的行"+b+"不存在");return false}var h={};var f={};var a=this.ths;var e=g.find("td");a.each(function(m,j){var l=e.get(m),k=$(j);if(k.attr("name")){h[k.attr("name")]=k.attr("dictName")?$(l).attr("key"):$(l).children("div").text();f[k.attr("name")]=$(l).children("div").text()}});c.onRowSelect.call(g,g,b,h);this.selecteds[b]={val:h,displays:f};if(!c.mutiSelect){var i=c.lastSelect;if(i&&i.rowidx!=b){if(this.mutiSelect){i.tr.find("input:checkbox.h_querytable_select").prop("checked",false)}else{i.tr.find("input:radio.h_querytable_select").prop("checked",false)}c.unSelectRow(i.rowidx,i.tr)}}c.lastSelect={rowidx:b,tr:g};if(this.mutiSelect){g.find("input:checkbox.h_querytable_select").prop("checked",true)}else{g.find("input:radio.h_querytable_select").prop("checked",true)}g.addClass("u-table-selected")},unSelectRow:function(c,a){var b=a;if(!b){b=$(this.el.find("tr").has("td").get(c))}this.selecteds[c]=null;delete this.selecteds[c];b.removeClass("u-table-selected");if(this.mutiSelect){b.find("input:checkbox.h_querytable_select").prop("checked",false);this.el.find(".h_querytable_select_all").prop("checked",false)}else{b.find("input:radio.h_querytable_select").prop("checked",false)}},getSelecteds:function(e){var d=[];for(var c in this.selecteds){var b=this.selecteds[c];if(b){var a=b.val;if(e===true){a=this.data[c]}else{if(e==1){a=b.displays}}d.push(a)}}return d},changeCurrent:function(a){if(!a instanceof $){a=this.el.children("tbody").children("tr")[a]}if(!this.curtr){this.curtr=this.el.find("tr.u-table-selected")}var b=this.el.children("table").children("tbody").children("tr").index(this.curtr);this.curtr.removeClass("u-table-selected");a.addClass("u-table-selected");this.curtr=a;this.curData=this.data[b-1]},getCurrentData:function(){return this.curData},hiddenColumns:function(){var a=this.el.children("table").children("tbody").children("tr");var b=this.ths;b.each(function(f,e){var c=$(e);var d=e.attributes.hidden;if(d!=null&&d!=undefined&&d.value=="true"){c.hide();a.each(function(i,h){var k=$(h);var j=k.find("td");for(var g=0;g<j.length;g++){var l=$(j[g]);if(f==g){l.hide();break}}})}})},formatColumn:function(a,b,c){return Horn.Util.Format.all(a,b,c)},resetTHWidth:function(){var d=this.ths;var f=d.size();var b=this.el.children("table");var g=b.width();var c=[];d.each(function(i,l){var j=$(l);if(j.hasClass("h_numbercolumn")||j.hasClass("h_querytable_checkboxcolumn")){j.addClass("h_table_th_extend")}else{if(l.attributes.hidden){var k=l.attributes.hidden;if(k!=null&&k!=undefined&&k.value=="true"){f--}}else{if(j.attr("width")){f--}else{c.push(j)}}}return true});var h=100/f;for(var e=0;e<c.length;e++){var a=c[e].attr("class");if(a&&a=="u-table-time"){c[e].css("width",h.toFixed(2)+"%")}}e},dictTrans:function(){var b=this,c=this.ths,a=this.el.find("tr");a.each(function(e,d){var g=$(d),f=b.mutiSelect?g.find("input:checkbox"):g.find("input:radio");if(f.hasClass("h_querytable_select")){if(b.rowSelect==false){f.change(function(){if(this.checked){b.selectRow(e-1,g)}else{b.unSelectRow(e-1,g)}})}if(f.attr("checked")){setTimeout(function(){b.selectRow(e,g)},3)}}g.find("td").each(function(h,l){var o=$(l);var n=o.children("div");var m=$(c.get(h));var j=m.attr("dictname"),k=m.attr("multiple"),t=m.data("staticDict"),s=m.attr("renderer"),z=m.data("buttons"),i=m.attr("showwhenover"),u=m.attr("dataType"),y=m.attr("format");if(t){o.attr("key",o.text());var r=n.text()||"";if(k){var q=[];$(r.trim().split(",")).each(function(C,D){q.push(t[D]||D)});n.html(q.join(","));o.attr("title",q.join(","))}else{if(r==""||t[o.text().trim()]==undefined){n.html("");o.attr("title","")}else{n.html(t[n.text().trim()]||n.text());o.attr("title",t[n.text().trim()]||n.text())}}}else{if(z){o.attr("title","");var w=z;var v=$("<span></span>");$(w).each(function(G,D){var E=Horn.Util.getFunObj(D.event);if(!E.fn){return}var C=$("<a href='javascript:void(0)'>"+D.label+"</a>"),F=n.text();C.click(function(){E.fn.call(C,{val:F,rowdata:b.data[e-1],alldata:b.data,table:b,rowidx:e,tdidx:h,tr:g,td:o})});v.append(C);if(G!=(w.length-1)){v.append(" | ")}});if(i){v.addClass("h_link-default")}n.html("");o.append(v)}else{if(u){var B=n.text();var A=b.formatColumn(u,y,B);n.html(A);o.attr("title",A)}}}if(s){o.attr("key",o.text());o.attr("title","");var p=Horn.Util.getFunObj(s),r=n.text();if(!p.fn){return}var x=p.fn.call($(this),{val:r,rowdata:b.data[e-1],alldata:b.data,table:b,rowidx:e,tdidx:h,tr:g,td:o});if(x instanceof $){n.html("");o.append(x)}else{n.html(x)}}})})},addRowData:function(a){}});Horn.regUI("div.h_formtable",Horn.Grid);
function registeSelfui(a){var b=$(a);Horn.getUIReady()(b,true)}Horn.GroupGrid=Horn.extend(Horn.Base,{COMPONENT_CLASS:"GroupGrid",id:"dyncGroupGrid",name:"dyncGroupGrid",title:"",data:null,selectModel:"",autoLoad:true,items:[],url:"",emptyMsg:"",rowSelect:false,hasPage:false,isDrag:false,frozenHead:false,toolbar:null,isExpand:true,pagebar:null,pageinfo:{totalPagesText:"页，每页{pagesize}条,共{pages}页",displayMsg:"当前显示{from}到{to}，共{total}条记录"},reqPageNo:1,reqPageSize:10,init:function(){Horn.GroupGrid.superclass.init.apply(this,arguments);this.name=this.params.name||this.name;var c=this;if(c.params.id&&c.params.id!=""){c.id=c.params.id}else{if(c.params.name&&c.params.name!=""){c.id=c.params.name}}c.hasPage=c.params.hasPage?c.params.hasPage:c.hasPage;$.each(this.params.events||[],function(d,e){c[e.event.toLowerCase()]=e["function"]});if(c.params.isExpand!=undefined){c.isExpand=c.params.isExpand}if(this.params.autoLoad!=undefined&&this.params.autoLoad.toString()=="false"){this.autoLoad=this.params.autoLoad}c.initElement();c.processReqConf();if(!c.params.pageConfig){c.pageConfig={}}var b=c.params.isDrag+"";if(b=="true"){c.el.find(".u-groupgrid-cell").resizable({autoHide:true,minHeight:35,maxHeight:35,resize:function(g,h){var f=h.size.width;var i=$(h.element[0]).parent().parent().find("td");$(h.element[0]).parent().css("width",f);var e=i.index($(h.element[0]).parent());var d=$("#grouptable_"+c.id).find("tr");d.each(function(k,j){var l=$(j);if(!l.hasClass("u-groupgrid-grouphead")){$(l.children("td").get(e)).css("width",f);$(l.children("td").get(e)).children("div").css("width",f)}})}})}if(c.params.editable){c.savebtn=c.el.find("#saveBTN_"+c.id);c.refreshbtn=c.el.find("#refreshBTN_"+c.id);$(c.savebtn).on("click",function(){c.saveData();if(c.save){var d=Horn.Util.getFunObj(c.save),e;if($.type(d.fn)=="function"){e=d.fn}if(e){e.apply(c,[c.data])}}});$(c.refreshbtn).on("click",function(){c.reload()})}if(c.params.url&&c.params.url!=""&&c.autoLoad){c.load(c.params.url);return}if(c.params.data&&c.params.data.length>0){c.data=c.params.data;c.loadFlag="staticData";c.selecteds=$.extend(true,[],c.data);for(var a=0;a<c.selecteds.length;a++){c.selecteds[a].items=[]}if(c.params.editable){c.editingCell=[];c.cacheData=[];$.extend(true,c.cacheData,c.data);c.creatEditTable(c.data)}else{c.loadGroupTable(c.data)}c.storgedData=c.data.data?c.data.data:c.data;c.reqPage(c.reqPageNo,c.reqPageSize)}if(!c.autoLoad){c.pageBtnDisabled(true)}},initElement:function(){var b=this;b.title=b.params.title||null;b.titleEl=null;if(b.title){b.titleEl=b.el.find(".u-groupgird-header>h4")}if(b.params.hasPage&&b.params.hasPage==true){b.createPagebar()}b.table=b.el.find("#grouptable_"+this.id);b.header=b.table.find("thead>tr");if(b.params.frozenHead){var a=b.el.find("#head_"+b.id);b.header=a.find("tbody>tr")}b.tbody=b.table.find("#grouptbody_"+this.id)},initEvent:function(){var a=this;a.initHeighlightEvent();if(a.params.selectModel!=undefined&&a.params.selectModel!=""){a.initSelectEvent()}a.initGroupBtn();if(a.isExpand){a.expandAll(true)}else{a.expandAll(false)}if(a.params.editable){a.table.find("tbody").unbind("dblclick");a.table.find("tbody").bind("dblclick",function(b){a.editCell(b)})}},initHeighlightEvent:function(){var b=this;var a=this.table.find("tbody>tr");a.each(function(d,c){var e=$(c);if(b.params.rowSelect&&!e.hasClass("u-groupgrid-grouphead")){e.on("click",function(i){var j=$(i.target);var l=j.index();if(j.attr("type")=="checkbox"||j.attr("type")=="radio"){return}if(b.params.selectModel=="multi"){if(e.hasClass("selected")){b.isRowSelect(false,e,h)}else{b.isRowSelect(true,e,h)}b.setGroupcheckStatus(e)}else{if(e.hasClass("selected")){if(b.lastselect.index==l){b.lastselect={}}b.isRowSelect(false,e,l)}else{if(b.lastselect&&b.lastselect.index!=l){b.isRowSelect(false,b.lastselect.tr,b.lastselect.index)}b.isRowSelect(true,e,l)}}if(b.rowclick){var f=Horn.Util.getFunObj(b.rowclick),k;var g=f.params,m=$(this).attr("groupindex"),h=$(this).attr("itemindex");if(m&&h){var n=b.data[m].items[h];g.push(n)}if($.type(f.fn)=="function"){k=f.fn}if(k){k.apply(b,g)}return}})}})},initGroupBtn:function(){var b=this;var a=b.table.find(".u-groupgrid-grouphead-title");a.each(function(c,d){var d=$(d);d.on("click",function(){var e=d.closest("tbody");if(d.closest("tr").hasClass("active")){d.closest("tr").removeClass("active");b.expandGroup(false,e)}else{d.closest("tr").addClass("active");b.expandGroup(true,e)}})})},createPagebar:function(){var a=this;if(a.params.pageConfig){a.pagebar=new Horn.group_Pagebar(a.params.pageConfig,a.id,a)}},initSelectEvent:function(){var a=this;if(a.params.selectModel&&a.params.selectModel=="multi"){a.initMulSelectEvent()}else{a.initSglSelectEvent()}},initMulSelectEvent:function(){var d=this;var b=d.table.find("tbody>tr");var a=d.el.find(".h_groupgrid_select_all"),c=d.table.find("tr").length-1;a.change(function(){if(this.checked){d.selectAll()}else{d.unSelectAll()}});b.each(function(g,i){var h=$(i);var e=h.find('input[type="checkbox"]');var f=e.attr("name");if(f&&f.indexOf("groupcheck")<0){e.change(function(){if(this.checked){d.isRowSelect(true,h,g)}else{d.isRowSelect(false,h,g)}d.setGroupcheckStatus(h)})}else{e.change(function(){var j=h.siblings();if(this.checked){j.each(function(k,l){var l=$(l);d.isRowSelect(true,l,k)});if(d.table.find('input[name!="selectall"]:checked').length==c){a.prop("checked",true)}}else{a.prop("checked",false);j.each(function(k,l){var l=$(l);d.isRowSelect(false,l,k)})}})}})},initSglSelectEvent:function(){var b=this;var a=b.table.find("tbody>tr");a.each(function(d,f){var e=$(f);var c=e.find('input[type="radio"]');c.change(function(){if(this.checked){if(b.lastselect&&b.lastselect.index!=d){b.isRowSelect(false,b.lastselect.tr,b.lastselect.index)}b.isRowSelect(true,e,d)}else{b.isRowSelect(false,e,d)}})})},processReqConf:function(){var d=this,b=d.params.pageConfig["pageNo"],a=d.params.pageConfig["pageSize"],c=$("#pageSize_"+d.id);if(a){c.val(a)}d.reqPageNo=d.reqPageNo?d.reqPageNo:b;d.reqPageSize=d.reqPageSize?d.reqPageSize:a},staticInitPagebar:function(){if(this.hasPage){var a=this.storgedData.length;if(this.pagebar){this.pagebar.setTotalCount(a);this.pagebar.calPage_(this.reqPageNo,this.reqPageSize,a);this.setPageInfo()}this.reqPageNo=this.reqPageNo+1}},setGroupcheckStatus:function(f){var h=this,b=h.el.find(".h_groupgrid_select_all"),d=f.closest("tbody").children("tr").get(0),e=$(d).find('input[type="checkbox"]'),c=f.closest("tbody").find('input[name="'+h.name+'checkbox"]:checked').length,a=f.closest("tbody").children("tr").length-1,g=h.table.find("tr").length-1;if(c==a){e.prop("checked",true)}else{e.prop("checked",false)}if(h.table.find('input[name!="selectall"]:checked').length==g){b.prop("checked",true)}else{b.prop("checked",false)}},expandGroup:function(b,c){var a=c.find("tr.u-groupgrid-grouphead").siblings();if(b){a.show()}else{a.hide()}},editCell:function(g){var i=this;var f=$(g.target).closest("td");if(i.params.numbercolumn&&f.index()==0){return}var d=f.find(".showvalue").text();var a=f.attr("compid");var c=f.attr("fieldtype");if(c==="0"){return}var h=Horn.getComp(a).getValue();if(d!=""&&h==""){if(c=="6"||c=="5"){var b=f.find(".showvalue").attr("key");Horn.getComp(a).setValue(b)}else{Horn.getComp(a).setValue(d)}}if(i.editingCell.length==0){i.editingCell=f;f.find(".content").show();f.find(".showvalue").hide()}if(i.editingCell.attr("id")==f.attr("id")){return}else{i.changeCelldata(i.editingCell);f.find(".content").show();f.find(".showvalue").hide();i.editingCell=f}},changeCelldata:function(j){var c=this;if(j.length==0){return}j.find(".content").hide();var f=j.attr("compid");var i=j.attr("factorcode");var b=Horn.getComp(f);if(b==undefined){return}var g=Horn.getComp(f).getValue(true);var e=j.attr("fieldtype");j.find(".showvalue").text(g).show();var d=parseInt(j.attr("rownum"));var h=parseInt(j.attr("group"));if(e=="5"||e=="6"){var a=Horn.getComp(f).getValue();j.find(".showvalue").attr("key",a);c.cacheData[h].items[d][i]=a}else{c.cacheData[h].items[d][i]=g}},destroyUI:function(){Horn.destroy("field","ID$_")},selectAll:function(){var c=this;var a=c.table.find("tbody>tr");a.each(function(d,f){var e=$(f);c.isRowSelect(true,e,d)});var b=c.header.find(".h_groupgrid_select_all");if(b.length>0){b.prop("checked",true)}},unSelectAll:function(){var c=this;var a=c.table.find("tbody>tr");a.each(function(d,f){var e=$(f);c.isRowSelect(false,e,d)});var b=c.header.find(".h_groupgrid_select_all");if(b.length>0){b.prop("checked",false)}},isRowSelect:function(a,e,b){var d=e.attr("groupIndex");var c=e.attr("itemIndex");if(a){e.addClass("selected");this.lastselect={rowindex:b,tr:e};if(this.params.selectModel&&this.params.selectModel=="single"){e.find("input[type='radio']").prop("checked",true);this.selecteds[d].items.push(this.data[d].items[c])}else{if(this.params.selectModel&&this.params.selectModel=="multi"){e.find("input[type='checkbox']").prop("checked",true)}}}else{e.removeClass("selected");if(this.params.selectModel&&this.params.selectModel=="single"){e.find("input[type='radio']").prop("checked",false);this.selecteds[d].items.pop()}else{if(this.params.selectModel&&this.params.selectModel=="multi"){e.find("input[type='checkbox']").prop("checked",false)}}}},getAllselected:function(){var d=this,c=d.table.find("tr.selected"),b=$.extend(true,[],d.data);for(var a=0;a<b.length;a++){b[a].items=[]}c.each(function(e,k){var j=$(k),h=j.attr("groupIndex"),f=j.attr("itemIndex");if(h&&f){b[h].items.push(d.data[h].items[f])}});return b},load:function(a,b){b=b||{};this.loadFlag="autoLoad";if($.type(b)=="array"){b=Horn.Util.arr2Obj(b)}this.reqPageNo=b.pageNo||this.reqPageNo;this.reqPageSize=b.pageSize||this.reqPageSize;if(this.loadFlag&&this.loadFlag!="autoLoad"){this.reqPageNo=1}this.loadFlag="autoLoad";if(this.hasPage){b.pageNo=this.reqPageNo;b.pageSize=this.reqPageSize}this.execute(a,b)},execute:function(d,c){c=c||{};var f=true;if(this.beforeload){var b=Horn.Util.getFunObj(this.beforeload),h;if($.type(b.fn)=="function"){h=b.fn}if(h){try{f=h.apply(this,[this.el,c])}catch(g){}}}if(f!=false){var a=Horn.apply({},this.baseParams,c);this.doAjax(d,a)}return f},doAjax:function(b,c){var d=this;var b=b?b:d.params.url;if(b&&b.indexOf("http:")==-1){b=context_path+b}var a=d.header.children().length;$.ajax(b,{async:true,beforeSend:function(e){d.table.find("tbody").remove();d.table.append('<tbody><tr><td style="border-right:0px;padding:15px;" colspan=\''+a+"'><img src='"+context_path+"/components/datagrid/img/hc_onLoad.gif'></img></td></tr></tbody");d.table.addClass("u-groupgrid-loading")},type:"POST",data:Horn.Util.obj2Arr(c),dataType:"json",error:function(g,h,f){var e=g.status;d.table.removeClass("u-groupgrid-loading");d.loadErrorCallback(h)},success:function(f,l,h){var j='<tr><td style="border-right:0px;padding:15px;" colSpan=\''+a+"'><p>暂时无数据</p></td></tr>";d.loadSuccessCallback(f,j);try{if(d.loadsuccess){var k=Horn.Util.getFunObj(d.loadsuccess),g;if($.type(k.fn)=="function"){g=k.fn}if(g){g.apply(d,[d.el,f])}}}catch(i){Horn.debug(i)}}})},loadErrorCallback:function(c){var b=this;var a=b.header.children().length;b.table.find("tbody").remove();b.table.append('<tbody><tr><td style="border-right:0px;padding:15px;" colSpan=\''+a+"'><p>暂时无数据</p><p>错误状态："+status+";错误信息："+c+"</p></td></tr></tbody>")},loadSuccessCallback:function(a,e){var f=this;f.table.removeClass("u-groupgrid-loading");if(!a||$.isEmptyObject(a)){f.table.find("tbody").remove();f.table.append("<tbody>"+e+"</tbody>");if(f.loaderror){var c=Horn.Util.getFunObj(f.loaderror),b;if($.type(c.fn)=="function"){b=c.fn}if(b){b.apply(f,[f.el,a])}return}}else{var d=a.data;f.initPagebar(a);if(d&&(d.length==0||$.isEmptyObject(d))){f.table.find("tbody").remove();f.table.append("<tbody>"+e+"</tbody>")}else{f.loadData(d)}}},loadData:function(b){var c=this;c.data=b;c.selecteds=$.extend(true,[],c.data);for(var a=0;a<c.selecteds.length;a++){c.selecteds[a].items=[]}c.table.removeClass("u-groupgrid-loading");c.table.find("tbody").unbind().remove();if(c.params.editable){c.editingCell=[];c.cacheData=[];$.extend(true,c.cacheData,c.data);c.creatEditTable(c.data)}else{c.loadGroupTable(c.data)}},loadGroupTable:function(f){var o=this,m=[],j=m.length,p=f.length,u=o.header.children().length;var a=o.params.pageConfig["pageNo"];var s=o.params.pageConfig["pageSize"];var g=o.params.items;o.reqPageNo=a?a:1;o.reqPageSize=s?s:10;for(var e=0;e<p;e++){m[j++]='<tbody><tr class="u-groupgrid-grouphead">';if(o.params.selectModel=="multi"){m[j++]='<td style="width:36px;"><div class="hc-datagrid-cell-check" style="TEXT-aLIGN: center;width:36px;"><input type="checkbox" name="'+o.name+'groupcheck"></div></td>';m[j++]='<td colspan="'+(u-1)+'"><div class="u-groupgrid-grouphead-title"><span class="fa-stack"><i class="fa fa-square-o fa-stack-1x"></i><i class="fa fa-angle-down fa-stack-1x"></i></span><span>'+f[e].title+"</span></div></td>"}else{m[j++]='<td colspan="'+u+'"><div class="u-groupgrid-grouphead-title"><span class="fa-stack"><i class="fa fa-square-o fa-stack-1x"></i><i class="fa fa-angle-down fa-stack-1x"></i></span><span>'+f[e].title+"</span></div></td>"}m[j++]="</tr>";var r=f[e].items;for(var d=0;d<r.length;d++){m[j++]='<tr groupIndex="'+e+'" itemIndex="'+d+'">';if(o.params.selectModel=="single"){m[j++]='<td style="width:36px;"><div class="hc-datagrid-cell-check" style="TEXT-aLIGN: center;width:36px;"><input type="radio" name="'+o.name+'radiobtn"></div></td>'}else{if(o.params.selectModel=="multi"){m[j++]='<td style="width:36px;"><div class="hc-datagrid-cell-check" style="TEXT-aLIGN: center;width:36px;"><input type="checkbox" name="'+o.name+'checkbox"></div></td>'}}for(var c=0;c<g.length;c++){var t=g[c]["name"],b=g[c]["width"],k=g[c]["hidden"],q=g[c]["renderer"];if(k&&k.toString()==="true"){k="display:none"}else{k=""}if(q){q=q}else{q=""}if(c==(g.length-1)){m[j++]='<td style="width:auto;'+k+'"" renderer="'+q+'"><div style="width:100px;overflow: hidden; white-space: nowrap;text-overflow: ellipsis;">'+r[d][t]+"</div></td>"}else{if(b){m[j++]='<td style="width:'+b+"px;"+k+'"" renderer="'+q+'" ><div style="width:'+b+'px;overflow: hidden; white-space: nowrap;text-overflow: ellipsis;">'+r[d][t]+"</div></td>"}else{m[j++]='<td style="width:100px;'+k+'"" renderer="'+q+'"><div style="width:100px;overflow: hidden; white-space: nowrap;text-overflow: ellipsis;">'+r[d][t]+"</div></td>"}}}m[j++]="</tr>"}m[j++]="</tbody>"}o.storgedData=f;o.table.append(m.join(""));if(o.params.height&&!isNaN(o.params.height)){o.table.parent().height(o.params.height)}o.initEvent();o.columnRender()},creatEditTable:function(f){var l="",m=[],j=this,p=j.header.children().length,b=$("#grouptable_"+j.id+"_copyedittab").find("td");j.table.find("tbody").remove();if(f&&f.length>0){for(var g=0,d=f.length;g<d;g++){var e=$("<tbody></tbody>");var h=$('<tr class="u-groupgrid-grouphead"></tr>');if(j.params.selectModel=="multi"){h.append('<td style="width:36px;"><div class="hc-datagrid-cell-check" style="TEXT-aLIGN: center;width:36px;"><input type="checkbox" name="'+j.name+'groupcheck"></div></td>');h.append('<td colspan="'+(p-1)+'"><div class="u-groupgrid-grouphead-title"><span class="fa-stack"><i class="fa fa-square-o fa-stack-1x"></i><i class="fa fa-angle-down fa-stack-1x"></i></span><span>'+f[g].title+"</span></div></td>")}else{h.append('<td colspan="'+p+'"><div class="u-groupgrid-grouphead-title"><span class="fa-stack"><i class="fa fa-square-o fa-stack-1x"></i><i class="fa fa-angle-down fa-stack-1x"></i></span><span>'+f[g].title+"</span></div></td>")}e.append(h);for(var a=0,o=f[g].items.length;a<o;a++){var c=f[g].items[a];var k=$("<tr groupIndex="+g+" itemIndex="+a+" ></tr>");b.each(function(r){var v=$(this).clone();var u=v.attr("factorcode");var i=uuid();v.attr({id:"td_"+u+a+i+r,compid:"field"+u+a+i+r+"ID",rownum:a,group:g});var w=v.html();var t="field"+u+a+i+r+"ID";var q=v.attr("fieldtype");v.html(w.replace(new RegExp(("field"+u+"0ID"),"g"),t));v.find("div.showvalue").text(c[u]).show();if(q=="6"){var n=$(j.header.find("td")[r]);var s=n.attr("dictName");j.dictColRender(v,s,c[u])}if(q=="5"){j.staticDict(v,r,c[u])}k.append(v)});e.append(k)}j.table.append(e)}registeSelfui(j.table)}if(j.params.height&&!isNaN(j.params.height)){j.table.parent().height(j.params.height)}j.initEvent()},columnRender:function(){var b=this;var a=b.table.find("tbody>tr");a.each(function(d,c){var e=$(c);e.find("td").each(function(f,h){var i=$(h);var g=i.attr("renderer");if(g&&g!=""){b.colRendererFunc(i,g,f,e)}})})},colRendererFunc:function(b,g,f,h){var e=this;b.attr("key",b.find("div").text());b.find("div").attr("title","");var i=Horn.Util.getFunObj(g);var j=b.find("div").html();var a=h.attr("groupindex");var d=h.attr("itemindex");if(!i.fn){return}var c=i.fn.call($(this),{val:j,rowdata:e.data[a].items[d],alldata:e.data,table:e,tdidx:f,tr:h,td:b});if(c instanceof $){b.find("div").html("");b.find("div").append(c)}else{b.find("div").html(c)}},dictColRender:function(d,c,a){var b=Horn.getDict(c);if(b){if(b[a]!=undefined){d.children("div.showvalue").text(b[a]).attr("key",a)}}},staticDict:function(b,e,h){if(this.params.selectModel!=""&&this.params.selectModel!=undefined){e=e-1}var k=this.params.items[e];var a=k.items;var l=h.toString().split(",");var m=[];for(var c=0;c<l.length;c++){var f=l[c];for(var d=0;d<a.length;d++){if(a[d]["code"]==f){m.push(a[d]["text"])}}}var g=m.join(",");b.children("div.showvalue").text(g);b.children("div.showvalue").attr("key",h)},saveData:function(){var a=this;a.changeCelldata(a.editingCell);a.data=$.extend(true,[],a.cacheData);a.editingCell=[];return a.data},reload:function(){var a=this;a.cacheData=[];a.editingCell=[];$.extend(true,a.cacheData,a.data);a.destroyUI();a.creatEditTable(a.data)},initPagebar:function(a){if(this.hasPage){var b=a.total;if(this.pagebar){if(a!=null){$("#toPage_"+this.id).attr("disabled",false);$("#pageSize_"+this.id).attr("disabled",false)}this.pagebar.setTotalCount(b);this.pagebar.calPage_(this.reqPageNo,this.reqPageSize,b);this.setPageInfo()}}},pageBtnDisabled:function(a){if(a){$("#toPage_"+this.id).attr("disabled",true);$("#pageSize_"+this.id).attr("disabled",true);$("#page_"+this.id).find(".first_page_btn,.pre_page_btn").addClass("disabled");$("#page_"+this.id).find(".next_page_btn,.last_page_btn").addClass("disabled");$("#page_"+this.id).find(".refresh_btn").addClass("disabled")}else{$("#toPage_"+this.id).attr("disabled",false);$("#pageSize_"+this.id).attr("disabled",false);$("#page_"+this.id).find(".first_page_btn,.pre_page_btn").removeClass("disabled");$("#page_"+this.id).find(".next_page_btn,.last_page_btn").removeClass("disabled");$("#page_"+this.id).find(".refresh_btn").removeClass("disabled")}},setPageInfo:function(){$("#toPage_"+this.id).val(this.pagebar.currentPage);$("#pageSize_"+this.id).val(this.pagebar.pageSize);$("#totalPages_"+this.id).html(this.pagebar.pages);if((this.pagebar.pageSize%5)==0){var c=this.pagebar.pageSize/5;if(c==20){c=11}else{if(c==40){c=12}else{if(c==100){c=13}else{if(c==200){c=14}}}}var a=$($(".dropdown-menu-datagrid").find("li").get(c-1));a.addClass("active");this.pagebar.activeLi=a}var b=this.params.isNotTotal?this.params.isNotTotal+"":"false";if(b!="true"){$("#pageInfo_"+this.id).html(this.pagebar.getPageInfo())}if(1==this.pagebar.currentPage){$("#page_"+this.id).find(".first_page_btn,.pre_page_btn").addClass("disabled")}else{$("#page_"+this.id).find(".first_page_btn,.pre_page_btn").removeClass("disabled")}if(this.pagebar.pages==this.pagebar.currentPage){if(b!="true"){$("#page_"+this.id).find(".next_page_btn,.last_page_btn").addClass("disabled")}}else{$("#page_"+this.id).find(".next_page_btn,.last_page_btn").removeClass("disabled")}$("#page_"+this.id).find(".refresh_btn").removeClass("disabled")},reqPage:function(b,a){this.reqPageNo=b?b:this.reqPageNo;this.reqPageSize=a?a:this.reqPageSize;if(this.loadFlag!="autoLoad"&&this.storgedData){this.result=this.storgedData.slice((this.reqPageNo-1)*this.reqPageSize,this.reqPageNo*this.reqPageSize);if(!this.hasPage){this.result=this.storgedData}this.staticInitPagebar()}else{if(this.params.editable){this.destroyUI()}this.load()}},expandAll:function(b){var c=this;var a=c.table.find(".u-groupgrid-grouphead-title");if(b){c.table.find("tbody>tr").show();c.tbody.hide();a.closest("tr").addClass("active")}else{c.table.find("tbody>tr").hide();a.closest("tr").show().removeClass("active")}},getSelecteds:function(){var a=this;if(a.params.selectModel=="single"){return this.selecteds}else{return a.getAllselected()}},setButtonDisabled:function(a,b){var d=this;var c=d.el.find("div.u-datagrid-toolbar").children("ul").children("li");c.each(function(g,e){var f=$(this).children("a");var h=f.attr("name");if(h==a){if(b){f.addClass("f-disabled");f.attr("onclick","javascript:return false;")}else{f.removeClass("f-disabled");f.attr("onclick",f.attr("event"))}return}})},getId:function(){return this.id},setTitle:function(a){var b=this;b.title=a;b.titleEl.text(a)},getTitle:function(){return this.title},addButton:function(b){var a={name:"",cls:"",event:""};var e=this,b=$.extend(a,b);if(!b||!b.label){return}var d=e.el.find("div.u-datagrid-toolbar").children("ul");var c=$('<li><a name="'+b.name+'" href="JavaScript:void(0)" class="hc-datagrid-a hc_datagrid-alink" onclick="'+b.event+'"><i class="fa '+b.cls+'"></i>'+b.label+"</a></li>");d.append(c)},hideButton:function(a,c){var e=this.el.find("div.u-datagrid-toolbar").children("ul");var d=e.children("li").children("a");for(var b=0;b<d.length;b++){if($(d[b]).attr("name")==a){if(c){$(d[b]).hide()}else{$(d[b]).show()}}}}});Horn.regUI("div.hdsungroupgrid",Horn.GroupGrid);Horn.group_Pagebar=function(d,c,a){var b={gridId:null,INDEX_PAGE:1,currentPage:1,pageSize:10,pageCount:0,pages:0,startRow:0,isNotTotal:false,init:function(g,f,e){if(g){setDefaultValue(g,"pageSize",10);setDefaultValue(g,"pageNo",1);setDefaultValue(g,"startRow",0);setDefaultValue(g,"pageCount",0);setDefaultValue(g,"currentPage",0);this.currentPage=parseInt(g.currentPage);this.pageCount=parseInt(g.pageCount);this.pageSize=parseInt(g.pageSize);this.pageNo=parseInt(g.pageNo);this.startRow=parseInt(g.startRow);this.pages=0}this.gridId=f;this.grid=e;this.grid.reqPageSize=this.pageSize;this.grid.reqPageNo=this.pageNo;this.el=$("#page_"+this.gridId);var h=this.el.attr("isNotTotal");if(h=="true"){this.isNotTotal=true}},initEvents:function(){var e=this;$("#page_"+this.gridId).children("li").find("a").each(function(g,h){var i=$(h);var j=function(l,m,k){l.click(function(){if(l.hasClass("disabled")){return}k=k||[];m.apply(e,k)})};if(!i.hasClass("disabled")){if(i.hasClass("first_page_btn")){j(i,e.first)}else{if(i.hasClass("pre_page_btn")){j(i,e.pre)}else{if(i.hasClass("next_page_btn")){j(i,e.next)}else{if(i.hasClass("last_page_btn")){j(i,e.last)}else{if(i.hasClass("refresh_btn")){j(i,e.refresh)}}}}}}});this.perPage=false;$("#_recPerPage"+this.gridId).on("click",function(){optGridId=$(this).attr("id");optGridId=optGridId.substring(11);var g=$(this).children("strong").text();if(e.perPage){$(this).next().hide();e.perPage=false}else{$(this).next().show();$(this).next().find("li").each(function(h,i){var j=$(this).children("a").text();if(g==j){$(this).addClass("active")}else{$(this).removeClass("active")}});e.perPage=true}});$("#_recPerPage"+this.gridId).bind("blur",function(h){var g=h;if(e.perPage){$(".dropdown-menu-datagrid").hide();e.perPage=false;return true}});$(".dropdown-menu-datagrid").bind("mouseover",function(){$("#_recPerPage"+e.gridId).unbind("blur")});$(".dropdown-menu-datagrid").bind("mouseout",function(){$("#_recPerPage"+e.gridId).bind("blur",function(h){var g=h;if(e.perPage){$(".dropdown-menu-datagrid").hide();e.perPage=false;return true}})});this.activeLi=$(".dropdown-menu-datagrid").find("li.active");var f=this.grid;$("#toPage_"+f.id).on("blur",function(){e.callToPage($(this))});$("#pageSize_"+f.id).on("blur",function(){e.callToPageSize($(this))});$("#toPage_"+f.id).bind("keypress",function(g){if(g.keyCode=="13"){e.callToPage($(this))}});$("#pageSize_"+f.id).bind("keypress",function(g){if(g.keyCode=="13"){e.callToPageSize($(this))}})},callToPage:function(g){var f=this.grid;var e=g.val();if(!e||isNaN(e)){e=f.reqPageNo}e=parseInt(e,10);if(e<=0){e=1}else{if(e>f.pagebar.pages){e=1}}g.val(e);f.reqPage(g.val(),$("#pageSize_"+f.id).html())},callToPageSize:function(h){var g=this;var e=h.val();if(e==""){var f=g.pageSize;if(f&&f!=""){e=f}else{e=10}}if(!e||isNaN(e)){e=thatgrid.pageSize}e=parseInt(e,10);if(e<=0){e=1}h.val(e);g.grid.reqPage(parseInt($("#toPage_"+g.grid.id).val()),e)},calPage_:function(g,f,e){this.pageSize=parseInt(f);this.pageCount=parseInt(e);this.pages=Math.ceil(this.pageCount/this.pageSize);if(!this.isNotTotal){if((g*this.pageSize)>this.totalCount){this.currentPage=this.pages}else{this.currentPage=g}}else{if(this.currentPage==0){this.currentPage=1}}},pre:function(){if(this.isNotTotal){var e=this.currentPage-1;this.currentPage=e;this.grid.reqPage(e,this.pageSize)}else{if(this.currentPage<=1||this.pageCount==0){this.grid.reqPage(1,this.pageSize)}else{this.grid.reqPage((this.currentPage-1),this.pageSize)}}},next:function(){if(!this.isNotTotal){if(this.pages==this.currentPage){return}}var e=0;if(this.currentPage!=""){e=parseInt(this.currentPage)+1}if(this.isNotTotal){e=this.currentPage+1;this.currentPage=e}this.grid.reqPage(e,this.pageSize)},last:function(){if(this.pages==0){return}else{this.grid.reqPage(this.pages,this.pageSize)}},first:function(){this.grid.reqPage(this.INDEX_PAGE,this.pageSize)},refresh:function(){var e=this.grid.reqPageNo-1;if(this.grid.loadFlag=="autoLoad"){e=this.grid.reqPageNo}this.grid.reqPage(e,this.pageSize)},getPageInfo:function(){var f;var g=0,e=0;if(this.pageCount>0){g=this.pageSize*(this.currentPage-1)+1;if((this.pageSize*this.currentPage)>=this.pageCount){e=this.pageCount}else{e=this.pageSize*this.currentPage}}f="显示"+g+"到"+e+"条,共"+this.pageCount+"条记录";return f},setTotalCount:function(e){this.totalCount=parseInt(e)}};b.init(d,c,a);b.initEvents();return b};
Horn.HiddenField=Horn.extend(Horn.Field,{COMPONENT_CLASS:"HiddenField",init:function(){Horn.HiddenField.superclass.init.apply(this,arguments);this.field=this.el;this.name=this.field.attr("name");this.alias=this.field.attr("alias")||"";this.defValue=(this.params.defValue!=undefined)?this.params.defValue:this.field.val()},isValid:function(){return true},showError:function(){},reset:function(a){if(a){this.field.val("")}else{this.field.val(this.defValue)}},removeError:function(){}});Horn.Field.regFieldType("input.hc_hiddenfield",Horn.HiddenField);
Horn.ImageBox=Horn.extend(Horn.Base,{COMPONENT_CLASS:"ImageBox",id:"imageBoxId",baseParams:{},url:"",mode:"",rows:3,columns:3,datas:null,pagebar:null,currentPage:1,hasPage:false,reqPageNo:1,reqPageSize:10,init:function(a){Horn.ImageBox.superclass.init.apply(this,arguments);var b=this;this.mode="iconMode";if(this.params.id&&this.params.id!=""){this.id=this.params.id}else{if(this.params.name&&this.params.name!=""){this.id=this.params.name}}this.baseParams=this.params.baseParams||{};this.url=this.params.url?this.params.url:null;this.rows=this.params.rows?this.params.rows:3;this.columns=this.params.columns?this.params.columns:3;if(!this.params.pageConfig){this.params.pageConfig={}}this.hasPage=this.params.hasPage+""||"false";if(this.hasPage&&this.hasPage=="true"){this.createPagebar()}this.processReqConf();$.each(b.params.events||[],function(c,d){b[d.event.toLowerCase()]=d["function"]});this.load();$("#iconBtn_"+this.id).on("click",function(c){b.mode="iconMode";$("#listBtn_"+b.id).removeClass("active");$(this).addClass("active");$("#listMode_"+b.id).hide();$("#iconMode_"+b.id).show();b.load()});$("#listBtn_"+this.id).on("click",function(c){b.mode="listMode";$("#iconBtn_"+b.id).removeClass("active");$(this).addClass("active");$("#iconMode_"+b.id).hide();$("#listMode_"+b.id).show();b.load()})},createPagebar:function(){if(this.params.pageConfig){var a=this;this.pagebar=new Horn._ImagePagebar(this.params.pageConfig,this.id,a)}},processReqConf:function(){var b=this.params.pageConfig["pageNo"];var a=this.params.pageConfig["pageSize"];var c=$("#pageSize_"+this.id);if(a){c.val(a)}this.reqPageNo=this.reqPageNo?this.reqPageNo:b;this.reqPageSize=this.reqPageSize?this.reqPageSize:a},load:function(a,b){b=b||{};if($.type(b)=="array"){b=Horn.Util.arr2Obj(b)}this.reqPageNo=b.pageNo||this.reqPageNo;this.reqPageSize=b.pageSize||this.reqPageSize;if(this.hasPage){b.pageNo=this.reqPageNo;b.pageSize=this.reqPageSize}this.execute(a,b)},execute:function(c,b){b=b||{};var d=true;if(d!=false){var a=Horn.apply({},this.baseParams,b);this.doAjax(c,a)}return d},doAjax:function(b,e){var g=this;var f=g.mode;var d=g.rows;var c=g.columns;var a=g.params.hasPage+"";var d=g.rows;var b=b?b:g.url;if(b&&b.indexOf("http:")==-1){b=context_path+b}$.ajax(b,{async:true,beforeSend:function(h){},type:"POST",data:Horn.Util.obj2Arr(e),dataType:"json",error:function(i,j,h){console.log("图片请求失败")},success:function(k,j,s){if(!k||$.isEmptyObject(k)){}else{var x="";var m="";if(k){var y=k.rows;x=k.redirectUrl;m=k.target;g.resultData=k;if(y==null||y=="null"){if(x&&x!=""){if(m=="top"){top.location.href=x}else{if(m=="parent"){parent.location.href=x}else{window.location.href=x}}return}}this.result=y?y:k}g.datas=k;g.params.data=k.rows;g.currentPageSize=k.length||(k.rows&&k.rows.length);if(f=="iconMode"){var v=$("#iconMode_"+g.id);v.html("");if(c){var p=[];var o=d*c;var z=k.rows.length;if(z>o){z=o}for(var u=0;u<z;u++){var w=k.rows[u];var l=12/parseInt(c);var t='<div id="icon_'+g.id+"_"+(u+1)+'" class="g-grid-'+l+'"><div class="imgBox f-fl"> <div class="imgBoxInner"><div class="img" imgindex="'+u+'"><a href="javascript:void(0)" class="imgShow" target="_blank"><img src="'+context_path+w.url+'" title="'+w.imgName+'" alt="'+w.imgName+'">';var q=w.isHotSale+"";if(q=="1"||q=="true"){t=t+'<div class="hotsale"><i class="fa fa-tag"></i><span>热卖</span></div>'}t=t+'</a></div><div class="imgDetailInfo clearix text-ellipsis"><span class="f-fl imgInfoLeft text-ellipsis"  title="'+w.imgTitle+'">'+w.imgTitle+'</span><span class="f-fr imgInfoRight text-ellipsis" title="$'+w.price+'">$'+w.price+"</span></div></div></div></div>";p.push(t)}v.append(p.join(""))}}else{var n=$("#listMode_"+g.id).find("ul");n.html("");var p=[];for(var u=0;u<k.rows.length;u++){var w=k.rows[u];var h='<li id="list_'+g.id+"_"+(u+1)+'"><div class="g-grid-1 list_ImgBox"><div class="list_Img" imgindex="'+u+'"><a href="javascript:void(0)" class="list_imgView"><img src="'+context_path+w.url+'" title="'+w.imgName+'" alt="'+w.imgName+'">';var r=w.isHotSale+"";if(r=="1"||r=="true"){h=h+'<div class="hotsale_list"><i class="fa fa-bookmark"></i></div>'}h=h+'</a></div></div><div class="g-grid-8 list_infoBox"><div class="list_detailInfo"><strong><a href="javascript:void(0)" class="list_info text-ellipsis" title="'+w.imgTitle+'">'+w.imgTitle+'</a></strong></div></div><div class="g-grid-1 list_prinBox"><div class=" list_prince "><strong><span class="text-ellipsis" title="$'+w.price+'">$'+w.price+'</span></strong></div></div><div class="g-grid-2 list_btnBox"><div class="list_btn"><button class="buy_btn" btnindex="'+u+'">购买</button></div></div></li>';p.push(h)}n.append(p.join(""))}g.bindClickEvent(k.length);if(a&&a=="true"){g.initPagebar(k)}}}})},bindClickEvent:function(){var d=this;var c=this.mode;var a;var b;if(c=="iconMode"){a=$("#iconMode_"+this.id);b="img"}else{a=$("#listMode_"+this.id);b="list_Img";$("#listMode_"+this.id).find(".buy_btn").each(function(e,g){var f=$(g);f.on("click",function(k){var j=$(k.target);if(d.btnclick){var i=Horn.Util.getFunObj(d.btnclick),h;var m=i.params,l=$(this).attr("btnindex");if(l){var n=d.datas.rows[l];m.push(n)}if($.type(i.fn)=="function"){h=i.fn}if(h){h.apply(d,m)}return}})})}a.find("."+b).each(function(f,g){var e=$(g);e.on("click",function(l){var k=$(l.target);if(d.click){var j=Horn.Util.getFunObj(d.click),h;var m=j.params,i=$(this).attr("imgindex");if(i){var n=d.datas.rows[i];m.push(n)}if($.type(j.fn)=="function"){h=j.fn}if(h){h.apply(d,m)}return}});e.on("dblclick",function(m){var l=$(m.target);if(d.dblclick){var k=Horn.Util.getFunObj(d.dblclick),j;var i=k.params,n=$(this).attr("imgindex");if(n){var h=d.datas.rows[n];i.push(h)}if($.type(k.fn)=="function"){j=k.fn}if(j){j.apply(d,i)}return}})})},initPagebar:function(a){if(this.hasPage){var b=a.total;if(this.pagebar){var c=a.rows;if(!c||$.isEmptyObject(c)||c==""||c.length==0){b=0}this.pagebar.setTotalCount(b);this.pagebar.calPage_(this.reqPageNo,this.reqPageSize,b);this.setPageInfo()}}},setPageInfo:function(){$("#toPage_"+this.id).val(this.pagebar.currentPage);$("#toPage_"+this.id).next().html(this.pagebar.currentPage);$("#totalPages_"+this.id).html(this.pagebar.pages);if((this.pagebar.pageSize%5)==0){var b=this.pagebar.pageSize/5;if(b==20){b=11}else{if(b==40){b=12}else{if(b==100){b=13}else{if(b==200){b=14}}}}var a=$($(".dropdown-menu-datagrid").find("li").get(b-1));a.addClass("active");this.pagebar.activeLi=a}if(1==this.pagebar.currentPage){$("#page_"+this.id).find(".first_page_btn,.pre_page_btn").addClass("disabled")}else{$("#page_"+this.id).find(".first_page_btn,.pre_page_btn").removeClass("disabled")}if(this.pagebar.pages==this.pagebar.currentPage){$("#page_"+this.id).find(".next_page_btn,.last_page_btn").addClass("disabled")}else{$("#page_"+this.id).find(".next_page_btn,.last_page_btn").removeClass("disabled")}},reqPage:function(b,a){this.reqPageNo=b?b:this.reqPageNo;this.reqPageSize=a?a:this.reqPageSize;this.load()}});Horn.regUI("div.hc_imageBox",Horn.ImageBox);function setImagePageDefaultValue(c,b,a){if(c[b]===undefined){c[b]=a}else{if(c[b]=="true"){c[b]=true}else{if(c[b]=="false"){c[b]=false}}}}Horn._ImagePagebar=function(d,c,a){var b={gridId:null,INDEX_PAGE:1,currentPage:1,pageSize:10,pageCount:0,pages:0,startRow:0,isNotTotal:false,selectPageSize:false,init:function(g,f,e){if(g){setImagePageDefaultValue(g,"pageSize",10);setImagePageDefaultValue(g,"pageNo",1);setImagePageDefaultValue(g,"startRow",0);setImagePageDefaultValue(g,"pageCount",0);setImagePageDefaultValue(g,"currentPage",0);this.currentPage=parseInt(g.currentPage);this.pageCount=parseInt(g.pageCount);this.pageSize=parseInt(g.pageSize);this.pageNo=parseInt(g.pageNo);this.startRow=parseInt(g.startRow);this.pages=0}this.gridId=f;this.grid=e;this.grid.reqPageSize=this.pageSize;this.grid.reqPageNo=this.pageNo;this.el=$("#page_"+this.gridId);var h=this.el.attr("isNotTotal");if(h=="true"){this.isNotTotal=true}var i=this.el.attr("selectPageSize");if(i=="true"){this.selectPageSize=true}},initEvents:function(){var f=this;$("#page_"+this.gridId).children(".pageIcon").children("ul").children("li").find("a").each(function(h,i){var j=$(i);var k=function(m,n,l){m.click(function(){if(m.hasClass("disabled")){return}l=l||[];n.apply(f,l)})};if(!j.hasClass("disabled")){if(j.hasClass("first_page_btn")){k(j,f.first)}else{if(j.hasClass("pre_page_btn")){k(j,f.pre)}else{if(j.hasClass("next_page_btn")){k(j,f.next)}else{if(j.hasClass("last_page_btn")){k(j,f.last)}}}}}});this.perPage=false;$("#_recPerPage"+this.gridId).on("click",function(){optGridId=$(this).attr("id");optGridId=optGridId.substring(11);var h=$(this).children("strong").text();if(f.perPage){$(this).next().hide();f.perPage=false}else{$(this).next().show();$(this).next().find("li").each(function(i,j){var k=$(this).children("a").text();if(h==k){$(this).addClass("active")}else{$(this).removeClass("active")}});f.perPage=true}});$("#_recPerPage"+this.gridId).bind("blur",function(i){var h=i;if(f.perPage){$(".dropdown-menu-datagrid").hide();f.perPage=false;return true}});$(".dropdown-menu-datagrid").bind("mouseover",function(){$("#_recPerPage"+f.gridId).unbind("blur")});$(".dropdown-menu-datagrid").bind("mouseout",function(){$("#_recPerPage"+f.gridId).bind("blur",function(i){var h=i;if(f.perPage){$(".dropdown-menu-datagrid").hide();f.perPage=false;return true}})});this.activeLi=$(".dropdown-menu-datagrid").find("li.active");var g=this.grid;var e=this.selectPageSize?"change":"blur"},callToPage:function(g){var f=this.grid;var e=g.val();if(!e||isNaN(e)){e=f.reqPageNo}e=parseInt(e,10);if(e<=0){e=1}else{if(e>f.pagebar.pages){e=1}}g.val(e);f.reqPage(g.val(),$("#pageSize_"+f.id).html())},callToPageSize:function(h){var g=this;var e=h.val();if(e==""){var f=g.pageSize;if(f&&f!=""){e=f}else{e=10}}if(!e||isNaN(e)){e=thatgrid.pageSize}e=parseInt(e,10);if(e<=0){e=1}h.val(e);g.grid.reqPage(parseInt($("#toPage_"+g.grid.id).val()),e)},calPage_:function(g,f,e){this.pageSize=parseInt(f);this.pageCount=parseInt(e);this.pages=Math.ceil(this.pageCount/this.pageSize);if(!this.isNotTotal){if((g*this.pageSize)>this.totalCount){this.currentPage=this.pages}else{this.currentPage=g}}else{if(this.currentPage==0){this.currentPage=1}}},pre:function(){if(this.isNotTotal){var e=this.currentPage-1;this.currentPage=e;this.grid.reqPage(e,this.pageSize)}else{if(this.currentPage<=1||this.pageCount==0){this.grid.reqPage(1,this.pageSize)}else{this.grid.reqPage((this.currentPage-1),this.pageSize)}}},next:function(){if(!this.isNotTotal){if(this.pages==this.currentPage){return}}var e=0;if(this.currentPage!=""){e=parseInt(this.currentPage)+1}if(this.isNotTotal){e=this.currentPage+1;this.currentPage=e}this.grid.reqPage(e,this.pageSize)},last:function(){if(this.pages==0){return}else{this.grid.reqPage(this.pages,this.pageSize)}},first:function(){this.grid.reqPage(this.INDEX_PAGE,this.pageSize)},setTotalCount:function(e){this.totalCount=parseInt(e)}};b.init(d,c,a);b.initEvents();return b};
Horn.ImageView=Horn.extend(Horn.Base,{COMPONENT_CLASS:"ImageView",id:"imageViewId",baseParams:{},url:"",smallWidth:0,init:function(a){Horn.ImageView.superclass.init.apply(this,arguments);var b=this;if(this.params.id&&this.params.id!=""){b.id=this.params.id}else{if(this.params.name&&this.params.name!=""){b.id=this.params.name}}if(!b.params.height||b.params.height<200||b.params.height==""){b.params.height=300}if(!b.params.width||b.params.width<200||b.params.width==""){b.params.width=300}this.baseParams=this.params.baseParams||{};if(b.params.width&&b.params.width!=""){b.smallWidth=(parseInt(b.params.width)-50-60)/6}$.each(b.params.events||[],function(c,d){b[d.event.toLowerCase()]=d["function"]});this.url=this.params.url?this.params.url:null;if(b.params.url!=""&&!b.params.data){b.load()}if(b.params.data){b.initEvent()}},initEvent:function(){var g=this;var d=$("#midimg_"+g.id).width();var e=$("#imageMenu_"+g.id+" li").length-5;var f=$("#imageMenu_"+g.id+" li").length;var b=$("#imageMenu_"+g.id+" li:first").width()+10;var a=f;var c=0;$(".scrollbutton").click(function(){if($(this).hasClass("disabled")){return false}if($(this).hasClass("smallImgUp")){--c}else{++c}$(".scrollbutton").removeClass("disabled");if(c==0){$("#smallImgUp_"+g.id).addClass("disabled")}if(c>=e-1){$("#smallImgDown_"+g.id).addClass("disabled");return}$("#imageMenu_"+g.id+" ul").stop(false,true).animate({marginLeft:-c*b+"px"},600)});g.bindImgEvent();$("#midimg_"+g.id).on("mouseover",function(h){g.mouseover(h)});$("#midimg_"+g.id+",#winSelector_"+g.id).on("mousemove",function(h){g.mouseover(h)}).on("mouseout",function(h){g.mouseOut(h)});g.divWidth=$("#winSelector_"+g.id).width();g.divHeight=$("#winSelector_"+g.id).height();g.imgWidth=$("#midimg_"+g.id).width();g.imgHeight=$("#midimg_"+g.id).height();g.viewImgWidth=g.viewImgHeight=g.height=null;g.changeViewImg();$("#bigView_"+g.id).scrollLeft(0).scrollTop(0)},load:function(b,d){d=d||{};var c=true;if(c!=false){var a=Horn.apply({},this.baseParams,d);this.doAjax(b,a)}return c},doAjax:function(a,b){var c=this;var a=a?a:c.url;if(a&&a.indexOf("http:")==-1){a=context_path+a}$.ajax(a,{async:true,beforeSend:function(d){},type:"POST",data:Horn.Util.obj2Arr(b),dataType:"json",error:function(e,f,d){console.log("图片请求失败")},success:function(g,f,p){if(!g||$.isEmptyObject(g)){}else{var w="";var m="";if(g){var A=g.items;w=g.redirectUrl;m=g.target;c.resultData=g;if(A==null||A=="null"){if(w&&w!=""){if(m=="top"){top.location.href=w}else{if(m=="parent"){parent.location.href=w}else{window.location.href=w}}return}}c.result=A?A:g}var x=$("#midImgDiv_"+c.id);var j=$("#imageMenu_"+c.id).children("ul");var y=$("#bigView_"+c.id);for(var s=0;s<g.items.length;s++){var v=g.items[s];if(s==0){x.html("");var o=v.mid;if(v.mid.indexOf(context_path)==-1){o=context_path+v.mid}var k='<img id="midimg_'+c.id+'" src="'+o+'" alt="">';x.append(k);y.html("");var t=v.big;if(v.big.indexOf(context_path)==-1){t=context_path+v.big}var n='<img src="'+t+'" style="';if(c.params.height){var d=c.params.height*2;n+="height:"+d+"px;"}if(c.params.width){var q=c.params.width*2;n+="width:"+q+"px;"}n+='" alt="">';y.append(n)}var r='<li class="smallImgItem" ';if(s==0){r+='id="onlickImg"'}r+='><img imgindex="'+s+'" style="';if(c.params.height){r+="height:"+c.smallWidth+"px;width:"+c.smallWidth+"px;"}r+='" ';var l=v.small;if(v.small.indexOf(context_path)==-1){l=context_path+v.small}r+='src="'+l+'" alt=""></li>';j.append(r)}}c.initEvent();try{if(c.loadsuccess){var z=Horn.Util.getFunObj(c.loadsuccess),h;if($.type(z.fn)=="function"){h=z.fn}if(h){h.apply(c,[c.el,g])}}}catch(u){Horn.debug(u)}}})},getImgInfo:function(){var c=[];if(this.params.data){this.result=this.params.data}if(!this.result||this.result==undefined){return}for(var a in this.result){if(a=="indexOf"){continue}var b=this.result[a];if(b){c.push(b)}}return c},midChange:function(a,e){var b=context_path;if(e.mid.indexOf(context_path)==-1){e.mid=context_path+e.mid}if(e.big.indexOf(context_path)==-1){e.big=context_path+e.big}var c=e.mid;var d=this;$("#midimg_"+d.id).attr("src",c).load(function(){d.changeViewImg(e.big)})},bindImgEvent:function(){var a=null;var b=this;$("#imageMenu_"+b.id+" li img").bind("click",function(){if($(this).attr("id")!="onlickImg"){var c=b.dataIndex($(this));b.midChange($(this),c);$("#imageMenu_"+b.id+" li").removeAttr("id");$(this).parent().attr("id","onlickImg")}}).bind("mouseover",function(){if($(this).attr("id")!="onlickImg"){window.clearTimeout(a);var c=b.dataIndex($(this));b.midChange($(this),c)}}).bind("mouseout",function(){if($(this).attr("id")!="onlickImg"){a=window.setTimeout(function(){var c=b.dataIndex($("#onlickImg img"));b.midChange($("#onlickImg img"),c)},1000)}})},dataIndex:function(b){var f=this;var e={mid:"",big:""};var c=b.attr("imgindex");if(!c){c=b.parent().attr("imgindex")}var d=f.params.data||[];if(d.length>0){e.mid=d[c].mid;e.big=d[c].big}else{var a=this.result;e.mid=a[c].mid;e.big=a[c].big}return e},changeViewImg:function(a){var b=this;$("#bigView_"+b.id+" img").attr("src",a)},mouseover:function(a){var b=this;if($("#winSelector_"+b.id).css("display")=="none"){$("#winSelector_"+b.id+",#bigView_"+b.id).show()}$("#winSelector_"+b.id).css(b.fixedPosition(a));a.stopPropagation()},mouseOut:function(a){var b=this;if($("#winSelector_"+b.id).css("display")!="none"){$("#winSelector_"+b.id+",#bigView_"+b.id).hide()}a.stopPropagation()},fixedPosition:function(g){var f=this;var k=f.id;var c=f.divWidth;var h=f.divHeight;var j=f.imgHeight;var m=f.imgWidth;var d=f.viewImgWidth;var b=f.viewImgHeight;if(g==null){return}var i=$("#midimg_"+k).offset().left;var a=$("#midimg_"+k).offset().top;X=g.pageX-i-c/2;Y=g.pageY-a-h/2;X=X<0?0:X;Y=Y<0?0:Y;X=X+c>m?m-c:X;Y=Y+h>j?j-h:Y;if(d==null){d=$("#bigView_"+k+" img").outerWidth();b=$("#bigView_"+k+" img").height();if(d<200||b<200){d=b=800}f.height=h*b/j;$("#bigView_"+k).width(c*d/m);$("#bigView_"+k).height(f.height)}var n=X*d/m;var l=Y*b/j;$("#bigView_"+k+" img").css({left:n*-1,top:l*-1});$("#bigView_"+k).css({top:a+20,left:i+m+15});return{left:X,top:Y}}});Horn.regUI("div.hc_imageView",Horn.ImageView);
Horn.Label=Horn.extend(Horn.Base,{COMPONENT_CLASS:"Label",el:null,dictName:null,staticDict:null,mutiValue:null,init:function(e){Horn.Label.superclass.init.apply(this,arguments);var d=this.params;if(d.name||d.hiddenName){this.name=d.name||d.hiddenName}this.mutiValue=$(e).attr("mutivalue");this.label=this.el.prev("span");this.hidden=this.el.find("input:hidden");if(d.hiddenName){this.hidden=this.el.next("input:hidden")}this.li=this.el.parent().parent().parent();if(this.hidden){this.el.parent().append(this.hidden)}var j=d.dictName,a=d.items,h=d.labelField||"label",k=d.valueField||"value",b=d.delimiter,l=this.hidden.get(0)?this.hidden.val():this.el.html();if(b==""||this.delimiter){this.delimiter=b;this.mutiValue=true}else{this.delimiter=","}if(a){var c={};for(var g=0;g<a.length;g++){var f=a[g];c[f[h]]=f[k]}a=c}if(j){this.dictName=j;a=Horn.getDict(j)}this.staticDict=a},setValue:function(m){m=$.trim(m);if(this.hidden){this.hidden.val(m)}var c=this.dictName,o=this.staticDict;var g=function(u){var j="";if(o){j=u}else{if(c){var i=$(".hc_checkboxdiv[ref_target="+c+"_s]").find("li[key="+u+"]");j=i.attr("title")||u}else{j=u}}return j};var e="";var n=false;if(!m){m=""}if(this.mutiValue){var l=[];$(m.split(this.delimiter)).each(function(i,u){var j=g(u);l.push(j||u)});e=l.join(this.delimiter||",");n=true}else{e=g(m)}if(c&&m!=""){e=Horn.getDict(c,m);this.el.attr("code",m)}if(!c){var r=[];var a=this.el.attr("keyfield");var f=this.el.attr("titlefield");var k=this.params.items;if(k&&k.length>0){for(var q=0;q<k.length;q++){var s=k[q];var h=s.code;if(!h){h=s.label}var d=s.text;if(!d){d=s.value}if(a){h=s[""+a+""]}if(f){d=s[""+f+""]}if(this.multipleline){var b=m.split(this.delimiter);for(var p=0;p<b.length;p++){if(h==b[p]){r.push(d)}}}else{if(s!=null&&h==m){r.push(d)}}}r=r.toString().replace(/,/g,this.delimiter);e=r}}this.el.html(e);var t=this.el.attr("title");if(n){this.el.addClass("hc_texthide")}this.el.attr("title",e)},getValue:function(){if(this.hidden.get(0)){return this.hidden.val()}return this.el.text()},clearValue:function(){this.setValue("")},changeDict:function(b){var e=this,c,a="";e.dictName=b;if(e.hidden.get(0)){c=e.hidden.val()}else{c=e.el.attr("code")}if(!c){c=""}if(b&&c!=""){a=Horn.getDict(b,c)}e.el.html(a);var d=e.el.attr("title");e.el.attr("title",a)},setLabel:function(b){var a=this.el.parent().prev().children();a.html(b)},getLabel:function(){var a=this.el.parent().prev().children();return a.html()},hide:function(){this.li.hide()},show:function(){this.li.show()}});Horn.regUI("div.hc_label",Horn.Label);
Horn.ListBox=Horn.extend(Horn.Base,{COMPONENT_CLASS:"ListBox",id:"listboxId",lurl:null,rurl:null,modelType:null,leftIndex:[],rightIndex:[],init:function(a){Horn.ListBox.superclass.init.apply(this,arguments);var b=this;this.lurl=this.params.lurl?this.params.lurl:null;this.rurl=this.params.rurl?this.params.rurl:null;this.id=this.el.attr("id");this.modelType="checkbox";if(this.lurl&&this.lurl!=""){b.createList(this.lurl,2)}if(this.rurl&&this.rurl!=""){b.createList(this.rurl,1)}this.initEvent()},initEvent:function(){var a=this;$("#left-columns_"+this.id).find("ul").on("click",function(b){a.bindLiClick(b)});$("#leftMove_"+this.id).click(function(){a.leftMove()});$("#right-columns_"+this.id).find("ul").on("click",function(b){a.bindLiClick(b)});$("#rightMove_"+this.id).click(function(){a.rightMove()});$("#leftMoveAll_"+this.id).click(function(){a.leftAllMove()});$("#rightMoveAll_"+this.id).click(function(){a.rightAllMove()});$("#leftCheckbox").change(function(b){a.leftCheckAll(b)});$("#rightCheckbox").change(function(b){a.rightCheckAll(b)});$("#up_"+this.id).click(function(){a.moveClick("p")});$("#down_"+this.id).click(function(){a.moveClick("a")})},moveClick:function(g){var e=this;var a=e.el.attr("id");var f=$("#left-columns_"+e.id+" ul").find("input[type='checkbox']").is(":checked");var i=$("#right-columns_"+e.id+" ul").find("input[type='checkbox']").is(":checked");var b=$("#left-columns_"+e.id+" ul").find("input[type='checkbox']:checked").length;var d=$("#right-columns_"+e.id+" ul").find("input[type='checkbox']:checked").length;if(f&&i){Horn.Msg.alert("提示","只能选中一边，请重新选择");return}else{if(g=="a"){if(b>1||d>1){Horn.Msg.alert("提示","暂时只支持单条下移，请重新选择");return}}var c=null;var h=null;if(f){c=$("#left-columns_"+a);h="l"}if(i){c=$("#right-columns_"+a);h="r"}if(c!=null){c.find("li").each(function(m,n){var k=$(n);var l=k.find("input[type='checkbox']:checked");var j=$(this).attr("tag");if(l&&l.length>0){e.move(j,h,g)}})}}},move:function(m,h,g){var b=false;var d=false;var e=m;var i=$("#left-columns_"+this.id+" ul").find("input[type='checkbox']").is(":checked");var k=$("#right-columns_"+this.id+" ul").find("input[type='checkbox']").is(":checked");var j,l,a,f=-1;var c=h=="r"?$("#right-columns_"+this.id):$("#left-columns_"+this.id);c.find("li").each(function(o){var n=$(this).attr("tag");if(n!=e&&f==-1){j=this}else{if(n==e){f=o;l=this}else{a=this;return false}}});if(g=="p"){$(l).insertBefore($(j))}else{$(l).insertAfter($(a))}},leftCheckAll:function(b){var c=this;var a=$("#left-columns_"+c.id+" ul").find("input[type='checkbox']");if(b.target.checked){a.prop("checked",true);a.closest("li").addClass("selected")}else{a.prop("checked",false);a.closest("li").removeClass("selected")}},rightCheckAll:function(b){var c=this;var a=$("#right-columns_"+c.id+" ul").find("input[type='checkbox']");if(b.target.checked){a.prop("checked",true);a.closest("li").addClass("selected")}else{a.prop("checked",false);a.closest("li").removeClass("selected")}},leftMove:function(){var f=this,a=0;var e=this.el.attr("id");$("#left-columns_"+e).find("li").each(function(i,k){var g=$(k);var h=g.find("input[type='checkbox']:checked");var j=g.find("span").text();if(h&&h.length>0){f.leftIndex.push({index:i,code:g.children("input").attr("value"),value:j});g.remove()}});var c=$("#right-columns_"+f.id+" ul").children("li");if(c){a=c.length}if(f.leftIndex&&f.leftIndex.length>0){for(var b=0;b<f.leftIndex.length;b++){var d="<li tag='"+(a+b)+"'><input type='checkbox' index='"+(a+b)+"' name='"+f.params.rname+"' value='"+f.leftIndex[b].code+"'><span>"+f.leftIndex[b].value+"</span></li>";$("#right-columns_"+e+" ul").append(d)}}f.leftIndex.splice(0);f.allSelect()},rightMove:function(){var f=this,a=0;var e=this.el.attr("id");$("#right-columns_"+e).find("li").each(function(i,k){var g=$(k);var h=g.find("input[type='checkbox']:checked");var j=g.find("span").text();if(h&&h.length>0){f.rightIndex.push({index:i,code:g.children("input").attr("value"),value:j});g.remove()}});var c=$("#left-columns_"+f.id+" ul").children("li");if(c){a=c.length}if(f.rightIndex&&f.rightIndex.length>0){for(var b=0;b<f.rightIndex.length;b++){var d="<li tag='"+(a+b)+"'><input type='checkbox' index='"+(a+b)+"' name='"+f.params.lname+"' value='"+f.rightIndex[b].code+"'><span>"+f.rightIndex[b].value+"</span></li>";$("#left-columns_"+e+" ul").append(d)}}f.rightIndex.splice(0);f.allSelect()},leftAllMove:function(){var e=this,a=0;var d=this.el.attr("id");var b=$("#right-columns_"+e.id+" ul").children("li");if(b){a=b.length}$("#left-columns_"+d+" ul").children("li").each(function(g,f){$(f).attr("tag",(a+g));$(f).children("input").attr("index",(a+g))});var c=$("#left-columns_"+d+" ul").html();c=c.replace(e.params.lname,e.params.rname);$("#right-columns_"+d+" ul").append(c);$("#left-columns_"+d+" ul").html("");e.allSelect()},rightAllMove:function(){var e=this,a=0;var d=this.el.attr("id");var c=$("#left-columns_"+e.id+" ul").children("li");if(c){a=c.length}$("#right-columns_"+d+" ul").children("li").each(function(g,f){$(f).attr("tag",(a+g));$(f).children("input").attr("index",(a+g))});var b=$("#right-columns_"+d+" ul").html();b=b.replace(e.params.rname,e.params.lname);$("#left-columns_"+d+" ul").append(b);$("#right-columns_"+d+" ul").html("");e.allSelect()},createList:function(a,b){var c=this;$.ajax(a,{async:true,beforeSend:function(d){},type:"POST",dataType:"json",error:function(e,f,d){},success:function(f,k,h){if(f&&f.length>0){for(var g=0;g<f.length;g++){var d=f[g];var j=null;var e=b==1?c.params.rname:c.params.lname;if(c.modelType!=null){j='<li tag="'+g+'"><input type="'+c.modelType+'" index="'+g+'" name="'+e+'" value="'+d.key+'"><span>'+d.text+"</span></li>"}else{j='<li tag="'+g+'"><input type="hidden" index="'+g+'" name="'+e+'" value="'+d.key+'"><span>'+d.text+"</span></li>"}if(b==1){$("#right-columns_"+c.id+" ul").append(j)}else{$("#left-columns_"+c.id+" ul").append(j)}}}}})},bindLiClick:function(c){var b=$(c.target).closest("li").find("input:checkbox");var a=$(c.target).closest("li").index();if(b.prop("checked")){if(c.target.tagName!="INPUT"){b.prop("checked",false);b.attr("checked",false);$(c.target).closest("li").removeClass("selected")}else{$(c.target).closest("li").addClass("selected")}}else{if(c.target.tagName!="INPUT"){b.prop("checked",true);b.attr("checked",true);$(c.target).closest("li").addClass("selected")}else{$(c.target).closest("li").removeClass("selected")}}},allSelect:function(){$("#leftCheckbox").prop("checked",false);$("#rightCheckbox").prop("checked",false);$("#left-columns_"+this.id+" li").removeClass("selected");$("#right-columns_"+this.id+" li").removeClass("selected");$("#left-columns_"+this.id+" li input").prop("checked",false);$("#right-columns_"+this.id+" li input").prop("checked",false)},load:function(a,b){this.createList(a,b)}});Horn.regUI("div.listbox",Horn.ListBox);
Horn.ListBox_Table=Horn.extend(Horn.Base,{COMPONENT_CLASS:"ListBox_Table",id:"listboxId",modelType:null,leftIndex:[],rightIndex:[],init:function(c){Horn.ListBox_Table.superclass.init.apply(this,arguments);var d=this;var a=this.params.ldata||{};this.ldata=a;var b=this.params.rdata||{};this.rdata=b;this.lcacheData=[];this.rcacheData=[];this.lrcacheData=[];this.lrcacheData.push(d.lcacheData);this.lrcacheData.push(d.rcacheData);this.id=this.el.attr("id");if(this.params.id&&this.params.id!=""){this.id=this.params.id}else{if(this.params.name&&this.params.name!=""){this.id=this.params.name}}this.lcolumns=d.params.lcolumns;this.rcolumns=d.params.rcolumns;this.modelType="checkbox";this.selecteds={};this.ltable=d.el.find("#left-columns_"+d.id).children("table");this.rtable=d.el.find("#right-columns_"+d.id).children("table");this.ltbody=this.ltable.children("tbody");this.rtbody=this.rtable.children("tbody");this.lths=this.ltable.find("th");this.rths=this.rtable.find("th");this.rowSelect=this.params.rowSelect+"";this.initEvent()},initEvent:function(){var a=this;a.ltbody.children("tr").each(function(c,d){var b=$(d).attr("line");if(b){a.lcacheData.push({line:b,data:a.ldata[c]})}a.bindTrClick(c,d,"left")});a.rtbody.children("tr").each(function(c,d){var b=$(d).attr("line");if(b){a.rcacheData.push({line:b,data:a.rdata[c]})}a.bindTrClick(c,d,"right")});a.changeTdData();$("#leftMove_"+this.id).click(function(){a.leftMove()});$("#rightMove_"+this.id).click(function(){a.rightMove()});$("#leftMoveAll_"+this.id).click(function(){a.leftAllMove()});$("#rightMoveAll_"+this.id).click(function(){a.rightAllMove()});$("#leftCheckbox").change(function(b){a.checkAll(b,"left")});$("#rightCheckbox").change(function(b){a.checkAll(b,"right")});$("#up_"+this.id).click(function(){a.moveClick("p")});$("#down_"+this.id).click(function(){a.moveClick("a")})},bindTrClick:function(c,f,h){var e=this;var a=c;var b=$(f),d=b.find("input:checkbox.h_querytable_select");var j=b.attr("line");if(!j||j==undefined){return}if(e.rowSelect=="true"){b.bind("click",function(m){var l,k,i=b.parent().attr("id");if(i.indexOf("left")>-1){l=$("#leftCheckbox");k=$("#left_tbody_"+e.id)}else{l=$("#rightCheckbox");k=$("#right_tbody_"+e.id)}var n=true;if(b.hasClass("u-table-selected")){e.unSelectRow(a,b,h);n=false}else{e.selectRow(a,b,h);k.find("input.h_querytable_select[type='checkbox']").each(function(p,o){if(!$(o).prop("checked")){n=false;return}})}if(n){l.prop("checked",true)}else{l.prop("checked",false)}})}else{var g=b.find("input.h_querytable_select[type='checkbox']");g.change(function(){var l,k,i=b.parent().attr("id");if(i.indexOf("left")>-1){l=$("#leftCheckbox");k=$("#left_tbody_"+e.id)}else{l=$("#rightCheckbox");k=$("#right_tbody_"+e.id)}var m=true;if(this.checked){e.selectRow(a,b);k.find("input.h_querytable_select[type='checkbox']").each(function(o,n){if(!$(n).prop("checked")){m=false;return}})}else{e.unSelectRow(a,b);m=false}if(m){l.prop("checked",true)}else{l.prop("checked",false)}})}},leftMove:function(){var c=this;var b=this.el.attr("id");var a=c.ldata;c.isHasCheck(b,"left");$("#left_tbody_"+b).find("tr").each(function(i,h){var k=$(h),p=k.attr("line"),n=0;if(p){n=p.split("_")[1]-1}var d=k.find("input.h_querytable_select[type='checkbox']:checked");var f;if(a&&a.length>0){f=a[n]}if(d&&d.length>0){c.leftIndex.push({line:p,ldata:f});var g=c.lcacheData;var o=c.rcacheData;if(g&&g.length>0){for(var e=0;e<g.length;e++){if(p==g[e].line){o.push(g[e]);g.splice(e,1)}}}var j=c.isOrNotHiddenTd(k[0],"left");$("#right_tbody_"+b).append(j)}});c.leftIndex.splice(0);$("#rightCheckbox").prop("checked",false)},rightMove:function(){var c=this;var b=this.el.attr("id");var a=c.rdata;c.isHasCheck(b,"right");$("#right_tbody_"+b).find("tr").each(function(i,h){var k=$(h),p=k.attr("line"),n=0;if(p){n=p.split("_")[1]-1}var d=k.find("input.h_querytable_select[type='checkbox']:checked");var g;if(a&&a.length>0){g=a[n]}if(d&&d.length>0){c.rightIndex.push({line:p,rdata:g});var o=c.rcacheData;var f=c.lcacheData;if(o&&o.length>0){for(var e=0;e<o.length;e++){if(p==o[e].line){f.push(o[e]);o.splice(e,1)}}}var j=c.isOrNotHiddenTd(k[0],"right");$("#left_tbody_"+b).append(j)}});c.rightIndex.splice(0);$("#leftCheckbox").prop("checked",false)},leftAllMove:function(){var f=this;var e=this.el.attr("id");var c=$("#left_tbody_"+e).find("tr").attr("line");if(c){$("#right_tbody_"+e).find("tr").each(function(h,i){var g=$(i).attr("line");if(!g){$(i).remove()}})}$("#left_tbody_"+e).find("tr").each(function(h,j){var i=$(j);if(i.attr("line")){var g=f.isOrNotHiddenTd(i[0],"left");$("#right_tbody_"+e).append(g)}});var b=f.lcacheData;var d=f.rcacheData;if(b&&b.length>0){for(var a=0;a<b.length;a++){if(b[a].line){d.push({line:b[a].line,data:b[a].data})}}}f.lcacheData.splice(0)},rightAllMove:function(){var f=this;var e=this.el.attr("id");var c=$("#rigth_tbody_"+e).find("tr").attr("line");if(c){$("#left_tbody_"+e).find("tr").each(function(h,i){var g=$(i).attr("line");if(!g){$(i).remove()}})}$("#right_tbody_"+e).find("tr").each(function(h,j){var i=$(j);if(i.attr("line")){var g=f.isOrNotHiddenTd(i[0],"right");$("#left_tbody_"+e).append(g)}});var b=f.lcacheData;var d=f.rcacheData;if(d&&d.length>0){for(var a=0;a<d.length;a++){if(d[a].line){b.push({line:d[a].line,data:d[a].data})}}}f.rcacheData.splice(0)},moveClick:function(g){var e=this;var a=e.el.attr("id");var f=$("#left_tbody_"+e.id).find("input.h_querytable_select[type='checkbox']").is(":checked");var i=$("#right_tbody_"+e.id).find("input.h_querytable_select[type='checkbox']").is(":checked");var b=$("#left_tbody_"+e.id).find("input.h_querytable_select[type='checkbox']:checked").length;var d=$("#right_tbody_"+e.id).find("input.h_querytable_select[type='checkbox']:checked").length;if(f&&i){Horn.Msg.alert("提示","只能选中一边，请重新选择");return}else{if(g=="a"){if(b>1||d>1){Horn.Msg.alert("提示","暂时只支持单条下移，请重新选择");return}}var c=null;var h=null;if(f){c=$("#left_tbody_"+a);h="l"}if(i){c=$("#right_tbody_"+a);h="r"}if(c!=null){c.find("tr").each(function(l,n){var m=$(n);var k=m.find("input.h_querytable_select[type='checkbox']:checked");var j=$(this).attr("line");if(k&&k.length>0){e.move(j,h,g)}})}}},move:function(m,h,g){var b=false;var d=false;var e=m;var i=$("#left_tbody_"+this.id).find("input.h_querytable_select[type='checkbox']").is(":checked");var k=$("#right_tbody_"+this.id).find("input.h_querytable_select[type='checkbox']").is(":checked");var j,l,a,f=-1;var c=h=="r"?$("#right_tbody_"+this.id):$("#left_tbody_"+this.id);c.find("tr").each(function(o){var n=$(this).attr("line");if(n!=e&&f==-1){j=this}else{if(n==e){f=o;l=this}else{a=this;return false}}});if(g=="p"){$(l).insertBefore($(j))}else{$(l).insertAfter($(a))}},isHasCheck:function(d,b){_this=this;var a="left";if(b=="left"){a="right"}var c=$("#"+b+"_tbody_"+d).find("tr").find("input.h_querytable_select[type='checkbox']:checked");if(c&&c.length>0){$("#"+a+"_tbody_"+d+" tr").each(function(f,g){var e=$(g).attr("line");if(!e){$("#"+a+"_tbody_"+d).html("")}})}},isOrNotHiddenTd:function(b,a){_this=this;var d;if(a=="left"){d=_this.rcolumns}else{d=_this.lcolumns}b=$(b);if(b&&b.length>0){b.removeClass("u-table-selected");var c=b.children("td");c.each(function(k){var g=$(this);var m=g.find("input.h_querytable_select[type='checkbox']").prop("checked",false);var f=g.attr("factorcode");if(f){if(d&&d.length>0){for(var e=0;e<d.length;e++){var h=d[e];var l=h.factorcode;var i=h.width;if(f==l){var j=h.hidden+"";if(j&&j=="true"){g.css("display","none")}else{g.css("display","table-cell")}if(i){g.attr("width",i);g.children("div").css("width",i)}else{g.attr("width","");g.children("div").css("width","110")}}}}}})}return b},changeTdData:function(){_this=this;var a=$("div.u-customCols-wrap tbody").children("tr").children("td");a.change(function(){var k=$(this);var g=_this.lrcacheData;var l=k.parent().attr("line");var c=k.attr("fieldtype");var d=k.attr("factorcode");var j=k.attr("compid");if(c&&c!=""){var f=Horn.getComp(j).getValue();if(g&&g.length>0){var h=g[0];for(var e=0;e<h.length;e++){if(l==h[e].line){h[e].data[d]=f}}var b=g[1];for(var i=0;i<b.length;i++){if(l==b[i].line){b[i].data[d]=f}}}}})},getAllDatas:function(){var d=this,c=[],a=d.lcacheData,b=d.rcacheData;if(a&&a.length>0){c.push({leftData:a})}if(b&&b.length>0){c.push({rightData:b})}return c},checkAll:function(c,a){var d=this;var b=$("#"+a+"_tbody_"+d.id+" tr").find("input.h_querytable_select[type='checkbox']");if(c.target.checked){b.prop("checked",true);b.closest("tr").addClass("u-table-selected")}else{b.prop("checked",false);b.closest("tr").removeClass("u-table-selected")}},selectRow:function(h,a,g){var f=a;if(!f){f=$(this.el.find("tr").has("td").get(h))}if(f.size()==0){Horn.debug("listbox_table["+this.name+"]","选择的行"+h+"不存在");return false}var e={};var c={};var b;if(g=="left"){b=this.lths}else{b=this.rths}var d=f.find("td");b.each(function(l,i){var k=d.get(l),j=$(i);if(j.attr("name")){e[j.attr("name")]=$(k).children("div").attr("fieldtype")!=""?$(k).children("div").attr("factorval"):$.trim($(k).children("div").text());c[j.attr("name")]=$(k).children("div").attr("fieldtype")!=""?$(k).children("div").attr("factorval"):$.trim($(k).children("div").text())}});this.selecteds[h]={val:e,displays:c};this.lastSelect={rowidx:h,tr:f};f.find("input:checkbox.h_querytable_select").prop("checked",true);f.addClass("u-table-selected")},unSelectRow:function(d,a,c){var b=a;if(!b){b=$(this.el.find("tr").has("td").get(d))}this.selecteds[d]=null;delete this.selecteds[d];b.removeClass("u-table-selected");b.find("input:checkbox.h_querytable_select").prop("checked",false)}});Horn.regUI("div.listbox_table",Horn.ListBox_Table);
Horn.Menu=Horn.extend(Horn.Base,{COMPONENT_CLASS:"menu",id:"menu",baseMenuEl:null,baseMenuItem:null,rootMenu:null,zindexInit:9999,opendir:"R",tier:0,classOneNum:0,init:function(a){Horn.Menu.superclass.init.apply(this,arguments);var b=this;this.classOneNum=this.params.items.length;this.id=this.params.id?this.params.id:this.id;this.el.attr("id",this.id);this.opendir=this.params.opendir?this.params.opendir:this.opendir;this.baseMenuEl=this.el.next();this.baseMenuItem=$("li",this.baseMenuEl);this.recursionItems(this.baseMenuEl,this.params);this.baseMenuEl.appendTo(this.el);$("li[base='']",this.el).remove();this.rootMenu=this.el.children("ul");this.rootMenu.css({"z-index":b.zindexInit-1});$(document).bind("click",function(c){if($(c.target).closest("*[refmenu="+b.id+"]").size()==0&&c.button==0){b.hideMenu()}});if(this.params.isContextMenu){document.oncontextmenu=function(d){d=d||window.event;if(d.button==2||d.type=="contextmenu"){var c=navigator.userAgent;if(navigator.appName!="Microsoft Internet Explorer"){window.event=d}b.showMenu();return false}}}$("*[refmenu="+b.id+"]").click(function(){if(!b.isContextDisabled($(this))){b.reCalOpendir($(this));if(!b.rootMenu.is(":visible")){b.showMenu($(this))}else{b.hideMenu()}}});$("*[refmenu="+b.id+"]").each(function(c,d){$("<i class='fa fa-caret-down'></i>").appendTo($(d));if(d.tagName=="A"||d.tagName=="a"){$(d).css({"text-decoration":"none"})}});$(window).bind("resize",function(){b.hideMenu()});this.el.prependTo($(document.body))},reCalOpendir:function(a){var b;var e={};var d=a.offset().left;var c=150;if(this.tier<4){b=this.tier*c;e.left=b<d+a.width();e.right=b<$(window).width()-d}else{e.left=e.right=true}if(e.left&&e.right||(!e.left&&!e.right)){return}if(this.opendir=="L"&&!e.left){this.opendir="R"}if(this.opendir=="R"&&!e.right){this.opendir="L"}},recursionItems:function(c,d){this.tier++;var f=this;if(d.items){var b=0;while(b<d.items.length){var e=f.processparam(f.baseMenuItem.clone(true).removeAttr("base"),d.items[b]);if(d.items[b].items){f.zindexInit++;var a=f.baseMenuEl.clone(true).css({"z-index":f.zindexInit});a.appendTo(e);f.recursionItems(a,d.items[b])}e.appendTo(c);b++}}},processparam:function(a,b){if(b.tips){$("a",a).attr("title",b.tips)}if(b.hasLine){$("span.h_toolbar-item-txt",a).addClass("h_menu-line")}if(b.event){$("a",a).attr("onclick",b.event)}if(b.icon){$("span.h_toolbar-item-icon",a).html("<img width='20px' src='"+b.icon+"'>")}if(b.label){$("span.h_toolbar-item-txt",a).text(b.label)}if(!b.items){$("span.h_toolbar-item-arrow",a).remove()}return a},showMenu:function(b,c,a){var e=this;if(!c){c=this.rootMenu}var d=this.getShowPosition(b,a);c.css({top:d.Y,left:d.X});c.show();c.children("li").hover(function(){var f=$(this).children("ul");if(f.size()==1){e.showMenu($(this),f,true)}},function(){var f=$(this).children("ul");if(f.size()==1){f.hide()}})},getShowPosition:function(c,d){var g=this;var h=150;var f,i,b,j;if(!c){f=window.event.clientX;i=window.event.clientY;j=0;b=0}else{f=c.offset().left;i=c.offset().top;b=c.outerWidth();j=c.outerHeight()}var e=function(){var k,l;k=-j;if(g.opendir=="R"&&(f+b+h)>$(window).width()||g.opendir=="L"){g.opendir="L";l=-b}if(g.opendir=="L"&&(f-h)<0||g.opendir=="R"){g.opendir="R";l=b}return{X:l,Y:k}};var a=function(){var n,o;var l=g.classOneNum;var m=$(window).height();var k=l*39;if(i+b+k>m){n=i-k}else{n=i+j}if((f+h)>$(window).width()||(g.opendir=="L"&&(f-h)>0)){o=f-h+b;g.opendir="L"}else{o=f}return{X:o,Y:n}};if(d){return e()}else{return a()}},hideMenu:function(){this.rootMenu.hide();this.rootMenu.css({top:1200,left:600});this.opendir=this.params.opendir},addItem:function(b){var a=this.processparam(this.baseMenuItem.clone(true).removeAttr("base"),b);a.appendTo(this.rootMenu)},isContextDisabled:function(a){return a.hasClass("h_btn-disabled")}});Horn.regUI("div.hc_menu",Horn.Menu);
(function(d,b){var h=window["$Utils"];function i(r,n){var s=n&&n.id||"fui";var q=s+"-mask-bg";var p=s+"-mask-img";var m=s+"-mask-msg";var o=[];o.push('<div id="'+q+'" class="f-mask-bg"></div>');o.push('<div id="'+p+'" class="f-mask-img"><div id="'+m+'" >');o.push('<div class="u-load"><div class="u-load-img"></div>');o.push('<div class="u-load-con"><span>');o.push(r||window["$i18n"].mask.defaultMsg);o.push("</span></div></div>");o.push("</div></div>");return o.join("")}function k(){if(window.hasHidden===true){return}var q=0;var p=0;var s;var t=window.hiddenArrayList||[];window.hiddenArrayList=t;window.hasHidden=true;var r=d("select");var n=r.length;for(var q=0;q<n;q++){var m=r.get(q);var o=m.style;if(o.display=="none"||o.display=="block"){}else{o.display="none";t.push(m)}}}function g(){if(window.hasHidden===false){return}var m=d("#win-mask-overlay,#dialog-mask-overlay");if(m.length>0){return}window.hasHidden=false;var p=window.hiddenArrayList;var o=d.isArray(p)&&p.length||0;if(p!=null&&p!=false&&o>0){for(var n=0;n<o;n++){p[n].style.display=""}}p=null;window.hiddenArrayList=null}function e(){if(d.browser.msie&&(d.browser.version=="6.0")){k()}}function a(){if(d.browser.msie&&(d.browser.version=="6.0")){g()}}function j(q,m,n){var o=d("#"+m+"-mask-bg");if(o.length==0){n=n||{};n.id=m;var p=i(q,n);d("body").append(p)}l(q,m,n)}function f(r,m,n){var q=m+"-mask-bg";var o=d("#"+q);if(o.length==0){var n={id:m};var p=i(r,n);d("body").append(p)}c(r,m,n)}function l(x,q,p){var v=d("#"+q+"-mask-bg");var u=d("#"+q+"-mask-img");var B=d("#"+q+"-mask-msg");var r=jQuery.support.boxModel;var E=document.documentElement;var s=r&&E.clientWidth||document.body.clientWidth;var C=r&&E.clientHeight||document.body.clientHeight;var A=r&&E.scrollLeft||document.body.scrollLeft;var m=r&&E.scrollTop||document.body.scrollTop;var D=(s+A)+"px";var o=(C+m)+"px";v.css("width",D);v.css("height",o);B.find(".u-load-con span").text(x);var n=u.outerWidth(true);var t=u.outerHeight(true);var z=((s-n)/2+A)+"px";var y=((C-t)/2+m)+"px";u.css("left",z);u.css("top",y);v.css("display","");if((p||{})["showImg"]===false){return}u.css("display","")}function c(z,s,q){var n=d("#"+s);var y=d("#"+s+"-mask-bg");var x=d("#"+s+"-mask-img");var E=d("#"+s+"-mask-msg");var v=n.outerWidth(true);var F=n.outerHeight(true);var D=n.scrollLeft();var m=n.scrollTop();var G=v+"px";var p=F+"px";y.css("width",G);y.css("height",p);var t=n.offset();var r=t.left;var C=t.top;y.css("left",r);y.css("top",C);E.html(z);var o=x.outerWidth(true);var u=x.outerHeight(true);var B=(r+(v-o)/2)+"px";var A=(C+(F-u)/2)+"px";x.css("left",B);x.css("top",A);y.css("display","");if((q||{})["showImg"]===false){return}x.css("display","")}d.fn.doMask=function(o,m){var n=d(this);e();if(n.is("body")){j(o,"fui",m)}else{var p=n.attr("id");f(o,p,m)}};d.fn.doUnMask=function(){var n=d(this);a();if(n.is("body")){var m=n.find(">#fui-mask-bg");if(m.length>0){var q=n.find(">#fui-mask-img");q.css("display","none");m.css("display","none")}a()}else{var r=n.attr("id");var p=r+"-mask-bg";var o=r+"-mask-img";var m=d("#"+p);if(m.length>0){var q=d("#"+o);q.css("display","none");m.css("display","none")}a()}}})(jQuery);
var Horn=Horn||{};(function(b){var c=function(E){var p="确定";var s="取消";var t=null;var u=null;if(E.okText){p=E.okText}if(E.cancelText){s=E.cancelText}if(E.btnPos){t=E.btnPos}if(E.height){u=E.height}if(window.event){Horn.debug("event keycode = ",window.event.keyCode);var z=window.event;var k=z.srcElement;Horn.debug("firedObj = ",k);$(k).blur()}var C='<div class="m-message-positon"  id="h_msg_floatdiv"><div class="m-message-header"><h4 class="m-message-title"></h4></div><div class="g-wrap m-message-body m-brt-none" ><div class="m-body-words"><span class="m-message-icon"><i class="fa fa-question"></i></span><div class="m-message-con"></div></div></div><div class="h_btndiv m-message-footer"></div></div>';var D=$(C);if(E.msgTitle){D.find(".m-message-header h4").html(E.msgTitle);D.find(".m-message-header").attr("title",E.msgTitle)}if(E.msgText){D.find(".m-body-words .m-message-con").append(E.msgText)}if(E.width){D.css("width",E.width+"px")}if(E.height){D.find(".m-message-body").css("height",E.height+"px")}else{D.css("height","auto")}if(t!=null){D.find(".m-message-footer").css("text-align",t)}if(E.msgType){D.find(".m-message-icon").removeClass().addClass("m-message-icon "+E.msgType)}if(E.msgCss){D.find(".m-message-icon i").removeClass().addClass("fa "+E.msgCss)}var o='<button type="button" id="buttonOK" class="h_btn-submit u-btn u-btn-primary">'+p+"</button>";var l='<button type="button" id="buttonCancel" class="h_btn-cencel u-btn">'+s+"</button>";var m=o+l;if(E.msgType&&E.msgType==Horn.Msg.CONFIRM){D.find(".h_btndiv").html(m)}else{D.find(".h_btndiv").html(o)}var n=jQuery.support.boxModel;var F=document.documentElement;var r=n&&F.clientWidth||document.body.clientWidth;var y=n&&F.clientHeight||document.body.clientHeight;var x=n&&F.scrollLeft||document.body.scrollLeft;var f=n&&F.scrollTop||document.body.scrollTop;var e=n&&F.scrollHeight||document.body.scrollHeight;var v=n&&F.scrollWidth||document.body.scrollWidth;var g="100%";var q="100%";if(x==0&&v<800){g="100%"}else{var B=v+x;g=B+"px"}if(f==0&&e<500){q="100%"}else{var i=e+f;q=i+"px"}var G=$("<div></div>").append('<div class="m-message-bg" id="h_msg_bg"></div>').append(D.clone());G.find("div.m-message-bg").css("width",g).css("height",q);var A=G.find(".h_btn-submit");if(A.length>0){A.unbind("click");A.bind("click",function(){if(top.Horn&&top.Horn.Window){top.Horn.Window.MAX_ZINDEX=top.Horn.Window.MAX_ZINDEX-2}else{Horn.Window.MAX_ZINDEX=Horn.Window.MAX_ZINDEX-2}G.remove();if(Horn.Window.getPrevOpen()<1){$("body").removeClass("h-overflow-hidden");$("html").removeClass("h-overflow-hidden")}if(E.onOK&&E.onOK!=""){E.onOK()}})}var j=G.find(".h_btn-cencel");if(j.length>0){j.unbind("click");j.bind("click",function(){if(top.Horn&&top.Horn.Window){top.Horn.Window.MAX_ZINDEX=top.Horn.Window.MAX_ZINDEX-2}else{Horn.Window.MAX_ZINDEX=Horn.Window.MAX_ZINDEX-2}G.remove();if(Horn.Window.getPrevOpen()<1){$("body").removeClass("h-overflow-hidden");$("html").removeClass("h-overflow-hidden")}if(E.onCancel){E.onCancel()}})}G.find(".m-message-bg").css("z-index",Horn.Window.getNextZIndex()+10);G.find(".m-message-positon").css("z-index",Horn.Window.getNextZIndex()+10);if(Horn.Window.getOpen()<1){$("html").addClass("h-overflow-hidden")}Horn.Window.getNextOpen();$("body").prepend(G);a(G.find(".m-message-positon"));$(window).resize(function(){if(G&&!G.is(":hidden")){a(G.find(".m-message-positon"))}});G.mousewheel(function(){return false})};var a=function(e){var l=$(window),g=e,j=0,f=0;var o=l.height();var k=l.width();var m=g.height();var i=g.width();j=o-m;f=k-i;var n=j/2+$(document).scrollTop();var h=f/2+$(document).scrollLeft();g.css("top",n+"px");g.css("left",h+"px")};var d=function(f){var e=350;if(f.width){e=f.width}this.params={width:e};Horn.apply(this.params,f);c(this.params);$("#h_msg_floatdiv").drag({o:".m-message-header"})};b.Msg={INFO:"m-message-info",WARNING:"m-message-warning",ERROR:"m-message-error",CONFIRM:"m-message-success",show:function(e){d(e)},alert:function(i,h,f,g){if(!g){g={}}var e={msgTitle:i,msgText:h,onOK:f,msgType:this.INFO,msgCss:"fa-check",width:g.width?g.width:350,height:g.height,okText:g.okText,btnPos:g.btnPos};d(e)},warning:function(i,h,f,g){if(!g){g={}}var e={msgTitle:i,msgText:h,onOK:f,msgType:this.WARNING,msgCss:"fa-exclamation",width:g.width?g.width:350,height:g.height,okText:g.okText,btnPos:g.btnPos};d(e)},error:function(i,h,f,g){if(!g){g={}}var e={msgTitle:i,msgText:h,onOK:f,msgType:this.ERROR,msgCss:"fa-times",width:g.width?g.width:350,height:g.height,okText:g.okText,btnPos:g.btnPos};d(e)},confirm:function(l,o,e,k,i){var m=null;var j=null;var p=null;var g=null;var n=null;if(!i){i={}}var f={msgTitle:l,msgText:o,onOK:e,onCancel:k,msgType:this.CONFIRM,msgCss:"fa-question",width:i.width?i.width:350,height:i.height,okText:i.okText,cancelText:i.cancelText,btnPos:i.btnPos};d(f)},load:function(e){if(!$("body").hasClass("h-overflow-hidden")){$("body").addClass("h-overflow-hidden")}$("body").doMask(e)},unload:function(){if($("body").hasClass("h-overflow-hidden")){$("body").removeClass("h-overflow-hidden")}$("body").doUnMask()}}})(Horn);
Horn.PageBar=Horn.extend(Horn.Base,{COMPONENT_CLASS:"PageBar",targetName:null,target:null,url:null,init:function(a){Horn.PageBar.superclass.init.apply(this,arguments);Horn.apply(this,this.params);this.targetName=this.el.attr("target");this.url=this.el.attr("url");if(!this.url){this.url=window.location.href}this.initPageParams();this.initEvent()},initPageParams:function(){var a="";if(this.el.attr("bindformname")&&this.el.attr("bindformname").length>0){a=this.el.attr("bindformname")}var b=this.el;this.page=parseInt(b.attr("pageNo"))||this.page;this.pageSize=parseInt(b.attr("pageSize"))||this.pageSize;this.pageCount=parseInt(b.attr("pageCount"))||this.pageCount;this.pages=parseInt(b.attr("pages"))||this.pages;this.gridId=b.attr("id")||"dyncGrid";this.bindFormName=b.attr("bindFormName")||"";if(this.pageCount<=0||this.pages<=0){$("#"+a+"_topageid").attr("disabled","disabled");$("#"+a+"_topagesize").attr("disabled","disabled");$("#"+a+"_pagebtn-go").attr("disabled","disabled")}else{$("#"+a+"_topageid").removeAttr("disabled");$("#"+a+"_topagesize").removeAttr("disabled");$("#"+a+"_pagebtn-go").removeAttr("disabled")}},initEvent:function(){var b=this;var a="";if(this.el.attr("bindformname")&&this.el.attr("bindformname").length>0){a=this.el.attr("bindformname")}this.el.children("ul").children("li").children("a").each(function(d,e){var g=$(e),f=function(i,j,h){i.click(function(){if(i.hasClass("disabled")){return}if(i.hasClass("h_pagebtn-next")||i.hasClass("h_pagebtn-prev")){i.addClass("disabled")}j.call(b,h)})};if(!g.hasClass("disabled")){if(g.hasClass("h_pagebtn-index")){f(g,b.goPage,b.INDEX_PAGE)}else{if(g.hasClass("h_pagebtn-end")){f(g,b.goPage,parseInt(b.pages))}else{if(g.hasClass("h_pagebtn-next")){f(g,b.nextpage)}else{if(g.hasClass("h_pagebtn-prev")){f(g,b.prevpage)}else{if(g.hasClass("h_page-num")){f(g,b.goPage,parseInt(g.text()))}else{if(g.hasClass("h_pagebtn-go")){g.bind("click",function(j){var h=document.getElementById(a+"_topageid").value;var i=document.getElementById(a+"_topagesize").value;if(i==0){i=10}var k=[];k.push(parseInt(h),parseInt(i));return b.goPage.apply(b,k)})}}}}}}}});this.perPage=false;$("#_recPerPage"+this.gridId).on("click",function(){optGridId=$(this).attr("id");optGridId=optGridId.substring(11);var d=$(this).children("strong").text();if(b.perPage){$(this).next().hide();b.perPage=false}else{$(this).next().show();$(this).next().find("li").each(function(e,f){var g=$(this).children("a").text();if(d==g){$(this).addClass("active")}else{$(this).removeClass("active")}});b.perPage=true}});$("#_recPerPage"+this.gridId).bind("blur",function(f){var d=f;if(b.perPage){$(".dropdown-menu-datagrid").hide();b.perPage=false;return true}});$(".dropdown-menu-datagrid").bind("mouseover",function(){$("#_recPerPage"+b.gridId).unbind("blur")});$(".dropdown-menu-datagrid").bind("mouseout",function(){$("#_recPerPage"+b.gridId).bind("blur",function(f){var d=f;if(b.perPage){$(".dropdown-menu-datagrid").hide();b.perPage=false;return true}})});this.activeLi=$(".dropdown-menu-datagrid").find("li.active");var c=this;$("#toPage_"+c.id).on("keydown",function(g){var d=g.keyCode;if(d==27||d==8){return true}if(d>=48&&d<=57){return true}if(d>=96&&d<=105){return true}var f=new RegExp("[0123456789]");var h=String.fromCharCode(d);if(!f.test(h)){return false}});$("#"+this.bindFormName+"_topageid").on("blur",function(){var d=$(this).val();if(d==""){d=c.page}if(!d||isNaN(d)){d=c.reqPageNo}d=parseInt(d,10);if(d<=0){d=1}else{if(d>c.pages){d=1}}$(this).val(d);var e=[];e.push(d,c.pageSize);b.goPage.apply(b,e)});$("#"+this.bindFormName+"_topageSize_show").on("blur",function(){var d=$(this).val();var e=$(this).next(":hidden");if(!d||isNaN(d)){d=e.attr("value")}d=parseInt(d,10);if(d<=0){d=1}$(this).val(d);if(b.pageCount>0){var f=[];var g=parseInt($("#"+b.bindFormName+"_topageid").val());if(b.pageCount&&d>b.pageCount){g=1}f.push(g,d);b.goPage.apply(b,f)}$("#"+b.bindFormName+"_topagesize").val(d)})},getTarget:function(){return this.target||Horn.getComp(this.targetName)},INDEX_PAGE:1,page:1,pageSize:20,pageCount:0,pages:1,nextpage:function(){this.goPage(parseInt(this.page)+1)},prevpage:function(){this.goPage(parseInt(this.page)-1)},firstpage:function(){this.goPage(this.INDEX_PAGE)},goPage:function(c,b){var a="";if(this.el.attr("bindformname")&&this.el.attr("bindformname").length>0){a=this.el.attr("bindformname")}if(c<this.INDEX_PAGE){c=this.INDEX_PAGE}if(c>this.pages){c=this.pages}if(b>this.pageCount){b=this.pageCount}if(b<0||b==null||b==undefined){b=this.pageSize}this.page=c;this.pageSize=b;this.doJump()},doJump:function(){if(this.el.attr("bindformname")&&this.el.attr("bindformname").length>0){var a=this.el.attr("bindformname");this.form=Horn.getCurrent().find("form[name='"+a+"']");var c='<input type="hidden" name="index" value="'+this.page+'"><input type="hidden" name="pageNo" value="'+this.page+'"><input type="hidden" name="pageSize" value="'+this.pageSize+'"><input type="hidden" name="count" value="'+this.pageCount+'"><input type="hidden" name="pages" value="'+this.pages+'">';this.form.append(c);this.form.submit()}else{var b=this.url;function d(e,g){var f=new RegExp("([?|&])"+e+"=[^&]*");if(f.test(b)){b=b.replace(f,"$1"+e+"="+g)}else{b+=(b.indexOf("?")!=-1?"&":"?")+e+"="+g}}d("index",this.page);d("pageNo",this.page);d("pageSize",this.pageSize);d("count",this.pageCount);d("pages",this.pages);Horn.Util.jump(b)}}});Horn.regUI("div.h_pages",Horn.PageBar);
Horn.Panel=Horn.extend(Horn.Base,{COMPONENT_CLASS:"Panel",init:function(){Horn.Panel.superclass.init.apply(this,arguments);var a=this.el.children("div.m-panel-box");var c=this.el.children("div.g-wrap");var d=this;if(a){var b=a.children().children("i");a.click(function(){if(b.hasClass("fa-angle-up")){c.hide();b.removeClass("fa-angle-up");b.addClass("fa-angle-down");d.autoGridHeight();if(d.params.unExpandClick){var e=Horn.Util.getFunObj(d.params.unExpandClick);var f;if($.type(e.fn)=="function"){f=e.fn}if(f){f.apply(d)}}}else{c.show();b.removeClass("fa-angle-down");b.addClass("fa-angle-up");d.autoGridHeight();if(d.params.expandClick){var e=Horn.Util.getFunObj(d.params.expandClick);var f;if($.type(e.fn)=="function"){f=e.fn}if(f){f.apply(d)}}}})}},autoGridHeight:function(){var a=$(".xdatagrid");a.each(function(c,e){var d=$(this).attr("autoHeight");var b=$(this).attr("name");if(d&&d=="true"){Horn.getComp(b).autoDataHeight()}})},show:function(){this.el.show()},hide:function(){this.el.hide()},expand:function(){var c=this,a=c.el.children("div.m-panel-box"),b=a.children().children("i");c.el.children("div.g-wrap").show();b.removeClass("fa-angle-down");b.addClass("fa-angle-up")},unexpand:function(){var c=this,a=c.el.children("div.m-panel-box"),b=a.children().children("i");c.el.children("div.g-wrap").hide();b.removeClass("fa-angle-up");b.addClass("fa-angle-down")},enable:function(){Horn.Field.findFieldCompsIn(this.el).each(function(a,b){this.setDisabled(false)});this.el.find("button,select").removeAttr("disabled")},disable:function(){Horn.Field.findFieldCompsIn(this.el).each(function(a,b){this.setDisabled(true)});this.el.find("button,select").removeAttr("disabled");this.el.find("button,select").attr("disabled","disabled")}});Horn.regUI("div.g-panel",Horn.Panel);
Horn.Password=Horn.extend(Horn.Field,{COMPONENT_CLASS:"Password",init:function(a){Horn.Password.superclass.init.apply(this,arguments)}});Horn.Field.regFieldType("div.hc_password",Horn.Password);
Horn.PasswordGroup=Horn.extend(Horn.Field,{COMPONENT_CLASS:"PasswordGroup",field1:null,field2:null,name1:null,name2:null,defValue1:"",defValue2:"",init:function(b){var a=$(b).find("input");this.field1=$(a[0]);this.field2=$(a[1]);this.name1=this.field1.attr("name");this.name2=this.field2.attr("name");Horn.PasswordGroup.superclass.init.apply(this,arguments);if(this.field1){this.defValue1=(this.params.defValue!=undefined)?this.params.defValue:this.field1.val();this.defValue2=(this.params.defValue!=undefined)?this.params.defValue:this.field2.val()}},initEvents:function(){var a=this;this.field2.bind("blur",function(){a.field=a.field2;var b=a.field2.val();if(b!=""){b=b.replace(/(^\s*)|(\s*$)/g,"");a.field2.val(b)}var c=a.field1.val();if(c!=""){c=c.replace(/(^\s*)|(\s*$)/g,"");a.field1.val(c)}Horn.Validate.onValid({data:[Horn.Validate,a]});if(c!=""&&b!=""){var e=a.field1.val();if(a.field2.val()!=e){a.showError("前后密码不一致，请重新输入！",2)}else{a.removeError()}}else{var d=a.field2.attr("check");if(d&&d.indexOf(Horn.Validate.REQUIRED)>-1){if(c==""){a.showError("当前输入不能为空",1)}else{if(b==""){a.showError("当前输入不能为空",2)}else{a.showError("当前输入不能为空",1)}}}}});this.field1.blur(function(){a.field=a.field1;var b=a.field2.val();if(b!=""){b=b.replace(/(^\s*)|(\s*$)/g,"");a.field2.val(b)}var c=a.field1.val();if(c!=""){c=c.replace(/(^\s*)|(\s*$)/g,"");a.field1.val(c)}Horn.Validate.onValid({data:[Horn.Validate,a]});var f=a.field1.val();var d=a.field2.val();if(f!=""&&d!=""){if(f!=d){a.showError("前后密码不一致，请重新输入！",1)}else{a.removeError()}}else{var e=a.field1.attr("check");if(e&&e.indexOf(Horn.Validate.REQUIRED)>-1){if(f==""){a.showError("当前输入不能为空",1)}else{if(d==""){a.showError("当前输入不能为空",2)}else{a.showError("当前输入不能为空",1)}}}}});this.field1.keyup(function(d){var c=$(this);var b=parseInt(a.params.maxlength,10);if(b>0){if(a.getStrlen(c.val())>b){c.val(a.getSubstring(c.val(),b))}}})},validate:function(){if(this.disabled){return}this.field1.blur();this.field2.blur()},addRule:function(g){var d=this.field1;var b=this.field2;var c=d.attr(Horn.Validate.CHECK);if(c){if(c.indexOf(g)>-1){return}c+=Horn.Validate.CHECKSEP+g}else{c=g}d.attr(Horn.Validate.CHECK,c);b.attr(Horn.Validate.CHECK,c);if(g&&g.indexOf(Horn.Validate.REQUIRED)>-1){var a=this.el.parent().parent(".g-unit-wrap");var e=$("label",a);var f=$("span.m-verify-symbol",e);if(!f.length){f=$("<span>",{"class":"m-verify-symbol",html:"*"});e.prepend(f)}else{f.html("*")}}this.removeError();this.field.removeClass("m-verify-success")},removeRule:function(e){var c=this.field1;var a=this.field2;var b=c.attr(Horn.Validate.CHECK);if(b&&b.indexOf(e)>-1){var d=b.split(Horn.Validate.CHECKSEP);d=$.grep(d,function(g,f){return g&&g!=e});c.attr(Horn.Validate.CHECK,d.join(";"));a.attr(Horn.Validate.CHECK,d.join(";"));this.removeError();this.setNotRequired()}},showError:function(f,i){var e=this.field1;var d=this.field2;var b=this.params.msgInBody+"";e.removeClass("m-verify-success");e.addClass("m-verify-error");d.removeClass("m-verify-success");d.addClass("m-verify-error");f=$.type(f)=="boolean"?"校验错误":f;if(!this.msgDiv){if(b=="true"){this.msgDiv=$('<div class="m-verify-tip bottom" role="m-verify-tip" msgInBody="true" style="display: none;"></div>');$("body").append(this.msgDiv)}else{this.msgDiv=$('<div class="m-verify-tip bottom" role="m-verify-tip"  style="display: none;"></div>');this.el.after(this.msgDiv)}}var c=this.msgDiv;c.html('<div class="verify-tip-arrow"></div><div class="verify-tip-inner">'+f+"</div>");c.css("display","block");if(i==2){var a=d.width();c.css("left",a+"px")}else{c.css("left",0)}this.err=true;if(b=="true"){var h=this;var g=Horn.Window.getNextZIndex();if(top.Horn&&top.Horn.Window){top.Horn.Window.MAX_ZINDEX=top.Horn.Window.MAX_ZINDEX-1}else{Horn.Window.MAX_ZINDEX=Horn.Window.MAX_ZINDEX-1}h.positionError(i);$(".h_floatdiv-con").bind("scroll",function(){h.positionError(i)});$(".h_floatdiv-con").bind("mousewheel",function(){h.positionError(i)});$(".h_tabpanel-contents").bind("scroll",function(){h.positionError(i)});$(".h_tabpanel-contents").bind("mousewheel",function(){h.positionError(i)});$(".m-message-title").mousemove(function(j){h.positionError(i)})}},removeError:function(){this.field1.removeClass("m-verify-error");this.field2.removeClass("m-verify-error");var b=this.get();var a=this.field1.attr(Horn.Validate.CHECK);if(a){if(this.isValid){if(this.field1.val()!=""||this.field2.val()!=""){this.field1.addClass("m-verify-success");this.field2.addClass("m-verify-success")}}}this.err=false;var c=this.msgDiv;if(c){c.remove()}delete this.msgDiv},positionError:function(b){var c=this.field1;if(b==2){c=this.field2}var d=this.msgDiv;if(d){var e=c.offset();if(e&&e.top>0){var a=c.outerHeight();d.css("left",e.left+"px");d.css("z-index",9999);d.css("top",(e.top+a)+"px")}}},setValue:function(a){this.field1.val(a);this.field2.val(a);this.field1.blur();this.field2.blur()},getValue:function(){return this.field1.val()},reset:function(a){var b=a?"":this.defValue1;this.setValue(b)},clearValue:function(){this.setValue("")},setEnable:function(a){var b=this;if(a){this.field1.removeAttr("disabled");this.field2.removeAttr("disabled");this.field1.blur();this.field2.blur()}else{this.field1.attr("disabled","disabled");this.field2.attr("disabled","disabled");b.removeError()}},setDisabled:function(a){if(a){this.setEnable(false)}else{this.setEnable(true)}}});Horn.Field.regFieldType("div.hc_passwordgroup",Horn.PasswordGroup);
Horn.QueryTable=Horn.extend(Horn.Base,{COMPONENT_CLASS:"QueryTable",id:"gridId",name:"gridName",table:null,form:null,dicName:null,delimiter:",",ths:[],simpleRequest:false,postData:null,rowSelect:false,keyAttr:"label",valueAttr:"value",clickFlag:null,mutiSelect:false,init:function(g){Horn.QueryTable.superclass.init.apply(this,arguments);this.name=this.params.name||this.name;if(this.params.id&&this.params.id!=""){this.id=this.params.id}else{if(this.params.name&&this.params.name!=""){this.id=this.params.name}}this.table=$(g);var a=this.params.baseparams||{};var b=this.params.bindformname;if(!b){b=this.params.bindFormName}this.rowSelect=Boolean(this.params.rowSelect);var f={},e={request_num:10,index:this.INDEX_PAGE,positionArr:[],start_position_str:0,returndata:null,url:"",position_str:"position_str",hasPage:false,baseparams:a,params:{},autoLoad:false,requestMethod:"post"};if(b){this.form=Horn.getCurrent().find("form[name='"+b+"']");f=Horn.Util.getValues(this.form)}e.request_num=f.request_num||this.params.request_num||e.request_num;e.request_num=parseInt(e.request_num)>0?parseInt(e.request_num):10;e.autoLoad=Boolean(this.params.autoLoad);e.url=this.params.url;if(this.params.requestMethod&&(this.params.requestMethod.toLowerCase()=="post"||this.params.requestMethod.toLowerCase()=="get")){e.requestMethod=this.params.requestMethod}if(!e.url&&this.form&&this.form.length){e.url=this.form.attr("action")}if(e.url&&e.url.indexOf("http:")==-1){e.url=context_path+e.url}e.start_position_str=f.position_str||this.params.start_position_str||e.start_position_str;if(this.params.position_str){e.position_str=this.params.position_str}e.hasPage=Boolean(this.params.hasPage!=undefined||this.params.hasPage!=null?this.params.hasPage:e.hasPage);e.positionArr.push(e.start_position_str);this.postData=e;var h=this;this.ths=this.el.find("th");if(this.params.simpleRequest==true){this.simpleRequest=true}if(e.url&&e.autoLoad==true){h.loadByForm.call(h)}$.each(this.params.events||[],function(j,k){h[k.event.toLowerCase()]=k["function"]});if(this.params.selectModel=="muti"||this.params.selectModel=="multi"){this.mutiSelect=true}this.ths.each(function(m,j){var k=j.attributes.hidden;j=$(j);var n=j.attr("dictName"),o=j.attr("colno"),i=undefined;var l=undefined,p=undefined;if(o){l=h.params.items[o-1].items;p=h.params.items[o-1].buttons}if(k!=null&&k!=undefined&&k.value==true.toString()){j.hide()}if(n){i={};var q=$(".hc_checkboxdiv[ref_target="+n+"_s]").find("li");q.each(function(s,r){r=$(r);var t=r.attr("title");var u=r.attr("key");i[u]=t})}else{if(l){i={};$(l).each(function(r,s){i[s[h.keyAttr]]=s[h.valueAttr]})}}j.data("staticDict",i);j.data("buttons",p)});this.selecteds=[];if(this.params.data){this.dictTrans();this.initEvents();this.hiddenColumns();this.lastList=this.params.data;this.doDataFilter(this.params.data)}this.el.find(".h_querytable_select_all").change(function(){if(this.checked){h.selectAll()}else{h.unSelectAll()}});var d=this.params.isDrag+"";if(d!="false"){this.el.find(".hc-datagrid-cell").resizable({autoHide:true,minHeight:35,maxHeight:35,resize:function(l,m){var k=m.size.width;$(m.element[0]).parent().css("width",k);var j=$(m.element[0]).parent().parent().find("th").index($(m.element[0]).parent());var i=$("#body_"+h.id).children("tr");i.each(function(o,n){var p=$(n);$(p.children("td").get(j)).css("width",k);$(p.children("td").get(j)).children("div").css("width",k)})}})}var c=this.params.autoHeight+"";if(this.params.autoHeight&&c=="true"){$(window).resize(function(){h.autoDataHeight()});h.autoDataHeight()}},customEvents:"rowclick,rowdblclick",getEventTarget:function(){return this.el},autoDataHeight:function(){var b=this.params.autoHeight+"";if(this.params.autoHeight&&b=="true"){var f=this.el.parent(".u-datagrid");var e=f.next(".u-datagrid-page");var a=$(window).height();var d=e.outerHeight(true);var g=f.offset().top;var c=a-g-d;f.css("height",c-25)}},stateTest:function(){var b=this;var a=true;b.el.find("input:checkbox.h_querytable_select").each(function(c,d){if(!$(d).prop("checked")){a=false}});if(a){b.el.find(".h_querytable_select_all").prop("checked",true)}else{b.el.find(".h_querytable_select_all").prop("checked",false)}},initEvents:function(){var a=this.el;var c=a.children("tbody");var d=this;var b=d.el.find(".h_querytable_select_all").length>0?true:false;if(b){this.el.find(".h_querytable_select").change(function(){d.stateTest()})}if(this.rowSelect==true){c.children("tr").each(function(f,j){var k=f;var e=$(j),h=d.mutiSelect?e.find("input:checkbox.h_querytable_select"):e.find("input:radio.h_querytable_select");var g=this.clickFlag;e.bind("click",function(i){clearTimeout(g);g=setTimeout(function(){if($.isEmptyObject(d.selecteds)){d.selectRow(k,e)}else{if(!d.selecteds.hasOwnProperty(k)){d.selectRow(k,e)}else{d.unSelectRow(k,e)}}if(b){d.stateTest()}},10)})})}},hiddenColumns:function(){var a=this.el.children("tbody").children("tr");var b=this.ths;b.each(function(f,e){var c=$(e);var d=e.attributes.hidden;if(d!=null&&d!=undefined&&d.value==true.toString()){c.hide();a.each(function(i,h){var k=$(h);var j=k.find("td");for(var g=0;g<j.length;g++){var l=$(j[g]);if(f==g){l.hide();break}}})}})},loadByForm:function(){var a={};if(this.form&&this.form.length){a=this.form.serializeArray()}this.load(a)},setBaseParams:function(a){if(a){this.postData.baseparams=a}else{this.postData.baseparams={}}},load:function(b){var a=this.postData;if(b){if($.type(b)=="array"){a.params=Horn.Util.arr2Obj(b)}else{a.params=b}}else{a.params={}}this.goPage(this.INDEX_PAGE)},INDEX_PAGE:1,nextpage:function(){this.goPage(this.postData.index+1)},prevpage:function(){this.goPage(this.postData.index-1)},firstpage:function(){this.goPage(this.INDEX_PAGE)},refreshpage:function(){this.ajaxRequest()},goPage:function(a){if(a<this.INDEX_PAGE){a=this.INDEX_PAGE}this.postData.index=a;this.ajaxRequest(this.el)},ajaxRequest:function(){var h=this,j=this.el,d=this.postData,c=d.positionArr,e=j.children("tbody"),a=d.params;if(Horn.QueryTable.DEF_PARAM){a=$.extend({currentUserId:top.currentUserId,menu_id:menuId||""},d.baseparams,a)}else{a=$.extend({},d.baseparams,a)}a.hasPage=d.hasPage;if(a!=null){a[d.position_str]=c[d.index]||d.start_position_str;a.position_str=c[d.index]||d.start_position_str;a.request_num=d.request_num+(this.simpleRequest?0:1)}a.index=d.index;var i=0;this.ths.each(function(k,l){if(!this.hidden){i=i+1}});if(a.hasPage==false){}var b=this.params.bindformname;if(!b){b=this.params.bindFormName}if(b){var g=$("form[name="+b+"]").serializeArray();var f=Horn.Util.arr2Obj(g);$.each(f,function(k,l){a[k]=l})}$.ajax(d.url,{async:true,beforeSend:function(k){e.html("<tr><td colSpan='"+i+"'><p class='h_loading'>正在加载</p></td></tr>")},type:d.requestMethod,data:Horn.Util.obj2Arr(a),dataType:"json",error:function(m,n,l){var k=m.status;e.html("<tr><td colSpan='"+i+"'><p>请求失败</p><p>错误状态："+k+"；错误信息："+n+"</p></td></tr>")},success:function(k,m,l){h.lastSelect=null;h.selecteds={};h.callback.call(h,h.doDataFilter(k));h.doCallBack(k);h.autoDataHeight()}})},doDataFilter:function(a){var b=this.table;var d=this.params.datafilter;if(d){var c=Horn.Util.getFunObj(d);if(c&&$.type(c.fn)=="function"){a=c.fn.call(this,a)}}return a},doCallBack:function(a){var c=this.table;var d=c.attr("callback");if(d){var b=Horn.Util.getFunObj(d);if(b&&$.type(b.fn)=="function"){b.fn.call(this,a)}}$(".h_screen").height("auto");setTimeout(function(){if(window.doLayout){window.doLayout()}},1000);this.dictTrans()},callback:function(reqData){var redirect_url="";var _target="";if(reqData){var data=reqData.rows;redirect_url=reqData.redirectUrl;_target=reqData.target;if(data==null||data=="null"){if(redirect_url&&redirect_url!=""){if(_target=="top"){top.location.href=redirect_url}else{if(_target=="parent"){parent.location.href=redirect_url}else{window.location.href=redirect_url}}return}}}reqData=reqData||{total:0,rows:[]};if($.type(reqData)=="array"){reqData={rows:reqData}}var list=reqData.rows;var table=this.table;var gridName=table.attr("name");var _this=this;var htmlArr=[];var ths=this.ths;var colLength=ths.length;var isSuccess=false;var data=this.postData;this.lastList=list;this.selecteds=[];this.lastSelect={};this.el.find(".h_querytable_select_all").prop("checked",false);table.css("height","auto");if(list&&list.length>0){data.list=list.slice(0,data.request_num);isSuccess=true;for(var i=0;i<list.length;i++){var itemData=list[i];htmlArr.push("<tr>");ths.each(function(index,o){var th=$(o);if(th.hasClass("h_numbercolumn")){htmlArr.push("<td><center>"+(i+1)+"</center></td>");return}else{if(th.hasClass("h_querytable_checkboxcolumn")){htmlArr.push('<td><center><input type="checkbox" class="h_querytable_select"/></center></td>');return}else{if(th.hasClass("h_querytable_radioboxcolumn")){htmlArr.push('<td><center><input type="radio" class="h_querytable_select" name="_querytable_row_checker_'+gridName+'"/></center></td>');return}}}var name=th.attr("name");var dealFun=th.attr("dealFun");var width=th.attr("width");var w="";if(width){w=width.replace("%","0").replace("px","").replace("PX","")+"px";if(width.indexOf("%")!=-1){th.attr("width",width.replace("%","0"))}}var align="left";if(th.attr("tAlign")){align=th.attr("tAlign")}htmlArr.push("<td><div style='overflow: hidden;width:"+w+";text-align:"+align+"'>");if(dealFun){var dFun=eval("(window."+dealFun+")");if($.type(dFun)=="function"){htmlArr.push(dFun(itemData[name],itemData,list,i,index))}}else{var value=itemData[name];var dataType=th.attr("dataType");var format=th.attr("format");if(dataType&&dataType!=null){value=Horn.Util.Format.all(dataType,format,value)}htmlArr.push(value)}htmlArr.push("</div></td>")});htmlArr.push("</tr>");if(i==data.request_num-1){data.positionArr[data.index+1]=itemData[data.position_str];break}}}else{if(reqData.errorInfo||reqData.err_info){data.list=[];var errorInfo=reqData.errorInfo||reqData.err_info;htmlArr.push("<tr><td colspan='"+colLength+"'>");htmlArr.push("<p>"+errorInfo+"</p>");htmlArr.push("</td></tr>")}else{data.list=[];htmlArr.push("<tr><td colspan='"+colLength+"'>");htmlArr.push("<p>没有查询到数据</p>");htmlArr.push("</td></tr>")}}var tbody=table.children("tbody");tbody.html(htmlArr.join(""));var h_listtable=table.parent(".h_listtable");var h_head=table.parent(".h_listtable").parent(".g-datagrid-wrap").children(".u-datagrid-header");var h_page=table.parent(".h_listtable").parent(".g-datagrid-wrap").children(".u-datagrid-page");var h_body=table.parent(".h_listtable").parent(".g-datagrid-wrap").parent(".m-panel-body");if(this.params.height&&this.params.height!=null){var tableHeight=parseFloat(this.params.height);if(!isNaN(tableHeight)){h_listtable.css("height",tableHeight)}}if(this.params.width&&this.params.width!=null){var tableWidth=parseFloat(this.params.width);if(!isNaN(tableWidth)){h_listtable.css("width",tableWidth);h_head.css("width",tableWidth);h_page.css("width",tableWidth);h_body.css("width",tableWidth+22)}}if(isSuccess){tbody.children("tr:odd").addClass("u-table-bg");var rowClickObj=undefined;var rowDBLClickObj=undefined;var rowClickFn=undefined;var rowDBLClickFn=undefined;if(this.rowclick){rowClickObj=Horn.Util.getFunObj(this.rowclick);if($.type(rowClickObj.fn)=="function"){rowClickFn=rowClickObj.fn}}if(this.rowdblclick){rowDBLClickObj=Horn.Util.getFunObj(this.rowdblclick);if($.type(rowDBLClickObj.fn)=="function"){rowDBLClickFn=rowDBLClickObj.fn}}if(rowClickFn||rowDBLClickFn){var trs=tbody.children("tr");var _clickFlag=this.clickFlag;for(var i=0;i<data.list.length;i++){var tr=$(trs.get(i));if(rowClickFn){var params=rowClickObj.params.slice(0);params.push(data.list[i],data.list);tr.bind("click",params,function(e){var p=e.data;var _this=this;clearTimeout(_clickFlag);_clickFlag=setTimeout(function(){return rowClickObj.fn.apply(_this,p)},300)})}if(rowDBLClickFn){var params=rowDBLClickObj.params.slice(0);params.push(data.list[i],data.list);tr.bind("dblclick",params,function(e){clearTimeout(_clickFlag);var p=e.data;return rowDBLClickObj.fn.apply(this,p)})}}}this.initEvents();this.hiddenColumns()}if(data.hasPage){var pageArr=[];pageArr.push('<ul class="m-pagebar">');if(data.index>_this.INDEX_PAGE){pageArr.push('<li><a href="javascript:void(0)"  class="h_page-first first_page_btn" title="首页"><i class="fa fa-step-backward"></i></a></li>');pageArr.push('<li><a href="javascript:void(0)" class="h_pagebtn-prev h_page-pgLast pre_page_btn" title="上一页"><i class="fa fa-caret-left"></i></a></li>')}else{pageArr.push('<li><a href="javascript:void(0)"  class="disabled first_page_btn" title="首页"><i class="fa fa-step-backward"></i></a></li>');pageArr.push('<li><a href="javascript:void(0)" class="disabled pre_page_btn" title="上一页"><i class="fa fa-caret-left"></i></a></li>')}if(this.simpleRequest){if(list!=null&&(list.length+1)>data.request_num){pageArr.push('<li><a href="javascript:void(0)" class="h_page-pgNext next_page_btn" title="下一页"><i class="fa fa-caret-right"></i></a></li>')}else{pageArr.push('<li><a href="javascript:void(0)" class="disabled next_page_btn" title="下一页"><i class="fa fa-caret-right"></i></a></li>')}}else{if(list!=null&&list.length>data.request_num){pageArr.push('<li><a href="javascript:void(0)" class="h_page-pgNext next_page_btn" title="下一页"><i class="fa fa-caret-right"></i></a></li>')}else{pageArr.push('<li><a href="javascript:void(0)" class="disabled next_page_btn" title="下一页"><i class="fa fa-caret-right"></i></a></li>')}}pageArr.push('<li><a href="javascript:void(0)" class="h_page-refresh refresh_btn" title="刷新"><i class="fa fa-refresh"></i></a></li>');pageArr.push("</ul>");var total_num=reqData.total;var pageIndex=this.postData.index;if(total_num!=undefined){var pagesnum=Math.ceil(parseInt(total_num)/parseInt(data.request_num));pageArr.push('<div  class="m-pagebar-all">共'+pagesnum+"页,共"+total_num+"条记录,当前第"+pageIndex+"页</div>")}var page=table.parent(".h_listtable").next("div.u-datagrid-page").children(".h_querytable_pages").html(pageArr.join(""));page.children("ul").children("li").children("a.h_page-first").click(function(e){return _this.firstpage.call(_this,table,e)});page.children("ul").children("li").children("a.h_page-pgLast").click(function(e){return _this.prevpage.call(_this,table,e)});page.children("ul").children("li").children("a.h_page-pgNext").click(function(e){return _this.nextpage.call(_this,table,e)});page.children("ul").children("li").children("a.h_page-refresh").click(function(e){return _this.refreshpage.call(_this,table,e)})}var isWordWrap=this.params.isWordwrap+"";if(isWordWrap=="true"){this.resetTdContent()}},loadData:function(a){this.callback(a);this.doCallBack(a)},resetTdContent:function(){var d=this;var a=this.table.children("tbody").children("tr");var b=this.table.children("thead").children("tr");var c=[];a.each(function(q,k){var m=$(k);var i=m.find("td");for(var l=0;l<i.length;l++){var h=$(i[l]);var j=h.attr("width");var p=h.children("div");var g=p.attr("style");var e=g+";overflow: visible;white-space: normal;word-wrap:break-word; word-break:break-all";p.attr("style",e);var o=h.text();var n=b.find("th:eq("+l+")").attr("width");if(n){var f=n.replace("px","").replace("PX","");p.css("width",f)}if(d.getStrlen(o)>40){if(c.indexOf(l)==-1){c.push(l)}p.css("width",300);h.css("width",300)}}})},getStrlen:function(e){var b=2;var a=0;for(var d=0;d<e.length;d++){var f=e.charCodeAt(d);if((f>=1&&f<=126)||(65376<=f&&f<=65439)){a++}else{a+=b}}return a},onRowSelect:function(){},selecteds:null,selectAll:function(){var a=this;this.el.find("input:checkbox.h_querytable_select").each(function(b,c){c.checked=true;if(a.rowSelect==false){$(c).trigger("change")}else{a.selectRow(b)}});this.el.find(".h_querytable_select_all").prop("checked",true)},unSelectAll:function(){var a=this;this.el.find("input:checkbox.h_querytable_select").each(function(b,c){c.checked=false;if(a.rowSelect==false){$(c).trigger("change")}else{a.unSelectRow(b)}});this.el.find(".h_querytable_select_all").prop("checked",false)},lastSelect:null,mutiSelect:false,selectRow:function(h,b){var a=this;var g=b;if(!g){g=$(this.el.find("tr").has("td").get(h))}if(g.length==0){Horn.debug("querytable["+this.name+"]","选择的行"+h+"不存在");return false}var f={};var c=this.ths;var d=g.find("td");c.each(function(l,i){var k=d.get(l),j=$(i);f[j.attr("name")]=j.attr("dictName")?$(k).attr("key"):$(k).text()});a.onRowSelect.call(g,g,h,f);this.selecteds[h]=f;if(!a.mutiSelect){var e=a.lastSelect;if(e&&e.rowidx!==undefined&&e.rowidx!=h){if(e.tr.find("input:radio").length>0){e.tr.find("input:radio").get(0).checked=false}a.unSelectRow(e.rowidx,e.tr)}if(g.find("input:radio").length>0){g.find("input:radio").get(0).checked=true}}else{if(g.find("input:checkbox").length>0){g.find("input:checkbox").get(0).checked=true}}a.lastSelect={rowidx:h,tr:g};g.addClass("u-table-selected")},getRowData:function(f){var a=this;var e=$(this.el.find("tr").has("td").get(f-1));var d={};var b=this.ths;var c=e.find("td");b.each(function(j,g){var i=c.get(j),h=$(g);d[h.attr("name")]=h.attr("dictName")?$(i).attr("key"):$(i).text()});return d},setHeight:function(a){},unSelectRow:function(e,b){var d=b;if(!d){d=$(this.el.find("tr").has("td").get(e))}this.selecteds[e]=null;delete this.selecteds[e];d.removeClass("u-table-selected");if(this.mutiSelect){if(d.find("input:checkbox").length>0){d.find("input:checkbox").get(0).checked=false}}else{if(d.find("input:radio").length>0){d.find("input:radio").get(0).checked=false}}var c=true;for(var a in this.selecteds){c=false;break}if(c){this.el.find(".h_querytable_select_all").prop("checked",false)}},getSelecteds:function(d){var c=[];if($.type(this.selecteds)=="array"){for(var b=0;b<this.selecteds.length;b++){var e=this.selecteds[b];if(e){c.push(d?this.lastList[b]:e)}}}else{for(var a in this.selecteds){var e=this.selecteds[a];if(e){c.push(d?this.lastList[a]:e)}}}return c},getData:function(){return this.lastList},dictTrans:function(){var b=this,c=this.ths,a=this.el.find("tr");a.each(function(e,d){var g=$(d),f=b.mutiSelect?g.find("input:checkbox"):g.find("input:radio");if(f.hasClass("h_querytable_select")){if(b.rowSelect==false){f.change(function(){if(this.checked){b.selectRow(e-1,g)}else{b.unSelectRow(e-1,g)}})}}g.find("td").each(function(p,j){var k=$(j);var i=$(c.get(p));var n=i.attr("dictname"),o=i.attr("renderer"),q=i.data("buttons"),h=i.data("staticDict");if(h){if(t==""||h[k.text().trim()]==undefined){k.text("");k.attr("title","")}else{k.attr("key",k.text());k.find("div").text(h[k.text()]||k.text())}}else{if(q){var m=q;var s=$("<span></span>");$(m).each(function(y,v){var w=Horn.Util.getFunObj(v.event);if(!w.fn){return}var u=$("<a href='javascript:void(0)'>"+v.label+"</a>");var x=k.text();u.click(function(){w.fn.call(u,{val:x,rowidx:e,tdidx:p,tr:g,td:k})});s.append(u);if(y!=(m.length-1)){s.append(" | ")}});k.find("div").html("");k.find("div").append(s)}}if(o){k.attr("key",k.text());var t=k.text();var r=Horn.Util.getFunObj(o);if(!r.fn){return}var l=r.fn.call($(this),{val:t,rowidx:e,tdidx:p,tr:g,tname:i.attr("name"),td:k});if(l instanceof $){k.find("div").html("");k.find("div").append(l)}else{k.find("div").html(l)}}})})}});$.extend(Horn.QueryTable,{DATANAME:"QUERYTABLE",get:function(a){var b=null;if(a){b=Horn.getComp(a)}else{b=Horn.data(Horn.QueryTable.DATANAME)[0]}return b}});Horn.regUI("table.h_querytable",Horn.QueryTable);
Horn.RadioGroup=Horn.extend(Horn.Field,{COMPONENT_CLASS:"RadioGroup",radios:null,name:null,alias:null,checkRegx:[],init:function(){Horn.RadioGroup.superclass.init.apply(this,arguments);this.radios=this.el.find("input[type='radio']");this.name=this.el.attr("name");this.alias=this.el.attr("alias")||"";if(this.params.check&&this.params.check.indexOf("required")>-1){this.checkRegx=[Horn.Validate.REQUIRED]}if(this.params.value){this.setValue(this.params.value)}if(this.params.disabled){this.setDisabled(true)}this.defValue=this.params.defValue||this.params.value||"";var b=this;var a=this.el.children("div").children("label").find("input:radio");a.each(function(c,d){$(d).bind("click",function(){var f=b.getValue();var e=$(d).attr(Horn.Validate.CHECK);if(f&&f!=""){b.removeError();if(e&&e.indexOf(Horn.Validate.REQUIRED)>-1){b.el.addClass("m-verify-success")}}else{b.showError();b.el.removeClass("m-verify-success")}})})},getEventTarget:function(){return this.el.children("div").children("label").find("input[type='radio']")},getValue:function(){return this.radios.filter(":checked").val()||""},setValue:function(c){var b=this;var a=this.radios;c=c.toString();if(c==""){this.radios.removeAttr("checked")}else{if(this.radios.filter('[value="'+c+'"]').length>0){if(this.radios.filter('[value="'+c+'"]').attr("disabled")){setTimeout(function(){a.attr("disabled","disabled");a.removeAttr("checked");a.filter('[value="'+c+'"]').prop("checked",true)},10)}else{a.removeAttr("checked");a.each(function(d,e){if($(e).val()==c){$(e).prop("checked",true)}})}}}this.validate()},clearValue:function(){this.setValue("")},setEnable:function(a){var b=this;this.radios.each(function(c,d){if(a===false){$(this).attr("disabled","disabled")}else{$(this).removeAttr("disabled")}})},setDisabled:function(a){var b=this;if(a===true){b.disabled=true}else{if(a===false){b.disabled=false}}this.radios.each(function(c,d){if(a===true){$(this).attr("disabled","disabled")}else{$(this).removeAttr("disabled")}})},validate:function(){if(this.disabled){return}this.isValid()},isValid:function(){var a=true;var d=this;var b=this.name;if(d.disabled==true){return true}if(this.checkRegx.length>0){var c=this.radios.filter(":checked").val();if(c==""||c===undefined){a=false;this.showError(d)}else{this.removeError(d)}}return a},showError:function(d){var a=this.params.msgInBody+"";if(!this.msgDiv){if(a=="true"){this.msgDiv=$('<div class="m-verify-tip bottom" role="m-verify-tip" msgInBody="true" style="display: none;"></div>');$("body").append(this.msgDiv)}else{this.msgDiv=$('<div class="m-verify-tip bottom" role="m-verify-tip"  style="display: none;"></div>');this.el.after(this.msgDiv)}}var c=this.msgDiv;c.html('<div class="verify-tip-arrow"></div><div class="verify-tip-inner">当前单选选框不能为空</div>');c.css("display","block");d.el.addClass("m-verify-error");d.err=true;if(a=="true"){var d=this;var b=Horn.Window.getNextZIndex();if(top.Horn&&top.Horn.Window){top.Horn.Window.MAX_ZINDEX=top.Horn.Window.MAX_ZINDEX-1}else{Horn.Window.MAX_ZINDEX=Horn.Window.MAX_ZINDEX-1}d.positionError(b);$(".h_floatdiv-con").bind("scroll",function(){d.positionError(b)});$(".h_floatdiv-con").bind("mousewheel",function(){d.positionError(b)});$(".h_tabpanel-contents").bind("scroll",function(){d.positionError(b)});$(".h_tabpanel-contents").bind("mousewheel",function(){d.positionError(b)});$(".m-message-title").mousemove(function(f){d.positionError(b)})}},removeError:function(c){this.el.removeClass("m-verify-error");this.err=false;var b=this.msgDiv;if(b){b.remove()}var a=this.el.parent().parent(".g-unit-wrap").children(".unit-label");delete this.msgDiv},positionError:function(){var b=this.el;var c=this.msgDiv;if(c){var d=b.offset();if(d&&d.top>0){var a=b.outerHeight();c.css("left",d.left+"px");c.css("z-index",9999);c.css("top",(d.top+a)+"px")}}},reset:function(){this.setValue(this.defValue)},addRule:function(e){if(e&&e.indexOf(Horn.Validate.REQUIRED)>-1){var f=this;var b=f.el.children("div").children("label").find("input:radio[check*=required]");if(b&&b.size()>0){return}else{f.err=true;this.checkRegx=e.split(";");var a=f.el.children("div").children("label").find("input:radio");a.each(function(g,i){var h=$(i).attr(Horn.Validate.CHECK);if(h){if(h.indexOf(e)>-1){return}h+=Horn.Validate.CHECKSEP+e}else{h=e}$(i).attr(Horn.Validate.CHECK,h)});if(e&&e.indexOf(Horn.Validate.REQUIRED)>-1){var c=this.el.parent().parent(".g-unit-wrap").children(".unit-label");var d=$("span.m-verify-symbol",c);if(!d.length){d=$("<span>",{"class":"m-verify-symbol",html:"*"});c.prepend(d)}else{d.html("*")}}}}else{return}},removeRule:function(d){var f=this;var a=f.el.children("div").children("label").find("input:radio");a.each(function(g,j){var h=$(j).attr(Horn.Validate.CHECK);if(h&&h.indexOf(d)>-1){var i=h.split(Horn.Validate.CHECKSEP);i=$.grep(i,function(l,k){return l&&l!=d});$(j).attr(Horn.Validate.CHECK,i.join(";"))}});this.checkRegx=[];if(d&&d.indexOf(Horn.Validate.REQUIRED)>-1){this.el.removeClass("m-verify-success");this.el.removeClass("m-verify-error");var b=this.el.parent().parent(".g-unit-wrap").children(".unit-label");var c=$("span.m-verify-symbol",b);if(c){c.remove()}var e=this.msgDiv;if(e){e.remove()}}}});Horn.Field.regFieldType("div.hc_radio-group",Horn.RadioGroup);
Horn.Select=Horn.extend(Horn.Field,{COMPONENT_CLASS:"Select",delimiter:",",bodyclicktype:"click.select",select:null,field:null,hidden:null,listEl:null,multipleline:false,name:null,alias:null,showLabel:false,showTitle:true,hasHeadItem:false,tempCheckedKeyArray:[],tempCheckedValue:"",ctrilA:false,init:function(w){Horn.Select.superclass.init.apply(this,arguments);var s=this;this.select=this.el;this.hidden=this.select.children("input[type='hidden']");this.field=this.hidden.next();this.name=this.hidden.attr("name");this.alias=this.hidden.attr("alias")||"";this.img=this.select.find(".u-select-down");this.enableFieldSearch=false;if(this.field.attr("delimiter")!=undefined){this.delimiter=this.field.attr("delimiter")}var v=this.params.showLabel+"";if(v=="true"){this.showLabel=true}var k=this.params.showTitle+"";if(k=="false"){this.showTitle=false}var c=this.params.headItem;if(c){this.hasHeadItem=true}var z=this.field.attr("ref");var p=this.params.id?this.params.id:this.params.name;this.listEl=z?$("#hc_hide_div").children("div.hc_checkboxdiv[ref_target='"+z+"']"):$("#combox_"+p);if(this.listEl&&this.listEl.length==0){var g="combox_"+p;this.listEl=z?$("div.hc_checkboxdiv[ref_target='"+z+"']"):$("div.hc_checkboxdiv[id='"+g+"']")}var r=this.params.hasSelectAll;var f=$("div.h_floatdiv-con");if(f){f.mousewheel(function(){s.hideList(s.field,s.listEl)});f.scroll(function(){s.hideList(s.field,s.listEl)})}var n=$("div.u-customCols-list-con");if(n){n.mousewheel(function(){s.hideList(s.field,s.listEl)});n.scroll(function(){s.hideList(s.field,s.listEl)})}this.multipleline=this.params.multiple;if(this.multipleline&&r){var m=this.listEl.find('li[key="-1"]');if(m.length==0){m="<li key='-1' title='全选/反选'><label><input type='checkbox' name='checkall' class='combox_input'>全选/反选</label></li>";this.listEl.children("ul").prepend(m)}}var e=this.params.multiple+"";if(this.params.multiple){if(e=="true"){this.multipleline=true}else{if(e=="false"){this.multipleline=false}}}if(String(this.params.showLabel)=="false"){this.showLabel=false}this.createHeadItem();this.setEditable(this.params.editable);if(this.params.readonly===true||this.params.readonly==="true"){this.el.attr("readonly",true);this.readonly=true;this.setEditable(false)}this.field.bind({focus:Horn.Util.apply(s.onFocus,s),click:Horn.Util.apply(s.onClick,s),keydown:Horn.Util.apply(s.onKeyDown,s),keypress:Horn.Util.apply(s.onKeyPress,s),keyup:Horn.Util.apply(s.onKeyUp,s)});$.each(s.params.events||[],function(j,A){s[A.event.toLowerCase()]=A["function"]});if(!this.params.disabled){this.img.bind({click:Horn.Util.apply(s.onFocus,s)})}var q=this.params.value||this.hidden.val();if(q===""){this.setValue("",undefined,true)}else{var x=[];var a=this.el.attr("keyfield");var h=this.el.attr("titlefield");var o=this.params.items;if(o&&o.length>0){for(var u=0;u<o.length;u++){var y=o[u];var l=y.code;if(!l){l=y.label}var d=y.text;if(!d){d=y.value}if(a){l=y[""+a+""]}if(h){d=y[""+h+""]}if(this.multipleline){var b=q.split(this.delimiter);for(var t=0;t<b.length;t++){if(l==b[t]){if((screenShowLabel&&screenShowLabel=="true")||this.showLabel){x.push(l+":"+d)}else{x.push(d)}}}}else{if(y!=null&&l==q){if((screenShowLabel&&screenShowLabel=="true")||this.showLabel){x.push(l+":"+d)}else{x.push(d)}}}}x=x.toString().replace(/,/g,this.delimiter);this.field.val(x);this.hidden.val(q)}}if(this.params.disabled){this.setDisabled(true)}this.DICT=(function(j){if(j.params.items){var i={};$(j.params.items).each(function(A,B){if(B.label){i[B.label]=B.value}else{i[B.code]=B.text}});return i}else{return Horn.getDict(j.params.dictName)}})(this);if(this.params.filterBy){this.params.enableFieldSearch=true}else{this.params.filterBy="keyOrValue"}if(this.params.enableFieldSearch||this.params.enableFieldSearch=="true"){this.enableFieldSearch=true;this.enableFieldQuery(true)}if(this.params.editable){this.field.bind("blur",function(){if(!s.editflag){return}s.editflag=false;var i=s.tempCheckedValue.replace(",",s.delimiter);$(this).attr("value",i)})}},enableFieldQuery:function(b){var g=this;var a;var f=this.getIEVersion();var e=(f=="8"||f=="7");if(e){a="propertychange"}else{a="input"}if(!b){g.enableFieldSearch=false;g.searchField.unbind(a);g.searchField.remove();return}else{this.enableFieldSearch=true}var d=$("<input type='text' value='' name='fieldToSearch' class='u-select' style='display:none'/>");d.appendTo(this.el);this.searchField=d;this.searchField.blur(function(){g.searchField.hide();g.field.show()});this.searchField.click(function(){return false});var c=function(){var h=g.searchField.val();if(h!=""){$("li",g.listEl).each(function(l,n){var m=false;var k=false;var j=false;if(g.params.filterBy=="key"){m=!($(n).attr("key").indexOf(h)!=-1)}else{if(g.params.filterBy=="value"){m=!($(n).attr("title").indexOf(h)!=-1);if(m){m=!(makePy($(n).attr("title")).toString().toUpperCase().indexOf(h.toUpperCase())!=-1)}}else{if(g.params.filterBy=="keyOrValue"){k=!($(n).attr("key").indexOf(h)!=-1);j=!($(n).attr("title").indexOf(h)!=-1);if(j){j=!(makePy($(n).attr("title")).toString().toUpperCase().indexOf(h.toUpperCase())!=-1)}if(k==false||j==false){m=false}else{m=true}}}}if(m){$(n).hide()}else{$(n).show()}})}else{$("li",g.listEl).each(function(j,k){$(k).show()})}if(g.params.filterDicts||g.params.showDicts){g.filterOrShowDict()}};g.searchField.bind(a,c);g.searchField.bind("focus",c);g.searchField.bind("keyup",function(){var h=g.searchField.val();if(h==""){g.field.focus()}});g.searchField.bind({keydown:Horn.Util.apply(g.onKeyDown,g)});if(g.readonly===true||g.readonly==="true"){return}},getIEVersion:function(){var c=-1;if(navigator.appName=="Microsoft Internet Explorer"){var a=navigator.userAgent;var b=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(b.exec(a)!=null){c=parseFloat(RegExp.$1)}}else{if(navigator.appName=="Netscape"){var a=navigator.userAgent;var b=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");if(b.exec(a)!=null){c=parseFloat(RegExp.$1)}}}return c},setDisabled:function(a){if(a===false){this.setEnable(true);this.disabled=false}else{this.setEnable(false);this.disabled=true}},setReadonly:function(a){if(!a){a=false}if(a===false){this.el.removeAttr("readonly");this.readonly=false;this.el.find("input[type='text']").removeClass("u-readonly");if(this.enableFieldSearch){this.setDisableSearch=false}}else{this.el.attr("readonly",true);this.readonly=true;this.setEditable(false);this.el.find("input[type='text']").addClass("u-readonly");if(this.enableFieldSearch){this.setDisableSearch=true}}},setEditable:function(a){if(!a){a=false}if(a===true){this.field.removeAttr("readonly");this.editable=true}else{this.field.attr("readonly",true);this.editable=false}},createHeadItem:function(){var e=this.params.headItem;var a=this.params.multiple;var h=this;if(this.hasHeadItem){var b=true;this.listEl.children("ul").children("li").each(function(){var i=$(this).attr("headItem");if(i&&i==h.name){b=false;return false}});if(b&&!a){var c=e.label?e.label:"";var g=e.pLabel?e.pLabel:"";var f=e.value?e.value:"";var d="<li key='"+c+"' pkey='"+g+"' title='"+f+"' headItem='"+this.name+"' ><label>"+f+"</label></li>";this.listEl.children("ul").prepend(d);if(this.field.val()==""){this.field.val(f)}}}},handerHeadItem:function(){var e=this.name;var a=this.listEl.children("ul");if(a.length>0){if(this.hasHeadItem){var d=false;var c=a.children("li[headItem]");if(c.length>0){c.each(function(f,h){var g=$(h).attr("headItem");if(e!=g){$(h).remove()}else{d=true}});if(d){return}else{this.createHeadItem()}}else{this.createHeadItem()}}else{var b=a.children("li[headItem]");if(b.length>0){b.remove()}}}},setValue:function(m,d,l){if(this.listEl&&this.listEl.length==0){this.listEl=this.field.parent().find("div.hc_checkboxdiv")}this.handerHeadItem();var r=this.hidden;var c=r.val();var a=this.field;if(m===undefined||m===null){a.val("");r.val("");return false}if(m==""){r.val("");this.tempCheckedKeyArray=[]}if($.type(m)=="string"||$.type(m)=="number"){m={key:m+""}}var h=this.listEl.children("ul");if(this.listEl.length>0){if(this.multipleline){if(m.key==null||m.key==""){a.val("")}else{if(m.text){if((screenShowLabel&&screenShowLabel=="true")||this.showLabel){var t=[];var f=[];var b=[];if(this.delimiter!=""){f=m.key.split(this.delimiter);b=m.text.split(this.delimiter)}else{f=m.key.toCharArray();b=m.text.toCharArray()}a.val(b.join(this.delimiter))}else{a.val(m.text)}}else{var t=[];var f=[];if(this.delimiter!=""){f=m.key.split(this.delimiter)}else{f=m.key.toCharArray()}this.tempCheckedKeyArray=f;if(this.params.dictName){for(var s=0;s<f.length;s++){t.push(Horn.getDict(this.params.dictName)[f[s]])}}else{var k=this.getListData().data;for(var s=0;s<f.length;s++){for(var p=0;p<k.length;p++){if(f[s]==k[p].key){t.push(k[p].value)}}}}t=t.toString().replace(/,/g,this.delimiter);a.val(t);a.attr("title",t)}}r.val(m.key)}else{if(!m.text){var g=h.children("li[key='"+m.key+"']");m.text=jQuery.trim(g.text());if(!this.showLabel&&(!screenShowLabel||screenShowLabel!="true")){var q=g.find("span");m.text=m.text.replace(q.text(),"")}}if(m.text!=""){var n=m.text;if($.type(m)=="string"){n=n+"";n=n.replace(/(^\s+)|(\s+$)/g,"");n=n.replace(/\s/g,"")}if(!this.showLabel&&(!screenShowLabel||screenShowLabel!="true")){if(n.indexOf(":")!=-1){n=n.split(":")[1]}}a.val(n);r.val(m.key)}else{if(m.key==""){a.val("")}else{r.val(m.key);return}}}if(d&&c!=m.key){a.trigger("change",[m.key])}}if(this.multipleline){var u=this.hidden.val();var e=[];var o=this;if(u!=""&&u!=null){$("input[type='checkbox']",this.listEl).each(function(w,B){var v=$(B).parent().parent("li[key]");var z=v.attr("key");var A=u.split(o.delimiter);var j=A.length;for(var y=0;y<j;y++){var x=A[y];if(z==x){e.push(x)}}});this.hidden.val(e.join(this.delimiter))}}this.tempCheckedValue=this.field.val();if(!l){this.validate()}this.clearOrResetTitle()},getValue:function(f){this.handerHeadItem();if(f){var e=this;var d=this.hidden.val();var i=function(j){return e.DICT[j]||null};if(this.multipleline){var a=d.split(this.delimiter);var g=[];$(a).each(function(j,k){var l=i(k);if(l){g.push(l)}});return g.join(this.delimiter)}else{return i(d)}}var b=this.hidden.val();var c=this.listEl.find("ul>li");var h="";if(!this.params.multiple||this.params.multiple==false){if(this.params.value){$.each(c,function(j,k){if($(k).attr("key")==b){h="has"}})}}return b},onClick:function(c){var f=this;if(f.readonly===true||f.readonly==="true"){return}if(this.searchField&&!this.setDisableSearch){this.field.hide();this.searchField.show();this.searchField.focus()}if(f.click){var b=Horn.Util.getFunObj(f.click),a;var d=b.params;if($.type(b.fn)=="function"){a=b.fn}if(a){a.apply(f,d)}}},onFocus:function(f){if(this.disabled){return}if(this.readonly===true||this.readonly==="true"){return}var j=$(f.currentTarget);if(j.hasClass("u-select-down")){j=$(f.currentTarget).prev()}var b=this.params.id?this.params.id:this.params.name;var h=this.listEl;var i=j.data("isFromOuter");if(h.length>0){var g="";if(this.searchField){g=this.searchField.val()}if(g!=""){}else{this.showList(j,h)}}else{var c=this.field.attr("ref");this.listEl=c?$("#hc_hide_div").children("div.hc_checkboxdiv[ref_target='"+c+"']"):$("#combox_"+b);if(this.listEl&&this.listEl.length==0){this.listEl=$("div.hc_checkboxdiv[ref_target='"+c+"']")}if(this.listEl.length>0){this.showList(j,this.listEl)}this.multipleline=this.listEl.attr("multiple_line")=="true"}if(this.enableFieldSearch&&!this.setDisableSearch){var d=this.el.find("input[name=fieldToSearch]");if(d.size()==2){d.first().remove()}var a=this.field.val();if(a==""){this.field.hide();this.searchField.show();this.searchField.focus()}}},onKeyDown:function(i){var n=i.keyCode;var g=this.listEl;var j=g.children("ul");var o=j.children("li");var m=j.children("li.h_cur");var a=g.get(0);var l=j.children("li").last().get(0);if(i.ctrlKey&&n===65&&this.multipleline){this.ctrilA=true;var f=j.find("input:not(:checked)");if(f.length==0){o.removeClass("h_cur");f=o.children("label").children("input");f.each(function(p,e){e.checked=false});this.setValue("")}else{f.each(function(p,e){var q=$(e).parent("label").parent("li").is(":visible");if(q){e.checked=true;$(e).parent("label").parent("li").addClass("h_cur")}});if(this.searchField){this.searchField.val("");this.searchField.hide();this.field.show()}f.last().parent("label").parent("li").triggerHandler("click.li")}Horn.Util.stopPropagation(i);return false}else{if(n===38){if(!this.multipleline){var b=m.prev();if(b.length){a.scrollTop=b.get(0).offsetTop+(a.scrollHeight-a.clientHeight)-l.offsetTop;m.removeClass("h_cur");b.addClass("h_cur")}}}else{if(n===40){if(!this.multipleline){var d=m.next();if(d.length){a.scrollTop=d.get(0).offsetTop+(a.scrollHeight-a.clientHeight)-l.offsetTop;m.removeClass("h_cur");d.addClass("h_cur")}}}else{if(n===46||n===8){}else{if(n===9){this.hideList(this.field,g)}else{if(n===13||n===32){if(!this.multipleline){m.trigger("click.li");Horn.Util.stopPropagation(i)}return false}else{}}}}}}if(this.keydown){var k=Horn.Util.getFunObj(this.keydown),h;var c=k.params;if($.type(k.fn)=="function"){h=k.fn}if(h){h.apply(this,c)}}},onKeyPress:function(g){var p=g.keyCode;var n=String.fromCharCode(p);var d="";var f=this.listEl;var h=f.children("ul");var m=h.children("li");if(p>=65&&p<=90){d=n.toLowerCase()}else{d=n.toUpperCase()}var b=this.selectLi(n,d);var l=m.last().get(0);var a=f.get(0);if(p===38){}else{if(p===46||p===8){}else{if(p===40){}else{if(p===13){}else{if(this.multipleline){var k=this.getValue();if(k.indexOf(n)==-1){if(b){var i=b.children("label").children("input");if(!i.get(0).checked){i.get(0).checked=true}}}else{}}if(b){a.scrollTop=b.get(0).offsetTop+(a.scrollHeight-a.clientHeight)-l.offsetTop}}}}}if(this.keypress){var o=Horn.Util.getFunObj(this.keypress),j;var c=o.params;if($.type(o.fn)=="function"){j=o.fn}if(j){j.apply(this,c)}}Horn.Util.stopPropagation(g)},onKeyUp:function(i){var l=this.ctrilA+"";if(l&&l=="true"&&this.multipleline){}else{var g=this.listEl;var h=this;if(this.multipleline&&!this.params.enableFieldSearch){if(h.params.editable){h.editflag=true}var d=this.field.val();var c=[];var j=[];var a="";$("input[type='checkbox']",g).each(function(o,m){var s=$(m).parent().parent("li[key]");var q=s.attr("title");var e=s.attr("key");$(m).prop("checked",false);var t=d.split(/[\,,\，]/);var p=t.length;for(var n=0;n<p;n++){var r=t[n];if(q==r||r==e){c.push(e);j.push(q);a=a+t[n]+",";$(m).prop("checked",true)}}if($(m).prop("checked")){s.addClass("h_cur")}else{s.removeClass("h_cur")}s.focus()});a=a.substring(0,a.length-1);this.tempCheckedKeyArray=c;this.tempCheckedValue=j.toString();h.hidden.val(c)}if(this.keyup){var k=Horn.Util.getFunObj(this.keyup),b;var f=k.params;if($.type(k.fn)=="function"){b=k.fn}if(b){b.apply(this,f)}}Horn.Util.stopPropagation(i)}},bodyClick:function(f){var d=this.getEventTarget();if(f.target==f.data.inputEl.get(0)||d.data("isFromOuter")||$(f.target).prev()[0]==f.data.inputEl.get(0)){d.data("isFromOuter",false);var c=f.data.listEl;var b=f.data.inputEl;this.showList(b,c);$(document).one(this.bodyclicktype,f.data,Horn.Util.apply(this.bodyClick,this))}else{var c=f.data.listEl;var b=f.data.inputEl;c.hide();if(!c.data("show_name")){return}var a=$("li[key]",c);a.unbind("click.li");c.data("show_name","");if(this.searchField){this.searchField.val("")}if(top.Horn&&top.Horn.Window){top.Horn.Window.MAX_ZINDEX=top.Horn.Window.MAX_ZINDEX-1}else{Horn.Window.MAX_ZINDEX=Horn.Window.MAX_ZINDEX-1}}},listClick:function(h){var f=this;var c=$(h.currentTarget);var b=h.data.listEl;var j={};if(f.multipleline){var a=new Array();var g=new Array();var k=b.find('li[key="-1"]');if(k.length>0){f.params.hasSelectAll=true}if(f.params.hasSelectAll){if(c.closest("li").attr("key")==="-1"){if(b.find("input[name='checkall']").prop("checked")){$("input[type='checkbox']",b).each(function(e,l){$(l).prop("checked",true)});f.selectALL=true}else{$("input[type='checkbox']",b).each(function(e,l){$(l).prop("checked",false)});f.selectALL=false}}else{if(c.find("input").prop("checked")){var d=b.find("input[name!='checkall']:checked").length;var i=b.find("li").length;if(d==(i-1)){b.find("input[name='checkall']").prop("checked",true);f.selectALL=true}}else{b.find("input[name='checkall']").prop("checked",false);f.selectALL=false}}}$("input[type='checkbox']:checked",b).each(function(m,p){var n=$(p).parent().parent("li[key]").attr("key");var o=$(p).parent().parent("li[key]");var l=jQuery.trim(o.attr("title"));if(o.attr("title")==""){l=jQuery.trim(o.attr("copytitle"))}var e=f.showLabel+"";if(e=="true"||(screenShowLabel&&screenShowLabel=="true")){if(n&&l.indexOf(":")==-1){l=n+":"+l}}if(n&&n!="-1"){a.push(n);g.push(l)}});this.tempCheckedKeyArray=a;this.field.attr("TITLE",g.toString());j.key=a.join(f.delimiter);j.text=g.join(f.delimiter);if($("input[type='checkbox']",c).get(0).checked){c.addClass("h_cur")}else{c.removeClass("h_cur")}h.stopPropagation();this.setValue(j,true,true)}else{c.addClass("h_cur");c.siblings().removeClass("h_cur");this.setValue(c.attr("key"),true,true)}this.field.trigger("blur");this.tempCheckedValue=this.field.val();if(f.multipleline){this.field.focus()}},hideList:function(c,b){if(!b.data("show_name")){return}b.hide();var a=$("li[key]",b);a.unbind("click.li");b.data("show_name","");if(top.Horn&&top.Horn.Window){top.Horn.Window.MAX_ZINDEX=top.Horn.Window.MAX_ZINDEX-1}else{Horn.Window.MAX_ZINDEX=Horn.Window.MAX_ZINDEX-1}},longerList:false,changeToLongerList:function(){this.longerList=true},showList:function(q,h){this.handerHeadItem();var k=this;var g=h.attr("ref_target");var l=$("#hc_hide_div").children("div.hc_checkboxdiv[ref_target='"+g+"']");if(l&&l.length>0){h=l}if(this.readonly==true&&this.enableFieldSearch==false){return false}if(this.params.filterDicts||this.params.showDicts){this.filterOrShowDict()}if(this.enableFieldSearch){if(this.searchField){var m=this.searchField.val();if(m!=""){$("li",h).each(function(r,s){$(s).show()})}}}if(this.setDisableSearch){return false}var i=q.prev();if(h.data("show_name")==i.attr("name")){return}this.hideAllList(h);var f={inputEl:q,listEl:h};if(h.offsetParent()!=q.offsetParent()){}var o=q.offset(),e=q.outerHeight();h.css("left",o.left+"px");h.css("z-index",Horn.Window.getNextZIndex()+2);h.css("top",(o.top+e)+"px");var d=this.getIEVersion();if(d=="9"){var p=h.children("ul").children("li");if(p.length>3){h.css("width",(q.outerWidth()*(this.longerList?2:1)-2)+18+"px")}else{h.css("width",(q.outerWidth()*(this.longerList?2:1)-2)+"px")}}else{h.css("width",(q.outerWidth()*(this.longerList?2:1)-2)+"px")}h.css("display","block");h.data("show_name",i.attr("name"));$(document).one(k.bodyclicktype,f,Horn.Util.apply(k.bodyClick,k));var c=$("li[key]",h);c.bind("click.li",f,Horn.Util.apply(k.listClick,k));c.removeClass("h_cur");var b=this.tempCheckedKeyArray.join(k.delimiter);if(b==""){b=this.hidden.val()}if(this.multipleline){$("input[type='checkbox']",h).each(function(s,x){var r=$(x).parent().parent("li[key]");var v=r.attr("key");$(x).prop("checked",false);var w=b.split(k.delimiter);for(var u=0;u<w.length;u++){var t=w[u];if(v==t){$(x).prop("checked",true)}}if($(x).prop("checked")){r.addClass("h_cur")}else{r.removeClass("h_cur")}r.focus()});if(this.params.hasSelectAll){var j=h.find("input[name!='checkall']:checked").length;var n=h.find("li").length;if(j==(n-1)){k.selectALL=true}if(k.selectALL){h.find('input[name="checkall"]').prop("checked",true)}}}else{var a=this.hidden.val();var p=h.children("ul").children("li[key='"+a+"']");p.addClass("h_cur");p.focus()}if(screenShowLabel&&screenShowLabel=="true"){}else{if(this.showLabel){this.listEl.find("span.hce_dictlabel").show()}else{this.listEl.find("span.hce_dictlabel").hide()}}if(this.showTitle){this.listEl.find("li").each(function(r,s){copyTitle=$(s).attr("copyTitle");$(s).attr("title",copyTitle)})}else{this.listEl.find("li").attr("title","")}},filterOrShowDict:function(){if(this.params.filterDicts&&this.params.showDicts){}else{if((this.params.filterDicts&&typeof(this.params.filterDicts)=="object")||(this.params.showDicts&&typeof(this.params.showDicts)=="object")){if(this.params.filterDicts&&typeof(this.params.filterDicts)=="object"){var b=this.params.filterDicts;this.listEl.find("li").each(function(c,e){var d=$(this).attr("key");if($.inArray(d,b)!=-1){$(this).hide()}})}if(this.params.showDicts&&typeof(this.params.showDicts)=="object"){var a=this.params.showDicts;this.listEl.find("li").each(function(){var c=$(this).attr("key");if($.inArray(c,a)==-1){$(this).hide()}})}}}},hideAllList:function(a){$("div.hc_checkboxdiv").each(function(b,c){if(a.get(0)!=c){$(c).hide();$(c).data("show_name","")}})},selectLi:function(g,c){var b=this.listEl.children("ul").children("li");var f=null;for(var e=0;e<b.size();e++){var a=$(b.get(e));var d=a.attr("key");if(d&&d.indexOf(g)==0){f=a;break}}if(f==null&&!this.multipleline){for(var e=0;e<b.size();e++){var a=$(b.get(e));var d=a.attr("key");if(d&&d.indexOf(c)==0){f=a;break}}}if(f!=null){if(!this.multipleline){f.siblings().removeClass("h_cur");f.addClass("h_cur")}}return f},bind:function(b,a){this.field.bind(b,[this.hidden],a)},setEnable:function(a){if(a){this.field.removeAttr("disabled");this.hidden.removeAttr("disabled")}else{this.hidden.attr("disabled","disabled");this.field.attr("disabled","disabled")}},getListData:function(){var a={};var b=[];if(this.listEl&&this.listEl.length==0){this.listEl=this.field.parent().find("div.hc_checkboxdiv")}if(this.multipleline){$("input[type='checkbox']",this.listEl).each(function(d,f){var c=$(f).parent().parent("li[key]");var e={};e.key=c.attr("key");e.value=c.attr("title");b.push(e)})}else{$("li[key!='']",this.listEl).each(function(d,f){var c=$(f);var e={};e.key=c.attr("key");e.value=c.attr("title");b.push(e)})}a.data=b;a.dom=this.listEl;return a}});Horn.Field.regFieldType("div.hc_select",Horn.Select);var strChineseFirstPY="YDYQSXMWZSSXJBYMGCCZQPSSQBYCDSCDQLDYLYBSSJGYZZJJFKCCLZDHWDWZJLJPFYYNWJJTMYHZWZHFLZPPQHGSCYYYNJQYXXGJHHSDSJNKKTMOMLCRXYPSNQSECCQZGGLLYJLMYZZSECYKYYHQWJSSGGYXYZYJWWKDJHYCHMYXJTLXJYQBYXZLDWRDJRWYSRLDZJPCBZJJBRCFTLECZSTZFXXZHTRQHYBDLYCZSSYMMRFMYQZPWWJJYFCRWFDFZQPYDDWYXKYJAWJFFXYPSFTZYHHYZYSWCJYXSCLCXXWZZXNBGNNXBXLZSZSBSGPYSYZDHMDZBQBZCWDZZYYTZHBTSYYBZGNTNXQYWQSKBPHHLXGYBFMJEBJHHGQTJCYSXSTKZHLYCKGLYSMZXYALMELDCCXGZYRJXSDLTYZCQKCNNJWHJTZZCQLJSTSTBNXBTYXCEQXGKWJYFLZQLYHYXSPSFXLMPBYSXXXYDJCZYLLLSJXFHJXPJBTFFYABYXBHZZBJYZLWLCZGGBTSSMDTJZXPTHYQTGLJSCQFZKJZJQNLZWLSLHDZBWJNCJZYZSQQYCQYRZCJJWYBRTWPYFTWEXCSKDZCTBZHYZZYYJXZCFFZZMJYXXSDZZOTTBZLQWFCKSZSXFYRLNYJMBDTHJXSQQCCSBXYYTSYFBXDZTGBCNSLCYZZPSAZYZZSCJCSHZQYDXLBPJLLMQXTYDZXSQJTZPXLCGLQTZWJBHCTSYJSFXYEJJTLBGXSXJMYJQQPFZASYJNTYDJXKJCDJSZCBARTDCLYJQMWNQNCLLLKBYBZZSYHQQLTWLCCXTXLLZNTYLNEWYZYXCZXXGRKRMTCNDNJTSYYSSDQDGHSDBJGHRWRQLYBGLXHLGTGXBQJDZPYJSJYJCTMRNYMGRZJCZGJMZMGXMPRYXKJNYMSGMZJYMKMFXMLDTGFBHCJHKYLPFMDXLQJJSMTQGZSJLQDLDGJYCALCMZCSDJLLNXDJFFFFJCZFMZFFPFKHKGDPSXKTACJDHHZDDCRRCFQYJKQCCWJDXHWJLYLLZGCFCQDSMLZPBJJPLSBCJGGDCKKDEZSQCCKJGCGKDJTJDLZYCXKLQSCGJCLTFPCQCZGWPJDQYZJJBYJHSJDZWGFSJGZKQCCZLLPSPKJGQJHZZLJPLGJGJJTHJJYJZCZMLZLYQBGJWMLJKXZDZNJQSYZMLJLLJKYWXMKJLHSKJGBMCLYYMKXJQLBMLLKMDXXKWYXYSLMLPSJQQJQXYXFJTJDXMXXLLCXQBSYJBGWYMBGGBCYXPJYGPEPFGDJGBHBNSQJYZJKJKHXQFGQZKFHYGKHDKLLSDJQXPQYKYBNQSXQNSZSWHBSXWHXWBZZXDMNSJBSBKBBZKLYLXGWXDRWYQZMYWSJQLCJXXJXKJEQXSCYETLZHLYYYSDZPAQYZCMTLSHTZCFYZYXYLJSDCJQAGYSLCQLYYYSHMRQQKLDXZSCSSSYDYCJYSFSJBFRSSZQSBXXPXJYSDRCKGJLGDKZJZBDKTCSYQPYHSTCLDJDHMXMCGXYZHJDDTMHLTXZXYLYMOHYJCLTYFBQQXPFBDFHHTKSQHZYYWCNXXCRWHOWGYJLEGWDQCWGFJYCSNTMYTOLBYGWQWESJPWNMLRYDZSZTXYQPZGCWXHNGPYXSHMYQJXZTDPPBFYHZHTJYFDZWKGKZBLDNTSXHQEEGZZYLZMMZYJZGXZXKHKSTXNXXWYLYAPSTHXDWHZYMPXAGKYDXBHNHXKDPJNMYHYLPMGOCSLNZHKXXLPZZLBMLSFBHHGYGYYGGBHSCYAQTYWLXTZQCEZYDQDQMMHTKLLSZHLSJZWFYHQSWSCWLQAZYNYTLSXTHAZNKZZSZZLAXXZWWCTGQQTDDYZTCCHYQZFLXPSLZYGPZSZNGLNDQTBDLXGTCTAJDKYWNSYZLJHHZZCWNYYZYWMHYCHHYXHJKZWSXHZYXLYSKQYSPSLYZWMYPPKBYGLKZHTYXAXQSYSHXASMCHKDSCRSWJPWXSGZJLWWSCHSJHSQNHCSEGNDAQTBAALZZMSSTDQJCJKTSCJAXPLGGXHHGXXZCXPDMMHLDGTYBYSJMXHMRCPXXJZCKZXSHMLQXXTTHXWZFKHCCZDYTCJYXQHLXDHYPJQXYLSYYDZOZJNYXQEZYSQYAYXWYPDGXDDXSPPYZNDLTWRHXYDXZZJHTCXMCZLHPYYYYMHZLLHNXMYLLLMDCPPXHMXDKYCYRDLTXJCHHZZXZLCCLYLNZSHZJZZLNNRLWHYQSNJHXYNTTTKYJPYCHHYEGKCTTWLGQRLGGTGTYGYHPYHYLQYQGCWYQKPYYYTTTTLHYHLLTYTTSPLKYZXGZWGPYDSSZZDQXSKCQNMJJZZBXYQMJRTFFBTKHZKBXLJJKDXJTLBWFZPPTKQTZTGPDGNTPJYFALQMKGXBDCLZFHZCLLLLADPMXDJHLCCLGYHDZFGYDDGCYYFGYDXKSSEBDHYKDKDKHNAXXYBPBYYHXZQGAFFQYJXDMLJCSQZLLPCHBSXGJYNDYBYQSPZWJLZKSDDTACTBXZDYZYPJZQSJNKKTKNJDJGYYPGTLFYQKASDNTCYHBLWDZHBBYDWJRYGKZYHEYYFJMSDTYFZJJHGCXPLXHLDWXXJKYTCYKSSSMTWCTTQZLPBSZDZWZXGZAGYKTYWXLHLSPBCLLOQMMZSSLCMBJCSZZKYDCZJGQQDSMCYTZQQLWZQZXSSFPTTFQMDDZDSHDTDWFHTDYZJYQJQKYPBDJYYXTLJHDRQXXXHAYDHRJLKLYTWHLLRLLRCXYLBWSRSZZSYMKZZHHKYHXKSMDSYDYCJPBZBSQLFCXXXNXKXWYWSDZYQOGGQMMYHCDZTTFJYYBGSTTTYBYKJDHKYXBELHTYPJQNFXFDYKZHQKZBYJTZBXHFDXKDASWTAWAJLDYJSFHBLDNNTNQJTJNCHXFJSRFWHZFMDRYJYJWZPDJKZYJYMPCYZNYNXFBYTFYFWYGDBNZZZDNYTXZEMMQBSQEHXFZMBMFLZZSRXYMJGSXWZJSPRYDJSJGXHJJGLJJYNZZJXHGXKYMLPYYYCXYTWQZSWHWLYRJLPXSLSXMFSWWKLCTNXNYNPSJSZHDZEPTXMYYWXYYSYWLXJQZQXZDCLEEELMCPJPCLWBXSQHFWWTFFJTNQJHJQDXHWLBYZNFJLALKYYJLDXHHYCSTYYWNRJYXYWTRMDRQHWQCMFJDYZMHMYYXJWMYZQZXTLMRSPWWCHAQBXYGZYPXYYRRCLMPYMGKSJSZYSRMYJSNXTPLNBAPPYPYLXYYZKYNLDZYJZCZNNLMZHHARQMPGWQTZMXXMLLHGDZXYHXKYXYCJMFFYYHJFSBSSQLXXNDYCANNMTCJCYPRRNYTYQNYYMBMSXNDLYLYSLJRLXYSXQMLLYZLZJJJKYZZCSFBZXXMSTBJGNXYZHLXNMCWSCYZYFZLXBRNNNYLBNRTGZQYSATSWRYHYJZMZDHZGZDWYBSSCSKXSYHYTXXGCQGXZZSHYXJSCRHMKKBXCZJYJYMKQHZJFNBHMQHYSNJNZYBKNQMCLGQHWLZNZSWXKHLJHYYBQLBFCDSXDLDSPFZPSKJYZWZXZDDXJSMMEGJSCSSMGCLXXKYYYLNYPWWWGYDKZJGGGZGGSYCKNJWNJPCXBJJTQTJWDSSPJXZXNZXUMELPXFSXTLLXCLJXJJLJZXCTPSWXLYDHLYQRWHSYCSQYYBYAYWJJJQFWQCQQCJQGXALDBZZYJGKGXPLTZYFXJLTPADKYQHPMATLCPDCKBMTXYBHKLENXDLEEGQDYMSAWHZMLJTWYGXLYQZLJEEYYBQQFFNLYXRDSCTGJGXYYNKLLYQKCCTLHJLQMKKZGCYYGLLLJDZGYDHZWXPYSJBZKDZGYZZHYWYFQYTYZSZYEZZLYMHJJHTSMQWYZLKYYWZCSRKQYTLTDXWCTYJKLWSQZWBDCQYNCJSRSZJLKCDCDTLZZZACQQZZDDXYPLXZBQJYLZLLLQDDZQJYJYJZYXNYYYNYJXKXDAZWYRDLJYYYRJLXLLDYXJCYWYWNQCCLDDNYYYNYCKCZHXXCCLGZQJGKWPPCQQJYSBZZXYJSQPXJPZBSBDSFNSFPZXHDWZTDWPPTFLZZBZDMYYPQJRSDZSQZSQXBDGCPZSWDWCSQZGMDHZXMWWFYBPDGPHTMJTHZSMMBGZMBZJCFZWFZBBZMQCFMBDMCJXLGPNJBBXGYHYYJGPTZGZMQBQTCGYXJXLWZKYDPDYMGCFTPFXYZTZXDZXTGKMTYBBCLBJASKYTSSQYYMSZXFJEWLXLLSZBQJJJAKLYLXLYCCTSXMCWFKKKBSXLLLLJYXTYLTJYYTDPJHNHNNKBYQNFQYYZBYYESSESSGDYHFHWTCJBSDZZTFDMXHCNJZYMQWSRYJDZJQPDQBBSTJGGFBKJBXTGQHNGWJXJGDLLTHZHHYYYYYYSXWTYYYCCBDBPYPZYCCZYJPZYWCBDLFWZCWJDXXHYHLHWZZXJTCZLCDPXUJCZZZLYXJJTXPHFXWPYWXZPTDZZBDZCYHJHMLXBQXSBYLRDTGJRRCTTTHYTCZWMXFYTWWZCWJWXJYWCSKYBZSCCTZQNHXNWXXKHKFHTSWOCCJYBCMPZZYKBNNZPBZHHZDLSYDDYTYFJPXYNGFXBYQXCBHXCPSXTYZDMKYSNXSXLHKMZXLYHDHKWHXXSSKQYHHCJYXGLHZXCSNHEKDTGZXQYPKDHEXTYKCNYMYYYPKQYYYKXZLTHJQTBYQHXBMYHSQCKWWYLLHCYYLNNEQXQWMCFBDCCMLJGGXDQKTLXKGNQCDGZJWYJJLYHHQTTTNWCHMXCXWHWSZJYDJCCDBQCDGDNYXZTHCQRXCBHZTQCBXWGQWYYBXHMBYMYQTYEXMQKYAQYRGYZSLFYKKQHYSSQYSHJGJCNXKZYCXSBXYXHYYLSTYCXQTHYSMGSCPMMGCCCCCMTZTASMGQZJHKLOSQYLSWTMXSYQKDZLJQQYPLSYCZTCQQPBBQJZCLPKHQZYYXXDTDDTSJCXFFLLCHQXMJLWCJCXTSPYCXNDTJSHJWXDQQJSKXYAMYLSJHMLALYKXCYYDMNMDQMXMCZNNCYBZKKYFLMCHCMLHXRCJJHSYLNMTJZGZGYWJXSRXCWJGJQHQZDQJDCJJZKJKGDZQGJJYJYLXZXXCDQHHHEYTMHLFSBDJSYYSHFYSTCZQLPBDRFRZTZYKYWHSZYQKWDQZRKMSYNBCRXQBJYFAZPZZEDZCJYWBCJWHYJBQSZYWRYSZPTDKZPFPBNZTKLQYHBBZPNPPTYZZYBQNYDCPJMMCYCQMCYFZZDCMNLFPBPLNGQJTBTTNJZPZBBZNJKLJQYLNBZQHKSJZNGGQSZZKYXSHPZSNBCGZKDDZQANZHJKDRTLZLSWJLJZLYWTJNDJZJHXYAYNCBGTZCSSQMNJPJYTYSWXZFKWJQTKHTZPLBHSNJZSYZBWZZZZLSYLSBJHDWWQPSLMMFBJDWAQYZTCJTBNNWZXQXCDSLQGDSDPDZHJTQQPSWLYYJZLGYXYZLCTCBJTKTYCZJTQKBSJLGMGZDMCSGPYNJZYQYYKNXRPWSZXMTNCSZZYXYBYHYZAXYWQCJTLLCKJJTJHGDXDXYQYZZBYWDLWQCGLZGJGQRQZCZSSBCRPCSKYDZNXJSQGXSSJMYDNSTZTPBDLTKZWXQWQTZEXNQCZGWEZKSSBYBRTSSSLCCGBPSZQSZLCCGLLLZXHZQTHCZMQGYZQZNMCOCSZJMMZSQPJYGQLJYJPPLDXRGZYXCCSXHSHGTZNLZWZKJCXTCFCJXLBMQBCZZWPQDNHXLJCTHYZLGYLNLSZZPCXDSCQQHJQKSXZPBAJYEMSMJTZDXLCJYRYYNWJBNGZZTMJXLTBSLYRZPYLSSCNXPHLLHYLLQQZQLXYMRSYCXZLMMCZLTZSDWTJJLLNZGGQXPFSKYGYGHBFZPDKMWGHCXMSGDXJMCJZDYCABXJDLNBCDQYGSKYDQTXDJJYXMSZQAZDZFSLQXYJSJZYLBTXXWXQQZBJZUFBBLYLWDSLJHXJYZJWTDJCZFQZQZZDZSXZZQLZCDZFJHYSPYMPQZMLPPLFFXJJNZZYLSJEYQZFPFZKSYWJJJHRDJZZXTXXGLGHYDXCSKYSWMMZCWYBAZBJKSHFHJCXMHFQHYXXYZFTSJYZFXYXPZLCHMZMBXHZZSXYFYMNCWDABAZLXKTCSHHXKXJJZJSTHYGXSXYYHHHJWXKZXSSBZZWHHHCWTZZZPJXSNXQQJGZYZYWLLCWXZFXXYXYHXMKYYSWSQMNLNAYCYSPMJKHWCQHYLAJJMZXHMMCNZHBHXCLXTJPLTXYJHDYYLTTXFSZHYXXSJBJYAYRSMXYPLCKDUYHLXRLNLLSTYZYYQYGYHHSCCSMZCTZQXKYQFPYYRPFFLKQUNTSZLLZMWWTCQQYZWTLLMLMPWMBZSSTZRBPDDTLQJJBXZCSRZQQYGWCSXFWZLXCCRSZDZMCYGGDZQSGTJSWLJMYMMZYHFBJDGYXCCPSHXNZCSBSJYJGJMPPWAFFYFNXHYZXZYLREMZGZCYZSSZDLLJCSQFNXZKPTXZGXJJGFMYYYSNBTYLBNLHPFZDCYFBMGQRRSSSZXYSGTZRNYDZZCDGPJAFJFZKNZBLCZSZPSGCYCJSZLMLRSZBZZLDLSLLYSXSQZQLYXZLSKKBRXBRBZCYCXZZZEEYFGKLZLYYHGZSGZLFJHGTGWKRAAJYZKZQTSSHJJXDCYZUYJLZYRZDQQHGJZXSSZBYKJPBFRTJXLLFQWJHYLQTYMBLPZDXTZYGBDHZZRBGXHWNJTJXLKSCFSMWLSDQYSJTXKZSCFWJLBXFTZLLJZLLQBLSQMQQCGCZFPBPHZCZJLPYYGGDTGWDCFCZQYYYQYSSCLXZSKLZZZGFFCQNWGLHQYZJJCZLQZZYJPJZZBPDCCMHJGXDQDGDLZQMFGPSYTSDYFWWDJZJYSXYYCZCYHZWPBYKXRYLYBHKJKSFXTZJMMCKHLLTNYYMSYXYZPYJQYCSYCWMTJJKQYRHLLQXPSGTLYYCLJSCPXJYZFNMLRGJJTYZBXYZMSJYJHHFZQMSYXRSZCWTLRTQZSSTKXGQKGSPTGCZNJSJCQCXHMXGGZTQYDJKZDLBZSXJLHYQGGGTHQSZPYHJHHGYYGKGGCWJZZYLCZLXQSFTGZSLLLMLJSKCTBLLZZSZMMNYTPZSXQHJCJYQXYZXZQZCPSHKZZYSXCDFGMWQRLLQXRFZTLYSTCTMJCXJJXHJNXTNRZTZFQYHQGLLGCXSZSJDJLJCYDSJTLNYXHSZXCGJZYQPYLFHDJSBPCCZHJJJQZJQDYBSSLLCMYTTMQTBHJQNNYGKYRQYQMZGCJKPDCGMYZHQLLSLLCLMHOLZGDYYFZSLJCQZLYLZQJESHNYLLJXGJXLYSYYYXNBZLJSSZCQQCJYLLZLTJYLLZLLBNYLGQCHXYYXOXCXQKYJXXXYKLXSXXYQXCYKQXQCSGYXXYQXYGYTQOHXHXPYXXXULCYEYCHZZCBWQBBWJQZSCSZSSLZYLKDESJZWMYMCYTSDSXXSCJPQQSQYLYYZYCMDJDZYWCBTJSYDJKCYDDJLBDJJSODZYSYXQQYXDHHGQQYQHDYXWGMMMAJDYBBBPPBCMUUPLJZSMTXERXJMHQNUTPJDCBSSMSSSTKJTSSMMTRCPLZSZMLQDSDMJMQPNQDXCFYNBFSDQXYXHYAYKQYDDLQYYYSSZBYDSLNTFQTZQPZMCHDHCZCWFDXTMYQSPHQYYXSRGJCWTJTZZQMGWJJTJHTQJBBHWZPXXHYQFXXQYWYYHYSCDYDHHQMNMTMWCPBSZPPZZGLMZFOLLCFWHMMSJZTTDHZZYFFYTZZGZYSKYJXQYJZQBHMBZZLYGHGFMSHPZFZSNCLPBQSNJXZSLXXFPMTYJYGBXLLDLXPZJYZJYHHZCYWHJYLSJEXFSZZYWXKZJLUYDTMLYMQJPWXYHXSKTQJEZRPXXZHHMHWQPWQLYJJQJJZSZCPHJLCHHNXJLQWZJHBMZYXBDHHYPZLHLHLGFWLCHYYTLHJXCJMSCPXSTKPNHQXSRTYXXTESYJCTLSSLSTDLLLWWYHDHRJZSFGXTSYCZYNYHTDHWJSLHTZDQDJZXXQHGYLTZPHCSQFCLNJTCLZPFSTPDYNYLGMJLLYCQHYSSHCHYLHQYQTMZYPBYWRFQYKQSYSLZDQJMPXYYSSRHZJNYWTQDFZBWWTWWRXCWHGYHXMKMYYYQMSMZHNGCEPMLQQMTCWCTMMPXJPJJHFXYYZSXZHTYBMSTSYJTTQQQYYLHYNPYQZLCYZHZWSMYLKFJXLWGXYPJYTYSYXYMZCKTTWLKSMZSYLMPWLZWXWQZSSAQSYXYRHSSNTSRAPXCPWCMGDXHXZDZYFJHGZTTSBJHGYZSZYSMYCLLLXBTYXHBBZJKSSDMALXHYCFYGMQYPJYCQXJLLLJGSLZGQLYCJCCZOTYXMTMTTLLWTGPXYMZMKLPSZZZXHKQYSXCTYJZYHXSHYXZKXLZWPSQPYHJWPJPWXQQYLXSDHMRSLZZYZWTTCYXYSZZSHBSCCSTPLWSSCJCHNLCGCHSSPHYLHFHHXJSXYLLNYLSZDHZXYLSXLWZYKCLDYAXZCMDDYSPJTQJZLNWQPSSSWCTSTSZLBLNXSMNYYMJQBQHRZWTYYDCHQLXKPZWBGQYBKFCMZWPZLLYYLSZYDWHXPSBCMLJBSCGBHXLQHYRLJXYSWXWXZSLDFHLSLYNJLZYFLYJYCDRJLFSYZFSLLCQYQFGJYHYXZLYLMSTDJCYHBZLLNWLXXYGYYHSMGDHXXHHLZZJZXCZZZCYQZFNGWPYLCPKPYYPMCLQKDGXZGGWQBDXZZKZFBXXLZXJTPJPTTBYTSZZDWSLCHZHSLTYXHQLHYXXXYYZYSWTXZKHLXZXZPYHGCHKCFSYHUTJRLXFJXPTZTWHPLYXFCRHXSHXKYXXYHZQDXQWULHYHMJTBFLKHTXCWHJFWJCFPQRYQXCYYYQYGRPYWSGSUNGWCHKZDXYFLXXHJJBYZWTSXXNCYJJYMSWZJQRMHXZWFQSYLZJZGBHYNSLBGTTCSYBYXXWXYHXYYXNSQYXMQYWRGYQLXBBZLJSYLPSYTJZYHYZAWLRORJMKSCZJXXXYXCHDYXRYXXJDTSQFXLYLTSFFYXLMTYJMJUYYYXLTZCSXQZQHZXLYYXZHDNBRXXXJCTYHLBRLMBRLLAXKYLLLJLYXXLYCRYLCJTGJCMTLZLLCYZZPZPCYAWHJJFYBDYYZSMPCKZDQYQPBPCJPDCYZMDPBCYYDYCNNPLMTMLRMFMMGWYZBSJGYGSMZQQQZTXMKQWGXLLPJGZBQCDJJJFPKJKCXBLJMSWMDTQJXLDLPPBXCWRCQFBFQJCZAHZGMYKPHYYHZYKNDKZMBPJYXPXYHLFPNYYGXJDBKXNXHJMZJXSTRSTLDXSKZYSYBZXJLXYSLBZYSLHXJPFXPQNBYLLJQKYGZMCYZZYMCCSLCLHZFWFWYXZMWSXTYNXJHPYYMCYSPMHYSMYDYSHQYZCHMJJMZCAAGCFJBBHPLYZYLXXSDJGXDHKXXTXXNBHRMLYJSLTXMRHNLXQJXYZLLYSWQGDLBJHDCGJYQYCMHWFMJYBMBYJYJWYMDPWHXQLDYGPDFXXBCGJSPCKRSSYZJMSLBZZJFLJJJLGXZGYXYXLSZQYXBEXYXHGCXBPLDYHWETTWWCJMBTXCHXYQXLLXFLYXLLJLSSFWDPZSMYJCLMWYTCZPCHQEKCQBWLCQYDPLQPPQZQFJQDJHYMMCXTXDRMJWRHXCJZYLQXDYYNHYYHRSLSRSYWWZJYMTLTLLGTQCJZYABTCKZCJYCCQLJZQXALMZYHYWLWDXZXQDLLQSHGPJFJLJHJABCQZDJGTKHSSTCYJLPSWZLXZXRWGLDLZRLZXTGSLLLLZLYXXWGDZYGBDPHZPBRLWSXQBPFDWOFMWHLYPCBJCCLDMBZPBZZLCYQXLDOMZBLZWPDWYYGDSTTHCSQSCCRSSSYSLFYBFNTYJSZDFNDPDHDZZMBBLSLCMYFFGTJJQWFTMTPJWFNLBZCMMJTGBDZLQLPYFHYYMJYLSDCHDZJWJCCTLJCLDTLJJCPDDSQDSSZYBNDBJLGGJZXSXNLYCYBJXQYCBYLZCFZPPGKCXZDZFZTJJFJSJXZBNZYJQTTYJYHTYCZHYMDJXTTMPXSPLZCDWSLSHXYPZGTFMLCJTYCBPMGDKWYCYZCDSZZYHFLYCTYGWHKJYYLSJCXGYWJCBLLCSNDDBTZBSCLYZCZZSSQDLLMQYYHFSLQLLXFTYHABXGWNYWYYPLLSDLDLLBJCYXJZMLHLJDXYYQYTDLLLBUGBFDFBBQJZZMDPJHGCLGMJJPGAEHHBWCQXAXHHHZCHXYPHJAXHLPHJPGPZJQCQZGJJZZUZDMQYYBZZPHYHYBWHAZYJHYKFGDPFQSDLZMLJXKXGALXZDAGLMDGXMWZQYXXDXXPFDMMSSYMPFMDMMKXKSYZYSHDZKXSYSMMZZZMSYDNZZCZXFPLSTMZDNMXCKJMZTYYMZMZZMSXHHDCZJEMXXKLJSTLWLSQLYJZLLZJSSDPPMHNLZJCZYHMXXHGZCJMDHXTKGRMXFWMCGMWKDTKSXQMMMFZZYDKMSCLCMPCGMHSPXQPZDSSLCXKYXTWLWJYAHZJGZQMCSNXYYMMPMLKJXMHLMLQMXCTKZMJQYSZJSYSZHSYJZJCDAJZYBSDQJZGWZQQXFKDMSDJLFWEHKZQKJPEYPZYSZCDWYJFFMZZYLTTDZZEFMZLBNPPLPLPEPSZALLTYLKCKQZKGENQLWAGYXYDPXLHSXQQWQCQXQCLHYXXMLYCCWLYMQYSKGCHLCJNSZKPYZKCQZQLJPDMDZHLASXLBYDWQLWDNBQCRYDDZTJYBKBWSZDXDTNPJDTCTQDFXQQMGNXECLTTBKPWSLCTYQLPWYZZKLPYGZCQQPLLKCCYLPQMZCZQCLJSLQZDJXLDDHPZQDLJJXZQDXYZQKZLJCYQDYJPPYPQYKJYRMPCBYMCXKLLZLLFQPYLLLMBSGLCYSSLRSYSQTMXYXZQZFDZUYSYZTFFMZZSMZQHZSSCCMLYXWTPZGXZJGZGSJSGKDDHTQGGZLLBJDZLCBCHYXYZHZFYWXYZYMSDBZZYJGTSMTFXQYXQSTDGSLNXDLRYZZLRYYLXQHTXSRTZNGZXBNQQZFMYKMZJBZYMKBPNLYZPBLMCNQYZZZSJZHJCTZKHYZZJRDYZHNPXGLFZTLKGJTCTSSYLLGZRZBBQZZKLPKLCZYSSUYXBJFPNJZZXCDWXZYJXZZDJJKGGRSRJKMSMZJLSJYWQSKYHQJSXPJZZZLSNSHRNYPZTWCHKLPSRZLZXYJQXQKYSJYCZTLQZYBBYBWZPQDWWYZCYTJCJXCKCWDKKZXSGKDZXWWYYJQYYTCYTDLLXWKCZKKLCCLZCQQDZLQLCSFQCHQHSFSMQZZLNBJJZBSJHTSZDYSJQJPDLZCDCWJKJZZLPYCGMZWDJJBSJQZSYZYHHXJPBJYDSSXDZNCGLQMBTSFSBPDZDLZNFGFJGFSMPXJQLMBLGQCYYXBQKDJJQYRFKZTJDHCZKLBSDZCFJTPLLJGXHYXZCSSZZXSTJYGKGCKGYOQXJPLZPBPGTGYJZGHZQZZLBJLSQFZGKQQJZGYCZBZQTLDXRJXBSXXPZXHYZYCLWDXJJHXMFDZPFZHQHQMQGKSLYHTYCGFRZGNQXCLPDLBZCSCZQLLJBLHBZCYPZZPPDYMZZSGYHCKCPZJGSLJLNSCDSLDLXBMSTLDDFJMKDJDHZLZXLSZQPQPGJLLYBDSZGQLBZLSLKYYHZTTNTJYQTZZPSZQZTLLJTYYLLQLLQYZQLBDZLSLYYZYMDFSZSNHLXZNCZQZPBWSKRFBSYZMTHBLGJPMCZZLSTLXSHTCSYZLZBLFEQHLXFLCJLYLJQCBZLZJHHSSTBRMHXZHJZCLXFNBGXGTQJCZTMSFZKJMSSNXLJKBHSJXNTNLZDNTLMSJXGZJYJCZXYJYJWRWWQNZTNFJSZPZSHZJFYRDJSFSZJZBJFZQZZHZLXFYSBZQLZSGYFTZDCSZXZJBQMSZKJRHYJZCKMJKHCHGTXKXQGLXPXFXTRTYLXJXHDTSJXHJZJXZWZLCQSBTXWXGXTXXHXFTSDKFJHZYJFJXRZSDLLLTQSQQZQWZXSYQTWGWBZCGZLLYZBCLMQQTZHZXZXLJFRMYZFLXYSQXXJKXRMQDZDMMYYBSQBHGZMWFWXGMXLZPYYTGZYCCDXYZXYWGSYJYZNBHPZJSQSYXSXRTFYZGRHZTXSZZTHCBFCLSYXZLZQMZLMPLMXZJXSFLBYZMYQHXJSXRXSQZZZSSLYFRCZJRCRXHHZXQYDYHXSJJHZCXZBTYNSYSXJBQLPXZQPYMLXZKYXLXCJLCYSXXZZLXDLLLJJYHZXGYJWKJRWYHCPSGNRZLFZWFZZNSXGXFLZSXZZZBFCSYJDBRJKRDHHGXJLJJTGXJXXSTJTJXLYXQFCSGSWMSBCTLQZZWLZZKXJMLTMJYHSDDBXGZHDLBMYJFRZFSGCLYJBPMLYSMSXLSZJQQHJZFXGFQFQBPXZGYYQXGZTCQWYLTLGWSGWHRLFSFGZJMGMGBGTJFSYZZGZYZAFLSSPMLPFLCWBJZCLJJMZLPJJLYMQDMYYYFBGYGYZMLYZDXQYXRQQQHSYYYQXYLJTYXFSFSLLGNQCYHYCWFHCCCFXPYLYPLLZYXXXXXKQHHXSHJZCFZSCZJXCPZWHHHHHAPYLQALPQAFYHXDYLUKMZQGGGDDESRNNZLTZGCHYPPYSQJJHCLLJTOLNJPZLJLHYMHEYDYDSQYCDDHGZUNDZCLZYZLLZNTNYZGSLHSLPJJBDGWXPCDUTJCKLKCLWKLLCASSTKZZDNQNTTLYYZSSYSSZZRYLJQKCQDHHCRXRZYDGRGCWCGZQFFFPPJFZYNAKRGYWYQPQXXFKJTSZZXSWZDDFBBXTBGTZKZNPZZPZXZPJSZBMQHKCYXYLDKLJNYPKYGHGDZJXXEAHPNZKZTZCMXCXMMJXNKSZQNMNLWBWWXJKYHCPSTMCSQTZJYXTPCTPDTNNPGLLLZSJLSPBLPLQHDTNJNLYYRSZFFJFQWDPHZDWMRZCCLODAXNSSNYZRESTYJWJYJDBCFXNMWTTBYLWSTSZGYBLJPXGLBOCLHPCBJLTMXZLJYLZXCLTPNCLCKXTPZJSWCYXSFYSZDKNTLBYJCYJLLSTGQCBXRYZXBXKLYLHZLQZLNZCXWJZLJZJNCJHXMNZZGJZZXTZJXYCYYCXXJYYXJJXSSSJSTSSTTPPGQTCSXWZDCSYFPTFBFHFBBLZJCLZZDBXGCXLQPXKFZFLSYLTUWBMQJHSZBMDDBCYSCCLDXYCDDQLYJJWMQLLCSGLJJSYFPYYCCYLTJANTJJPWYCMMGQYYSXDXQMZHSZXPFTWWZQSWQRFKJLZJQQYFBRXJHHFWJJZYQAZMYFRHCYYBYQWLPEXCCZSTYRLTTDMQLYKMBBGMYYJPRKZNPBSXYXBHYZDJDNGHPMFSGMWFZMFQMMBCMZZCJJLCNUXYQLMLRYGQZCYXZLWJGCJCGGMCJNFYZZJHYCPRRCMTZQZXHFQGTJXCCJEAQCRJYHPLQLSZDJRBCQHQDYRHYLYXJSYMHZYDWLDFRYHBPYDTSSCNWBXGLPZMLZZTQSSCPJMXXYCSJYTYCGHYCJWYRXXLFEMWJNMKLLSWTXHYYYNCMMCWJDQDJZGLLJWJRKHPZGGFLCCSCZMCBLTBHBQJXQDSPDJZZGKGLFQYWBZYZJLTSTDHQHCTCBCHFLQMPWDSHYYTQWCNZZJTLBYMBPDYYYXSQKXWYYFLXXNCWCXYPMAELYKKJMZZZBRXYYQJFLJPFHHHYTZZXSGQQMHSPGDZQWBWPJHZJDYSCQWZKTXXSQLZYYMYSDZGRXCKKUJLWPYSYSCSYZLRMLQSYLJXBCXTLWDQZPCYCYKPPPNSXFYZJJRCEMHSZMSXLXGLRWGCSTLRSXBZGBZGZTCPLUJLSLYLYMTXMTZPALZXPXJTJWTCYYZLBLXBZLQMYLXPGHDSLSSDMXMBDZZSXWHAMLCZCPJMCNHJYSNSYGCHSKQMZZQDLLKABLWJXSFMOCDXJRRLYQZKJMYBYQLYHETFJZFRFKSRYXFJTWDSXXSYSQJYSLYXWJHSNLXYYXHBHAWHHJZXWMYLJCSSLKYDZTXBZSYFDXGXZJKHSXXYBSSXDPYNZWRPTQZCZENYGCXQFJYKJBZMLJCMQQXUOXSLYXXLYLLJDZBTYMHPFSTTQQWLHOKYBLZZALZXQLHZWRRQHLSTMYPYXJJXMQSJFNBXYXYJXXYQYLTHYLQYFMLKLJTMLLHSZWKZHLJMLHLJKLJSTLQXYLMBHHLNLZXQJHXCFXXLHYHJJGBYZZKBXSCQDJQDSUJZYYHZHHMGSXCSYMXFEBCQWWRBPYYJQTYZCYQYQQZYHMWFFHGZFRJFCDPXNTQYZPDYKHJLFRZXPPXZDBBGZQSTLGDGYLCQMLCHHMFYWLZYXKJLYPQHSYWMQQGQZMLZJNSQXJQSYJYCBEHSXFSZPXZWFLLBCYYJDYTDTHWZSFJMQQYJLMQXXLLDTTKHHYBFPWTYYSQQWNQWLGWDEBZWCMYGCULKJXTMXMYJSXHYBRWFYMWFRXYQMXYSZTZZTFYKMLDHQDXWYYNLCRYJBLPSXCXYWLSPRRJWXHQYPHTYDNXHHMMYWYTZCSQMTSSCCDALWZTCPQPYJLLQZYJSWXMZZMMYLMXCLMXCZMXMZSQTZPPQQBLPGXQZHFLJJHYTJSRXWZXSCCDLXTYJDCQJXSLQYCLZXLZZXMXQRJMHRHZJBHMFLJLMLCLQNLDXZLLLPYPSYJYSXCQQDCMQJZZXHNPNXZMEKMXHYKYQLXSXTXJYYHWDCWDZHQYYBGYBCYSCFGPSJNZDYZZJZXRZRQJJYMCANYRJTLDPPYZBSTJKXXZYPFDWFGZZRPYMTNGXZQBYXNBUFNQKRJQZMJEGRZGYCLKXZDSKKNSXKCLJSPJYYZLQQJYBZSSQLLLKJXTBKTYLCCDDBLSPPFYLGYDTZJYQGGKQTTFZXBDKTYYHYBBFYTYYBCLPDYTGDHRYRNJSPTCSNYJQHKLLLZSLYDXXWBCJQSPXBPJZJCJDZFFXXBRMLAZHCSNDLBJDSZBLPRZTSWSBXBCLLXXLZDJZSJPYLYXXYFTFFFBHJJXGBYXJPMMMPSSJZJMTLYZJXSWXTYLEDQPJMYGQZJGDJLQJWJQLLSJGJGYGMSCLJJXDTYGJQJQJCJZCJGDZZSXQGSJGGCXHQXSNQLZZBXHSGZXCXYLJXYXYYDFQQJHJFXDHCTXJYRXYSQTJXYEFYYSSYYJXNCYZXFXMSYSZXYYSCHSHXZZZGZZZGFJDLTYLNPZGYJYZYYQZPBXQBDZTZCZYXXYHHSQXSHDHGQHJHGYWSZTMZMLHYXGEBTYLZKQWYTJZRCLEKYSTDBCYKQQSAYXCJXWWGSBHJYZYDHCSJKQCXSWXFLTYNYZPZCCZJQTZWJQDZZZQZLJJXLSBHPYXXPSXSHHEZTXFPTLQYZZXHYTXNCFZYYHXGNXMYWXTZSJPTHHGYMXMXQZXTSBCZYJYXXTYYZYPCQLMMSZMJZZLLZXGXZAAJZYXJMZXWDXZSXZDZXLEYJJZQBHZWZZZQTZPSXZTDSXJJJZNYAZPHXYYSRNQDTHZHYYKYJHDZXZLSWCLYBZYECWCYCRYLCXNHZYDZYDYJDFRJJHTRSQTXYXJRJHOJYNXELXSFSFJZGHPZSXZSZDZCQZBYYKLSGSJHCZSHDGQGXYZGXCHXZJWYQWGYHKSSEQZZNDZFKWYSSTCLZSTSYMCDHJXXYWEYXCZAYDMPXMDSXYBSQMJMZJMTZQLPJYQZCGQHXJHHLXXHLHDLDJQCLDWBSXFZZYYSCHTYTYYBHECXHYKGJPXHHYZJFXHWHBDZFYZBCAPNPGNYDMSXHMMMMAMYNBYJTMPXYYMCTHJBZYFCGTYHWPHFTWZZEZSBZEGPFMTSKFTYCMHFLLHGPZJXZJGZJYXZSBBQSCZZLZCCSTPGXMJSFTCCZJZDJXCYBZLFCJSYZFGSZLYBCWZZBYZDZYPSWYJZXZBDSYUXLZZBZFYGCZXBZHZFTPBGZGEJBSTGKDMFHYZZJHZLLZZGJQZLSFDJSSCBZGPDLFZFZSZYZYZSYGCXSNXXCHCZXTZZLJFZGQSQYXZJQDCCZTQCDXZJYQJQCHXZTDLGSCXZSYQJQTZWLQDQZTQCHQQJZYEZZZPBWKDJFCJPZTYPQYQTTYNLMBDKTJZPQZQZZFPZSBNJLGYJDXJDZZKZGQKXDLPZJTCJDQBXDJQJSTCKNXBXZMSLYJCQMTJQWWCJQNJNLLLHJCWQTBZQYDZCZPZZDZYDDCYZZZCCJTTJFZDPRRTZTJDCQTQZDTJNPLZBCLLCTZSXKJZQZPZLBZRBTJDCXFCZDBCCJJLTQQPLDCGZDBBZJCQDCJWYNLLZYZCCDWLLXWZLXRXNTQQCZXKQLSGDFQTDDGLRLAJJTKUYMKQLLTZYTDYYCZGJWYXDXFRSKSTQTENQMRKQZHHQKDLDAZFKYPBGGPZREBZZYKZZSPEGJXGYKQZZZSLYSYYYZWFQZYLZZLZHWCHKYPQGNPGBLPLRRJYXCCSYYHSFZFYBZYYTGZXYLXCZWXXZJZBLFFLGSKHYJZEYJHLPLLLLCZGXDRZELRHGKLZZYHZLYQSZZJZQLJZFLNBHGWLCZCFJYSPYXZLZLXGCCPZBLLCYBBBBUBBCBPCRNNZCZYRBFSRLDCGQYYQXYGMQZWTZYTYJXYFWTEHZZJYWLCCNTZYJJZDEDPZDZTSYQJHDYMBJNYJZLXTSSTPHNDJXXBYXQTZQDDTJTDYYTGWSCSZQFLSHLGLBCZPHDLYZJYCKWTYTYLBNYTSDSYCCTYSZYYEBHEXHQDTWNYGYCLXTSZYSTQMYGZAZCCSZZDSLZCLZRQXYYELJSBYMXSXZTEMBBLLYYLLYTDQYSHYMRQWKFKBFXNXSBYCHXBWJYHTQBPBSBWDZYLKGZSKYHXQZJXHXJXGNLJKZLYYCDXLFYFGHLJGJYBXQLYBXQPQGZTZPLNCYPXDJYQYDYMRBESJYYHKXXSTMXRCZZYWXYQYBMCLLYZHQYZWQXDBXBZWZMSLPDMYSKFMZKLZCYQYCZLQXFZZYDQZPZYGYJYZMZXDZFYFYTTQTZHGSPCZMLCCYTZXJCYTJMKSLPZHYSNZLLYTPZCTZZCKTXDHXXTQCYFKSMQCCYYAZHTJPCYLZLYJBJXTPNYLJYYNRXSYLMMNXJSMYBCSYSYLZYLXJJQYLDZLPQBFZZBLFNDXQKCZFYWHGQMRDSXYCYTXNQQJZYYPFZXDYZFPRXEJDGYQBXRCNFYYQPGHYJDYZXGRHTKYLNWDZNTSMPKLBTHBPYSZBZTJZSZZJTYYXZPHSSZZBZCZPTQFZMYFLYPYBBJQXZMXXDJMTSYSKKBJZXHJCKLPSMKYJZCXTMLJYXRZZQSLXXQPYZXMKYXXXJCLJPRMYYGADYSKQLSNDHYZKQXZYZTCGHZTLMLWZYBWSYCTBHJHJFCWZTXWYTKZLXQSHLYJZJXTMPLPYCGLTBZZTLZJCYJGDTCLKLPLLQPJMZPAPXYZLKKTKDZCZZBNZDYDYQZJYJGMCTXLTGXSZLMLHBGLKFWNWZHDXUHLFMKYSLGXDTWWFRJEJZTZHYDXYKSHWFZCQSHKTMQQHTZHYMJDJSKHXZJZBZZXYMPAGQMSTPXLSKLZYNWRTSQLSZBPSPSGZWYHTLKSSSWHZZLYYTNXJGMJSZSUFWNLSOZTXGXLSAMMLBWLDSZYLAKQCQCTMYCFJBSLXCLZZCLXXKSBZQCLHJPSQPLSXXCKSLNHPSFQQYTXYJZLQLDXZQJZDYYDJNZPTUZDSKJFSLJHYLZSQZLBTXYDGTQFDBYAZXDZHZJNHHQBYKNXJJQCZMLLJZKSPLDYCLBBLXKLELXJLBQYCXJXGCNLCQPLZLZYJTZLJGYZDZPLTQCSXFDMNYCXGBTJDCZNBGBQYQJWGKFHTNPYQZQGBKPBBYZMTJDYTBLSQMPSXTBNPDXKLEMYYCJYNZCTLDYKZZXDDXHQSHDGMZSJYCCTAYRZLPYLTLKXSLZCGGEXCLFXLKJRTLQJAQZNCMBYDKKCXGLCZJZXJHPTDJJMZQYKQSECQZDSHHADMLZFMMZBGNTJNNLGBYJBRBTMLBYJDZXLCJLPLDLPCQDHLXZLYCBLCXZZJADJLNZMMSSSMYBHBSQKBHRSXXJMXSDZNZPXLGBRHWGGFCXGMSKLLTSJYYCQLTSKYWYYHYWXBXQYWPYWYKQLSQPTNTKHQCWDQKTWPXXHCPTHTWUMSSYHBWCRWXHJMKMZNGWTMLKFGHKJYLSYYCXWHYECLQHKQHTTQKHFZLDXQWYZYYDESBPKYRZPJFYYZJCEQDZZDLATZBBFJLLCXDLMJSSXEGYGSJQXCWBXSSZPDYZCXDNYXPPZYDLYJCZPLTXLSXYZYRXCYYYDYLWWNZSAHJSYQYHGYWWAXTJZDAXYSRLTDPSSYYFNEJDXYZHLXLLLZQZSJNYQYQQXYJGHZGZCYJCHZLYCDSHWSHJZYJXCLLNXZJJYYXNFXMWFPYLCYLLABWDDHWDXJMCXZTZPMLQZHSFHZYNZTLLDYWLSLXHYMMYLMBWWKYXYADTXYLLDJPYBPWUXJMWMLLSAFDLLYFLBHHHBQQLTZJCQJLDJTFFKMMMBYTHYGDCQRDDWRQJXNBYSNWZDBYYTBJHPYBYTTJXAAHGQDQTMYSTQXKBTZPKJLZRBEQQSSMJJBDJOTGTBXPGBKTLHQXJJJCTHXQDWJLWRFWQGWSHCKRYSWGFTGYGBXSDWDWRFHWYTJJXXXJYZYSLPYYYPAYXHYDQKXSHXYXGSKQHYWFDDDPPLCJLQQEEWXKSYYKDYPLTJTHKJLTCYYHHJTTPLTZZCDLTHQKZXQYSTEEYWYYZYXXYYSTTJKLLPZMCYHQGXYHSRMBXPLLNQYDQHXSXXWGDQBSHYLLPJJJTHYJKYPPTHYYKTYEZYENMDSHLCRPQFDGFXZPSFTLJXXJBSWYYSKSFLXLPPLBBBLBSFXFYZBSJSSYLPBBFFFFSSCJDSTZSXZRYYSYFFSYZYZBJTBCTSBSDHRTJJBYTCXYJEYLXCBNEBJDSYXYKGSJZBXBYTFZWGENYHHTHZHHXFWGCSTBGXKLSXYWMTMBYXJSTZSCDYQRCYTWXZFHMYMCXLZNSDJTTTXRYCFYJSBSDYERXJLJXBBDEYNJGHXGCKGSCYMBLXJMSZNSKGXFBNBPTHFJAAFXYXFPXMYPQDTZCXZZPXRSYWZDLYBBKTYQPQJPZYPZJZNJPZJLZZFYSBTTSLMPTZRTDXQSJEHBZYLZDHLJSQMLHTXTJECXSLZZSPKTLZKQQYFSYGYWPCPQFHQHYTQXZKRSGTTSQCZLPTXCDYYZXSQZSLXLZMYCPCQBZYXHBSXLZDLTCDXTYLZJYYZPZYZLTXJSJXHLPMYTXCQRBLZSSFJZZTNJYTXMYJHLHPPLCYXQJQQKZZSCPZKSWALQSBLCCZJSXGWWWYGYKTJBBZTDKHXHKGTGPBKQYSLPXPJCKBMLLXDZSTBKLGGQKQLSBKKTFXRMDKBFTPZFRTBBRFERQGXYJPZSSTLBZTPSZQZSJDHLJQLZBPMSMMSXLQQNHKNBLRDDNXXDHDDJCYYGYLXGZLXSYGMQQGKHBPMXYXLYTQWLWGCPBMQXCYZYDRJBHTDJYHQSHTMJSBYPLWHLZFFNYPMHXXHPLTBQPFBJWQDBYGPNZTPFZJGSDDTQSHZEAWZZYLLTYYBWJKXXGHLFKXDJTMSZSQYNZGGSWQSPHTLSSKMCLZXYSZQZXNCJDQGZDLFNYKLJCJLLZLMZZNHYDSSHTHZZLZZBBHQZWWYCRZHLYQQJBEYFXXXWHSRXWQHWPSLMSSKZTTYGYQQWRSLALHMJTQJSMXQBJJZJXZYZKXBYQXBJXSHZTSFJLXMXZXFGHKZSZGGYLCLSARJYHSLLLMZXELGLXYDJYTLFBHBPNLYZFBBHPTGJKWETZHKJJXZXXGLLJLSTGSHJJYQLQZFKCGNNDJSSZFDBCTWWSEQFHQJBSAQTGYPQLBXBMMYWXGSLZHGLZGQYFLZBYFZJFRYSFMBYZHQGFWZSYFYJJPHZBYYZFFWODGRLMFTWLBZGYCQXCDJYGZYYYYTYTYDWEGAZYHXJLZYYHLRMGRXXZCLHNELJJTJTPWJYBJJBXJJTJTEEKHWSLJPLPSFYZPQQBDLQJJTYYQLYZKDKSQJYYQZLDQTGJQYZJSUCMRYQTHTEJMFCTYHYPKMHYZWJDQFHYYXWSHCTXRLJHQXHCCYYYJLTKTTYTMXGTCJTZAYYOCZLYLBSZYWJYTSJYHBYSHFJLYGJXXTMZYYLTXXYPZLXYJZYZYYPNHMYMDYYLBLHLSYYQQLLNJJYMSOYQBZGDLYXYLCQYXTSZEGXHZGLHWBLJHEYXTWQMAKBPQCGYSHHEGQCMWYYWLJYJHYYZLLJJYLHZYHMGSLJLJXCJJYCLYCJPCPZJZJMMYLCQLNQLJQJSXYJMLSZLJQLYCMMHCFMMFPQQMFYLQMCFFQMMMMHMZNFHHJGTTHHKHSLNCHHYQDXTMMQDCYZYXYQMYQYLTDCYYYZAZZCYMZYDLZFFFMMYCQZWZZMABTBYZTDMNZZGGDFTYPCGQYTTSSFFWFDTZQSSYSTWXJHXYTSXXYLBYQHWWKXHZXWZNNZZJZJJQJCCCHYYXBZXZCYZTLLCQXYNJYCYYCYNZZQYYYEWYCZDCJYCCHYJLBTZYYCQWMPWPYMLGKDLDLGKQQBGYCHJXY";var oMultiDiff={"19969":"DZ","19975":"WM","19988":"QJ","20048":"YL","20056":"SC","20060":"NM","20094":"QG","20127":"QJ","20167":"QC","20193":"YG","20250":"KH","20256":"ZC","20282":"SC","20285":"QJG","20291":"TD","20314":"YD","20340":"NE","20375":"TD","20389":"YJ","20391":"CZ","20415":"PB","20446":"YS","20447":"SQ","20504":"TC","20608":"KG","20854":"QJ","20857":"ZC","20911":"PF","20504":"TC","20608":"KG","20854":"QJ","20857":"ZC","20911":"PF","20985":"AW","21032":"PB","21048":"XQ","21049":"SC","21089":"YS","21119":"JC","21242":"SB","21273":"SC","21305":"YP","21306":"QO","21330":"ZC","21333":"SDC","21345":"QK","21378":"CA","21397":"SC","21414":"XS","21442":"SC","21477":"JG","21480":"TD","21484":"ZS","21494":"YX","21505":"YX","21512":"HG","21523":"XH","21537":"PB","21542":"PF","21549":"KH","21571":"E","21574":"DA","21588":"TD","21589":"O","21618":"ZC","21621":"KHA","21632":"ZJ","21654":"KG","21679":"LKG","21683":"KH","21710":"A","21719":"YH","21734":"WOE","21769":"A","21780":"WN","21804":"XH","21834":"A","21899":"ZD","21903":"RN","21908":"WO","21939":"ZC","21956":"SA","21964":"YA","21970":"TD","22003":"A","22031":"JG","22040":"XS","22060":"ZC","22066":"ZC","22079":"MH","22129":"XJ","22179":"XA","22237":"NJ","22244":"TD","22280":"JQ","22300":"YH","22313":"XW","22331":"YQ","22343":"YJ","22351":"PH","22395":"DC","22412":"TD","22484":"PB","22500":"PB","22534":"ZD","22549":"DH","22561":"PB","22612":"TD","22771":"KQ","22831":"HB","22841":"JG","22855":"QJ","22865":"XQ","23013":"ML","23081":"WM","23487":"SX","23558":"QJ","23561":"YW","23586":"YW","23614":"YW","23615":"SN","23631":"PB","23646":"ZS","23663":"ZT","23673":"YG","23762":"TD","23769":"ZS","23780":"QJ","23884":"QK","24055":"XH","24113":"DC","24162":"ZC","24191":"GA","24273":"QJ","24324":"NL","24377":"TD","24378":"QJ","24439":"PF","24554":"ZS","24683":"TD","24694":"WE","24733":"LK","24925":"TN","25094":"ZG","25100":"XQ","25103":"XH","25153":"PB","25170":"PB","25179":"KG","25203":"PB","25240":"ZS","25282":"FB","25303":"NA","25324":"KG","25341":"ZY","25373":"WZ","25375":"XJ","25384":"A","25457":"A","25528":"SD","25530":"SC","25552":"TD","25774":"ZC","25874":"ZC","26044":"YW","26080":"WM","26292":"PB","26333":"PB","26355":"ZY","26366":"CZ","26397":"ZC","26399":"QJ","26415":"ZS","26451":"SB","26526":"ZC","26552":"JG","26561":"TD","26588":"JG","26597":"CZ","26629":"ZS","26638":"YL","26646":"XQ","26653":"KG","26657":"XJ","26727":"HG","26894":"ZC","26937":"ZS","26946":"ZC","26999":"KJ","27099":"KJ","27449":"YQ","27481":"XS","27542":"ZS","27663":"ZS","27748":"TS","27784":"SC","27788":"ZD","27795":"TD","27812":"O","27850":"PB","27852":"MB","27895":"SL","27898":"PL","27973":"QJ","27981":"KH","27986":"HX","27994":"XJ","28044":"YC","28065":"WG","28177":"SM","28267":"QJ","28291":"KH","28337":"ZQ","28463":"TL","28548":"DC","28601":"TD","28689":"PB","28805":"JG","28820":"QG","28846":"PB","28952":"TD","28975":"ZC","29100":"A","29325":"QJ","29575":"SL","29602":"FB","30010":"TD","30044":"CX","30058":"PF","30091":"YSP","30111":"YN","30229":"XJ","30427":"SC","30465":"SX","30631":"YQ","30655":"QJ","30684":"QJG","30707":"SD","30729":"XH","30796":"LG","30917":"PB","31074":"NM","31085":"JZ","31109":"SC","31181":"ZC","31192":"MLB","31293":"JQ","31400":"YX","31584":"YJ","31896":"ZN","31909":"ZY","31995":"XJ","32321":"PF","32327":"ZY","32418":"HG","32420":"XQ","32421":"HG","32438":"LG","32473":"GJ","32488":"TD","32521":"QJ","32527":"PB","32562":"ZSQ","32564":"JZ","32735":"ZD","32793":"PB","33071":"PF","33098":"XL","33100":"YA","33152":"PB","33261":"CX","33324":"BP","33333":"TD","33406":"YA","33426":"WM","33432":"PB","33445":"JG","33486":"ZN","33493":"TS","33507":"QJ","33540":"QJ","33544":"ZC","33564":"XQ","33617":"YT","33632":"QJ","33636":"XH","33637":"YX","33694":"WG","33705":"PF","33728":"YW","33882":"SR","34067":"WM","34074":"YW","34121":"QJ","34255":"ZC","34259":"XL","34425":"JH","34430":"XH","34485":"KH","34503":"YS","34532":"HG","34552":"XS","34558":"YE","34593":"ZL","34660":"YQ","34892":"XH","34928":"SC","34999":"QJ","35048":"PB","35059":"SC","35098":"ZC","35203":"TQ","35265":"JX","35299":"JX","35782":"SZ","35828":"YS","35830":"E","35843":"TD","35895":"YG","35977":"MH","36158":"JG","36228":"QJ","36426":"XQ","36466":"DC","36710":"JC","36711":"ZYG","36767":"PB","36866":"SK","36951":"YW","37034":"YX","37063":"XH","37218":"ZC","37325":"ZC","38063":"PB","38079":"TD","38085":"QY","38107":"DC","38116":"TD","38123":"YD","38224":"HG","38241":"XTC","38271":"ZC","38415":"YE","38426":"KH","38461":"YD","38463":"AE","38466":"PB","38477":"XJ","38518":"YT","38551":"WK","38585":"ZC","38704":"XS","38739":"LJ","38761":"GJ","38808":"SQ","39048":"JG","39049":"XJ","39052":"HG","39076":"CZ","39271":"XT","39534":"TD","39552":"TD","39584":"PB","39647":"SB","39730":"LG","39748":"TPB","40109":"ZQ","40479":"ND","40516":"HG","40536":"HG","40583":"QJ","40765":"YQ","40784":"QJ","40840":"YK","40863":"QJG"};function makePy(e){if(typeof(e)!="string"){throw new Error(-1,"函数makePy需要字符串类型参数!")}var b=new Array();for(var c=0,a=e.length;c<a;c++){var d=e.charAt(c);b.push(checkCh(d))}return mkRslt(b)}function checkCh(a){var b=a.charCodeAt(0);if(b>40869||b<19968){return a}return(oMultiDiff[b]?oMultiDiff[b]:(strChineseFirstPY.charAt(b-19968)))}function mkRslt(f){var h=[""];for(var e=0,g=f.length;e<g;e++){var l=f[e];var m=l.length;if(m==1){for(var a=0;a<h.length;a++){h[a]+=l}}else{var c=h.slice(0);h=[];for(a=0;a<m;a++){var d=c.slice(0);for(var b=0;b<d.length;b++){d[b]+=l.charAt(a)}h=h.concat(d)}}}return h}String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};
Horn.SelectTree=Horn.extend(Horn.Field,{COMPONENT_CLASS:"SelectTree",hidden:null,field:null,ref:null,listEl:null,treeEl:null,_this:null,expandFirst:true,callback:null,init:function(){Horn.SelectTree.superclass.init.apply(this,arguments);var a=this.name;this.id=this.el.attr("id");var d=this.id.replace(/\./,"_");this.field=this.el.children("input[type='text'][ref*='"+d+"']");this.hidden=this.field.prev();this.name=this.hidden.attr("name");this.ref=this.field.attr("ref");this.img=this.el.find(".u-select-down");c=this;if(this.params.readonly){this.el.attr("readonly",true);this.readonly=true}expandFirst=false;if(this.hidden.attr("expandFirst")){expandFirst=this.params.expandFirst}this.field.bind({focus:Horn.Util.apply(this.onFocus,this)});if(this.params.afterClear){var b=this.params.afterClear.replace("(","").replace(")","");this.callback=window[b]}var c=this;this.el.children("a").bind({click:Horn.Util.apply(c.delVal,c)});this.initZTree()},delVal:function(){if(this.params.disabled){return}var b=this;var a=this.field.val();if(a!=""){if(this.params.confirm){Horn.Msg.confirm("确认","你确定要清除该值？",function(){b.hidden.val("");b.field.val("");b.field.attr("selectnodes","");b.field.attr("pIds","");if(b.callback){b.callback()}},function(){})}else{b.hidden.val("");b.field.val("");b.field.attr("selectnodes","");b.field.attr("pIds","");if(b.callback){b.callback()}}}},initZTree:function(){var b=this.params.id?this.params.id:this.params.name;var k=Horn.getCurrent();var a=this.id.replace(/\./,"_");this.listEl=$("#hc_hide-div-tree-"+a).find("div.hc_selectbox-tree-div[ref_target='"+this.ref+"']");if(this.listEl.length==0){var i=[];i.push("<div class='hc_selectbox-tree-div' ref_target='ztree_"+a+"'>");i.push("<div class='hc_selectbox-tree-left'>");i.push("<ul class='ztree' id='ztree_"+a+"'>");i.push("</ul>");i.push("</div>");i.push("</div>");var n=$("#hc_hide-div-tree-"+a);if(n.length==0){n=$('<div class="hc_hide-div-tree-'+a+'" id="hc_hide_div-tree-'+a+'"></div>').appendTo("body");this.listEl=$(i.join("")).appendTo(n)}}var f=this.listEl.children("div.hc_selectbox-tree-left").children("ul.ztree");this.treeEl=f;var j=this;var h=$("div.h_floatdiv-con");if(h){h.mousewheel(function(){$("div.hc_selectbox-tree-div").each(function(){$(this).hide()})});h.scroll(function(){$("div.hc_selectbox-tree-div").each(function(){$(this).hide()})})}var d=false;if(this.params.url&&this.params.url!=""){d=true}var p={view:{nameIsHTML:true,showLine:false,showIcon:true,showTitle:true,selectedMulti:true,dblClickExpand:true,fontCss:this.getFontCss},data:{key:{name:"name",title:"name"},simpleData:{enable:true,idKey:"id",pIdKey:"pId"}},callback:{beforeClick:this.beforeClick,beforeCheck:this.params.beforeCheck?window[this.params.beforeCheck]:null,beforeAsync:this.params.beforeAsync?window[this.params.beforeAsync]:null,onAsyncSuccess:this.onAsyncSuccess,onAsyncError:this.params.onAsyncError?window[this.params.onAsyncError]:null,beforeCollapse:this.params.beforeCollapse?window[this.params.beforeCollapse]:null,beforeDblClick:this.params.beforeDblClick?window[this.params.beforeDblClick]:null,beforeDrag:this.params.beforeDrag?window[this.params.beforeDrag]:null,beforeDragOpen:this.params.beforeDragOpen?window[this.params.beforeDragOpen]:null,beforeDrop:this.params.beforeDrop?window[this.params.beforeDrop]:null,beforeEditName:this.params.beforeEditName?window[this.params.beforeEditName]:null,beforeExpand:this.params.beforeExpand?window[this.params.beforeExpand]:null,beforeMouseDown:this.params.beforeMouseDown?window[this.params.beforeMouseDown]:null,beforeMouseUp:this.params.beforeMouseUp?window[this.params.beforeMouseUp]:null,beforeRemove:this.params.beforeRemove?window[this.params.beforeRemove]:null,beforeRename:this.params.beforeRename?window[this.params.beforeRename]:null,beforeRightClick:this.params.beforeRightClick?window[this.params.beforeRightClick]:null,onCheck:this.onCheck,onCollapse:this.params.onCollapse?window[this.params.onCollapse]:null,onDblClick:this.params.onDblClick?window[this.params.onDblClick]:null,onDrag:this.params.onDrag?window[this.params.onDrag]:null,onDragMove:this.params.onDragMove?window[this.params.onDragMove]:null,onExpand:this.params.onExpand?window[this.params.onExpand]:null,onMouseDown:this.params.onMouseDown?window[this.params.onMouseDown]:null,onMouseUp:this.params.onMouseUp?window[this.params.onMouseUp]:null,onNodeCreated:this.params.onNodeCreated?window[this.params.onNodeCreated]:null,onRemove:this.params.onRemove?window[this.params.onRemove]:null,onRename:this.params.onRename?window[this.params.onRename]:null,onRightClick:this.params.onRightClick?window[this.params.onRightClick]:null,onClick:this.onCheck},async:{enable:d,url:this.params.url?this.params.url:"",autoParam:this.params.otherParam?this.params.otherParam:[],otherParam:this.params.otherParam?this.params.otherParam:{},type:this.params.type?this.params.type:"post",dataFilter:this.params.dataFilter?window[this.params.dataFilter]:null}};var o=this.hidden.attr("checkMode");if(o&&o=="checkbox"){p.check={enable:true,chkStyle:o,chkboxType:{Y:"",N:""}}}var g=this.hidden.attr("data-data");if(g&&g!=""){g=$.parseJSON(g)}else{g=[]}this.treedata=g;if(d){this.zTreeObj=$.fn.zTree.init(f,p)}else{this.zTreeObj=$.fn.zTree.init(f,p,g)}var e=this.treeEl.attr("id");this.treeObj=$.fn.zTree.getZTreeObj(e);this.treeObj.expandAll(expandFirst);if(!d){var l=this.hidden.val();if(l!=""){this.initVal()}}var c=this.treeObj;var m="name";if(this.hidden.attr("filterBy")){m=this.hidden.attr("filterBy")}this.field.bind("keyup",function(t){var s=[];var r=c.getNodesByParamFuzzy(m,this.value,null);var q=c.getNodesByParamFuzzy(m,"",null);if(this.value!=""){$.each(r,function(u,v){s.push(v.id)});$.each(q,function(u,v){if(s.indexOf(v.id)!=-1){v.highlight=true;j.treeObj.updateNode(v);j.treeObj.expandNode(v.getParentNode(),true)}else{v.highlight=false;j.treeObj.updateNode(v)}})}else{$.each(r,function(u,v){v.highlight=false;j.treeObj.updateNode(v)});c.expandAll(false)}this.focus()});this.field.bind({blur:function(){$(this).val($(this).attr("selectNodes"));var q=c.getNodesByParam("highlight",true,null);$.each(q,function(r,s){s.highlight=false;c.updateNode(s)})}})},clearValue:function(){this.field.val("");this.field.attr("selectnodes","");this.hidden.val("");this.field.attr("pIds","");this.clearHighlight();this.initVal()},reset:function(){var b=this;var a=b.params.value;if(a&&a!=""){b.initVal(a)}else{b.field.val("");b.field.attr("selectnodes","");b.hidden.val("");b.clearHighlight()}},onBeforeCheck:function(a,c){var b=$.fn.zTree.getZTreeObj(a);var d=b.thisScope;return(function(){var f=this.hidden.attr("isLevelSelect")=="true";var e=this.hidden.attr("checkMode")=="checkbox"||this.hidden.attr("checkbox")=="radio";if(e){if(f){if(this.hidden.data("level")!=undefined&&c.level!=this.hidden.data("level")){return false}this.hidden.data("level",c.level)}}}).apply(d,arguments)},clearHighlight:function(){var b=this;var a=b.treeObj.getNodesByParamFuzzy("id","",null);$.each(a,function(c,d){d.highlight=false;b.treeObj.updateNode(d)})},initVal:function(l){if(l){this.hidden.val(l)}var c=this.hidden.val();var h="";var a=[];var g=this.field.attr("ref");var b=this.hidden.attr("checkMode")=="checkbox"||this.hidden.attr("checkMode")=="radio";var k=$.fn.zTree.getZTreeObj(g);if(c!=""){var j=c.split(",");for(var e=0;e<j.length;e++){var f=this.treeObj.getNodesByParam("id",j[e],null);if(f&&f[0]!=null&&f[0]!={}){h+=","+f[0].name;a.push(f[0])}}}this.clearLog(k);k.checkAllNodes(false);k.selectNode(null,false);if(h!=""){this.field.val(h.substring(1));this.showLog(a,this.treeObj,true)}else{this.field.val("")}if(this.hidden.val()){tIdArrs=this.hidden.attr("tids")||"";tIdArrs=tIdArrs.split(",");var a=[];for(var e=0;e<tIdArrs.length;e++){if(tIdArrs[e]){var d=k.getNodeByTId(tIdArrs[e]);a.push(d);if(b){k.checkNode(d,true,true,false)}else{k.selectNode(d,false)}}}}},onAsyncSuccess:function(a,c,b,d){var e=c.substring(6);Horn.getCompById(e).initVal()},getFontCss:function(b,a){return(a.highlight)?{color:"#f00","font-weight":"bold"}:{color:"#333","font-weight":"normal"}},onCheck:function(d,c,b){var a=$.fn.zTree.getZTreeObj(c);var f=a.thisScope;return(function(){var g=a.getCheckedNodes();var e=this.hidden.attr("checkMode");var g=new Array();if(e&&e=="checkbox"){g=a.getCheckedNodes()}else{g=a.getSelectedNodes()}this.showLog.call(this,g,a,e,true);if(this.params.onCheck){var h=window[this.params.onCheck];h()}}).apply(f,arguments);this.field.trigger("blur")},showLog:function(a,c,b,l){var k="dark";var e=[];var j=[];var n=[];var m=[];var h=[];var i=this;var g=this.listEl.children("div.hc_selectbox-tree-left").children("ul.ztree");var f=g.parent().next("div.hc_selectbox-tree-right").children("ul.ztree");var d=this.treeObj.getNodesByParamFuzzy("id","",null);$.each(d,function(o,p){p.highlight=false;i.treeObj.updateNode(p)});$.each(a,function(q,s){s.highlight=true;i.treeObj.updateNode(s);i.treeObj.expandNode(s.getParentNode(),true);var r="ztree_node_"+s.tId;var t=s.name;var p=s.id;var o=s.pId;n.push(t);h.push(p);m.push(o);e.push(r);j.push(s.tId);f.children("li[zid='"+r+"']");if(f.children("li[zid='"+r+"']").length==0){f.append("<li class='"+k+"' zid='"+r+"'>"+t+"</li>")}});f.children("li").each(function(p,o){var q=$(o);if(jQuery.inArray(q.attr("zid"),e)==-1){q.remove()}});this.hidden.val(h.join(","));if(b){this.field.val(n.join(","));this.field.attr("selectNodes",n.join(","));this.field.attr("pIds",m.join(","));this.field.attr("title",n.join(","))}else{this.field.val(n.join(","));this.field.attr("pIds",m.join(","));this.field.attr("selectNodes",n.join(","))}this.hidden.attr("tids",j.join(","));var b=this.hidden.attr("checkMode");if(!b||b=="radio"){if(l!=undefined){if(l){this.hideTree(this.field,this.listEl)}else{this.showTree(this.field,this.listEl)}}}this.validate()},clearLog:function(){var a=this.listEl.children("div.hc_selectbox-tree-right").children("ul.ztree");a.children("li").remove()},onFocus:function(h){var j=Horn.getCurrent();var g=this.field.attr("ref");this.listEl=$("#hc_hide-div-tree-"+this.id).children("div.hc_selectbox-tree-div[ref_target='"+g+"']");this.listEl.find("div.hc_selectbox-tree-left").width(this.field.width()+30);var n=$(h.currentTarget);var g=n.attr("ref");var l=$("div.hc_selectbox-tree-div[ref_target='"+g+"']");if(l.length>0){this.showTree(n,l);var k=$.fn.zTree.getZTreeObj(g);k.thisScope=this;k.currentTarget=n;var c=this.hidden.attr("checkMode")=="checkbox"||this.hidden.attr("checkMode")=="radio";this.clearLog(k);k.checkAllNodes(false);k.selectNode(null,false);if(this.hidden.val()){tIdArrs=this.hidden.attr("tids")||"";tIdArrs=tIdArrs.split(",");var b=[];for(var f=0;f<tIdArrs.length;f++){if(tIdArrs[f]){var d=k.getNodeByTId(tIdArrs[f]);b.push(d);if(c){k.checkNode(d,true,true,false)}else{k.selectNode(d,false)}}}this.showLog(b,k,c,false)}}var a=n.prev();var o=a.attr("search");var m=a.attr("filterBy");if(o||m){n.val("");n.removeAttr("readonly")}},hideTree:function(c,b){if(!b.data("show_name")){return}b.hide();b.data("show_name",false);var d=c.attr("ref");var a=$.fn.zTree.getZTreeObj(d);a.thisScope=null;a.currentTarget=null;if(top.Horn&&top.Horn.Window){top.Horn.Window.MAX_ZINDEX=top.Horn.Window.MAX_ZINDEX-1}else{Horn.Window.MAX_ZINDEX=Horn.Window.MAX_ZINDEX-1}},showTree:function(e,d){if(d.data("show_name")){return}if(this.readonly==true){return false}var c={inputEl:e,listEl:d};var g=e.offset(),b=e.outerHeight();d.css("left",g.left+"px");d.css("z-index",Horn.Window.getNextZIndex()+2);d.css("top",(g.top+b)+"px");var f=this.getIEVersion();if(f=="9"){var a=d.children("ul").children("li");if(a.length>3){d.css("width",(e.outerWidth()*(this.longerList?2:1)-2)+18+"px")}else{d.css("width",(e.outerWidth()*(this.longerList?2:1)-2)+"px")}}else{d.css("width",(e.outerWidth()*(this.longerList?2:1)-2)+"px")}d.show();d.data("show_name",true);d.bind("click.ztree.list",c,function(h){Horn.Util.stopPropagation(h)});$(document).one("click.combo.body",c,Horn.Util.apply(this.bodyClick,this))},hideAllList:function(a){$("div.hc_selectbox-tree-div").each(function(b,c){if(a.get(0)!=c){$(c).hide();$(c).data("show_name","")}})},bodyClick:function(c){var b=c.data.inputEl;if(c.target==b.get(0)){$(document).one("click.combo.body",c.data,Horn.Util.apply(this.bodyClick,this))}else{var a=c.data.listEl;this.hideTree(b,a)}},setEnable:function(a){if(a){this.field.removeAttr("disabled");this.hidden.removeAttr("disabled")}else{this.field.attr("disabled","disabled");this.hidden.attr("disabled","disabled")}},setValue:function(a){this.initVal(a);this.validate()},setReadonly:function(a){if(!a){a=false}if(a===false){this.el.removeAttr("readonly");this.readonly=false;this.el.find("input[type='text']").removeClass("u-readonly")}else{this.el.attr("readonly",true);this.readonly=true;this.el.find("input[type='text']").addClass("u-readonly")}},getSelectedNodes:function(){var a=this.hidden.attr("checkMode");if(!a||a=="radio"){return this.treeObj.getSelectedNodes()}else{return this.treeObj.getCheckedNodes()}},getValue:function(){var a=this.get();var b=a.val();return b},getText:function(){var a=this.field;var b=a.attr("selectnodes");return b},getPid:function(){var a=this.field;var b=a.attr("pIds");return b}});Horn.Field.regFieldType("div.hc_select-tree",Horn.SelectTree);
var isFirstClick=true;var firstTab=null;(function(H){Horn.TabPanel=Horn.extend(Horn.Base,{maxTabCn:30,tabWidth:121,minTabHeight:undefined,init:function(){Horn.TabPanel.superclass.init.apply(this,arguments);var _this=this;this.maxTabCn=this.params.maxTabCn?this.params.maxTabCn:this.maxTabCn;var tabWidth=(this.params.width||this.tabWidth||"")+"";this.tabWidth=tabWidth.match(/[px|%]+$/)?tabWidth:tabWidth+"px";this.isFormValidate=this.params.isFormValidate==="false"?false:!!this.params.isFormValidate;var tabPanel=this.el;this.tabsDiv=tabPanel.children("div.h_tabpanel-tabs");this.contentsDiv=tabPanel.children("div.h_tabpanel-contents");this.tabWrap=this.tabsDiv.children("div.h_tabpanel-wrap");this.tabWrapUl=this.tabWrap.children("ul");this.leftScroller=this.tabsDiv.children(".h_tabscroller-left");this.rightScroller=this.tabsDiv.children(".h_tabscroller-right");this.topScroller=this.tabsDiv.children(".h_tabscroller-top");this.bottomScroller=this.tabsDiv.children(".h_tabscroller-bottom");$.each(_this.params.events||[],function(i,o){_this[o.event.toLowerCase()]=o["function"]});var tempTabsUl=tabPanel.children("ul");if(tempTabsUl.size()>this.maxTabCn){tempTabsUl.splice(this.maxTabCn);Horn.Msg.alert("提示","最多只能添加"+this.maxTabCn+"个页签！")}if(this.params.height&&this.params.height!=""){this.contentsDiv.css("height",this.params.height);this.contentsDiv.css("overflow","auto")}if(this.params.width&&this.params.width!=""){this.topScroller.css("width",this.params.width);this.bottomScroller.css("width",this.params.width)}tempTabsUl.children("li[ref]").appendTo(this.tabWrapUl).each(function(i,o){var tab=$(o);var ref=tab.attr("ref");var content=$("[ref_target="+ref+"]",tabPanel);var contentId=content.attr("id");if(!contentId){contentId=Horn.id("tab-panel-content-");content.attr("id",contentId)}_this.contentsDiv.get(0).appendChild(content.get(0));tab.bind("click",function(){if(!isFirstClick){if($(this).data("content")!=firstTab.data("content")){_this.activate(firstTab)}}_this.activate($(this));if(_this.tabclick){var tabclickObj=Horn.Util.getFunObj(_this.tabclick),tabclickFn;var params=tabclickObj.params;if($.type(tabclickObj.fn)=="function"){tabclickFn=tabclickObj.fn}if(tabclickFn){tabclickFn.apply($(this),params)}}}).data({content:content}).css("width",_this.tabWidth);if(_this.tabWidth){var icon=tab.children(".h_tab-icon");var title=tab.children(".h_tab-title");title.css({width:parseInt(_this.tabWidth)-icon.outerWidth()})}});tempTabsUl.remove();this.tabChange=function(){};if(this.params.tabChange){var tabChangeObj=Horn.Util.getFunObj(this.params.tabChange);if($.type(tabChangeObj.fn)=="function"){this.tabChange=tabChangeObj.fn}}initScrollerEvents.call(this);initTabPosition.call(this,this.params.position);firstTab=this.tabWrapUl.children("li:eq(0)");calculateScrollLength.call(this);var isSelectFirst=true;var selectFirst=this.params.selectFirst+"";if(selectFirst=="false"){isSelectFirst=false}if(isSelectFirst){firstTab.addClass("h_cur").click()}isFirstClick=false;firstTab.data("content").show();$(window).bind("resizes",function(){locateScroller.call(_this.tabWrap);moveToCenter.call(_this,_this.getCurrentTab())});locateScroller.call(this.tabWrap)},getCurrentTab:function(){if(!this.currentTabName){var _this=this;this.tabWrapUl.children("li").each(function(i,o){var curTab=$(this).attr("class");if(curTab.indexOf("h_cur")>-1){_this.currentTabName=$(this).attr("ref")}})}return this.getTab(this.currentTabName)},getTab:function(o){if($.type(o)!="object"){return this.tabWrapUl.children("li[ref='"+o+"']")}return o&&o.length?o:$(o)},addTab:function(params){if(!params.url){Horn.Msg.alert("提示","页签url必填，请检查！");return}var _this=this;var maxTabCn=params.maxTabCn?params.maxTabCn:this.maxTabCn;var tabWidth=params.width?params.width:this.tabWidth||"auto";if(params.name&&this.getTab(params.name).length){this.activate(params.name);return}if(this.tabWrapUl.children("li").length>=maxTabCn){Horn.Msg.alert("提示","最多只能添加"+maxTabCn+"个页签");return}var tabPanel=this.el;var tabWrapUl=this.tabWrapUl;var ref=params.name||("h_tab-uldiv-"+new Date().getTime());var refID=Horn.id("tab-uldiv-");if(!params.title){params.title="未命名页签"}var newTab=createTab(ref,params.title,tabWidth).appendTo(tabWrapUl);var newContent=createContent(ref,refID).appendTo(this.contentsDiv);newTab.data("content",newContent).click(function(){_this.activate($(this))});if(this.tabWidth){var icon=newTab.children(".h_tab-icon");var title=newTab.children(".h_tab-title");title.css({width:parseInt(_this.tabWidth)-icon.outerWidth()})}this.position=this.params.position||"top";this.isVertical=this.position=="left"||this.position=="right";this.tabWrap.data("isVertical",this.isVertical);var tabWrapUl=this.tabWrapUl;if(this.isVertical){var liWidth=tabWrapUl.children("li:eq(0)").width();this.contentsDiv.css("margin-"+this.position,this.tabsDiv.outerWidth())}newContent.attr("lazyload",params.url||"");whenTabEdit.call(this);this.activate(ref);return ref},removeTab:function(name){var tab=this.getTab(name);if(!tab||!tab.length){return}if(isActive(tab)){var closestTab=getClosest(tab);if(!closestTab||!closestTab.length){Horn.Msg.alert("提示","至少要有一个页签");return}this.activate(closestTab)}tab.data("content").remove();tab.remove();whenTabEdit.call(this)},closeTab:function(name){this.removeTab(name)},renderTab:function(content,bp){content.children().remove();if((bp.html&&bp.html.length>3)||(bp.jsCode&&bp.jsCode.length>3)){BigPipe.onArrive(bp);Horn.setCurrent(content);BigPipe.start();Horn.init()}content.data("loaded",true)},activate:function(name){var tab=this.getTab(name);if(tab&&tab.length&&tab.is(":visible")){selectTab.call(this,tab)}},locate:function(o){this.activate(o)},enable:function(name){var tab=this.getTab(name).show();whenTabEdit.call(this);this.activate(tab)},disable:function(name){var tab=this.getTab(name);if(!tab||!tab.length){return}if(isActive(tab)){var closestTab=getClosest(tab);if(!closestTab||!closestTab.length){Horn.Msg.alert("提示","至少要有一个页签");return}this.activate(closestTab)}tab.hide().data("content").hide();whenTabEdit.call(this)},setIframeUrl:function(id,url){if(id&&url){var _this=this;var tabContent=_this.contentsDiv.find('div[iframeID="'+id+'"]');if(tabContent.length>0){tabContent.attr("iframeurl",url);if(tabContent.css("display")==="block"){$("#"+id).attr("src",url);$("body").doMask("正在加载,请稍后...");$("#"+id).load(function(){$("body").doUnMask()})}}}else{return}},doLayout:function(){}});function selectTab(tab){if(!tab||!tab.length){return false}var ref=tab.attr("ref");var currentTab=this.getCurrentTab();if(currentTab&&currentTab.length){if(currentTab.attr("ref")!=ref){var currentContent=currentTab.data("content");if(!whenTabChange.call(this,currentTab,currentContent)){return}currentTab.removeClass("h_cur");currentContent.hide();this.tabChange(currentTab,tab)}else{}}this.currentTabName=ref;tab.addClass("h_cur");var content=tab.data("content").show();var iframeId=content.attr("iframeID");var url=content.attr("lazyload");if(url&&!content.data("loaded")){var contentId=content.attr("id");url=(url.indexOf("?")===-1?url+"?":url+"&")+"pagelet="+contentId;var _this=this;requestPage.call(this,{id:contentId,url:url,content:content,success:function(){moveToCenter.call(_this,tab)}})}else{moveToCenter.call(this,tab)}if(iframeId){if(!content.data("loaded")){var iframeUrl=content.attr("iframeUrl");$("#"+iframeId).attr("src",iframeUrl);$("body").doMask("正在加载,请稍后...");$("#"+iframeId).load(function(){$("body").doUnMask();if($(this).attr("height")==undefined){var height=$(this).contents().height();$(this).height(height+"px")}});content.data("loaded",true)}else{return}}}function moveToCenter(tab,noDelay){var tabWrap=this.tabWrap;tabWrap.stop(false,true);scroll.call(this,calculateActualScroll.call(this,tab,tabWrap),noDelay)}function isCoverByScroller(tab){var tabOffset=tab.offset();var d=8;if(this.isVertical){var topScroller=this.topScroller;var bottomScroller=this.bottomScroller;var tabHeight=tab.outerHeight();var coverByTopScroller=topScroller.is(":visible")&&tabOffset.top<=topScroller.offset().top+topScroller.outerHeight()+d;var coverByBottomScroller=bottomScroller.is(":visible")&&tabOffset.top+tabHeight+d>=bottomScroller.offset().top;return coverByTopScroller||coverByBottomScroller}else{var leftScroller=this.leftScroller;var rightScroller=this.rightScroller;var tabWidth=tab.outerWidth();var coverByLeftScroller=leftScroller.is(":visible")&&tabOffset.left<=leftScroller.offset().left+leftScroller.outerWidth()+d;var coverByRightScroller=rightScroller.is(":visible")&&tabOffset.left+tabWidth+d>=rightScroller.offset().left;return coverByLeftScroller||coverByRightScroller}}function calculateActualScroll(tab,tabWrap){var actualScroll=0;var scrollLength=tabWrap.data("scrollLength");if(isCoverByScroller.call(this,tab)){if(this.isVertical){var tabHeight=tab.outerHeight();var wrapHeight=tabWrap.outerHeight();var p1=tab.position().top;var p2=(wrapHeight-tabHeight)/2;var scrollTop=this.tabWrap.scrollTop()+p1-p2;actualScroll=scrollTop+wrapHeight>scrollLength?(scrollLength-wrapHeight):scrollTop}else{var tabWidth=tab.outerWidth();var wrapWidth=tabWrap.outerWidth();var p1=tab.position().left;var p2=(wrapWidth-tabWidth)/2;var scrollLeft=this.tabWrap.scrollLeft()+p1-p2;actualScroll=scrollLeft+wrapWidth>scrollLength?(scrollLength-wrapWidth):scrollLeft}}else{actualScroll=this.isVertical?tabWrap.scrollTop():tabWrap.scrollLeft()}return actualScroll}function scroll(distance,noDelay){if(this.isVertical){scrollTop.call(this.tabWrap,distance,noDelay)}else{scrollLeft.call(this.tabWrap,distance,noDelay)}}function scrollLeft(distance,noDelay){var wrapWidth=this.outerWidth();var scrollLength=this.data("scrollLength");distance=distance!=undefined?distance:this.scrollLeft();distance=distance+wrapWidth>scrollLength?(scrollLength-wrapWidth):distance;this.animate({scrollLeft:distance},noDelay?0:250,function(){locateScroller.call($(this))})}function scrollTop(distance,noDelay){var scrollLength=this.data("scrollLength");var wrapHeight=this.outerHeight();distance=distance!=undefined?distance:this.scrollTop();distance=distance+wrapHeight>scrollLength?(scrollLength-wrapHeight):distance;this.animate({scrollTop:distance},noDelay?0:250,function(){locateScroller.call($(this))})}function locateScroller(){if(this.data("isVertical")){var topScroller=this.siblings(".h_tabscroller-top");var bottomScroller=this.siblings(".h_tabscroller-bottom");var scrollTop=this.scrollTop();if(scrollTop==0){topScroller.hide()}else{topScroller.show()}if((scrollTop+this.outerHeight())<this.data("scrollLength")){bottomScroller.css("top",this.outerHeight()-25);bottomScroller.show()}else{bottomScroller.hide()}}else{var leftScroller=this.siblings(".h_tabscroller-left");var rightScroller=this.siblings(".h_tabscroller-right");var scrollLeft=this.scrollLeft();if(scrollLeft==0){leftScroller.hide()}else{leftScroller.show()}if((scrollLeft+this.outerWidth())<this.data("scrollLength")){rightScroller.show()}else{rightScroller.hide()}}}function calculateScrollLength(){var v=this.isVertical;var tabWrap=this.tabWrap;var tabWrapUl=tabWrap.children("ul");var tabsTotalLength=0;tabWrapUl.children("li:visible").each(function(i,o){var $this=$(this);var margin,size;if(v){margin=parseInt($this.css("margin-top"))+parseInt($this.css("margin-bottom"));size=$this.outerHeight()}else{margin=parseInt($this.css("margin-left"))+parseInt($this.css("margin-right"));size=$this.outerWidth()}tabsTotalLength+=size+margin});tabsTotalLength+=(v?20:40);tabWrap.data("scrollLength",tabsTotalLength);return tabsTotalLength}function initScrollerEvents(){var tabWrap=this.tabWrap;this.leftScroller.click(function(){scrollLeft.call(tabWrap,tabWrap.scrollLeft()-150)});this.rightScroller.click(function(){scrollLeft.call(tabWrap,tabWrap.scrollLeft()+150)});this.topScroller.click(function(){scrollTop.call(tabWrap,tabWrap.scrollTop()-104)});this.bottomScroller.click(function(){scrollTop.call(tabWrap,tabWrap.scrollTop()+104)})}function isActive(tab){return tab.hasClass("h_cur")}function getClosest(jq){if(!jq||!jq.length){return undefined}var closest=jq.nextAll(":visible:first");return closest.length?closest:jq.prevAll(":visible:first")}function requestPage(params){var _this=this;$.ajax(params.url,{type:"get",error:function(xhr,textStatus,errorThrown){_this.renderTab(params.content,{html:"",id:params.id||"",css:[],js:[],jsCode:""});if(params.callback){params.callback()}},success:function(reqData,textStatus,jqXHR){_this.renderTab(params.content,eval("("+reqData+")"));if(params.success){params.success()}if(params.callback){params.callback()}}})}function whenTabChange(tab,content){if(!this.isFormValidate){var tipDiv=$(".m-verify-tip");if(tipDiv){tipDiv.each(function(){var msgInBody=$(this).attr("msgInBody");if(msgInBody&&msgInBody=="true"){$(this).hide()}})}return true}if(!Horn.Validate.isFormValidate(content)){var title=tab.attr("title");if(title!="该页签下有未验证通过的内容"){tab.attr("title","该页签下有未验证通过的内容").append('<span class="h_tabli-error"></span>')}tab.data("content").show();return false}tab.attr("title",tab.attr("tipMsg")).find("span.h_tabli-error").remove();return true}function whenTabEdit(){calculateScrollLength.call(this);scroll.call(this)}function createTab(ref,title,width){var tab=[];tab.push('<li ref="'+ref+'" title="'+title+'" tipMsg="'+title+'"');tab.push(' class="h_tabpanel-wrap-li" style="width:'+width+'"><a href="javascript:void(0)">');tab.push('<span class="h_tab-arrow"></span>');tab.push('<span class="h_tab-icon"></span>');tab.push('<span class="h_tab-title">'+title+"</span>");tab.push("</a></li>");return $(tab.join(""))}function createContent(ref,refID){return $('<div style="display: block" class="h_tabpanel-content" ref_target="'+ref+'" id="'+refID+'"></div>')}function initTabPosition(p){this.position=p||this.params.position||"top";this.isVertical=this.position=="left"||this.position=="right";this.tabWrap.data("isVertical",this.isVertical);var _this=this;var tabWrapUl=this.tabWrapUl;if(this.isVertical){var liWidth=tabWrapUl.children("li:eq(0)").width();tabWrapUl.children("li").width(liWidth);tabWrapUl.width("auto").width(tabWrapUl.width()-1);this.contentsDiv.css("margin-"+this.position,this.tabsDiv.outerWidth())}var height=(this.params.height||"")+"";if(height){height=height.match(/[px|%]+$/)?height:height+"px";if(this.isVertical){tabWrapUl.height(5000);this.tabWrap.height(parseInt(height)+2)}this.tabWrap.unbind().mousewheel(function(event,delta){event.preventDefault();var $this=$(this);var scrollOffset=_this.isVertical?$this.scrollTop():$this.scrollLeft();if(delta>0){scroll.call(_this,scrollOffset-80,true)}else{scroll.call(_this,scrollOffset+80,true)}})}else{if(this.params.tabFloat){this.tabsDiv.floatTop()}}}$.extend(Horn.TabPanel,{DATANAME:"h_tabpanel",get:function(name){var arr=Horn.data(Horn.TabPanel.DATANAME);var tabPanel=arr[0];return tabPanel},locate:function(obj){Horn.TabPanel.get().locate(obj)},activate:function(obj){Horn.TabPanel.get().activate(obj)},enable:function(obj){Horn.TabPanel.get().enable(obj)},disable:function(obj){Horn.TabPanel.get().disable(obj)}});Horn.regUI("div.h_tabpanel",Horn.TabPanel)})(Horn);(function(d){d.extend(d.fn,{floatLeft:function(){return this._float("left")},floatTop:function(){return this._float("top")},floatRight:function(){return this._float("right")},floatBottom:function(){return this._float("bottom")},floatCenter:function(){return this.floatLeft().floatTop().floatRight().floatBottom()},_float:function(l){return this.each(function(){b.call(d(this),null,l)})},cancelFloat:function(){return k.call(this)}});function a(m){var n=document,l=n.compatMode=="BackCompat"?n.body:n.documentElement;if(m=="width"){return l.clientWidth}else{if(m=="height"){return l.clientHeight}}return undefined}function b(n,m){n=n||d(window);var l=this;n.scroll(d.data(this[0],"scrollOnFloat",function(){if(!l.data("hasFloat")){f.call(l)}var p=d(this);var q=l.data(),u=q.offset;var s=p.scrollTop(),t=p.scrollLeft();var o,r=undefined;switch(m){case"left":o=t-u.left;r="right";break;case"top":o=s-u.top;r="bottom";break;case"right":o=u.left+l.outerWidth()-t-a("width");r="left";break;case"bottom":o=u.top+l.outerHeight()-s-a("height");r="top";break;default:o=t-u.left;r="right"}if(q.fixed[r]){return}if(o>0){g.call(l,m,{left:t,top:s},r)}else{e.call(l,m)}}))}function k(m){var l=this;m=m||["top","left","bottom","right"];d.each(m,function(o,n){e.call(l,n)});d(window).unbind("resize",this.data("resizeOnFloat")).unbind("scroll",this.data("scrollOnFloat"))}function f(){this.data({hasFloat:true,isAbsolute:this.css("position")=="absolute",page:undefined,fixed:{},style:this.attr("style"),offset:this.offset()});var l=this;d(window).resize(d.data(this[0],"resizeOnFloat",function(){if(l.css("position")=="fixed"){var o=l.next(),n=o.offset(),m=l.data("fixed");if(!m.left&&!m.right){l.css("left",n.left)}else{if(!m.top&&!m.bottom){l.css("top",n.top)}}l.css({width:o.width()}).data({offset:o.offset()})}else{l.data({offset:l.offset()})}}))}function g(m,l,q){var p=this.data(),r=p.offset;var o=c(this,m);if(o){this.css(o,0)}else{if(!p.fixed[m]){var n=this.outerWidth();if(!p.isAbsolute){this.clone().css("visibility","hidden").insertAfter(this)}this.css({position:"fixed",marginLeft:"auto",marginTop:"auto",width:n,zIndex:99999})}this.css({left:r.left-l.left,top:r.top-l.top})}p.fixed[m]=true;this.css(m,0);if(q){this.css(q,"auto")}}function e(l){var m=this.data();if(m.fixed&&m.fixed[l]){m.fixed[l]=false;if(c(this,l)==undefined){if(!m.isAbsolute){this.next().remove()}this.removeAttr("style").attr("style",m.style)}}}function c(m,l){var n=undefined;var q=m.data("fixed");for(var o in q){if(l!=o&&q[o]){n=o;break}}return n}function i(l){l+="";l=l?l:"0px";l=l.replace(/^\s+|\s+$/g,"");return l.match(/[px|%|auto]+$/)?l:l+"px"}function j(l){return l?Horn.paramCaches[l.attr("paramcacheid")]||{}:{}}function h(m,l){if(m.currentStyle){return m.currentStyle[l]}else{return getComputedStyle(m,false)[l]}}})(jQuery);(function(n,p,u){var w=n([]),s=n.resizes=n.extend(n.resizes,{}),o,l="setTimeout",m="resizes",t=m+"-special-event",v="delay",r="throttleWindow";s[v]=250;s[r]=true;n.event.special[m]={setup:function(){if(!s[r]&&this[l]){return false}var a=n(this);w=w.add(a);n.data(this,t,{w:a.width(),h:a.height()});if(w.length===1){q()}},teardown:function(){if(!s[r]&&this[l]){return false}var a=n(this);w=w.not(a);a.removeData(t);if(!w.length){clearTimeout(o)}},add:function(b){if(!s[r]&&this[l]){return false}var c;function a(d,h,g){var f=n(this),e=n.data(this,t);e.w=h!==u?h:f.width();e.h=g!==u?g:f.height();c.apply(this,arguments)}if(n.isFunction(b)){c=b;return a}else{c=b.handler;b.handler=a}}};function q(){o=p[l](function(){w.each(function(){var d=n(this),a=d.width(),b=d.height(),c=n.data(this,t);if(a!==c.w||b!==c.h){d.trigger(m,[c.w=a,c.h=b])}});q()},s[v])}})(jQuery,this);
Horn.TargetSelect=Horn.extend(Horn.Field,{COMPONENT_CLASS:"TargetSelect",field:null,hidden:null,name:null,alias:null,callback:null,init:function(d){Horn.TargetSelect.superclass.init.apply(this,arguments);var e=this;this.select=this.el;this.hidden=this.select.children("input[type='hidden']");this.field=this.hidden.next();this.name=this.hidden.attr("name");this.alias=this.hidden.attr("alias")||"";if(this.params.afterClear){var b=this.params.afterClear.replace("(","").replace(")","");this.callback=window[b]}var e=this;this.el.children("a").find(".fa-close").bind({click:Horn.Util.apply(e.delVal,e)});var c=this.params.value;if(c&&c!=""){this.setValue(c)}var a=this.params.readonly+"";if(a=="false"){this.field.attr("readonly",false)}this.field.keyup(function(h){var g=e.field.attr("readonly")+"";if(g&&g!="undefined"){}else{var f=$(this).val();e.hidden.val(f);e.field.attr("title",f)}e.validate()});this.field.blur(function(h){var g=e.field.attr("readonly")+"";if(g&&g!="undefined"){}else{var f=$(this).val();e.hidden.val(f);e.field.attr("title",f)}e.validate()})},setValue:function(a){var b=this.getValue();if(a==null||a==""){this.field.val("");this.hidden.val("")}else{if(a instanceof Object){if(a.id){this.field.val(a.name);this.hidden.val(a.id)}else{this.field.val(a.label);this.hidden.val(a.key)}}else{this.field.val(a);this.hidden.val(a)}}if(a&&a.key!=b){this.getEventTarget().trigger("change")}this.validate();this.clearOrResetTitle()},validate:function(){if(this.disabled){return}var a=this;var b=a.getIEVersion();if(b!=-1&&b<10){if(a.params.emptyText&&a.params.emptyText!=""&&a.field.val()==a.params.emptyText){a.field.val("")}}if(!this.skipValid){if(this.hidden.val()!=""){this.el.next("div.m-verify-tip").remove()}Horn.Validate.onValid({data:[Horn.Validate,a]})}},getText:function(){var a=this.field.val();return a},delVal:function(){if(this.params.disabled){return}var b=this;var a=this.field.val();if(a!=""){Horn.Msg.confirm("确认","你确定要清除该值？",function(){b.hidden.val("");b.field.val("");if(b.callback){b.callback()}b.validate()},function(){})}}});Horn.Field.regFieldType("div.hc_inputsearch",Horn.TargetSelect);


(function(a){a.TipBox=a.extend(a.Base,{init:function(b){Horn.TipBox.superclass.init.apply(this,arguments);this.el.appendTo($("body"))},getTipBox:function(b){return this.children(".hc_tip-"+b)}});Horn.regUI("div.hc_tip-list",Horn.TipBox)})(Horn);(function(c){var d={message:"提示信息",location:"auto",type:"error",event:"hover",style:"",timeout:undefined};c.extend(c.fn,{addTip:function(f){f=f||d;if(typeof f=="string"){f=c.extend({},d,{message:f})}else{f=c.extend({},d,f)}if(this.length>1){return this.each(function(g,h){c(this).addTip(f)})}if(!this.data("tip")){this.data("tip",c.extend({},f,{tipList:c(document.body).children(".hc_tip-list"),timeouts:[]}));if(f.event=="hover"){this.hover(this.tipBoxEnter=function(){var i=c(this);var j=i.offset();var k=i.data("tip");e(k.timeouts);var g=b.call(i);var h=k.tipBox;k.timeouts.push(setTimeout(function(){h.css({left:j.left,top:g=="down"?j.top+i.outerHeight()+"px":j.top-40+"px"});h.find(".hc_tip-content").html(k.message||"");h.fadeIn(200,function(){if(f.timeout){k.timeouts.push(setTimeout(function(){h.fadeOut(300);k.timeouts.splice(k.timeouts.length-1)},f.timeout))}});k.timeouts.splice(k.timeouts.length-1)},300))},this.tipBoxLeave=function(){var g=c(this).data("tip");e(g.timeouts);g.tipBox.fadeOut(260)})}}this.data("tip").message=f.message;return this},removeTip:function(){return this.unbind("mouseenter",this.tipBoxEnter).unbind("mouseleave",this.tipBoxLeave).data({tip:null})},positionTo:function(i){i=i||c("body");var h={left:0,top:0};var m=this.get(0),g=m.tagName.toUpperCase();var j=this.offsetParent();if(j[0]!=i[0]&&g!="HTML"&&g!="BODY"){h=j.positionTo(i);var f=0,l=0;if(j.css("borderWidth")!="medium"&&j.css("boxSizing")!="border-box"){f=parseInt(j.css("borderLeftWidth"));l=parseInt(j.css("borderTopWidth"))}h={left:h.left+f,top:h.top+l}}var k=this.position();return{left:h.left+k.left,top:h.top+k.top}}});function b(){var h=this.data("tip"),f=h.location;if(f=="auto"){var g=document.body.scrollTop||document.documentElement.scrollTop;f=this.offset().top-g<40?"down":"up"}h.tipBox=h.tipList.children(".hc_tip-"+f);return f}function e(f){if(!f){return}if(typeof f=="string"){clearTimeout(f)}else{c.each(f,function(g,h){clearTimeout(h)});f.splice(0)}}function a(g,f){}})(jQuery);
Horn.Treetable=Horn.extend(Horn.Base,{COMPONENT_CLASS:"treetable",id:"dyncTreetable",name:"dyncTreetable",title:"",data:null,selectModel:"",items:[],subSelectModel:"",url:"",emptyMsg:"",suburl:"",groupkey:"",rowSelect:false,hasPage:false,toolbar:null,pagebar:null,pageinfo:{totalPagesText:"页，每页{pagesize}条,共{pages}页",displayMsg:"当前显示{from}到{to}，共{total}条记录"},reqPageNo:1,reqPageSize:10,init:function(){Horn.Treetable.superclass.init.apply(this,arguments);this.name=this.params.name||this.name;var a=this;if(a.params.id&&a.params.id!=""){a.id=a.params.id}else{if(a.params.name&&a.params.name!=""){a.id=a.params.name}}a.hasPage=a.params.hasPage?a.params.hasPage:a.hasPage;$.each(this.params.events||[],function(b,c){a[c.event.toLowerCase()]=c["function"]});a.initElement();a.processReqConf();if(!a.params.pageConfig){a.pageConfig={}}if(a.params.url&&a.params.url!=""){a.load(a.params.url)}if(this.params.subSelectModel&&a.params.subSelectModel!=""){a.subSelectModel=this.params.subSelectModel}},initElement:function(){var b=this;b.title=b.params.title||null;b.titleEl=null;b.table=b.el.find("#treetable_"+this.id);b.header=b.table.find("#treetableHeader_"+this.id+">tr");b.tbody=b.table.find("#treetablebody_"+this.id);if(b.title){b.titleEl=b.el.find(".u-datagrid-header>h4")}var a=b.params.isDrag+"";if(a=="true"){b.header.find(".u-groupgrid-cell").resizable({autoHide:true,minHeight:35,maxHeight:35,resize:function(f,g){var e=g.size.width;var h=$(g.element[0]).parent();$(g.element[0]).parent().css("width",e);var d=h.index();var c=b.table.find(".tree-table-bg");c.each(function(j,i){var k=$(i);$(k.children("td").get(d)).css("width",e);$(k.children("td").get(d)).children("div").css("width",e)})}})}if(b.params.hasPage&&b.params.hasPage==true){b.createPagebar()}},initEvents:function(){var a=this;a.initGroupBtn();a.initHeighlightEvent();if(a.params.selectModel&&a.params.selectModel!=""){a.initSelectEvent()}},initsubTableDrag:function(a){var c=this;var b=a.find("thead");b.find(".subtable-header").resizable({autoHide:true,minHeight:35,maxHeight:35,resize:function(g,h){var f=h.size.width;var i=$(h.element[0]).parent();$(h.element[0]).parent().css("width",f);var e=i.index();var d=a.find("tbody>tr");d.each(function(k,j){var l=$(j);$(l.children("td").get(e)).css("width",f);$(l.children("td").get(e)).children("div").css("width",f)})}})},initHeighlightEvent:function(){var b=this;var a=this.table.find("tbody>tr.tree-table-bg");a.each(function(d,c){var e=$(c);e.on("click",function(j){var i=$(j.target);var f=i.index();if(b.params.rowSelect){if(i.attr("type")=="checkbox"||i.attr("type")=="radio"){return}if(b.params.selectModel=="multi"){if(e.hasClass("u-table-selected")){b.isRowSelect(false,e,d)}else{b.isRowSelect(true,e,d)}b.setGroupcheckStatus(e)}else{if(e.hasClass("u-table-selected")){if(b.lastselect.index==f){b.lastselect={}}b.isRowSelect(false,e,f)}else{if(b.lastselect&&b.lastselect.index!=f){b.isRowSelect(false,b.lastselect.tr,b.lastselect.index)}b.isRowSelect(true,e,f)}}}if(b.rowclick){var h=Horn.Util.getFunObj(b.rowclick),g;var k=h.params;var m=e.attr("index");var l=b.data[m];k.push(l);if($.type(h.fn)=="function"){g=h.fn}if(g){g.apply(b,k)}return}}).on("dblclick",function(){if(b.rowdblclick){var g=Horn.Util.getFunObj(b.rowdblclick),f;var h=g.params;var j=e.attr("index");var i=b.data[j];h.push(i);if($.type(g.fn)=="function"){f=g.fn}if(f){f.apply(b,h)}return}})})},initsubHeighlightEvent:function(b){var c=this;var a=b.find("tbody>tr");a.each(function(e,d){var f=$(d);f.on("click",function(k){var l=$(k.target);var o=l.index();if(c.params.rowSelect){if(l.attr("type")=="checkbox"||l.attr("type")=="radio"){return}if(c.params.subSelectModel=="multi"){if(f.hasClass("u-table-selected")){c.subRowSelect(false,f,j)}else{c.subRowSelect(true,f,j)}c.setSubGroupcheckStatus(f,b)}else{if(f.hasClass("u-table-selected")){c.subRowSelect(false,f,o)}else{a.removeClass("u-table-selected");c.subRowSelect(true,f,o)}}}if(c.subrowclick){var n=Horn.Util.getFunObj(c.subrowclick),h;var g=n.params;var m=f.closest(".u-datagrid-sub").parent().attr("id");var j=c.table.find('tr[reftab="'+m+'"]').attr("index");var q=c.data[j];var p=f.data()["rowdata"];var i={};i.maindata=q;i.rowdata=p;g.push(i);if($.type(n.fn)=="function"){h=n.fn}if(h){h.apply(c,g)}return}}).on("dblclick",function(){if(c.subrowdblclick){var i=Horn.Util.getFunObj(c.subrowdblclick),m;var l=i.params;var k=f.closest(".u-datagrid-sub").parent().attr("id");var g=c.table.find('tr[reftab="'+k+'"]').attr("index");var h=c.data[g];var n=f.data()["rowdata"];var j={};j.maindata=h;j.rowdata=n;l.push(j);if($.type(i.fn)=="function"){m=i.fn}if(m){m.apply(c,l)}return}})})},initGroupBtn:function(){var b=this;var a=b.table.find(".tree-table-bg");a.each(function(c,e){var e=$(e);var d=e.find(".fa-stack");d.on("click",function(){var f=e.closest("tr");if(f.hasClass("active")){f.removeClass("active");b.expandsubTable(false,f)}else{f.addClass("active");b.expandsubTable(true,f)}})})},expandsubTable:function(j,h){var b=this;var c=h.attr("reftab");var i=b.el.find("#"+c);if(b.params.subUrl&&b.params.subUrl!=""){var f=b.params.subUrl}else{return}if(j){if(b.subbeforeload){var g=Horn.Util.getFunObj(b.subbeforeload),a;if($.type(g.fn)=="function"){a=g.fn}if(a){try{a.apply(b,[b.el])}catch(d){Horn.debug(d)}}}b.getSubData(f,h)}else{i.hide()}},initSelectEvent:function(){var a=this;if(a.params.selectModel&&a.params.selectModel=="multi"){a.initMulSelectEvent()}else{a.initSglSelectEvent()}},initSubSelect:function(a){var b=this;if(b.subSelectModel=="multi"){b.initsubMulEvent(a)}else{b.initsubSglEvent(a)}},initMulSelectEvent:function(){var d=this;var b=d.table.find("tbody>tr.tree-table-bg");var a=d.el.find('input[name="selectall"]'),c=d.table.find("tr.tree-table-bg").length-1;a.change(function(){if(this.checked){d.selectAll(true)}else{d.selectAll(false)}});b.each(function(g,i){var h=$(i);var e=h.find('input[type="checkbox"]');var f=e.attr("name");e.change(function(){if(this.checked){d.isRowSelect(true,h,g)}else{d.isRowSelect(false,h,g)}d.setGroupcheckStatus(h)})})},initsubMulEvent:function(d){var e=this;var b=d.find("tbody>tr");var a=d.find('input[name="subcheckAll"]'),c=d.find("tbody>tr").length-1;a.change(function(){if(this.checked){e.subselectAll(true,$(this))}else{e.subselectAll(false,$(this))}});b.each(function(h,j){var i=$(j);var f=i.find('input[type="checkbox"]');var g=f.attr("name");f.change(function(){if(this.checked){e.subRowSelect(true,i,h)}else{e.subRowSelect(false,i,h)}e.setSubGroupcheckStatus(i,d)})})},initsubSglEvent:function(b){var c=this;var a=b.find("tbody>tr");a.each(function(e,g){var f=$(g);var d=f.find('input[type="radio"]');d.change(function(){if(this.checked){a.removeClass("u-table-selected");c.subRowSelect(true,f,e)}else{c.subRowSelect(false,f,e)}})})},subRowSelect:function(a,b){if(a){b.addClass("u-table-selected");if(this.params.subSelectModel&&this.params.subSelectModel=="single"){b.find("input[type='radio']").prop("checked",true)}else{if(this.params.subSelectModel&&this.params.subSelectModel=="multi"){b.find("input[type='checkbox']").prop("checked",true)}}}else{b.removeClass("u-table-selected");if(this.params.subSelectModel&&this.params.subSelectModel=="single"){b.find("input[type='radio']").prop("checked",false)}else{if(this.params.subSelectModel&&this.params.subSelectModel=="multi"){b.find("input[type='checkbox']").prop("checked",false)}}}},initSglSelectEvent:function(){var b=this;var a=b.table.find("tbody>tr.tree-table-bg");a.each(function(d,f){var e=$(f);var c=e.find('input[type="radio"]');c.change(function(){if(this.checked){if(b.lastselect&&b.lastselect.index!=d){b.isRowSelect(false,b.lastselect.tr,b.lastselect.index)}b.isRowSelect(true,e,d)}else{b.isRowSelect(false,e,d)}})})},isRowSelect:function(a,c,b){if(a){c.addClass("u-table-selected");this.lastselect={rowindex:b,tr:c};if(this.params.selectModel&&this.params.selectModel=="single"){c.find("input[type='radio']").prop("checked",true)}else{if(this.params.selectModel&&this.params.selectModel=="multi"){c.find("input[type='checkbox']").prop("checked",true)}}}else{c.removeClass("u-table-selected");if(this.params.selectModel&&this.params.selectModel=="single"){c.find("input[type='radio']").prop("checked",false)}else{if(this.params.selectModel&&this.params.selectModel=="multi"){c.find("input[type='checkbox']").prop("checked",false)}}}},setGroupcheckStatus:function(b){var d=this,a=d.el.find('input[name="selectall"]'),c=d.table.find("tr.tree-table-bg").length;if(d.table.find('tr.tree-table-bg input[name!="selectall"]:checked').length==c){a.prop("checked",true)}else{a.prop("checked",false)}},setSubGroupcheckStatus:function(c,b){var e=this,a=b.find('input[name="subcheckAll"]'),d=b.find("tbody>tr").length;if(b.find('tr input[name!="subcheckAll"]:checked').length==d){a.prop("checked",true)}else{a.prop("checked",false)}},getSubData:function(d,e){var h=this;var g=e.attr("reftab");var c=e.attr("index");var a=h.el.find("#"+g);if(d&&d.indexOf("http:")==-1){d=context_path+d}var f={};f.parentRowdata=JSON.stringify(h.data[c]);f.groupkey=h.params.groupkey||"";a.show();var b=h.header.children().length;$.ajax(d,{async:true,beforeSend:function(i){a.find(".u-datagrid").html("");a.find(".u-datagrid").html('<tr><td style="border-right:0px;padding:15px;" colspan=\''+b+"'><img src='"+context_path+"/components/datagrid/img/hc_onLoad.gif'></img></td></tr>")},type:"POST",data:Horn.Util.obj2Arr(f),dataType:"json",error:function(k,l,j){var i=k.status;h.loadErrorCallback(l,a)},success:function(i,j,q){var o='<tr><td style="border-right:0px;padding:15px;" colSpan=\''+b+"'><p>暂时无数据</p></td></tr>";if(!i||$.isEmptyObject(i)){a.find(".u-datagrid").empty().html(o);if(h.subloaderror){var k=Horn.Util.getFunObj(h.subloaderror),m;if($.type(k.fn)=="function"){m=k.fn}if(m){m.apply(h,[h.el,i])}return}}else{var l=i.rows;if(l&&(l.length==0||$.isEmptyObject(l))){a.find(".u-datagrid").empty().html(o)}else{h.createSubtable(l,a)}try{if(h.subloadsuccess){var p=Horn.Util.getFunObj(h.subloadsuccess),r;if($.type(p.fn)=="function"){r=p.fn}if(r){r.apply(h,[h.el,i])}}}catch(n){Horn.debug(n)}}}})},createPagebar:function(){var a=this;if(a.params.pageConfig){a.pagebar=new Horn.treetable_Pagebar(a.params.pageConfig,a.id,a)}},load:function(a,b){var c=this;b=b||{};if($.type(b)=="array"){b=Horn.Util.arr2Obj(b)}c.reqPageNo=b.pageNo||c.reqPageNo;c.reqPageSize=b.pageSize||c.reqPageSize;if(c.hasPage){b.pageNo=c.reqPageNo;b.pageSize=c.reqPageSize}c.execute(a,b)},execute:function(d,c){c=c||{};var f=true;if(this.beforeload){var b=Horn.Util.getFunObj(this.beforeload),h;if($.type(b.fn)=="function"){h=b.fn}if(h){try{f=h.apply(this,[this.el,c])}catch(g){}}}if(f!=false){var a=Horn.apply({},this.baseParams,c);this.doAjax(d,a)}return f},doAjax:function(b,c){var d=this;var b=b?b:d.params.url;if(b&&b.indexOf("http:")==-1){b=context_path+b}var a=d.header.children().length;$.ajax(b,{async:true,beforeSend:function(e){d.tbody.html("");d.tbody.html('<tr><td style="border-right:0px;padding:15px;" colspan=\''+a+"'><img src='"+context_path+"/components/datagrid/img/hc_onLoad.gif'></img></td></tr>");d.tbody.parent().addClass("u-groupgrid-loading")},type:"POST",data:Horn.Util.obj2Arr(c),dataType:"json",error:function(g,h,f){var e=g.status;d.tbody.parent().removeClass("u-groupgrid-loading");d.loadErrorCallback(h)},success:function(f,l,h){var j='<tr><td style="border-right:0px;padding:15px;" colSpan=\''+a+"'><p>暂时无数据</p></td></tr>";d.loadSuccessCallback(f,j);try{if(d.loadsuccess){var k=Horn.Util.getFunObj(d.loadsuccess),g;if($.type(k.fn)=="function"){g=k.fn}if(g){g.apply(d,[d.el,f])}}}catch(i){Horn.debug(i)}}})},loadErrorCallback:function(d,a){var c=this;var b=c.header.children().length;if(a){a.find(".u-datagrid").html('<tr><td style="border-right:0px;padding:15px;" colspan=\''+b+"'><p>暂时无数据</p><p>错误状态："+status+";错误信息："+d+"</p></td></tr>");return}c.tbody.empty().html('<tr><td style="border-right:0px;padding:15px;" colSpan=\''+b+"'><p>暂时无数据</p><p>错误状态："+status+";错误信息："+d+"</p></td></tr>")},loadSuccessCallback:function(a,e){var f=this;f.tbody.parent().removeClass("u-groupgrid-loading");if(!a||$.isEmptyObject(a)){f.tbody.empty().html(e);if(f.loaderror){var c=Horn.Util.getFunObj(f.loaderror),b;if($.type(c.fn)=="function"){b=c.fn}if(b){b.apply(f,[f.el,a])}return}}else{var d=a.rows;f.initPagebar(a);if(d&&(d.length==0||$.isEmptyObject(d))){f.tbody.empty().html(e)}else{f.loadData(d)}}},loadData:function(a){var b=this;b.data=a;b.selecteds=$.extend(true,[],b.data);b.table.find("tbody").unbind().remove();b.creatMainTable(b.data)},creatMainTable:function(c){var k=this,g=[],f=g.length,l=c.length,n=k.header.children().length;var e=k.params.items;k.table.find("tbody").unbind().remove();for(var d=0;d<l;d++){g[f++]='<tr  class="tree-table-bg" index="'+d+'" reftab="subtable_'+d+'">';g[f++]='<td class="u-table-number"><div style="width: 40px;">';g[f++]='<span class="fa-stack"><i class="fa fa-square-o fa-stack-1x"></i><i class="fa fa-angle-down fa-stack-1x"></i></span>';g[f++]="</div>";g[f++]="</td>";if(k.params.selectModel=="multi"){g[f++]='<td class="u-table-check"><div  style="width:40px;"><input type="checkbox" name="'+k.name+'groupcheck"></div></td>'}else{if(k.params.selectModel=="single"){g[f++]='<td class="u-table-check"><div  style="width:40px;"><input type="radio" name="'+k.name+'groupcheck"></div></td>'}}for(var b=0;b<e.length;b++){var m=e[b]["name"],a=e[b]["width"];renderer=e[b]["renderer"];if(renderer){renderer=renderer}else{renderer=""}if(b==e.length-1){g[f++]='<td style="width:auto;" renderer="'+renderer+'"><div style="width:100px">'+c[d][m]+"</div></td>"}else{if(a){g[f++]='<td style="width:'+a+'px;" renderer="'+renderer+'" ><div style="width:'+a+'px">'+c[d][m]+"</div></td>"}else{g[f++]='<td style="width:100px" renderer="'+renderer+'"><div style="width:100px">'+c[d][m]+"</div></td>"}}}g[f++]="</tr>";g[f++]='<tr style="display:none" id="subtable_'+d+'"><td colspan="'+n+'" class="u-datagrid-sub"><div class="u-datagrid" style="display: block;"></div></td> </tr>'}k.storgedData=c;k.table.append(g.join(""));if(k.params.height&&!isNaN(k.params.height)){k.table.parent().height(k.params.height)}k.initEvents();k.columnRender()},columnRender:function(b){var c=this;var a;if(b){a=b.find("tbody>tr")}else{a=c.table.find("tbody>tr.tree-table-bg")}a.each(function(e,d){var f=$(d);f.find("td").each(function(g,i){var k=$(i);var h=k.attr("renderer");if(h&&h!=""){if(b){var j=f.data().rowdata;c.colRendererFunc(k,h,e,j)}else{c.colRendererFunc(k,h,e)}}})})},colRendererFunc:function(h,c,a,g){var f=this;h.attr("key",h.find("div").text());h.find("div").attr("title","");var b=Horn.Util.getFunObj(c);var e=h.find("div").html();if(!b.fn){return}if(g){var d=b.fn.call($(this),{val:e,rowdata:g,maindata:f.data})}else{var d=b.fn.call($(this),{val:e,rowdata:f.data[a],alldata:f.data})}if(d instanceof $){h.find("div").html("");h.find("div").append(d)}else{h.find("div").html(d)}},createSubtable:function(u,c){var q=this;var d;var m=c.find(".u-datagrid");var g=c.attr("id");m.html("");var h=$('<table class="u-datagrid-group"></table');var a=$("<tbody></tbody>");var t=$("<thead><tr></tr></thead");if(q.params.subSelectModel&&q.params.subSelectModel!=""){d=q.params.subSelectModel;if(d==="multi"){t.find("tr").append('<th class="u-table-check"><div style="width: 40px;"><input type="checkbox" name="subcheckAll"></div></th>')}else{t.find("tr").append('<th class="u-table-check"><div style="width: 40px;"></div></th>')}}var l=q.params.subItems;for(var s=0;s<l.length;s++){var e=$('<th><div class="subtable-header">'+l[s]["text"]+"</div></th>");t.find("tr").append(e)}for(var r=0;r<u.length;r++){var b=$("<tr></tr>");b.data("rowdata",u[r]);if(d==="multi"){b.append('<td class="u-table-check"><div style="width: 40px;"><input type="checkbox" name="item"></div></td>')}else{if(d==="single"){b.append('<td class="u-table-check"><div style="width: 40px;"><input type="radio" name="'+g+'item"></div></td>')}}for(var o=0;o<l.length;o++){var v=l[o]["name"];var p=l[o]["renderer"];var f=$('<td name="'+v+'" renderer="'+p+'"><div>'+u[r][v]+"</div></td>");b.append(f)}a.append(b)}h.append(t);h.append(a);m.append(h);if(q.subSelectModel){q.initSubSelect(m);q.initsubHeighlightEvent(m)}q.columnRender(m);var k=q.params.subDrag+"";if(k=="true"){q.initsubTableDrag(m)}},selectAll:function(b){var d=this;var a=d.table.find("tbody>tr.tree-table-bg");a.each(function(e,g){var f=$(g);d.isRowSelect(b,f,e)});var c=d.header.find("input[type='checkbox']");if(c.length>0){c.prop("checked",b)}},subselectAll:function(c,b){var g=this;var d=b.closest("table");var f=d.find("thead");var a=d.find("tbody>tr");a.each(function(h,j){var i=$(j);g.subRowSelect(c,i,h)});var e=f.find("input[type='checkbox']");if(e.length>0){e.prop("checked",c)}},processReqConf:function(){var d=this,b=d.params.pageConfig["pageNo"],a=d.params.pageConfig["pageSize"],c=$("#pageSize_"+d.id);if(a){c.val(a)}d.reqPageNo=d.reqPageNo?d.reqPageNo:b;d.reqPageSize=d.reqPageSize?d.reqPageSize:a},staticInitPagebar:function(){if(this.hasPage){var a=this.storgedData.length;if(this.pagebar){this.pagebar.setTotalCount(a);this.pagebar.calPage_(this.reqPageNo,this.reqPageSize,a);this.setPageInfo()}this.reqPageNo=this.reqPageNo+1}},initPagebar:function(a){if(this.hasPage){var b=a.total;if(this.pagebar){if(a!=null){$("#toPage_"+this.id).attr("disabled",false);$("#pageSize_"+this.id).attr("disabled",false)}this.pagebar.setTotalCount(b);this.pagebar.calPage_(this.reqPageNo,this.reqPageSize,b);this.setPageInfo()}}},pageBtnDisabled:function(a){if(a){$("#toPage_"+this.id).attr("disabled",true);$("#pageSize_"+this.id).attr("disabled",true);$("#page_"+this.id).find(".first_page_btn,.pre_page_btn").addClass("disabled");$("#page_"+this.id).find(".next_page_btn,.last_page_btn").addClass("disabled");$("#page_"+this.id).find(".refresh_btn").addClass("disabled")}else{$("#toPage_"+this.id).attr("disabled",false);$("#pageSize_"+this.id).attr("disabled",false);$("#page_"+this.id).find(".first_page_btn,.pre_page_btn").removeClass("disabled");$("#page_"+this.id).find(".next_page_btn,.last_page_btn").removeClass("disabled");$("#page_"+this.id).find(".refresh_btn").removeClass("disabled")}},setPageInfo:function(){$("#toPage_"+this.id).val(this.pagebar.currentPage);$("#pageSize_"+this.id).val(this.pagebar.pageSize);$("#totalPages_"+this.id).html(this.pagebar.pages);if((this.pagebar.pageSize%5)==0){var c=this.pagebar.pageSize/5;if(c==20){c=11}else{if(c==40){c=12}else{if(c==100){c=13}else{if(c==200){c=14}}}}var a=$($(".dropdown-menu-datagrid").find("li").get(c-1));a.addClass("active");this.pagebar.activeLi=a}var b=this.params.isNotTotal?this.params.isNotTotal+"":"false";if(b!="true"){$("#pageInfo_"+this.id).html(this.pagebar.getPageInfo())}if(1==this.pagebar.currentPage){$("#page_"+this.id).find(".first_page_btn,.pre_page_btn").addClass("disabled")}else{$("#page_"+this.id).find(".first_page_btn,.pre_page_btn").removeClass("disabled")}if(this.pagebar.pages==this.pagebar.currentPage){if(b!="true"){$("#page_"+this.id).find(".next_page_btn,.last_page_btn").addClass("disabled")}}else{$("#page_"+this.id).find(".next_page_btn,.last_page_btn").removeClass("disabled")}$("#page_"+this.id).find(".refresh_btn").removeClass("disabled")},reqPage:function(b,a){this.reqPageNo=b?b:this.reqPageNo;this.reqPageSize=a?a:this.reqPageSize;if(this.loadFlag!="autoLoad"&&this.storgedData){this.result=this.storgedData.slice((this.reqPageNo-1)*this.reqPageSize,this.reqPageNo*this.reqPageSize);if(!this.hasPage){this.result=this.storgedData}this.staticInitPagebar()}else{this.load()}},getId:function(){return this.id},resetToolbar:function(d){var g=this;var c=[];if(!d||d.length<1){return}var f=g.el.find("div.u-datagrid-toolbar").children("ul");f.empty();for(var b=0;b<d.length;b++){var a;switch(d[b].cls){case"add":a="fa-plus-circle";break;case"edit":a="fa-pencil-square-o";break;case"del":a="fa-remove";break;case"confirm":a="fa-save";break;case"save":a="fa-save";break;case"query":a="fa-search";break;case"open":a="fa-folder-open-o";break;case"refresh":a="fa-refresh";break;default:a=d[b].cls}var e=$('<li><a name="'+d[b].name+'" href="JavaScript:void(0)" class="hc-datagrid-a hc_datagrid-alink" onclick="'+d[b].event+'"><i class="fa '+a+'"></i>'+d[b].label+"</a></li>");f.append(e)}},getMainSelecteds:function(){var c=this;var b=c.table.find("tr.tree-table-bg.u-table-selected");var a=[];b.each(function(f,e){var g=$(e);var d=g.attr("index");a.push(c.data[d])});return a},setTitle:function(a){var b=this;b.title=a;b.titleEl.text(a)},getTitle:function(){return this.title}});Horn.Field.regFieldType("div.hc_treetable",Horn.Treetable);Horn.treetable_Pagebar=function(d,c,a){var b={gridId:null,INDEX_PAGE:1,currentPage:1,pageSize:10,pageCount:0,pages:0,startRow:0,isNotTotal:false,init:function(g,f,e){if(g){setDefaultValue(g,"pageSize",10);setDefaultValue(g,"pageNo",1);setDefaultValue(g,"startRow",0);setDefaultValue(g,"pageCount",0);setDefaultValue(g,"currentPage",0);this.currentPage=parseInt(g.currentPage);this.pageCount=parseInt(g.pageCount);this.pageSize=parseInt(g.pageSize);this.pageNo=parseInt(g.pageNo);this.startRow=parseInt(g.startRow);this.pages=0}this.gridId=f;this.grid=e;this.grid.reqPageSize=this.pageSize;this.grid.reqPageNo=this.pageNo;this.el=$("#page_"+this.gridId);var h=this.el.attr("isNotTotal");if(h=="true"){this.isNotTotal=true}},initEvents:function(){var e=this;$("#page_"+this.gridId).children("li").find("a").each(function(g,h){var i=$(h);var j=function(l,m,k){l.click(function(){if(l.hasClass("disabled")){return}k=k||[];m.apply(e,k)})};if(!i.hasClass("disabled")){if(i.hasClass("first_page_btn")){j(i,e.first)}else{if(i.hasClass("pre_page_btn")){j(i,e.pre)}else{if(i.hasClass("next_page_btn")){j(i,e.next)}else{if(i.hasClass("last_page_btn")){j(i,e.last)}else{if(i.hasClass("refresh_btn")){j(i,e.refresh)}}}}}}});this.perPage=false;$("#_recPerPage"+this.gridId).on("click",function(){optGridId=$(this).attr("id");optGridId=optGridId.substring(11);var g=$(this).children("strong").text();if(e.perPage){$(this).next().hide();e.perPage=false}else{$(this).next().show();$(this).next().find("li").each(function(h,i){var j=$(this).children("a").text();if(g==j){$(this).addClass("active")}else{$(this).removeClass("active")}});e.perPage=true}});$("#_recPerPage"+this.gridId).bind("blur",function(h){var g=h;if(e.perPage){$(".dropdown-menu-datagrid").hide();e.perPage=false;return true}});$(".dropdown-menu-datagrid").bind("mouseover",function(){$("#_recPerPage"+e.gridId).unbind("blur")});$(".dropdown-menu-datagrid").bind("mouseout",function(){$("#_recPerPage"+e.gridId).bind("blur",function(h){var g=h;if(e.perPage){$(".dropdown-menu-datagrid").hide();e.perPage=false;return true}})});this.activeLi=$(".dropdown-menu-datagrid").find("li.active");var f=this.grid;$("#toPage_"+f.id).on("blur",function(){e.callToPage($(this))});$("#pageSize_"+f.id).on("blur",function(){e.callToPageSize($(this))});$("#toPage_"+f.id).bind("keypress",function(g){if(g.keyCode=="13"){e.callToPage($(this))}});$("#pageSize_"+f.id).bind("keypress",function(g){if(g.keyCode=="13"){e.callToPageSize($(this))}})},callToPage:function(g){var f=this.grid;var e=g.val();if(!e||isNaN(e)){e=f.reqPageNo}e=parseInt(e,10);if(e<=0){e=1}else{if(e>f.pagebar.pages){e=1}}g.val(e);f.reqPage(g.val(),$("#pageSize_"+f.id).html())},callToPageSize:function(h){var g=this;var e=h.val();if(e==""){var f=g.pageSize;if(f&&f!=""){e=f}else{e=10}}if(!e||isNaN(e)){e=thatgrid.pageSize}e=parseInt(e,10);if(e<=0){e=1}h.val(e);g.grid.reqPage(parseInt($("#toPage_"+g.grid.id).val()),e)},calPage_:function(g,f,e){this.pageSize=parseInt(f);this.pageCount=parseInt(e);this.pages=Math.ceil(this.pageCount/this.pageSize);if(!this.isNotTotal){if((g*this.pageSize)>this.totalCount){this.currentPage=this.pages}else{this.currentPage=g}}else{if(this.currentPage==0){this.currentPage=1}}},pre:function(){if(this.isNotTotal){var e=this.currentPage-1;this.currentPage=e;this.grid.reqPage(e,this.pageSize)}else{if(this.currentPage<=1||this.pageCount==0){this.grid.reqPage(1,this.pageSize)}else{this.grid.reqPage((this.currentPage-1),this.pageSize)}}},next:function(){if(!this.isNotTotal){if(this.pages==this.currentPage){return}}var e=0;if(this.currentPage!=""){e=parseInt(this.currentPage)+1}if(this.isNotTotal){e=this.currentPage+1;this.currentPage=e}this.grid.reqPage(e,this.pageSize)},last:function(){if(this.pages==0){return}else{this.grid.reqPage(this.pages,this.pageSize)}},first:function(){this.grid.reqPage(this.INDEX_PAGE,this.pageSize)},refresh:function(){var e=this.grid.reqPageNo-1;if(this.grid.loadFlag=="autoLoad"){e=this.grid.reqPageNo}this.grid.reqPage(e,this.pageSize)},getPageInfo:function(){var f;var g=0,e=0;if(this.pageCount>0){g=this.pageSize*(this.currentPage-1)+1;if((this.pageSize*this.currentPage)>=this.pageCount){e=this.pageCount}else{e=this.pageSize*this.currentPage}}f="显示"+g+"到"+e+"条,共"+this.pageCount+"条记录";return f},setTotalCount:function(e){this.totalCount=parseInt(e)}};b.init(d,c,a);b.initEvents();return b};
Horn.TypeField=Horn.extend(Horn.Field,{regChars:"-0123456789",suffixNumber:2,init:function(d){Horn.TypeField.superclass.init.apply(this,arguments);this.params.inputType=this.params.inputType?this.params.inputType:"money";this.config={};this.config.bigTips=this.params.bigTips||false;if(this.params.split==""){this.config.split=this.params.split}else{this.config.split=this.params.split||","}if(this.params.suffixNum){var b=/^\d+(\.\d+)?$/;if(b.test(this.params.suffixNum)){this.suffixNumber=this.params.suffixNum}}if(this.params.integerNum){this.integerNum=this.params.integerNum}var c=this;var a=this.params.position+"";if(a=="right"){this.field.css("text-align","right")}$.each(c.params.events||[],function(h,j){c[j.event.toLowerCase()]=j["function"]});this.field.bind({keypress:Horn.Util.apply(c.onKeyPress,c)});var g=this.el.find("#u-typefield-tip-id").appendTo($("body")).html(this.params.value||"");var f="";if(this.field.width()&&this.field.width()>0){f=this.el.find("#u-typefield-capital-id").width(this.field.width())}else{f=this.el.find("#u-typefield-capital-id").css("width","100px")}this.tipLabel=g;this.tipDiv=f;if(this.params.inputType==="money"){this.maskRe=new RegExp("["+this.regChars+".]");this.check="decmal1;";this.initProcess()}else{if(this.params.inputType==="cardNo"){this.maskRe=new RegExp("["+this.regChars+"]");this.check="num;";this.initProcess()}else{return}}$(window).resize(function(){g.hide()});var e=this.getIEVersion();if(e!=-1&&e<10){if(this.params.emptyText&&this.params.emptyText!=""){this.field.val(this.params.emptyText)}}if(Horn.TypeField.IS_INIT){if(this.params.value&&this.params.value!=""){if(this.params.inputType=="money"){this.setValue(this.params.value)}}}this.field.blur(function(){var l=$(this);var n=$(this).val();var k=n.substring(0,1);var j=l.parent("div.typefield");if(j&&l.attr("inputType")=="money"){var h=spliteByChar(n,c.config.split,c.suffixNumber,c.integerNum);if(k=="-"){if(h!==undefined){h=k+h}else{h=k}}l.val(h);if(h&&h!=""){var m=h.replace(/,/g,"");l.prev().attr("value",m)}}})},setValue:function(e){e=e+"";if(e!=null&&e!=""){e=e+"";e=e.replace(/(^\s*)|(\s*$)/g,"")}var b=this.hidden;var d=this.field;if(e===undefined||e===null||e==""){d.val("");b.val("");this.tipLabel.html("");this.tipDiv.html("")}else{if(e.indexOf(".")==0){e="0"+e}var g=e.substring(0,1);e=e.replace(/[^0-9\.-]/g,"");b.val(e);this.changeTipsVal(e);var a,j="";if(this.params.inputType=="money"){a=spliteByChar(e,this.config.split,this.suffixNumber,this.integerNum);if(g=="-"){if(a!==undefined){a=g+a}else{a=g}}d.val(a);if(a&&a!=""){var f=a.replace(/,/g,"");b.attr("value",f);d.attr("title",a)}}else{if(this.params.inputType=="cardNo"){if(e!=null&&e!=""){if(e.indexOf(".")!=-1){e=e.split(".")[0]}}var h=e,c="";a=h?h.match(/\d{1,4}/g).join("  "):"";d.attr("value",a);d.val(a)}}}if(e!=null&&e!=""){if(this.params.value!=e){this.validate()}}},getValue:function(){var a=this.hidden.val();if(a!=null&&a!=""){a=a+"";a=a.replace(/(^\s*)|(\s*$)/g,"")}return a},onKeyPress:function(b){var a=b.keyCode;var c=String.fromCharCode(a);if(!this.maskRe.test(c)){}},showBigtips:function(){var a=this.field.width(),b=this.field.outerHeight();this.tipLabel.css({top:this.field.offset().top+b,left:this.field.offset().left,"z-index":9999}).show()},hideBigtips:function(){this.tipLabel.hide()},initProcess:function(){var c=this;var e=this.tipLabel;if(this.params.value&&/^[\d|\.-]*$/.test(this.params.value)){if(this.params.inputType==="money"){var a=spliteByChar(this.params.value,c.config.split,c.suffixNumber,c.integerNum);var b=this.params.value.substring(0,1);if(b=="-"){a=b+a}this.field.val(a);if(a&&a!=""){var d=a.replace(/,/g,"");this.hidden.attr("value",d)}}else{this.setValue(this.params.value)}}else{this.params.value="";this.setValue("")}if(this.params.defValue&&/^[\d|\.-]*$/.test(this.params.defValue)){}else{this.params.defValue=""}this.field.focusin(function(){$(this).val(c.hidden.val());if(c.params.bigTips==true&&c.hidden.val()&&c.hidden.val()!=""){c.showBigtips()}$(".h_floatdiv-con").scroll(function(){if(c.hidden.val()&&c.hidden.val()!=""){c.showBigtips();var k=c.tipLabel.position().top;var j=$(this).parent(".h_floatdiv").position().top;var l=$(this).siblings(".m-message-header").outerHeight();var g=$(this).parent(".h_floatdiv").outerHeight();var f=j+l;var h=j+g;if(k<f||k>h){c.hideBigtips()}}});$(".h_floatdiv-con").mousewheel(function(){if(c.hidden.val()&&c.hidden.val()!=""){c.showBigtips();var k=c.tipLabel.position().top;var j=$(this).parent(".h_floatdiv").position().top;var l=$(this).siblings(".m-message-header").outerHeight();var g=$(this).parent(".h_floatdiv").outerHeight();var f=j+l;var h=j+g;if(k<f||k>h){c.hideBigtips()}}})});this.field.focusout(function(){c.hideBigtips();c.setValue(c.hidden.val());$(".h_floatdiv-con").bind("scroll",function(){c.hideBigtips()});$(".h_floatdiv-con").bind("mousewheel",function(){c.hideBigtips()})});this.field.keyup(function(h){c.changeTipsVal($(this).val());if(c.hidden.val()&&c.hidden.val()!=""){if(c.params.bigTips==true){c.showBigtips()}}else{c.hideBigtips()}if(c.keyup){var f=Horn.Util.getFunObj(c.keyup),g;var j=f.params;if($.type(f.fn)=="function"){g=f.fn}if(g){g.apply(c,j)}}})},changeTipsVal:function(h){var l=h.substring(0,1);h=h.replace(/[^0-9\.-]/g,"");if(this.params.inputType=="cardNo"){if(h!=null&&h!=""){if(h.indexOf(".")!=-1){h=h.split(".")[0]}}}if(h==""||h==null){var f=h.split(".");if(f&&f.length>1){var c=parseFloat(f[1]).toFixed(this.suffixNumber);if(c!=0){h=parseFloat(h).toFixed(this.suffixNumber)}}}this.hidden.val(h);var d,m="";if(this.params.inputType=="money"){var g=h.split(".");if(g.length>0){var b=g[0].substr(0,this.integerNum);if(g.length>1){h=b+"."+g[1]}else{h=b}this.hidden.val(h)}if(h.split(".")[1]&&h.split(".")[1].length>2){var a=Horn.TypeField.ISNOTROUND;if(a&&a==true){var k=h.split(".")[1].substr(0,this.suffixNumber);h=h.split(".")[0]+"."+k}else{h=parseFloat(h).toFixed(this.suffixNumber)}this.hidden.val(h)}d=spliteByChar(h,this.config.split,this.suffixNumber,this.integerNum);m=numtochinese(h+"",this.suffixNumber);this.tipLabel.html(m);this.tipDiv.html(m);this.tipDiv.attr("title",m)}else{if(this.params.inputType=="cardNo"){var j=h,e="";d=j?j.match(/\d{1,4}/g).join("  "):"";e=j?j.match(/\d{1,4}/g).join(""):"";this.tipLabel.html(d)}}}});Horn.Field.regFieldType("div.hc_textfield.typefield",Horn.TypeField);function isSpecialKey(a,b){return(b.type=="keypress"&&b.ctrlKey)||(a>=33&&a<=40)||a==13||a==9||a==27||(a==8)||(a>=16&&a<=20)||(a>=44&&a<=46)}function spliteByChar(b,k,j,c){var f=b.substring(0,1);if(f=="-"){b=b.substring(1)}var g=b,e=g.split("."),h=e[0],d="";h=h.replace(/\D{1}/g,"");if(!h){return}h=h.substr(0,c);$.each(h.reverse().match(/\d{1,3}/g).reverse(),function(l,m){d+=m.reverse()+k});if(k!=""){d=d.replace(new RegExp("["+k+"]$"),"")}var a=d+(e.length>1?"."+e[1].substr(0,j):"");return a}function numtochinese(e,l){for(i=e.length-1;i>=0;i--){e=e.replace(",","");e=e.replace(" ","")}e=e.replace("￥","");if(isNaN(e)){return}var b=String(e).split(".");var c="";for(i=b[0].length-1;i>=0;i--){if(b[0].length>17){return"位数过大，无法计算"}var a="";var j=b[0].charAt(i);switch(j){case"0":a="零"+a;break;case"1":a="壹"+a;break;case"2":a="贰"+a;break;case"3":a="叁"+a;break;case"4":a="肆"+a;break;case"5":a="伍"+a;break;case"6":a="陆"+a;break;case"7":a="柒"+a;break;case"8":a="捌"+a;break;case"9":a="玖"+a;break}switch(b[0].length-i-1){case 0:a=a+"元";break;case 1:if(j!=0){a=a+"拾"}break;case 2:if(j!=0){a=a+"佰"}break;case 3:if(j!=0){a=a+"仟"}break;case 4:a=a+"万";break;case 5:if(j!=0){a=a+"拾"}break;case 6:if(j!=0){a=a+"佰"}break;case 7:if(j!=0){a=a+"仟"}break;case 8:a=a+"亿";break;case 9:if(j!=0){a=a+"拾"}break;case 10:if(j!=0){a=a+"百"}break;case 11:if(j!=0){a=a+"仟"}break;case 12:a=a+"兆";break;case 13:if(j!=0){a=a+"拾"}break;case 14:if(j!=0){a=a+"百"}break;case 15:if(j!=0){a=a+"仟"}break;case 16:if(j!=0){a=a+"吉"}break;case 17:a=a+"拾";break}c=a+c}if(e.indexOf(".")!=-1){if(b[1].length>2){var g=parseFloat(e);e=g.toFixed(l);b=String(e).split(".")}for(i=0;i<b[1].length;i++){a="";j=b[1].charAt(i);switch(j){case"0":a="零"+a;break;case"1":a="壹"+a;break;case"2":a="贰"+a;break;case"3":a="叁"+a;break;case"4":a="肆"+a;break;case"5":a="伍"+a;break;case"6":a="陆"+a;break;case"7":a="柒"+a;break;case"8":a="捌"+a;break;case"9":a="玖"+a;break}if(i==0){a=a+"角"}if(i==1){a=a+"分"}c=c+a}}while(c.search("零零")!=-1){c=c.replace("零零","零")}c=c.replace("零亿","亿");c=c.replace("亿万","亿");c=c.replace("零万","万");c=c.replace("零元","元");c=c.replace("零角","");c=c.replace("零分","");c=c.replace("亿万","亿");c=c.replace("兆亿","兆");c=c.replace("零兆","兆");c=c.replace("吉兆","吉");if(c.charAt(c.length-1)=="元"||c.charAt(c.length-1)=="角"){c=c+"整"}var f=["壹","贰","叁","肆","伍","陆","柒","捌","玖"];var d=0;while(c.length>0){if(f.indexOf(c[0])<0){c=c.substr(1)}else{break}}var h=e.substring(0,1);if(h=="-"){c="负"+c}var k=c.charAt(c.length-1);if("零"==k){c=c.substring(0,c.length-1);c=c+"整"}return c};
(function(a){a.fn.datetimepicker.dates["zh-CN"]={days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六","星期日"],daysShort:["周日","周一","周二","周三","周四","周五","周六","周日"],daysMin:["日","一","二","三","四","五","六","日"],months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],today:"今天",suffix:[],meridiem:["上午","下午"]}}(jQuery));Horn.Calendar=Horn.extend(Horn.Field,{COMPONENT_CLASS:"Calendar",init:function(dom){Horn.Calendar.superclass.init.apply(this,arguments);var input=this.el.children("input:text");var hidden=this.el.children("input:hidden");this.name=hidden.attr("name");this.alias=hidden.attr("alias");var config=this.params.config;var settings={};if(config&&typeof(config)=="string"){settings=eval("("+config+")")}else{if(typeof(config)=="object"){settings=config}else{settings={}}}this.format=settings.format;if(!settings.format){settings.format=Horn.Calendar.DEFAULT_FORMAT;hidden.attr("format","noConfig")}else{hidden.attr("format","yesConfig")}settings.btnBar=false;this.settings=settings;this.minDate=Horn.Util.Format.date(settings.minDate,"yyyy-MM-dd HH:mm");this.maxDate=Horn.Util.Format.date(settings.maxDate,"yyyy-MM-dd HH:mm");this.initDate=function(conf){var lformat=conf.format.toLowerCase();var viewNo=conf.format.indexOf("m")>-1?0:lformat.indexOf("h")>-1?1:lformat.indexOf("d")>-1?2:conf.format.indexOf("M")>-1?3:4;if(viewNo===3){conf.noToday=true}var that=this;var language="zh-CN";if((this.params.language&&this.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){if(this.params.language){language=this.params.language.replace("_","-")}else{language=Horn.Validate.language.replace("_","-")}}this.calobj=input.datetimepicker({format:conf.format,startDate:that.minDate,endDate:that.maxDate,language:language,autoclose:true,minView:viewNo,startView:viewNo===3?4:2,todayBtn:conf.noToday===true?false:true}).on("changeDate",function(e){var h=e.date.getHours()-8;e.date.setHours(h);var date=e.date.format(conf.format);this.value=date;that.hidden.val(date);if(that.params.focusShowCalendar==false||that.params.canEditable==false){that._inputValue=date}}).on("hide",function(){input.trigger("blur");if(that._inputValue!=null){var date;if(that._inputValue==""){date=""}else{date=Horn.Util.Format.date(that._inputValue,that.settings.format);if(that.params.focusShowCalendar==false||that.params.canEditable==false){date=that._inputValue}if(date.indexOf("1899")==0){date=that._inputValue}}that.hidden.val(date);this.value=date;that._inputValue=null}else{this.value=that.hidden.val()}});if(this.minDate!=undefined){input.datetimepicker("setStartDate",that.minDate)}if(this.maxDate!=undefined){input.datetimepicker("setEndDate",that.maxDate)}};var that=this;input.focus(function(){var _org=$(this).val();if(_org&&_org.indexOf("/")==-1&&_org.indexOf("-")==-1){var _ttt=Horn.Util.Format.date(_org,"yyyy-MM-dd");$(this).val(_ttt)}return true}).keyup(function(e){if($(this).val()==""){input.datetimepicker("hide");that.hidden.val("");that.field.val("");input.datetimepicker("show");return}that._inputValue=$(this).val();that.hidden.val($(this).val())}).keypress(function(e){that._inputValue=$(this).val();that.hidden.val($(this).val())}).blur(function(e){that.formatValue();that.validate()});var disabled=this.field.attr("disabled");if(disabled&&disabled=="disabled"){return}var $a=input.next("i");var inputNotShow=input.attr("inputNotShow");$a.click(function(){var disabled=that.field.attr("disabled");if(disabled&&disabled=="disabled"){return}input.attr("focusShowCalendar","true");input.attr("canEditable","true");input.focus();input.focus();if(inputNotShow=="false"){input.attr("focusShowCalendar","false");input.attr("canEditable","false")}});this.initDate(settings);if(this.params.readonly){this.setReadonly(true)}if(this.params.disabled){this.setDisabled(true)}var val=hidden.val();if(val!=""){if(val==0||val=="0"){hidden.val("");this.setValue("");input.attr("value","")}else{this.setValue(val)}}},getEventTarget:function(){return this.el.children("input:text")},setValue:function(a){if(a=="null"||a=="NULL"||a=="undefined"){return}if(a==0||a=="0"){a=""}this.field.val(a);this.hidden.val(a);if(a!=""&&this.params.value!=a){this.validate()}},getValue:function(){var a=this.get().val();if(a!=null&&a!=""){a=a+"";a=a.replace(/(^\s*)|(\s*$)/g,"")}if(a!=""){a=Horn.Util.Format.date(a,this.settings.format)}else{a=""}return a},reset:function(a){if(this.defValue&&this.defValue=="0"){this.defValue=""}if(this.defHiddenValue&&this.defHiddenValue=="0"){this.defHiddenValue=""}this.field.val(a?"":this.defValue);this.hidden.val(a?"":this.defHiddenValue);this.validate()},validate:function(){if(this.disabled){return}this.removeError();this.err=false;var e=true;var c=this;c.formatValue();var a=c.hidden.attr("check");if(a&&a.length>0&&!this.params.config){if(c.calobj.val()!=""){var b=a.split(";");var f="";for(var d=0;d<b.length;d++){var g=b[d];g=g.replace("(","").replace(")","");if(g!=""&&g!="Horn.Validate.validateFmt"&&g!=Horn.Validate.REQUIRED){Horn.Validate.onValid({data:[Horn.Validate,c]});return}}}}if(c.calobj.val()!=""){if(!Horn.Util.Format.validateFmt(c.hidden.val(),c.settings.format)){e=false;this.err=true;if((c.params.language&&c.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){c.showError("Date format error,it should be："+c.settings.format)}else{c.showError("日期格式不正确,格式为："+c.settings.format)}return}}else{if(a&&a.indexOf(Horn.Validate.REQUIRED)>-1){e=false;this.err=true;if((c.params.language&&c.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){c.showError("Not empty！")}else{c.showError("该输入不能为空！")}return}}},formatValue:function(){var a=this;var b=a.hidden.val();if(b!=""){date=Horn.Util.Format.date(b,a.settings.format)}else{date=""}if(date.indexOf("1899")==0){date=a.hidden.val()}a.hidden.val(date);a.calobj.val(date);a.value=date},isValid:function(){if(this.disabled){return true}if(this.calobj.val()==null||this.calobj.val()==""){var a=this.hidden.attr("check");if(a&&a.indexOf(Horn.Validate.REQUIRED)>-1){return false}else{return true}}else{return(Horn.Util.Format.validateFmt(this.hidden.val(),this.settings.format)&&!this.err)?true:false}},initEvents:function(){var a=this;a.checkRegx=[];var b=this.field.attr("checkstr");if(b){a.checkRegx=b.split(";")}this.field.blur(function(){var e="yyyy-MM-dd";if(a.settings){var d=a.settings.format;if(d){e=d}}var f=$(this).val();if(f!=""){var c=Horn.Util.Format.date(f,e);$(this).val(c)}setTimeout(function(){var g=a.hidden.attr("check");var k=true;if(g&&g.length>0&&!a.params.config){if(a.calobj.val()!=""){var h=g.split(";");var l="";for(var j=0;j<h.length;j++){var m=h[j];m=m.replace("(","").replace(")","");if(m!=""&&m!="Horn.Validate.validateFmt"&&m!=Horn.Validate.REQUIRED){Horn.Validate.onValid({data:[Horn.Validate,a]});return}}}}if(a.calobj.val()!=""){if(!Horn.Util.Format.validateFmt(a.hidden.val(),a.settings.format)){if((a.params.language&&a.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){a.showError("Date format error,it should be："+a.settings.format)}else{a.showError("日期格式不正确,格式为："+a.settings.format)}}else{a.removeError();Horn.Validate.onValid({data:[Horn.Validate,a]})}}else{a.removeError();var g=a.hidden.attr("check");if(g&&g.indexOf(Horn.Validate.REQUIRED)>-1){if((a.params.language&&a.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){a.showError("Not empty！")}else{a.showError("该输入不能为空！")}}}},10)})},setEnable:function(a){if(a){this.field.removeAttr("disabled");this.hidden.removeAttr("disabled")}else{this.field.attr("disabled","disabled");this.hidden.attr("disabled","disabled")}},setReadonly:function(b){Horn.Calendar.superclass.setReadonly.apply(this,arguments);var a=this.el.children("input:text");if(this.readonly){this.calobj.datetimepicker("remove")}else{a.unbind("changeDate hide");this.initDate(this.settings)}},destroy:function(){this.calobj.datetimepicker("remove")}});Horn.apply(Horn.Calendar,{DEFAULT_FORMAT:"yyyy-MM-dd"});Horn.Field.regFieldType("div.hc_calendar",Horn.Calendar);
Horn.CalendarGroup=Horn.extend(Horn.Field,{COMPONENT_CLASS:"CalendarGroup",cal1:null,cal2:null,hidden1:null,hidden2:null,name1:null,name2:null,calobj1:null,calobj2:null,defValue1:"",defHiddenValue1:"",defValue2:"",defHiddenValue2:"",inValidEle:null,tmpValide:"",language:"zh-CN",init:function(dom){Horn.CalendarGroup.superclass.init.apply(this,arguments);this.el.attr("tabIndex",1000);var cal1=$(this.el.find("input:text")[0]);var cal2=$(this.el.find("input:text")[1]);var hidden1=$(this.el.find("input[type=hidden]")[0]);var hidden2=$(this.el.find("input[type=hidden]")[1]);if((this.params.language&&this.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){if(this.params.language){this.language=this.params.language.replace("_","-")}else{this.language=Horn.Validate.language.replace("_","-")}}this.name1=hidden1.attr("name");this.name2=hidden2.attr("name");this.name=this.name1;this.alias=hidden1.attr("alias");var config=this.params.config;var settings={};var _this=this;if(hidden1){this.defHiddenValue1=(this.params.defValue1!=undefined)?this.params.defValue1:hidden1.val()}if(hidden2){this.defHiddenValue2=(this.params.defValue2!=undefined)?this.params.defValue2:hidden2.val()}if(cal1){this.defValue1=(this.params.defValue1!=undefined)?this.params.defValue1:cal1.val()}if(cal2){this.defValue2=(this.params.defValue2!=undefined)?this.params.defValue2:cal2.val()}if(config&&typeof(config)=="string"){settings=eval("("+config+")")}else{if(typeof(config)=="object"){settings=config}else{settings={}}}this.format=settings.format;if(!settings.format){settings.format=Horn.Calendar.DEFAULT_FORMAT}this.settings=settings;$.fn.isValid=function(value,format){return Horn.Util.Format.validateFmt(value,format)};$.fn.getDate=function(){return this.val()};settings.onchange=function(){return cal1.change&&cal1.change()};if(!settings.maxDate){settings.maxDate="2999/12/31"}if(!settings.minDate){settings.minDate="1099/12/31"}this.minDate=this._formatDate(settings.minDate);this.maxDate=this._formatDate(settings.maxDate);var $a_cal1=cal1.next("i");var $a_cal2=cal2.next("i");var inputNotShow=cal1.attr("inputNotShow");$a_cal1.click(function(){var disabled=cal1.attr("disabled");if(disabled&&disabled=="disabled"){return}cal1.attr("focusShowCalendar","true");cal1.attr("canEditable","true");cal1.focus();cal1.focus();if(inputNotShow=="false"){cal1.attr("focusShowCalendar","false");cal1.attr("canEditable","false")}});$a_cal2.click(function(){var disabled=cal1.attr("disabled");if(disabled&&disabled=="disabled"){return}cal2.attr("focusShowCalendar","true");cal2.attr("canEditable","true");cal2.focus();cal2.focus();if(inputNotShow=="false"){cal2.attr("focusShowCalendar","false");cal2.attr("canEditable","false")}});if(!cal1.attr("readonly")||true){cal1.focus(function(event){if(_this.readonly){return false}var _org=cal1.val();if(_org&&_org.indexOf("/")==-1&&_org.indexOf("-")==-1){var _ttt=Horn.Util.Format.date(_org,"yyyy-MM-dd");cal1.val(_ttt)}var config1=Horn.apply({},settings);var maxDate=_this._formatDate(_this.cal2.val());maxDate=maxDate||_this.maxDate;if(!_this.compareDate(_this.minDate,maxDate)||!_this.compareDate(maxDate,_this.maxDate)){maxDate=_this.maxDate}config1=Horn.apply(config1,{minDate:Horn.Util.Format.date(_this.minDate,"yyyy-MM-dd HH:mm"),maxDate:Horn.Util.Format.date(maxDate,"yyyy-MM-dd HH:mm"),real:hidden1,btnBar:false,onSetDate:function(){setTimeout(function(){cal1.evented=true;cal1.blur()},100)}});var conf=config1;var lformat=conf.format.toLowerCase();var viewNo=conf.format.indexOf("m")>-1?0:lformat.indexOf("h")>-1?1:lformat.indexOf("d")>-1?2:conf.format.indexOf("M")>-1?3:4;if(viewNo===3){conf.noToday=true}var that=this;this.config1=conf;if(cal1.evented==undefined){_this.calobj1=cal1.datetimepicker({format:conf.format,startDate:conf.minDate,endDate:conf.maxDate,language:_this.language,autoclose:true,minView:viewNo,startView:viewNo===3?4:2,todayBtn:conf.noToday===true?false:true}).on("changeDate",function(e){var h=e.date.getHours()-8;e.date.setHours(h);var date=e.date.format(conf.format);this.value=date;hidden1.val(date)}).on("hide",function(){if(that._inputValue1!=null){var date;if(that._inputValue1==""){date=""}else{date=Horn.Util.Format.date(that._inputValue1,that.config1.format);if(date.indexOf("1899")==0){date=that._inputValue1}}hidden1.val(date);this.value=date;that._inputValue1=null}else{this.value=hidden1.val()}conf.onSetDate()}).keyup(function(){if($(this).val()==""){cal1.datetimepicker("hide");hidden1.val("");cal1.val("");cal1.datetimepicker("show");return}that._inputValue1=$(this).val();hidden1.val($(this).val())}).keypress(function(e){that._inputValue=$(this).val();hidden1.val($(this).val())})}if(conf.minDate!=undefined){_this.calobj1.datetimepicker("setStartDate",conf.minDate)}if(conf.maxDate!=undefined){_this.calobj1.datetimepicker("setEndDate",conf.maxDate)}_this.calobj1.datetimepicker("show");cal1.evented=true;var rv=_this.getIEVersion();if(rv!=-1&&rv<10){if(cal1.attr("placeholder")&&cal1.attr("placeholder")!=""){if(cal1.val()==cal1.attr("placeholder")){cal1.val("")}}}});var _field=this;cal1.blur(function(){_this.tmpValide="";if(!_field.format){$(this).attr("format","noConfig")}else{$(this).attr("format","yesConfig")}var _calendarGroup=_this;_this.formatVal();if(_this.cal1.val()!=""){if(_this.cal2.val()==""){var rule2=_this.cal2.attr("check");if(rule2&&rule2.indexOf(Horn.Validate.REQUIRED)>-1){if((_this.params.language&&_this.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){_this.showError("Not empty！")}else{_this.showError("当前输入不能为空")}return}}if(!_field.format){var _validate=Horn.Validate;var comp=_calendarGroup;var obj=comp.cal1;var rules=_validate.getRules.call(_validate,obj);if(rules&&rules.length>0&&obj.attr("disabled")==undefined){_this.tmpValide=_validate.isValide.call(_validate,rules,comp,obj.val());if(_this.tmpValide!="true"){return}}else{_validate.removeError.call(_validate,comp)}}}else{var rule1=_this.cal1.attr("check");if(rule1&&rule1.indexOf(Horn.Validate.REQUIRED)>-1&&(!_this.cal1.val()||!_this.cal2.val())){if((_this.params.language&&_this.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){_this.showError("Not empty！")}else{_this.showError("当前输入不能为空")}return}}if(_this.cal1.val()!=""){_this.valideDateFormat()}var rv=_this.getIEVersion();if(rv!=-1&&rv<10){var placeholder=_this.cal1.attr("placeholder");if(placeholder&&placeholder!=""){if(_this.hidden1.val()==""){_this.cal1.val(placeholder)}}}})}if(!cal2.attr("readonly")||true){cal2.focus(function(event){if(_this.readonly){return false}var _org=cal2.val();if(_org&&_org.indexOf("/")==-1&&_org.indexOf("-")==-1){var _ttt=Horn.Util.Format.date(_org,"yyyy-MM-dd");cal2.val(_ttt)}var config2=Horn.apply({},settings);var minDate=_this._formatDate(_this.cal1.val());minDate=minDate||_this.minDate;if(!_this.compareDate(_this.minDate,minDate)||!_this.compareDate(minDate,_this.maxDate)){minDate=_this.minDate}config2=Horn.apply(config2,{maxDate:Horn.Util.Format.date(_this.maxDate,"yyyy-MM-dd HH:mm"),minDate:Horn.Util.Format.date(minDate,"yyyy-MM-dd HH:mm"),real:hidden2,btnBar:false,onSetDate:function(){setTimeout(function(){cal2.evented=true;cal2.blur()},10)}});var conf=config2;var lformat=conf.format.toLowerCase();var viewNo=conf.format.indexOf("m")>-1?0:lformat.indexOf("h")>-1?1:lformat.indexOf("d")>-1?2:conf.format.indexOf("M")>-1?3:4;if(viewNo===3){conf.noToday=true}var that=this;that.config2=conf;if(cal2.evented==undefined){_this.calobj2=cal2.datetimepicker({format:conf.format,language:_this.language,autoclose:true,minView:viewNo,startView:viewNo===3?4:2,todayBtn:conf.noToday===true?false:true}).on("changeDate",function(e){var h=e.date.getHours()-8;e.date.setHours(h);var date=e.date.format(conf.format);this.value=date;hidden2.val(date)}).on("hide",function(){if(that._inputValue2!=null){var date;if(that._inputValue2==""){date=""}else{date=Horn.Util.Format.date(that._inputValue2,that.config2.format);if(date.indexOf("1899")==0){date=that._inputValue2}}hidden2.val(date);this.value=date;that._inputValue2=null}else{this.value=hidden2.val()}conf.onSetDate()}).keyup(function(){if($(this).val()==""){cal2.datetimepicker("hide");hidden2.val("");cal2.val("");cal2.datetimepicker("show");return}that._inputValue2=$(this).val();hidden2.val($(this).val())}).keypress(function(e){that._inputValue2=$(this).val();hidden2.val($(this).val())})}if(conf.minDate!=undefined){_this.calobj2.datetimepicker("setStartDate",conf.minDate)}if(conf.maxDate!=undefined){_this.calobj2.datetimepicker("setEndDate",conf.maxDate)}_this.calobj2.datetimepicker("show");cal2.evented=true;var rv=_this.getIEVersion();if(rv!=-1&&rv<10){if(cal2.attr("placeholder")&&cal2.attr("placeholder")!=""){if(cal2.val()==cal2.attr("placeholder")){cal2.val("")}}}});cal2.blur(function(){_tmpValide="";if(!_field.format){$(this).attr("format","noConfig")}else{$(this).attr("format","yesConfig")}var _calendarGroup=_this;_this.formatVal();if(_this.cal2.val()!=""){if(_this.cal1.val()==""){var rule1=_this.cal1.attr("check");if(rule1&&rule1.indexOf(Horn.Validate.REQUIRED)>-1){if((_this.params.language&&_this.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){_this.showError("Not empty！")}else{_this.showError("当前输入不能为空")}return}}if(!_field.format){var _validate=Horn.Validate;var comp=_calendarGroup;var obj=comp.cal2;var rules=_validate.getRules.call(_validate,obj);if(rules&&rules.length>0&&obj.attr("disabled")==undefined){_this.tmpValide=_validate.isValide.call(_validate,rules,comp,obj.val());if(_this.tmpValide!="true"){return}}else{_validate.removeError.call(_validate,comp)}}}else{var rule2=_this.cal2.attr("check");if(rule2&&rule2.indexOf(Horn.Validate.REQUIRED)>-1&&(!_this.cal2.val()||!_this.cal1.val())){if((_this.params.language&&_this.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){_this.showError("Not empty！")}else{_this.showError("当前输入不能为空")}return}}if(_this.cal2.val()!=""){_this.valideDateFormat()}var rv=_this.getIEVersion();if(rv!=-1&&rv<10){var placeholder=_this.cal2.attr("placeholder");if(placeholder&&placeholder!=""){if(_this.hidden2.val()==""){_this.cal2.val(placeholder)}}}})}this.cal1=cal1;this.hidden1=hidden1;this.cal2=cal2;this.hidden2=hidden2;if(this.params.disabled){this.setEnable(false)}if(this.params.readonly){this.setReadonly(true)}this.calobj1=this.cal1;this.calobj2=this.cal2;var rv=this.getIEVersion();if(rv!=-1&&rv<10){var placeholder=this.cal1.attr("placeholder");if(placeholder&&placeholder!=""){if(!this.params.value1||this.params.value1==""){this.cal1.val(this.cal1.attr("placeholder"))}if(!this.params.value2||this.params.value2==""){this.cal2.val(this.cal2.attr("placeholder"))}}}},getDisabled:function(b){var a=b.attr("disabled");if(a&&a=="disabled"){return true}return false},formatVal:function(){var e=this;var c=e.hidden1.val();var d="";if(c!=""){d=Horn.Util.Format.date(c,e.settings.format)}if(d.indexOf("1899")==0){d=c}e.hidden1.val(d);e.cal1.val(d);this.value=d;var a=e.hidden2.val();var b="";if(a!=""){b=Horn.Util.Format.date(a,e.settings.format)}if(b.indexOf("1899")==0){b=a}e.hidden2.val(b);e.cal2.val(b);this.value=b},valideDateFormat:function(){var d=true;var g=this;var a=true;var h=this.cal1.attr("check");if(h&&h.length>0){if(g.calobj1.val()==""||g.calobj2.val()==""){if(h.indexOf(Horn.Validate.REQUIRED)>-1){if((g.params.language&&g.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){g.showError("Not empty！")}else{g.showError("当前输入不能为空")}d=false;this.err=true;return}}}if(h&&h.length>0&&!this.params.config){if(g.calobj1.val()!=""||g.calobj2.val()!=""){var j=h.split(";");var b="";for(var e=0;e<j.length;e++){var l=j[e];l=l.replace("(","").replace(")","");if(l!=""&&l!="Horn.Validate.validateFmt"&&l!=Horn.Validate.REQUIRED){var k=Horn.Validate;var f=g;var c=f.cal1;g.tmpValide=k.isValide.call(k,rules,f,c.val());if(g.tmpValide!="true"){return}c=f.cal2;g.tmpValide=k.isValide.call(k,rules,f,c.val());if(g.tmpValide!="true"){return}}else{this.formatVal()}}if(!a){g.showError(biz_func);a=false;this.err=true;return}}}else{this.formatVal()}if(g.calobj1.val()!=""&&!Horn.Util.Format.validateFmt(g.calobj1.val(),g.settings.format)){if((g.params.language&&g.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){g.showError("Date format error,it should be:"+g.settings.format)}else{g.showError("日期格式不正确,格式为："+g.settings.format)}d=false;this.err=true;return}if(g.calobj2.val()!=""&&!Horn.Util.Format.validateFmt(g.calobj2.val(),g.settings.format)){if((g.params.language&&g.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){g.showError("Date format error,it should be:"+g.settings.format)}else{g.showError("日期格式不正确,格式为："+g.settings.format)}d=false;this.err=true;return}if(g.calobj1&&(!g.compareDate(g.calobj1.getDate(),g.maxDate)||!g.compareDate(g.minDate,g.calobj1.getDate()))||g.calobj2&&(!g.compareDate(g.calobj2.getDate(),g.maxDate)||!g.compareDate(g.minDate,g.calobj2.getDate()))){if(!g.compareDate(g.calobj1.getDate(),g.maxDate)||!g.compareDate(g.minDate,g.calobj1.getDate())){g.inValidEle=g.cal1}else{if(g.calobj2&&(!g.compareDate(g.calobj2.getDate(),g.maxDate)||!g.compareDate(g.minDate,g.calobj2.getDate()))){g.inValidEle=g.cal2}}d=false;this.err=true;if((g.params.language&&g.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){g.showError("The date is not in the valid range")}else{g.showError("日期不在有效区间")}return}else{if(g.calobj1&&g.calobj1.isValid(g.calobj1.val(),g.settings.format)&&g.calobj2&&g.calobj2.isValid(g.calobj2.val(),g.settings.format)&&g.calobj1.getDate()&&g.calobj2.getDate()){if(g.calobj1.getDate()&&g.calobj2.getDate()&&!g.compareDate(g.calobj1.getDate(),g.calobj2.getDate())){d=false;this.err=true;g.inValidEle=g.cal1;if((g.params.language&&g.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){g.showError("The start date can not be later than the end date")}else{g.showError("开始日期不能大于结束日期")}return}}}if(d){this.err=false;g.removeError()}},getEventTarget:function(){return this.el.find("input:text")},_formatDate:function(a){a=a||"";if(a.indexOf("/")==-1&&a.indexOf("-")==-1&&a.length>=8){return a.substring(0,4)+"/"+a.substring(4,6)+"/"+a.substring(6)}return a.replace(/-/g,"/")},compareDate:function(b,a){b=this._formatDate(b);a=this._formatDate(a);if(!Date.parse(b)||!Date.parse(a)){return true}return Date.parse(b)<=Date.parse(a)},setValue:function(b){var a=this;this.cal1.val(b[this.name1]);this.hidden1.val(b[this.name1]);this.cal2.val(b[this.name2]);this.hidden2.val(b[this.name2]);this.formatVal();this.valideDateFormat()},getValue:function(){var d=this;var b=[];b.push(this.hidden1);b.push(this.hidden2);var c="";var a;$.each(b,function(e,f){a=$(f).val();if(a){a=Horn.Util.Format.date(a,d.settings.format)}c+=","+a});if(c==",,"){return""}return c.indexOf(",")==0?c.substring(1):c},showError:function(d){var b=this.cal1;var g=this.cal2;var a=this.params.msgInBody+"";b.removeClass("m-verify-success");b.addClass("m-verify-error");g.removeClass("m-verify-success");g.addClass("m-verify-error");d=$.type(d)=="boolean"?"校验错误":d;if(!this.msgDiv){if(a=="true"){this.msgDiv=$('<div class="m-verify-tip bottom" role="m-verify-tip" msgInBody="true" style="display: none;"></div>');$("body").append(this.msgDiv)}else{this.msgDiv=$('<div class="m-verify-tip bottom" role="m-verify-tip"  style="display: none;"></div>');this.el.after(this.msgDiv)}}var e=this.msgDiv;e.html('<div class="verify-tip-arrow"></div><div class="verify-tip-inner">'+d+"</div>");e.css("display","block");this.err=true;if(a=="true"){var f=this;var c=Horn.Window.getNextZIndex();if(top.Horn&&top.Horn.Window){top.Horn.Window.MAX_ZINDEX=top.Horn.Window.MAX_ZINDEX-1}else{Horn.Window.MAX_ZINDEX=Horn.Window.MAX_ZINDEX-1}f.positionError(c);$(".h_floatdiv-con").bind("scroll",function(){f.positionError(c)});$(".h_floatdiv-con").bind("mousewheel",function(){f.positionError(c)});$(".h_tabpanel-contents").bind("scroll",function(){f.positionError(c)});$(".h_tabpanel-contents").bind("mousewheel",function(){f.positionError(c)});$(".m-message-title").mousemove(function(h){f.positionError(c)})}},removeError:function(){var a=this.cal1;var e=this.cal2;a.removeClass("m-verify-error");e.removeClass("m-verify-error");var c=this.get();var b=a.attr(Horn.Validate.CHECK);if(b){if(this.isValid){if(a.val()!=""||e.val()!=""){a.addClass("m-verify-success");e.addClass("m-verify-success")}}}this.err=false;var d=this.msgDiv;if(d){d.remove()}delete this.msgDiv},positionError:function(){var b=this.cal1;var c=this.msgDiv;if(c){var d=b.offset();if(d&&d.top==0){d=this.el.offset()}if(d&&d.top>0){var a=b.outerHeight();c.css("left",d.left+"px");c.css("z-index",9999);c.css("top",(d.top+a)+"px")}}},addRule:function(g){var d=this.cal1;var b=this.cal2;var c=d.attr(Horn.Validate.CHECK);if(c){if(c.indexOf(g)>-1){return}c+=Horn.Validate.CHECKSEP+g}else{c=g}d.attr(Horn.Validate.CHECK,c);b.attr(Horn.Validate.CHECK,c);if(g&&g.indexOf(Horn.Validate.REQUIRED)>-1){var a=this.el.parent().parent(".g-unit-wrap");var e=$("label",a);var f=$("span.m-verify-symbol",e);if(!f.length){f=$("<span>",{"class":"m-verify-symbol",html:"*"});e.prepend(f)}else{f.html("*")}}this.removeError();this.field.removeClass("m-verify-success")},removeRule:function(e){var c=this.cal1;var a=this.cal2;var b=c.attr(Horn.Validate.CHECK);if(b&&b.indexOf(e)>-1){var d=b.split(Horn.Validate.CHECKSEP);d=$.grep(d,function(g,f){return g&&g!=e});c.attr(Horn.Validate.CHECK,d.join(";"));a.attr(Horn.Validate.CHECK,d.join(";"));this.removeError();this.setNotRequired()}},mutiName:function(){return[this.name1,this.name2]},validate:function(){if(this.disabled){return}var a=true;var c=this;var g=this;if(c.params.disabled&&c.params.disabled==true){return true}var j=this.cal1.attr("check");var j=this.cal1.attr("check");if(j&&j.indexOf(Horn.Validate.REQUIRED)>-1){if(g.calobj1.val()==""||g.calobj2.val()==""){if((g.params.language&&g.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){g.showError("Not empty！")}else{g.showError("当前输入不能为空")}vaid=false;this.err=true;return}}var l=Horn.Validate;var e=this.cal1;var n=l.getRules.call(l,e);if(j&&j.length>0&&!this.params.config){var k=j.split(";");var b="";for(var d=0;d<k.length;d++){var p=k[d];p=p.replace("(","").replace(")","");var h=function(){};if(p!=""&&p!="Horn.Validate.validateFmt"&&p!=Horn.Validate.REQUIRED){var l=Horn.Validate;var f=c;var e=f.cal1;g.tmpValide=l.isValide.call(l,n,f,e.val());if(g.tmpValide!="true"){return}e=f.cal2;g.tmpValide=l.isValide.call(l,n,f,e.val());if(g.tmpValide!="true"){return}}}}var o=this.calobj1.getDate();var m=this.calobj2.getDate();if(this.tmpValide!=undefined&&this.tmpValide!=""){if(!this.tmpValide){c.showError(this.tmpValide);a=false}}else{if(this.msgDiv!=null){a=false}}if(g.calobj1.val()!=""){if(!Horn.Util.Format.validateFmt(g.calobj1.val(),g.settings.format)){a=false;this.err=true;if((g.params.language&&g.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){g.showError("Date format error,it should be:"+g.settings.format)}else{g.showError("日期格式不正确,格式为："+g.settings.format)}return}}else{if(g.calobj1&&(!g.compareDate(g.calobj1.getDate(),g.maxDate)||!g.compareDate(g.minDate,g.calobj1.getDate()))||g.calobj2&&(!g.compareDate(g.calobj2.getDate(),g.maxDate)||!g.compareDate(g.minDate,g.calobj2.getDate()))){a=false;this.err=true;if((g.params.language&&g.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){g.showError("The date is not in the valid range")}else{g.showError("日期不在有效区间")}return}else{if(g.calobj1&&g.calobj1.isValid(g.calobj1.val(),g.settings.format)&&g.calobj2&&g.calobj2.isValid(g.calobj2.val(),g.settings.format)&&g.calobj1.getDate()&&g.calobj2.getDate()){if(g.calobj1.getDate()&&g.calobj2.getDate()&&!g.compareDate(g.calobj1.getDate(),g.calobj2.getDate())){a=false;this.err=true;if((g.params.language&&g.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){g.showError("The start date can not be later than the end date")}else{g.showError("开始日期不能大于结束日期")}return}}else{g.removeError();this.err=false;a=true}}}if(g.calobj2.val()!=""){if(!Horn.Util.Format.validateFmt(g.calobj2.val(),g.settings.format)){a=false;this.err=true;if((g.params.language&&g.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){g.showError("Date format error,it should be:"+g.settings.format)}else{g.showError("日期格式不正确,格式为："+g.settings.format)}return}}else{if(g.calobj1&&(!g.compareDate(g.calobj1.getDate(),g.maxDate)||!g.compareDate(g.minDate,g.calobj1.getDate()))||g.calobj2&&(!g.compareDate(g.calobj2.getDate(),g.maxDate)||!g.compareDate(g.minDate,g.calobj2.getDate()))){if(!g.compareDate(g.calobj1.getDate(),g.maxDate)||!g.compareDate(g.minDate,g.calobj1.getDate())){g.inValidEle=g.cal1}else{if(g.calobj2&&(!g.compareDate(g.calobj2.getDate(),g.maxDate)||!g.compareDate(g.minDate,g.calobj2.getDate()))){g.inValidEle=g.cal2}}if((g.params.language&&g.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){g.showError("The date is not in the valid range")}else{g.showError("日期不在有效区间")}return}else{if(g.calobj1&&g.calobj1.isValid(g.calobj1.val(),g.settings.format)&&g.calobj2&&g.calobj2.isValid(g.calobj2.val(),g.settings.format)&&g.calobj1.getDate()&&g.calobj2.getDate()){if(g.calobj1.getDate()&&g.calobj2.getDate()&&!g.compareDate(g.calobj1.getDate(),g.calobj2.getDate())){g.inValidEle=g.cal1;if((g.params.language&&g.params.language=="en_US")||(Horn.Validate.language&&Horn.Validate.language=="en_US")){g.showError("The start date can not be later than the end date")}else{g.showError("开始日期不能大于结束日期")}return}}else{g.removeError();this.err=false;a=true}}}if(!a){this.err=true}c.formatVal()},setEnable:function(a){if(a){this.cal1.removeAttr("disabled");this.cal2.removeAttr("disabled");this.hidden1.removeAttr("disabled");this.hidden2.removeAttr("disabled")}else{this.cal1.attr("disabled","disabled");this.cal2.attr("disabled","disabled");this.hidden1.attr("disabled","disabled");this.hidden2.attr("disabled","disabled")}},reset:function(a){if(this.defValue1&&this.defValue1=="0"){this.defValue1=""}if(this.defValue2&&this.defValue2=="0"){this.defValue2=""}if(this.defHiddenValue1&&this.defHiddenValue1=="0"){this.defHiddenValue1=""}if(this.defHiddenValue2&&this.defHiddenValue2=="0"){this.defHiddenValue2=""}this.hidden1.val(a?"":this.defHiddenValue1);this.hidden2.val(a?"":this.defHiddenValue2);var c=a?"":this.defValue1||this.defHiddenValue1;var b=a?"":this.defValue2||this.defHiddenValue2;var d={};d[this.name1]=c;d[this.name2]=b;this.setValue(d);this.validate()},clearValue:function(){this.hidden1.val("");this.hidden2.val("");this.cal1.val("");this.cal2.val("");this.validate()},getInValidEle:function(){return this.inValidEle},setReadonly:function(a){Horn.Calendar.superclass.setReadonly.apply(this,arguments);if(this.readonly){this.cal1.unbind("click").datetimepicker("remove");this.cal2.unbind("click").datetimepicker("remove")}else{this.cal1.evented=undefined;this.cal2.evented=undefined}}});Horn.Field.regFieldType("div.hc_calendargroup",Horn.CalendarGroup);
Horn.Checkbox=Horn.extend(Horn.Field,{COMPONENT_CLASS:"Checkbox",checkbox:null,init:function(){Horn.Checkbox.superclass.init.apply(this,arguments);this.checkbox=this.el.find("input:checkbox");this.checkbox.val("false");if(this.params.disabled){this.disabled=true}if(this.params.checked&&this.params.checked.toString()==="true"){this.checkbox.val("true")}},getEventTarget:function(){return this.el.find("input:checkbox")},initEvents:function(){var c=this;var a=c.el.find("input:checkbox[check*=required]");var b=this.el.find("input:checkbox");if(a&&a.size()>0){this.checkRegx=$(a[0]).attr("check").split(";");a.each(function(d,e){$(e).bind("click",function(){var f=c.el.children("div").children("label").find("input:checkbox[checked]");var g=$(this).get(0).checked;if(g){c.removeError()}else{c.showError()}})})}b.on("change",function(){if(this.checked){b.val("true")}else{b.val("false")}})},showError:function(){var d=this;var a=this.params.msgInBody+"";if(!this.msgDiv){if(a=="true"){this.msgDiv=$('<div class="m-verify-tip bottom" role="m-verify-tip" msgInBody="true" style="display: none;"></div>');$("body").append(this.msgDiv)}else{this.msgDiv=$('<div class="m-verify-tip bottom" role="m-verify-tip"  style="display: none;"></div>');this.el.after(this.msgDiv)}}var c=this.msgDiv;c.html('<div class="verify-tip-arrow"></div><div class="verify-tip-inner">当前复选框不能为空</div>');c.css("display","block");d.el.addClass("m-verify-error");d.el.removeClass("m-verify-success");d.err=true;if(a=="true"){var e=this;var b=Horn.Window.getNextZIndex();if(top.Horn&&top.Horn.Window){top.Horn.Window.MAX_ZINDEX=top.Horn.Window.MAX_ZINDEX-1}else{Horn.Window.MAX_ZINDEX=Horn.Window.MAX_ZINDEX-1}e.positionError(b);$(".h_floatdiv-con").bind("scroll",function(){e.positionError(b)});$(".h_floatdiv-con").bind("mousewheel",function(){e.positionError(b)});$(".h_tabpanel-contents").bind("scroll",function(){e.positionError(b)});$(".h_tabpanel-contents").bind("mousewheel",function(){e.positionError(b)});$(".m-message-title").mousemove(function(f){e.positionError(b)})}},removeError:function(){var b=this;b.el.removeClass("m-verify-error");b.el.addClass("m-verify-success");b.err=false;var a=this.msgDiv;if(a){a.remove()}delete this.msgDiv},positionError:function(){var b=this.el;var c=this.msgDiv;if(c){var d=b.offset();if(d&&d.top>0){var a=b.outerHeight();c.css("left",d.left+"px");c.css("z-index",9999);c.css("top",(d.top+a)+"px")}}},setValue:function(a){if(this.checkbox.get(0)){this.checkbox.get(0).checked=!!a}if(a&&$.type(a)!="boolean"){this.setStaticValue(a)}this.checkbox.val(a)},setStaticValue:function(a){this.checkbox.val(a)},validate:function(){if(this.disabled){return}var c=this;var a=this.el.find("input:checkbox[check*=required]");if(a&&a.size()>0){if(c.disabled===true){c.err=false;return}var b=this.checkbox.get(0).checked;if(!b){c.err=true;c.showError("该选项不能为空")}else{c.err=false;c.removeError()}}},getValue:function(){var a=this.checkbox.val();return JSON.parse(a)},setDisabled:function(a){if(a===false){this.checkbox.removeAttr("disabled");this.checkbox.disabled=false}else{this.checkbox.attr("disabled","disabled");this.checkbox.disabled=true}}});Horn.Field.regFieldType("div.hc_checkbox",Horn.Checkbox);
(function(a,b){a.CheckboxGroup=a.extend(Horn.Field,{COMPONENT_CLASS:"CheckboxGroup",checkboxs:null,init:function(){Horn.CheckboxGroup.superclass.init.apply(this,arguments);var g=this;this.name=this.el.attr("name");this.alias=this.el.attr("alias")||"";var f=this.el.children("div").children("label").find("input:checkbox");if(f.length>0){var d=f.first().attr("group");if(d){var e=d.split(";");b(e).each(function(h,i){g.checkGroup[i]=true})}}this.checkboxs={};g.checkboxClick();this.el.children("div").children("label").find("input:checkbox").each(function(h,i){var j=b(i);var k=j.val();g.checkboxs[k]=j}).click(function(){if(b(this).prop("checked")){b(this).attr("checked",true)}else{b(this).attr("checked",false)}var h=b(this).attr(Horn.Validate.CHECK);if(h&&h.indexOf(Horn.Validate.REQUIRED)>-1){var i=g.el.children("div").children("label").find("input:checkbox[checked]");if(i&&i.size()>0){g.removeError()}else{g.showError()}}});if(this.params.value){this.setValue(this.params.value)}if(this.params.readonly){this.setReadonly(true)}if(this.params.disabled){this.setDisabled(true)}this.defValue=this.params.defValue||this.params.value||"";var c=g.el.find("input:checkbox[check*=required]");if(c&&c.size()>0){this.checkRegx=b(c[0]).attr("check").split(";")}},getEventTarget:function(){return this.el.children("div").children("label").find("input:checkbox")},setValue:function(e){var d=this;if(!b.isArray(e)){e=e.toString().split(",")}for(var c in d.checkboxs){d.checkboxs[c].prop("checked",false);d.checkboxs[c].attr("checked",false)}b(e).each(function(f,g){var h=d.checkboxs[g];if(h){h.attr("checked",true);h.prop("checked",true)}});this.validate()},getValue:function(){var c="";this.el.children("div").children("label").find("input:checkbox").each(function(d,g){var f=b(g).attr("value");var e=b(g).prop("checked");if(e){c+=","+f}});c=c.substring(1);return c},reset:function(){this.setValue(this.defValue)},clearValue:function(){this.setValue("")},setEnable:function(c){var d=this;this.el.children("div").children("label").find("input:checkbox").each(function(e,f){if(c===false){b(f).attr("disabled","disabled")}else{b(f).removeAttr("disabled")}})},setDisabled:function(c){if(c===false){this.setEnable(true);this.disabled=false}else{this.setEnable(false);this.disabled=true}},setReadonly:function(c){var d=this;this.el.children("div").children("label").find("input:checkbox").each(function(e,f){if(c===false){d.readonly=false;b(f).removeAttr("onclick");b(f).bind("click",function(){setTimeout(function(){var g=b(f).attr(Horn.Validate.CHECK);if(g&&g.indexOf(Horn.Validate.REQUIRED)>-1){var h=d.el.children("div").children("label").find("input:checkbox[checked]");if(h&&h.size()>0){d.removeError()}else{d.showError()}}},10)})}else{d.readonly=true;if(d.el.children("div").children("label").find("input:checkbox[checked]").length==0){b(f).unbind("click")}b(f).get(0).onclick=function(){return false}}})},validate:function(){if(this.disabled){return}if(!this.skipValid&&this.checkRegx&&this.checkRegx.length>0){var d=this;if(d.disabled===true){d.err=false;return}var c=this.el.children("div").children("label").find("input:checkbox[checked]");if(c&&c.size()<1){Horn.Validate.addError(d,Horn.Validate.regexEnum.requiredMessage)}else{Horn.Validate.removeError(d)}}},checkboxClick:function(){var c=this;this.el.find("input:checkbox").each(function(d,e){var f=b(e);var g=f.val();c.checkboxs[g]=f}).click(function(){if(b(this).prop("checked")){b(this).attr("checked",true)}else{b(this).attr("checked",false)}var d=b(this).attr(Horn.Validate.CHECK);if(d&&d.indexOf(Horn.Validate.REQUIRED)>-1){var e=c.el.find("input:checkbox[checked]");if(e&&e.size()>0){c.removeError()}else{c.showError()}}})},showError:function(){var f=this;var c=this.params.msgInBody+"";if(!this.msgDiv){if(c=="true"){this.msgDiv=b('<div class="m-verify-tip bottom" role="m-verify-tip" msgInBody="true" style="display: none;"></div>');b("body").append(this.msgDiv)}else{this.msgDiv=b('<div class="m-verify-tip bottom" role="m-verify-tip"  style="display: none;"></div>');this.el.after(this.msgDiv)}}var e=this.msgDiv;e.html('<div class="verify-tip-arrow"></div><div class="verify-tip-inner">当前复选框不能为空</div>');e.css("display","block");f.el.addClass("m-verify-error");f.el.removeClass("m-verify-success");f.err=true;if(c=="true"){var g=this;var d=Horn.Window.getNextZIndex();if(top.Horn&&top.Horn.Window){top.Horn.Window.MAX_ZINDEX=top.Horn.Window.MAX_ZINDEX-1}else{Horn.Window.MAX_ZINDEX=Horn.Window.MAX_ZINDEX-1}g.positionError(d);b(".h_floatdiv-con").bind("scroll",function(){g.positionError(d)});b(".h_floatdiv-con").bind("mousewheel",function(){g.positionError(d)});b(".h_tabpanel-contents").bind("scroll",function(){g.positionError(d)});b(".h_tabpanel-contents").bind("mousewheel",function(){g.positionError(d)});b(".m-message-title").mousemove(function(h){g.positionError(d)})}},removeError:function(){var e=this;e.el.removeClass("m-verify-error");e.el.addClass("m-verify-success");e.err=false;var d=this.msgDiv;if(d){d.remove()}var c=this.el.parent().parent(".g-unit-wrap").children(".unit-label");delete this.msgDiv},positionError:function(){var d=this.el;var e=this.msgDiv;if(e){var f=d.offset();if(f&&f.top>0){var c=d.outerHeight();e.css("left",f.left+"px");e.css("z-index",9999);e.css("top",(f.top+c)+"px")}}},addRule:function(g){if(g&&g.indexOf(Horn.Validate.REQUIRED)>-1){var h=this;var d=h.el.children("div").children("label").find("input:checkbox[check*=required]");if(d&&d.size()>0){return}else{h.err=true;this.checkRegx=g.split(";");var c=h.el.children("div").children("label").find("input:checkbox");c.each(function(i,k){var j=b(k).attr(Horn.Validate.CHECK);if(j){if(j.indexOf(g)>-1){return}j+=Horn.Validate.CHECKSEP+g}else{j=g}b(k).attr(Horn.Validate.CHECK,j);b(k).bind("click");h.checkboxClick()});if(g&&g.indexOf(Horn.Validate.REQUIRED)>-1){var e=this.el.parent().parent(".g-unit-wrap").children(".unit-label");var f=b("span.m-verify-symbol",e);if(!f.length){f=b("<span>",{"class":"m-verify-symbol",html:"*"});e.prepend(f)}else{f.html("*")}}}}else{return}},removeRule:function(f){var h=this;var c=h.el.children("div").children("label").find("input:checkbox");c.each(function(i,l){var j=b(l).attr(Horn.Validate.CHECK);if(j&&j.indexOf(f)>-1){var k=j.split(Horn.Validate.CHECKSEP);k=b.grep(k,function(n,m){return n&&n!=f});b(l).attr(Horn.Validate.CHECK,k.join(";"))}b(l).unbind("click")});this.checkRegx=[];if(f&&f.indexOf(Horn.Validate.REQUIRED)>-1){this.el.removeClass("m-verify-success");this.el.removeClass("m-verify-error");var d=this.el.parent().parent(".g-unit-wrap").children(".unit-label");var e=b("span.m-verify-symbol",d);if(e){e.remove()}var g=this.msgDiv;if(g){g.remove()}}}});a.Field.regFieldType("div.hc_checkbox-group",a.CheckboxGroup)})(Horn,jQuery);
var swfobject=function(){var aq="undefined",aD="object",ab="Shockwave Flash",X="ShockwaveFlash.ShockwaveFlash",aE="application/x-shockwave-flash",ac="SWFObjectExprInst",ax="onreadystatechange",af=window,aL=document,aB=navigator,aa=false,Z=[aN],aG=[],ag=[],al=[],aJ,ad,ap,at,ak=false,aU=false,aH,an,aI=true,ah=function(){var a=typeof aL.getElementById!=aq&&typeof aL.getElementsByTagName!=aq&&typeof aL.createElement!=aq,e=aB.userAgent.toLowerCase(),c=aB.platform.toLowerCase(),h=c?/win/.test(c):/win/.test(e),j=c?/mac/.test(c):/mac/.test(e),g=/webkit/.test(e)?parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,d=!+"\v1",f=[0,0,0],k=null;if(typeof aB.plugins!=aq&&typeof aB.plugins[ab]==aD){k=aB.plugins[ab].description;if(k&&!(typeof aB.mimeTypes!=aq&&aB.mimeTypes[aE]&&!aB.mimeTypes[aE].enabledPlugin)){aa=true;d=false;k=k.replace(/^.*\s+(\S+\s+\S+$)/,"$1");f[0]=parseInt(k.replace(/^(.*)\..*$/,"$1"),10);f[1]=parseInt(k.replace(/^.*\.(.*)\s.*$/,"$1"),10);f[2]=/[a-zA-Z]/.test(k)?parseInt(k.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof af.ActiveXObject!=aq){try{var i=new ActiveXObject(X);if(i){k=i.GetVariable("$version");if(k){d=true;k=k.split(" ")[1].split(",");f=[parseInt(k[0],10),parseInt(k[1],10),parseInt(k[2],10)]}}}catch(b){}}}return{w3:a,pv:f,wk:g,ie:d,win:h,mac:j}}(),aK=function(){if(!ah.w3){return}if((typeof aL.readyState!=aq&&aL.readyState=="complete")||(typeof aL.readyState==aq&&(aL.getElementsByTagName("body")[0]||aL.body))){aP()}if(!ak){if(typeof aL.addEventListener!=aq){aL.addEventListener("DOMContentLoaded",aP,false)}if(ah.ie&&ah.win){aL.attachEvent(ax,function(){if(aL.readyState=="complete"){aL.detachEvent(ax,arguments.callee);aP()}});if(af==top){(function(){if(ak){return}try{aL.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}aP()})()}}if(ah.wk){(function(){if(ak){return}if(!/loaded|complete/.test(aL.readyState)){setTimeout(arguments.callee,0);return}aP()})()}aC(aP)}}();function aP(){if(ak){return}try{var b=aL.getElementsByTagName("body")[0].appendChild(ar("span"));b.parentNode.removeChild(b)}catch(a){return}ak=true;var d=Z.length;for(var c=0;c<d;c++){Z[c]()}}function aj(a){if(ak){a()}else{Z[Z.length]=a}}function aC(a){if(typeof af.addEventListener!=aq){af.addEventListener("load",a,false)}else{if(typeof aL.addEventListener!=aq){aL.addEventListener("load",a,false)}else{if(typeof af.attachEvent!=aq){aM(af,"onload",a)}else{if(typeof af.onload=="function"){var b=af.onload;af.onload=function(){b();a()}}else{af.onload=a}}}}}function aN(){if(aa){Y()}else{am()}}function Y(){var d=aL.getElementsByTagName("body")[0];var b=ar(aD);b.setAttribute("type",aE);var a=d.appendChild(b);if(a){var c=0;(function(){if(typeof a.GetVariable!=aq){var e=a.GetVariable("$version");if(e){e=e.split(" ")[1].split(",");ah.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]}}else{if(c<10){c++;setTimeout(arguments.callee,10);return}}d.removeChild(b);a=null;am()})()}else{am()}}function am(){var g=aG.length;if(g>0){for(var h=0;h<g;h++){var c=aG[h].id;var l=aG[h].callbackFn;var a={success:false,id:c};if(ah.pv[0]>0){var i=aS(c);if(i){if(ao(aG[h].swfVersion)&&!(ah.wk&&ah.wk<312)){ay(c,true);if(l){a.success=true;a.ref=av(c);l(a)}}else{if(aG[h].expressInstall&&au()){var e={};e.data=aG[h].expressInstall;e.width=i.getAttribute("width")||"0";e.height=i.getAttribute("height")||"0";if(i.getAttribute("class")){e.styleclass=i.getAttribute("class")}if(i.getAttribute("align")){e.align=i.getAttribute("align")}var f={};var d=i.getElementsByTagName("param");var k=d.length;for(var j=0;j<k;j++){if(d[j].getAttribute("name").toLowerCase()!="movie"){f[d[j].getAttribute("name")]=d[j].getAttribute("value")}}ae(e,f,c,l)}else{aF(i);if(l){l(a)}}}}}else{ay(c,true);if(l){var b=av(c);if(b&&typeof b.SetVariable!=aq){a.success=true;a.ref=b}l(a)}}}}}function av(b){var d=null;var c=aS(b);if(c&&c.nodeName=="OBJECT"){if(typeof c.SetVariable!=aq){d=c}else{var a=c.getElementsByTagName(aD)[0];if(a){d=a}}}return d}function au(){return !aU&&ao("6.0.65")&&(ah.win||ah.mac)&&!(ah.wk&&ah.wk<312)}function ae(f,d,h,e){aU=true;ap=e||null;at={success:false,id:h};var a=aS(h);if(a){if(a.nodeName=="OBJECT"){aJ=aO(a);ad=null}else{aJ=a;ad=h}f.id=ac;if(typeof f.width==aq||(!/%$/.test(f.width)&&parseInt(f.width,10)<310)){f.width="310"}if(typeof f.height==aq||(!/%$/.test(f.height)&&parseInt(f.height,10)<137)){f.height="137"}aL.title=aL.title.slice(0,47)+" - Flash Player Installation";var b=ah.ie&&ah.win?"ActiveX":"PlugIn",c="MMredirectURL="+af.location.toString().replace(/&/g,"%26")+"&MMplayerType="+b+"&MMdoctitle="+aL.title;if(typeof d.flashvars!=aq){d.flashvars+="&"+c}else{d.flashvars=c}if(ah.ie&&ah.win&&a.readyState!=4){var g=ar("div");h+="SWFObjectNew";g.setAttribute("id",h);a.parentNode.insertBefore(g,a);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}aA(f,d,h)}}function aF(a){if(ah.ie&&ah.win&&a.readyState!=4){var b=ar("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(aO(a),b);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}else{a.parentNode.replaceChild(aO(a),a)}}function aO(b){var d=ar("div");if(ah.win&&ah.ie){d.innerHTML=b.innerHTML}else{var e=b.getElementsByTagName(aD)[0];if(e){var a=e.childNodes;if(a){var f=a.length;for(var c=0;c<f;c++){if(!(a[c].nodeType==1&&a[c].nodeName=="PARAM")&&!(a[c].nodeType==8)){d.appendChild(a[c].cloneNode(true))}}}}}return d}function aA(e,g,c){var d,a=aS(c);if(ah.wk&&ah.wk<312){return d}if(a){if(typeof e.id==aq){e.id=c}if(ah.ie&&ah.win){var f="";for(var i in e){if(e[i]!=Object.prototype[i]){if(i.toLowerCase()=="data"){g.movie=e[i]}else{if(i.toLowerCase()=="styleclass"){f+=' class="'+e[i]+'"'}else{if(i.toLowerCase()!="classid"){f+=" "+i+'="'+e[i]+'"'}}}}}var h="";for(var j in g){if(g[j]!=Object.prototype[j]){h+='<param name="'+j+'" value="'+g[j]+'" />'}}a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>";ag[ag.length]=e.id;d=aS(e.id)}else{var b=ar(aD);b.setAttribute("type",aE);for(var k in e){if(e[k]!=Object.prototype[k]){if(k.toLowerCase()=="styleclass"){b.setAttribute("class",e[k])}else{if(k.toLowerCase()!="classid"){b.setAttribute(k,e[k])}}}}for(var l in g){if(g[l]!=Object.prototype[l]&&l.toLowerCase()!="movie"){aQ(b,l,g[l])}}a.parentNode.replaceChild(b,a);d=b}}return d}function aQ(b,d,c){var a=ar("param");a.setAttribute("name",d);a.setAttribute("value",c);b.appendChild(a)}function aw(a){var b=aS(a);if(b&&b.nodeName=="OBJECT"){if(ah.ie&&ah.win){b.style.display="none";(function(){if(b.readyState==4){aT(a)}else{setTimeout(arguments.callee,10)}})()}else{b.parentNode.removeChild(b)}}}function aT(a){var b=aS(a);if(b){for(var c in b){if(typeof b[c]=="function"){b[c]=null}}b.parentNode.removeChild(b)}}function aS(a){var c=null;try{c=aL.getElementById(a)}catch(b){}return c}function ar(a){return aL.createElement(a)}function aM(a,c,b){a.attachEvent(c,b);al[al.length]=[a,c,b]}function ao(a){var b=ah.pv,c=a.split(".");c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10)||0;c[2]=parseInt(c[2],10)||0;return(b[0]>c[0]||(b[0]==c[0]&&b[1]>c[1])||(b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]))?true:false}function az(b,f,a,c){if(ah.ie&&ah.mac){return}var e=aL.getElementsByTagName("head")[0];if(!e){return}var g=(a&&typeof a=="string")?a:"screen";if(c){aH=null;an=null}if(!aH||an!=g){var d=ar("style");d.setAttribute("type","text/css");d.setAttribute("media",g);aH=e.appendChild(d);if(ah.ie&&ah.win&&typeof aL.styleSheets!=aq&&aL.styleSheets.length>0){aH=aL.styleSheets[aL.styleSheets.length-1]}an=g}if(ah.ie&&ah.win){if(aH&&typeof aH.addRule==aD){aH.addRule(b,f)}}else{if(aH&&typeof aL.createTextNode!=aq){aH.appendChild(aL.createTextNode(b+" {"+f+"}"))}}}function ay(a,c){if(!aI){return}var b=c?"visible":"hidden";if(ak&&aS(a)){aS(a).style.visibility=b}else{az("#"+a,"visibility:"+b)}}function ai(b){var a=/[\\\"<>\.;]/;var c=a.exec(b)!=null;return c&&typeof encodeURIComponent!=aq?encodeURIComponent(b):b}var aR=function(){if(ah.ie&&ah.win){window.attachEvent("onunload",function(){var a=al.length;for(var b=0;b<a;b++){al[b][0].detachEvent(al[b][1],al[b][2])}var d=ag.length;for(var c=0;c<d;c++){aw(ag[c])}for(var e in ah){ah[e]=null}ah=null;for(var f in swfobject){swfobject[f]=null}swfobject=null})}}();return{registerObject:function(a,e,c,b){if(ah.w3&&a&&e){var d={};d.id=a;d.swfVersion=e;d.expressInstall=c;d.callbackFn=b;aG[aG.length]=d;ay(a,false)}else{if(b){b({success:false,id:a})}}},getObjectById:function(a){if(ah.w3){return av(a)}},embedSWF:function(k,e,h,f,c,a,b,i,g,j){var d={success:false,id:e};if(ah.w3&&!(ah.wk&&ah.wk<312)&&k&&e&&h&&f&&c){ay(e,false);aj(function(){h+="";f+="";var q={};if(g&&typeof g===aD){for(var o in g){q[o]=g[o]}}q.data=k;q.width=h;q.height=f;var n={};if(i&&typeof i===aD){for(var p in i){n[p]=i[p]}}if(b&&typeof b===aD){for(var l in b){if(typeof n.flashvars!=aq){n.flashvars+="&"+l+"="+b[l]}else{n.flashvars=l+"="+b[l]}}}if(ao(c)){var m=aA(q,n,e);if(q.id==e){ay(e,true)}d.success=true;d.ref=m}else{if(a&&au()){q.data=a;ae(q,n,e,j);return}else{ay(e,true)}}if(j){j(d)}})}else{if(j){j(d)}}},switchOffAutoHideShow:function(){aI=false},ua:ah,getFlashPlayerVersion:function(){return{major:ah.pv[0],minor:ah.pv[1],release:ah.pv[2]}},hasFlashPlayerVersion:ao,createSWF:function(a,b,c){if(ah.w3){return aA(a,b,c)}else{return undefined}},showExpressInstall:function(b,a,d,c){if(ah.w3&&au()){ae(b,a,d,c)}},removeSWF:function(a){if(ah.w3){aw(a)}},createCSS:function(b,a,c,d){if(ah.w3){az(b,a,c,d)}},addDomLoadEvent:aj,addLoadEvent:aC,getQueryParamValue:function(b){var a=aL.location.search||aL.location.hash;if(a){if(/\?/.test(a)){a=a.split("?")[1]}if(b==null){return ai(a)}var c=a.split("&");for(var d=0;d<c.length;d++){if(c[d].substring(0,c[d].indexOf("="))==b){return ai(c[d].substring((c[d].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(aU){var a=aS(ac);if(a&&aJ){a.parentNode.replaceChild(aJ,a);if(ad){ay(ad,true);if(ah.ie&&ah.win){aJ.style.display="block"}}if(ap){ap(at)}}aU=false}}}}();var SWFUpload;if(SWFUpload==undefined){SWFUpload=function(b){this.initSWFUpload(b)}}SWFUpload.prototype.initSWFUpload=function(c){try{this.customSettings={};this.settings=c;this.eventQueue=[];this.movieName="SWFUpload_"+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings();this.loadFlash();this.displayDebugInfo()}catch(d){delete SWFUpload.instances[this.movieName];throw d}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.2.0 2009-03-25";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120};SWFUpload.CURSOR={ARROW:-1,HAND:-2};SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"};SWFUpload.completeURL=function(e){if(typeof(e)!=="string"||e.match(/^https?:\/\//i)||e.match(/^\//)){return e}var f=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");var d=window.location.pathname.lastIndexOf("/");if(d<=0){path="/"}else{path=window.location.pathname.substr(0,d)+"/"}if(e!=""){return path+e}else{return e}};SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(c,d){this.settings[c]=(this.settings[c]==undefined)?d:this.settings[c]};this.ensureDefault("upload_url","");this.ensureDefault("preserve_relative_urls",false);this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("http_success",[]);this.ensureDefault("assume_success_timeout",0);this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id","");this.ensureDefault("button_placeholder",null);this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW);this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);this.ensureDefault("debug_handler",this.debugMessage);this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;if(!!this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+new Date().getTime()}if(!this.settings.preserve_relative_urls){this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url);this.settings.button_image_url=SWFUpload.completeURL(this.settings.button_image_url)}delete this.ensureDefault};SWFUpload.prototype.loadFlash=function(){var d,c;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added"}d=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder;if(d==undefined){throw"Could not find the placeholder element: "+this.settings.button_placeholder_id}c=document.createElement("div");c.innerHTML=this.getFlashHTML();d.parentNode.replaceChild(c.firstChild,d);if(window[this.movieName]==undefined){window[this.movieName]=this.getMovieElement()}};SWFUpload.prototype.getFlashHTML=function(){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")};SWFUpload.prototype.getFlashVars=function(){var c=this.buildParamString();var d=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(d),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(c),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName)}if(this.movieElement===null){throw"Could not find Flash element"}return this.movieElement};SWFUpload.prototype.buildParamString=function(){var f=this.settings.post_params;var d=[];if(typeof(f)==="object"){for(var e in f){if(f.hasOwnProperty(e)){d.push(encodeURIComponent(e.toString())+"="+encodeURIComponent(f[e].toString()))}}}return d.join("&amp;")};SWFUpload.prototype.destroy=function(){try{this.cancelUpload(null,false);var g=null;g=this.getMovieElement();if(g&&typeof(g.CallFunction)==="unknown"){for(var j in g){try{if(typeof(g[j])==="function"){g[j]=null}}catch(h){}}try{g.parentNode.removeChild(g)}catch(f){}}window[this.movieName]=null;SWFUpload.instances[this.movieName]=null;delete SWFUpload.instances[this.movieName];this.movieElement=null;this.settings=null;this.customSettings=null;this.eventQueue=null;this.movieName=null;return true}catch(i){return false}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","\t","upload_url:               ",this.settings.upload_url,"\n","\t","flash_url:                ",this.settings.flash_url,"\n","\t","use_query_string:         ",this.settings.use_query_string.toString(),"\n","\t","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","\t","http_success:             ",this.settings.http_success.join(", "),"\n","\t","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","\t","file_post_name:           ",this.settings.file_post_name,"\n","\t","post_params:              ",this.settings.post_params.toString(),"\n","\t","file_types:               ",this.settings.file_types,"\n","\t","file_types_description:   ",this.settings.file_types_description,"\n","\t","file_size_limit:          ",this.settings.file_size_limit,"\n","\t","file_upload_limit:        ",this.settings.file_upload_limit,"\n","\t","file_queue_limit:         ",this.settings.file_queue_limit,"\n","\t","debug:                    ",this.settings.debug.toString(),"\n","\t","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","\t","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","\t","button_placeholder:       ",(this.settings.button_placeholder?"Set":"Not Set"),"\n","\t","button_image_url:         ",this.settings.button_image_url.toString(),"\n","\t","button_width:             ",this.settings.button_width.toString(),"\n","\t","button_height:            ",this.settings.button_height.toString(),"\n","\t","button_text:              ",this.settings.button_text.toString(),"\n","\t","button_text_style:        ",this.settings.button_text_style.toString(),"\n","\t","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","\t","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","\t","button_action:            ",this.settings.button_action.toString(),"\n","\t","button_disabled:          ",this.settings.button_disabled.toString(),"\n","\t","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","\t","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","\t","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","\t","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","\t","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","\t","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","\t","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","\t","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","\t","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","\t","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","\t","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n"].join(""))};SWFUpload.prototype.addSetting=function(d,f,e){if(f==undefined){return(this.settings[d]=e)}else{return(this.settings[d]=f)}};SWFUpload.prototype.getSetting=function(b){if(this.settings[b]!=undefined){return this.settings[b]}return""};SWFUpload.prototype.callFlash=function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getMovieElement();var returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>");returnValue=eval(returnString)}catch(ex){throw"Call to "+functionName+" failed"}if(returnValue!=undefined&&typeof returnValue.post==="object"){returnValue=this.unescapeFilePostParams(returnValue)}return returnValue};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")};SWFUpload.prototype.startUpload=function(b){this.callFlash("StartUpload",[b])};SWFUpload.prototype.cancelUpload=function(d,c){if(c!==false){c=true}this.callFlash("CancelUpload",[d,c])};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")};SWFUpload.prototype.setStats=function(b){this.callFlash("SetStats",[b])};SWFUpload.prototype.getFile=function(b){if(typeof(b)==="number"){return this.callFlash("GetFileByIndex",[b])}else{return this.callFlash("GetFile",[b])}};SWFUpload.prototype.addFileParam=function(e,d,f){return this.callFlash("AddFileParam",[e,d,f])};SWFUpload.prototype.removeFileParam=function(d,c){this.callFlash("RemoveFileParam",[d,c])};SWFUpload.prototype.setUploadURL=function(b){this.settings.upload_url=b.toString();this.callFlash("SetUploadURL",[b])};SWFUpload.prototype.setPostParams=function(b){this.settings.post_params=b;this.callFlash("SetPostParams",[b])};SWFUpload.prototype.addPostParam=function(d,c){this.settings.post_params[d]=c;this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.removePostParam=function(b){delete this.settings.post_params[b];this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.setFileTypes=function(d,c){this.settings.file_types=d;this.settings.file_types_description=c;this.callFlash("SetFileTypes",[d,c])};SWFUpload.prototype.setFileSizeLimit=function(b){this.settings.file_size_limit=b;this.callFlash("SetFileSizeLimit",[b])};SWFUpload.prototype.setFileUploadLimit=function(b){this.settings.file_upload_limit=b;this.callFlash("SetFileUploadLimit",[b])};SWFUpload.prototype.setFileQueueLimit=function(b){this.settings.file_queue_limit=b;this.callFlash("SetFileQueueLimit",[b])};SWFUpload.prototype.setFilePostName=function(b){this.settings.file_post_name=b;this.callFlash("SetFilePostName",[b])};SWFUpload.prototype.setUseQueryString=function(b){this.settings.use_query_string=b;this.callFlash("SetUseQueryString",[b])};SWFUpload.prototype.setRequeueOnError=function(b){this.settings.requeue_on_error=b;this.callFlash("SetRequeueOnError",[b])};SWFUpload.prototype.setHTTPSuccess=function(b){if(typeof b==="string"){b=b.replace(" ","").split(",")}this.settings.http_success=b;this.callFlash("SetHTTPSuccess",[b])};SWFUpload.prototype.setAssumeSuccessTimeout=function(b){this.settings.assume_success_timeout=b;this.callFlash("SetAssumeSuccessTimeout",[b])};SWFUpload.prototype.setDebugEnabled=function(b){this.settings.debug_enabled=b;this.callFlash("SetDebugEnabled",[b])};SWFUpload.prototype.setButtonImageURL=function(b){if(b==undefined){b=""}this.settings.button_image_url=b;this.callFlash("SetButtonImageURL",[b])};SWFUpload.prototype.setButtonDimensions=function(f,e){this.settings.button_width=f;this.settings.button_height=e;var d=this.getMovieElement();if(d!=undefined){d.style.width=f+"px";d.style.height=e+"px"}this.callFlash("SetButtonDimensions",[f,e])};SWFUpload.prototype.setButtonText=function(b){this.settings.button_text=b;this.callFlash("SetButtonText",[b])};SWFUpload.prototype.setButtonTextPadding=function(c,d){this.settings.button_text_top_padding=d;this.settings.button_text_left_padding=c;this.callFlash("SetButtonTextPadding",[c,d])};SWFUpload.prototype.setButtonTextStyle=function(b){this.settings.button_text_style=b;this.callFlash("SetButtonTextStyle",[b])};SWFUpload.prototype.setButtonDisabled=function(b){this.settings.button_disabled=b;this.callFlash("SetButtonDisabled",[b])};SWFUpload.prototype.setButtonAction=function(b){this.settings.button_action=b;this.callFlash("SetButtonAction",[b])};SWFUpload.prototype.setButtonCursor=function(b){this.settings.button_cursor=b;this.callFlash("SetButtonCursor",[b])};SWFUpload.prototype.queueEvent=function(d,f){if(f==undefined){f=[]}else{if(!(f instanceof Array)){f=[f]}}var e=this;if(typeof this.settings[d]==="function"){this.eventQueue.push(function(){this.settings[d].apply(this,f)});setTimeout(function(){e.executeNextEvent()},0)}else{if(this.settings[d]!==null){throw"Event handler "+d+" is unknown or is not a function"}}};SWFUpload.prototype.executeNextEvent=function(){var b=this.eventQueue?this.eventQueue.shift():null;if(typeof(b)==="function"){b.apply(this)}};SWFUpload.prototype.unescapeFilePostParams=function(l){var j=/[$]([0-9a-f]{4})/i;var i={};var k;if(l!=undefined){for(var h in l.post){if(l.post.hasOwnProperty(h)){k=h;var g;while((g=j.exec(k))!==null){k=k.replace(g[0],String.fromCharCode(parseInt("0x"+g[1],16)))}i[k]=l.post[h]}}l.post=i}return l};SWFUpload.prototype.testExternalInterface=function(){try{return this.callFlash("TestExternalInterface")}catch(b){return false}};SWFUpload.prototype.flashReady=function(){var b=this.getMovieElement();if(!b){this.debug("Flash called back ready but the flash movie can't be found.");return}this.cleanUp(b);this.queueEvent("swfupload_loaded_handler")};SWFUpload.prototype.cleanUp=function(f){try{if(this.movieElement&&typeof(f.CallFunction)==="unknown"){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(var h in f){try{if(typeof(f[h])==="function"){f[h]=null}}catch(e){}}}}catch(g){}window.__flash__removeCallback=function(c,b){try{if(c){c[b]=null}}catch(a){}}};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")};SWFUpload.prototype.fileQueued=function(b){b=this.unescapeFilePostParams(b);this.queueEvent("file_queued_handler",b)};SWFUpload.prototype.fileQueueError=function(e,f,d){e=this.unescapeFilePostParams(e);this.queueEvent("file_queue_error_handler",[e,f,d])};SWFUpload.prototype.fileDialogComplete=function(d,f,e){this.queueEvent("file_dialog_complete_handler",[d,f,e])};SWFUpload.prototype.uploadStart=function(b){b=this.unescapeFilePostParams(b);this.queueEvent("return_upload_start_handler",b)};SWFUpload.prototype.returnUploadStart=function(d){var c;if(typeof this.settings.upload_start_handler==="function"){d=this.unescapeFilePostParams(d);c=this.settings.upload_start_handler.call(this,d)}else{if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function"}}if(c===undefined){c=true}c=!!c;this.callFlash("ReturnUploadStart",[c])};SWFUpload.prototype.uploadProgress=function(e,f,d){e=this.unescapeFilePostParams(e);this.queueEvent("upload_progress_handler",[e,f,d])};SWFUpload.prototype.uploadError=function(e,f,d){e=this.unescapeFilePostParams(e);this.queueEvent("upload_error_handler",[e,f,d])};SWFUpload.prototype.uploadSuccess=function(d,e,f){d=this.unescapeFilePostParams(d);this.queueEvent("upload_success_handler",[d,e,f])};SWFUpload.prototype.uploadComplete=function(b){b=this.unescapeFilePostParams(b);this.queueEvent("upload_complete_handler",b)};SWFUpload.prototype.debug=function(b){this.queueEvent("debug_handler",b)};SWFUpload.prototype.debugMessage=function(h){if(this.settings.debug){var f,g=[];if(typeof h==="object"&&typeof h.name==="string"&&typeof h.message==="string"){for(var e in h){if(h.hasOwnProperty(e)){g.push(e+": "+h[e])}}f=g.join("\n")||"";g=f.split("\n");f="EXCEPTION: "+g.join("\nEXCEPTION: ");SWFUpload.Console.writeLine(f)}else{SWFUpload.Console.writeLine(h)}}};SWFUpload.Console={};SWFUpload.Console.writeLine=function(g){var e,f;try{e=document.getElementById("SWFUpload_Console");if(!e){f=document.createElement("form");document.getElementsByTagName("body")[0].appendChild(f);e=document.createElement("textarea");e.id="SWFUpload_Console";e.style.fontFamily="monospace";e.setAttribute("wrap","off");e.wrap="off";e.style.overflow="auto";e.style.width="700px";e.style.height="350px";e.style.margin="5px";f.appendChild(e)}e.value+=g+"\n";e.scrollTop=e.scrollHeight-e.clientHeight}catch(h){if(!Horn.Uploadify.isCloseAlert){alert("Exception: "+h.name+" Message: "+h.message)}}};(function(c){var b={init:function(d,e){return this.each(function(){var n=c(this);var m=n.clone();var j=c.extend({id:n.attr("id"),swf:"uploadify.swf",uploader:"uploadify.php",auto:true,buttonClass:"",buttonCursor:"hand",buttonImage:null,buttonText:"SELECT FILES",checkExisting:false,debug:false,fileObjName:"Filedata",fileSizeLimit:0,fileTypeDesc:"All Files",fileTypeExts:"*.*",height:30,itemTemplate:false,method:"post",multi:true,formData:{},preventCaching:true,progressData:"percentage",queueID:false,queueSizeLimit:999,removeCompleted:true,removeTimeout:3,requeueErrors:false,successTimeout:30,uploadLimit:0,width:120,overrideEvents:[]},d);var g={assume_success_timeout:j.successTimeout,button_placeholder_id:j.id,button_width:j.width,button_height:j.height,button_text:null,button_text_style:null,button_text_top_padding:0,button_text_left_padding:0,button_action:(j.multi?SWFUpload.BUTTON_ACTION.SELECT_FILES:SWFUpload.BUTTON_ACTION.SELECT_FILE),button_disabled:false,button_cursor:(j.buttonCursor=="arrow"?SWFUpload.CURSOR.ARROW:SWFUpload.CURSOR.HAND),button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,debug:j.debug,requeue_on_error:j.requeueErrors,file_post_name:j.fileObjName,file_size_limit:j.fileSizeLimit,file_types:j.fileTypeExts,file_types_description:j.fileTypeDesc,file_queue_limit:j.queueSizeLimit,file_upload_limit:j.uploadLimit,flash_url:j.swf,prevent_swf_caching:j.preventCaching,post_params:j.formData,upload_url:j.uploader,use_query_string:(j.method=="get"),file_dialog_complete_handler:a.onDialogClose,file_dialog_start_handler:a.onDialogOpen,file_queued_handler:a.onSelect,file_queue_error_handler:a.onSelectError,swfupload_loaded_handler:j.onSWFReady,upload_complete_handler:a.onUploadComplete,upload_error_handler:a.onUploadError,upload_progress_handler:a.onUploadProgress,upload_start_handler:a.onUploadStart,upload_success_handler:a.onUploadSuccess};if(e){g=c.extend(g,e)}g=c.extend(g,j);var o=swfobject.getFlashPlayerVersion();var h=(o.major>=9);if(h){window["uploadify_"+j.id]=new SWFUpload(g);var i=window["uploadify_"+j.id];n.data("uploadify",i);var l=c("<div />",{id:j.id,"class":"uploadify",css:{height:j.height+"px",width:j.width+"px"}});c("#"+i.movieName).wrap(l);l=c("#"+j.id);l.data("uploadify",i);var f=c("<div />",{id:j.id+"-button","class":"uploadify-button "+j.buttonClass});if(j.buttonImage){f.css({"background-image":"url('"+j.buttonImage+"')","text-indent":"-9999px"})}f.html('<span class="uploadify-button-text">'+j.buttonText+"</span>").css({height:j.height+"px","line-height":j.height+"px",width:j.width+"px"});l.append(f);c("#"+i.movieName).css({position:"absolute","z-index":1});if(!j.queueID){var k=c("<div />",{id:j.id+"-queue","class":"uploadify-queue"});l.after(k);i.settings.queueID=j.id+"-queue";i.settings.defaultQueue=true}i.queueData={files:{},filesSelected:0,filesQueued:0,filesReplaced:0,filesCancelled:0,filesErrored:0,uploadsSuccessful:0,uploadsErrored:0,averageSpeed:0,queueLength:0,queueSize:0,uploadSize:0,queueBytesUploaded:0,uploadQueue:[],errorMsg:"Some files were not added to the queue:"};i.original=m;i.wrapper=l;i.button=f;i.queue=k;if(j.onInit){j.onInit.call(n,i)}}else{if(j.onFallback){j.onFallback.call(n)}}})},cancel:function(d,f){var e=arguments;this.each(function(){var l=c(this),i=l.data("uploadify"),j=i.settings,h=-1;if(e[0]){if(e[0]=="*"){var g=i.queueData.queueLength;c("#"+j.queueID).find(".uploadify-queue-item").each(function(){h++;if(e[1]===true){i.cancelUpload(c(this).attr("id"),false)}else{i.cancelUpload(c(this).attr("id"))}c(this).find(".data").removeClass("data").html(" - Cancelled");c(this).find(".uploadify-progress-bar").remove();c(this).delay(1000+100*h).fadeOut(500,function(){c(this).remove()})});i.queueData.queueSize=0;i.queueData.queueLength=0;if(j.onClearQueue){j.onClearQueue.call(l,g)}}else{for(var m=0;m<e.length;m++){i.cancelUpload(e[m]);c("#"+e[m]).find(".data").removeClass("data").html(" - Cancelled");c("#"+e[m]).find(".uploadify-progress-bar").remove();c("#"+e[m]).delay(1000+100*m).fadeOut(500,function(){c(this).remove()})}}}else{var k=c("#"+j.queueID).find(".uploadify-queue-item").get(0);$item=c(k);i.cancelUpload($item.attr("id"));$item.find(".data").removeClass("data").html(" - Cancelled");$item.find(".uploadify-progress-bar").remove();$item.delay(1000).fadeOut(500,function(){c(this).remove()})}})},destroy:function(){this.each(function(){var f=c(this),d=f.data("uploadify"),e=d.settings;d.destroy();if(e.defaultQueue){c("#"+e.queueID).remove()}c("#"+e.id).replaceWith(d.original);if(e.onDestroy){e.onDestroy.call(this)}delete d})},disable:function(d){this.each(function(){var i=c(this),f=i.data("uploadify"),g=f.settings;if(d){f.button.addClass("disabled");if(g.onDisable){g.onDisable.call(this)}}else{f.button.removeClass("disabled");if(g.onEnable){g.onEnable.call(this)}}try{f.setButtonDisabled(d)}catch(h){}})},settings:function(e,g,h){var d=arguments;var f=g;this.each(function(){var k=c(this),i=k.data("uploadify"),j=i.settings;if(typeof(d[0])=="object"){for(var l in g){setData(l,g[l])}}if(d.length===1){f=j[e]}else{switch(e){case"uploader":i.setUploadURL(g);break;case"formData":if(!h){g=c.extend(j.formData,g)}i.setPostParams(j.formData);break;case"method":if(g=="get"){i.setUseQueryString(true)}else{i.setUseQueryString(false)}break;case"fileObjName":i.setFilePostName(g);break;case"fileTypeExts":i.setFileTypes(g,j.fileTypeDesc);break;case"fileTypeDesc":i.setFileTypes(j.fileTypeExts,g);break;case"fileSizeLimit":i.setFileSizeLimit(g);break;case"uploadLimit":i.setFileUploadLimit(g);break;case"queueSizeLimit":i.setFileQueueLimit(g);break;case"buttonImage":i.button.css("background-image",settingValue);break;case"buttonCursor":if(g=="arrow"){i.setButtonCursor(SWFUpload.CURSOR.ARROW)}else{i.setButtonCursor(SWFUpload.CURSOR.HAND)}break;case"buttonText":c("#"+j.id+"-button").find(".uploadify-button-text").html(g);break;case"width":i.setButtonDimensions(g,j.height);break;case"height":i.setButtonDimensions(j.width,g);break;case"multi":if(g){i.setButtonAction(SWFUpload.BUTTON_ACTION.SELECT_FILES)}else{i.setButtonAction(SWFUpload.BUTTON_ACTION.SELECT_FILE)}break}j[e]=g}});if(d.length===1){return f}},stop:function(){this.each(function(){var e=c(this),d=e.data("uploadify");d.queueData.averageSpeed=0;d.queueData.uploadSize=0;d.queueData.bytesUploaded=0;d.queueData.uploadQueue=[];d.stopUpload()})},upload:function(){var d=arguments;this.each(function(){var f=c(this),e=f.data("uploadify");e.queueData.averageSpeed=0;e.queueData.uploadSize=0;e.queueData.bytesUploaded=0;e.queueData.uploadQueue=[];if(d[0]){if(d[0]=="*"){e.queueData.uploadSize=e.queueData.queueSize;e.queueData.uploadQueue.push("*");e.startUpload()}else{for(var g=0;g<d.length;g++){e.queueData.uploadSize+=e.queueData.files[d[g]].size;e.queueData.uploadQueue.push(d[g])}e.startUpload(e.queueData.uploadQueue.shift())}}else{e.startUpload()}})}};var a={onDialogOpen:function(){var d=this.settings;this.queueData.errorMsg="Some files were not added to the queue:";this.queueData.filesReplaced=0;this.queueData.filesCancelled=0;if(d.onDialogOpen){d.onDialogOpen.call(this)}},onDialogClose:function(d,f,g){var e=this.settings;this.queueData.filesErrored=d-f;this.queueData.filesSelected=d;this.queueData.filesQueued=f-this.queueData.filesCancelled;this.queueData.queueLength=g;if(c.inArray("onDialogClose",e.overrideEvents)<0){if(this.queueData.filesErrored>0){if(!Horn.Uploadify.isCloseAlert){alert(this.queueData.errorMsg)}}}if(e.onDialogClose){e.onDialogClose.call(this,this.queueData)}if(e.auto){c("#"+e.id).uploadify("upload","*")}},onSelect:function(h){var i=this.settings;var f={};for(var g in this.queueData.files){f=this.queueData.files[g];if(f.uploaded!=true&&f.name==h.name){var e=confirm('The file named "'+h.name+'" is already in the queue.\nDo you want to replace the existing item in the queue?');if(!e){this.cancelUpload(h.id);this.queueData.filesCancelled++;return false}else{c("#"+f.id).remove();this.cancelUpload(f.id);this.queueData.filesReplaced++}}}var j=Math.round(h.size/1024);var o="KB";if(j>1000){j=Math.round(j/1000);o="MB"}var l=j.toString().split(".");j=l[0];if(l.length>1){j+="."+l[1].substr(0,2)}j+=o;var k=h.name;if(k.length>25){k=k.substr(0,25)+"..."}itemData={fileID:h.id,instanceID:i.id,fileName:k,fileSize:j};if(i.itemTemplate==false){i.itemTemplate='<div id="${fileID}" class="uploadify-queue-item">					<div class="cancel">						<a href="javascript:$(\'#${instanceID}\').uploadify(\'cancel\', \'${fileID}\')" title="关闭">X</a>					</div>					<span class="fileName">${fileName} (${fileSize})</span><span class="data"></span>					<div class="uploadify-progress">						<div class="uploadify-progress-bar"><!--Progress Bar--></div>					</div>				</div>'}if(c.inArray("onSelect",i.overrideEvents)<0){itemHTML=i.itemTemplate;for(var m in itemData){itemHTML=itemHTML.replace(new RegExp("\\$\\{"+m+"\\}","g"),itemData[m])}c("#"+i.queueID).append(itemHTML)}this.queueData.queueSize+=h.size;this.queueData.files[h.id]=h;if(i.onSelect){i.onSelect.apply(this,arguments)}},onSelectError:function(d,g,f){var e=this.settings;if(c.inArray("onSelectError",e.overrideEvents)<0){switch(g){case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:if(e.queueSizeLimit>f){this.queueData.errorMsg+="\nThe number of files selected exceeds the remaining upload limit ("+f+")."}else{this.queueData.errorMsg+="\nThe number of files selected exceeds the queue size limit ("+e.queueSizeLimit+")."}break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:this.queueData.errorMsg+='\nThe file "'+d.name+'" exceeds the size limit ('+e.fileSizeLimit+").";break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:this.queueData.errorMsg+='\nThe file "'+d.name+'" is empty.';break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:this.queueData.errorMsg+='\nThe file "'+d.name+'" is not an accepted file type ('+e.fileTypeDesc+").";break}}if(g!=SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED){delete this.queueData.files[d.id]}if(e.onSelectError){e.onSelectError.apply(this,arguments)}},onQueueComplete:function(){if(this.settings.onQueueComplete){this.settings.onQueueComplete.call(this,this.settings.queueData)}},onUploadComplete:function(f){var g=this.settings,d=this;var e=this.getStats();this.queueData.queueLength=e.files_queued;if(this.queueData.uploadQueue[0]=="*"){if(this.queueData.queueLength>0){this.startUpload()}else{this.queueData.uploadQueue=[];if(g.onQueueComplete){g.onQueueComplete.call(this,this.queueData)}}}else{if(this.queueData.uploadQueue.length>0){this.startUpload(this.queueData.uploadQueue.shift())}else{this.queueData.uploadQueue=[];if(g.onQueueComplete){g.onQueueComplete.call(this,this.queueData)}}}if(c.inArray("onUploadComplete",g.overrideEvents)<0){if(g.removeCompleted){switch(f.filestatus){case SWFUpload.FILE_STATUS.COMPLETE:setTimeout(function(){if(c("#"+f.id)){d.queueData.queueSize-=f.size;d.queueData.queueLength-=1;delete d.queueData.files[f.id];c("#"+f.id).fadeOut(500,function(){c(this).remove()})}},g.removeTimeout*1000);break;case SWFUpload.FILE_STATUS.ERROR:if(!g.requeueErrors){setTimeout(function(){if(c("#"+f.id)){d.queueData.queueSize-=f.size;d.queueData.queueLength-=1;delete d.queueData.files[f.id];c("#"+f.id).fadeOut(500,function(){c(this).remove()})}},g.removeTimeout*1000)}break}}else{f.uploaded=true}}if(g.onUploadComplete){g.onUploadComplete.call(this,f)}},onUploadError:function(e,i,h){var f=this.settings;var g="Error";switch(i){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:g="HTTP Error ("+h+")";break;case SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL:g="Missing Upload URL";break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:g="IO Error";break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:g="Security Error";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:if(!Horn.Uploadify.isCloseAlert){alert("The upload limit has been reached ("+h+").")}g="Exceeds Upload Limit";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:g="Failed";break;case SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND:break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:g="Validation Error";break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:g="Cancelled";this.queueData.queueSize-=e.size;this.queueData.queueLength-=1;if(e.status==SWFUpload.FILE_STATUS.IN_PROGRESS||c.inArray(e.id,this.queueData.uploadQueue)>=0){this.queueData.uploadSize-=e.size}if(f.onCancel){f.onCancel.call(this,e)}delete this.queueData.files[e.id];break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:g="Stopped";break}if(c.inArray("onUploadError",f.overrideEvents)<0){if(i!=SWFUpload.UPLOAD_ERROR.FILE_CANCELLED&&i!=SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED){c("#"+e.id).addClass("uploadify-error")}c("#"+e.id).find(".uploadify-progress-bar").css("width","1px");if(i!=SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND&&e.status!=SWFUpload.FILE_STATUS.COMPLETE){c("#"+e.id).find(".data").html(" - "+g)}}var d=this.getStats();this.queueData.uploadsErrored=d.upload_errors;if(f.onUploadError){f.onUploadError.call(this,e,i,h,g)}},onUploadProgress:function(g,m,j){var h=this.settings;var e=new Date();var n=e.getTime();var k=n-this.timer;if(k>500){this.timer=n}var i=m-this.bytesLoaded;this.bytesLoaded=m;var d=this.queueData.queueBytesUploaded+m;var p=Math.round(m/j*100);var o="KB/s";var l=0;var f=(i/1024)/(k/1000);f=Math.floor(f*10)/10;if(this.queueData.averageSpeed>0){this.queueData.averageSpeed=Math.floor((this.queueData.averageSpeed+f)/2)}else{this.queueData.averageSpeed=Math.floor(f)}if(f>1000){l=(f*0.001);this.queueData.averageSpeed=Math.floor(l);o="MB/s"}if(c.inArray("onUploadProgress",h.overrideEvents)<0){if(h.progressData=="percentage"){c("#"+g.id).find(".data").html(" - "+p+"%")}else{if(h.progressData=="speed"&&k>500){c("#"+g.id).find(".data").html(" - "+this.queueData.averageSpeed+o)}}c("#"+g.id).find(".uploadify-progress-bar").css("width",p+"%")}if(h.onUploadProgress){h.onUploadProgress.call(this,g,m,j,d,this.queueData.uploadSize)}},onUploadStart:function(d){var e=this.settings;var f=new Date();this.timer=f.getTime();this.bytesLoaded=0;if(this.queueData.uploadQueue.length==0){this.queueData.uploadSize=d.size}if(e.checkExisting){c.ajax({type:"POST",async:false,url:e.checkExisting,data:{filename:d.name},success:function(h){if(h==1){var g=confirm('A file with the name "'+d.name+'" already exists on the server.\nWould you like to replace the existing file?');if(!g){this.cancelUpload(d.id);c("#"+d.id).remove();if(this.queueData.uploadQueue.length>0&&this.queueData.queueLength>0){if(this.queueData.uploadQueue[0]=="*"){this.startUpload()}else{this.startUpload(this.queueData.uploadQueue.shift())}}}}}})}if(e.onUploadStart){e.onUploadStart.call(this,d)}},onUploadSuccess:function(f,h,d){var g=this.settings;var e=this.getStats();this.queueData.uploadsSuccessful=e.successful_uploads;this.queueData.queueBytesUploaded+=f.size;if(c.inArray("onUploadSuccess",g.overrideEvents)<0){c("#"+f.id).find(".data").html(" - Complete")}if(g.onUploadSuccess){g.onUploadSuccess.call(this,f,h,d)}}};c.fn.uploadify=function(d){if(b[d]){return b[d].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof d==="object"||!d){return b.init.apply(this,arguments)}else{c.error("The method "+d+" does not exist in $.uploadify")}}}})($);
Horn.Uploadify=Horn.extend(Horn.Field,{COMPONENT_CLASS:"Uploadify",id:"uploadId",height:30,width:120,auto:true,fileSizeLimit:2,fileTypeDesc:"any",fileTypeExts:"*.*",progressData:"speed",multi:true,removeCompleted:true,removeTimeout:2,requeueErrors:true,uploadLimit:20,successTimeout:30,queueSizeLimit:99,isUseNewName:true,savePath:"/upload",url:"",buttonText:"选择文件",buttonClass:"u-btn u-btn-primary u-btn-fileinput",uploadParams:null,init:function(){Horn.Uploadify.superclass.init.apply(this,arguments);this.height=this.params.height?this.params.height:30;this.width=this.params.width?this.params.width:120;var j=this.params.auto+"";if(j=="false"){this.auto=this.params.auto}var g=this.params.isUseNewName+"";if(g=="false"){this.isUseNewName=this.params.isUseNewName}this.progressData=this.params.progressData?this.params.progressData:"speed";this.fileSizeLimit=this.params.fileSizeLimit?this.params.fileSizeLimit:2;this.fileTypeDesc=this.params.fileTypeDesc?this.params.fileTypeDesc:"任何文件";this.fileTypeExts=this.params.fileTypeExts?this.params.fileTypeExts:"*.*";this.buttonText=this.params.buttonText?this.params.buttonText:"请选择文件";this.buttonClass=this.params.buttonClass?this.params.buttonClass:this.buttonClass;var k=this.params.multi+"";if(k=="false"){this.multi=this.params.multi}if(this.params.removeCompleted+""=="false"){this.removeCompleted=this.params.removeCompleted}this.removeTimeout=this.params.removeTimeout?this.params.removeTimeout:2;if(this.params.requeueErrors+""=="false"){this.requeueErrors=this.params.requeueErrors}this.uploadLimit=this.params.uploadLimit?this.params.uploadLimit:20;this.queueSizeLimit=this.params.queueSizeLimit?this.params.queueSizeLimit:99;this.successTimeout=this.params.successTimeout?this.params.successTimeout:30;this.savePath=this.params.savePath?this.params.savePath:"/upload";this.url=this.params.url?this.params.url:"";var a=this.el.attr("appServer");var d="uploadify_"+this.el.attr("id");this.id=d;this.hidden=this.el.children("div").children("input[type=hidden]");this.field=this.hidden.next();var e=this;var b="";if(this.url&&this.url!=""){if(this.url.indexOf("?")!=-1){b=e.url+"&savePath="+encodeURI(encodeURIComponent(e.savePath))+"&isUseNewName="+e.isUseNewName}else{b=e.url+"?savePath="+encodeURI(encodeURIComponent(e.savePath))+"&isUseNewName="+e.isUseNewName}}if(e.params.value&&e.params.value!=""){e.createFileList()}$("#"+d).uploadify({debug:false,auto:e.auto,swf:a+"/components/uploadify/uploadify.swf",method:"get",uploader:b,preventCaching:true,buttonCursor:"hand",buttonText:e.buttonText,buttonClass:e.buttonClass,height:e.height,width:e.width,fileObjName:"filedata",fileSizeLimit:e.fileSizeLimit+"MB",fileTypeDesc:e.fileTypeDesc,fileTypeExts:e.fileTypeExts,multi:e.multi,progressData:e.progressData,queueSizeLimit:e.queueSizeLimit,removeCompleted:e.removeCompleted,removeTimeout:e.removeTimeout,requeueErrors:e.requeueErrors,uploadLimit:e.uploadLimit,successTimeout:e.successTimeout,onCancel:function(m){if(e.params.onCancel){var l=Horn.Util.getFunObj(e.params.onCancel);var n;if($.type(l.fn)=="function"){n=l.fn}if(n){n.apply(e,[m])}}},onClearQueue:function(m){if(e.params.onClearQueue){var l=Horn.Util.getFunObj(e.params.onClearQueue);var n;if($.type(l.fn)=="function"){n=l.fn}if(n){n.apply(e,[m])}}},onQueueComplete:function(m){if(e.params.onQueueComplete){var l=Horn.Util.getFunObj(e.params.onQueueComplete);var n;if($.type(l.fn)=="function"){n=l.fn}if(n){n.apply(e,[m])}}},onDialogClose:function(m){if(e.params.onDialogClose){var l=Horn.Util.getFunObj(e.params.onDialogClose);var n;if($.type(l.fn)=="function"){n=l.fn}if(n){n.apply(e,[m])}}},onDialogOpen:function(){$("#fileBody_"+e.id).hide();if(e.params.onDialogOpen){var l=Horn.Util.getFunObj(e.params.onDialogOpen);var m;if($.type(l.fn)=="function"){m=l.fn}if(m){m.apply(e)}}},onDisable:function(){if(e.params.onDisable){var l=Horn.Util.getFunObj(e.params.onDisable);var m;if($.type(l.fn)=="function"){m=l.fn}if(m){m.apply(e)}}},onEnable:function(){if(e.params.onEnable){var l=Horn.Util.getFunObj(e.params.onEnable);var m;if($.type(l.fn)=="function"){m=l.fn}if(m){m.apply(e)}}},onDestroy:function(){if(e.params.onDestroy){var l=Horn.Util.getFunObj(e.params.onDestroy);var m;if($.type(l.fn)=="function"){m=l.fn}if(m){m.apply(e)}}},onSelect:function(m){if(e.params.onSelect){var l=Horn.Util.getFunObj(e.params.onSelect);var n;if($.type(l.fn)=="function"){n=l.fn}if(n){n.apply(e,[m])}}},onSelectError:function(m,p,o){if(e.params.onSelectError){var l=Horn.Util.getFunObj(e.params.onSelectError);var n;if($.type(l.fn)=="function"){n=l.fn}if(n){n.apply(e,[m,p,o,e.params])}}},onFallback:function(){if(e.params.onFallback){var l=Horn.Util.getFunObj(e.params.onFallback);var m;if($.type(l.fn)=="function"){m=l.fn}if(m){m.apply(e)}}},onInit:function(m){if(e.params.onInit){var l=Horn.Util.getFunObj(e.params.onInit);var n;if($.type(l.fn)=="function"){n=l.fn}if(n){n.apply(e,[m])}}},onUploadComplete:function(m){e.createFileList();if(e.params.onUploadComplete){var l=Horn.Util.getFunObj(e.params.onUploadComplete);var n;if($.type(l.fn)=="function"){n=l.fn}if(n){n.apply(e,[m])}}},onUploadStart:function(m){if(e.uploadParams!=null){$("#"+d).uploadify("settings","formData",e.uploadParams)}if(e.params.onUploadStart){var l=Horn.Util.getFunObj(e.params.onUploadStart);var n;if($.type(l.fn)=="function"){n=l.fn}if(n){n.apply(e,[m])}}},onUploadError:function(m,q,p,o){if(e.params.onUploadError){var l=Horn.Util.getFunObj(e.params.onUploadError);var n;if($.type(l.fn)=="function"){n=l.fn}if(n){n.apply(e,[m,q,p,o])}}},onUploadSuccess:function(n,r,o){var p=$.parseJSON(r);var q="";var u="";var m=e.hidden.val();var l=p.return_code;if(l=="10000"){if(m){m=m.replace("[","").replace("]","")}var t=JSON.stringify(p.success);if(m==""){m=t}else{m=m+","+t}m="["+m+"]";e.hidden.val(m)}if(e.params.onUploadSuccess){var v=Horn.Util.getFunObj(e.params.onUploadSuccess);var s;if($.type(v.fn)=="function"){s=v.fn}if(s){s.apply(e,[n,r,o])}}}});var i=this.params.auto+"";if(i=="false"){var c=this.el.children("div").children("button.startUpload");var f=this.el.children("div").children("button.stopUpload");var h=this.el.children("div").children("button.cancelUpload");c.bind("click",function(){$("#"+d).uploadify("upload","*");return false});f.bind("click",function(){$("#"+d).uploadify("stop");return false});h.bind("click",function(){$("#"+d).uploadify("cancel");return false})}},createFileList:function(){var g=this;var a=g.hidden.val();$("#fileBody_"+g.id).remove();$(".g-screen").after("<div id='fileBody_"+g.id+"'class='hc_uploaddiv' style='display:none'><div class='u-uploaded-close'><span>已上传文件列表</span><i class='fa fa-close' title='关闭'></i></div><div class='u-uploaded-list'></div></div>");var f=$("#fileBody_"+g.id);var c=f.children("div.u-uploaded-close").children("i");var e=f.children("div.u-uploaded-list");if(a&&a!=""){var d=$.parseJSON(a);var b=g.el.children("div").children("span");if(b){b.html('<a href="javascript:void(0)" style=\'text-decoration: underline;color: blue;\'>已上传了<span id="allCount_'+g.id+'">'+d.length+"</span>个文件</a>");b.bind("click",function(){d=$.parseJSON(g.hidden.val());if(g.params.onOpenFileWin){var i=Horn.Util.getFunObj(g.params.onOpenFileWin);var l;if($.type(i.fn)=="function"){l=i.fn}if(l){l.apply(g)}}var h=$("<ul>");var m="";var k=g.url+"?";if(g.uploadParams){$.each(g.uploadParams,function(o,p){m+=o+"="+p+"&"})}$.each(d,function(q,r){var o="";var t=g.params.isDel+"";var u=g.params.isDownload+"";var p=r.isDownload+"";if(t!="false"){var s="";if(m!=""){s=g.url+"?"+m}o="<i class='fa fa-trash-o u-delete'  title='点击删除文件' onclick=\"delUploadFile('"+s+"&delFile=true&savePath="+g.savePath+"&fileName="+encodeURI(encodeURIComponent(r.fileName))+"','file_li_"+q+"','"+g.id+"','"+g.params.name+"','"+r.fileName+"')\"></i>"}if(u=="true"){if(p=="false"){h.append("<li id='file_li_"+q+"'><span title='"+r.oldFileName+"'>"+(q+1)+"."+r.oldFileName+"</span>"+o+"</li>")}else{k=g.url+"?"+m+"&downloadFile=true&fileName="+encodeURI(encodeURIComponent(r.fileName));h.append("<li id='file_li_"+q+"'><a href='"+k+"' target='_blank' title='点击这里进行下载'><span title='"+r.oldFileName+"'>"+(q+1)+"."+r.oldFileName+"</span></a><a href='"+k+"' target='_blank' title='点击这里进行下载'><i class='fa fa-download u-download'></i></a>"+o+"</li>")}}else{if(p=="true"){k=g.url+"?"+m+"&downloadFile=true&fileName="+encodeURI(encodeURIComponent(r.fileName));h.append("<li id='file_li_"+q+"'><a href='"+k+"' target='_blank' title='点击这里进行下载'><span title='"+r.oldFileName+"'>"+(q+1)+"."+r.oldFileName+"</span></a><a href='"+k+"' target='_blank' title='点击这里进行下载'><i class='fa fa-download u-download'></i></a>"+o+"</li>")}else{h.append("<li id='file_li_"+q+"'><span title='"+r.oldFileName+"'>"+(q+1)+"."+r.oldFileName+"</span>"+o+"</li>")}}});h.append("</ul>");e.html(h);var n=g.field.offset();if(n&&n.top==0){n=g.el.offset()}if(n&&n.top>=0){var j=g.field.outerHeight();f.css("left",n.left+"px");f.css("z-index",Horn.Window.getNextZIndex());f.css("height",(d.length*30)+30);f.css("top",(n.top+j+40)+"px");f.show()}});c.bind("click",function(){if(top.Horn&&top.Horn.Window){top.Horn.Window.MAX_ZINDEX=top.Horn.Window.MAX_ZINDEX-1}else{Horn.Window.MAX_ZINDEX=Horn.Window.MAX_ZINDEX-1}f.hide()})}}},cancel:function(){$("#"+this.id).uploadify("cancel","*");return false},stop:function(){$("#"+this.id).uploadify("stop","*");return false},upload:function(){$("#"+this.id).uploadify("upload","*");return false},destroy:function(){$("#"+this.id).uploadify("destroy")},disable:function(a){$("#"+this.id).uploadify("disable",a)},clearValue:function(){this.hidden.val("");var b=this.el.children("div.u-upload-btn").children("span");var a=$(".hc_uploaddiv");b.html("");a.html("");a.hide()},reset:function(){this.hidden.val("");var b=this.el.children("div.u-upload-btn").children("span");var a=$(".hc_uploaddiv");b.html("");a.html("");a.hide()},setParams:function(a){if(a&&a!=""){this.uploadParams=a}}});Horn.regUI("div.hc_upload-group",Horn.Uploadify);Horn.regUI("div.hc_upload-panel",Horn.Uploadify);function delUploadFile(a,e,b,c,d){Horn.Msg.confirm("确认","确定要删除吗",function(){$.post(a,null,function(m){var i=$.parseJSON(m);var h=i.return_code;var n=i.return_msg;if(h=="10000"){$("#"+e).remove();var k=$("#allCount_"+b).text();var j=parseInt(k)-1;$("#allCount_"+b).text(j);var g=$("input[name="+c+"]").val();var l=$.parseJSON(g);var f="";$.each(l,function(o,q){var r=q.fileName;if(r!=d){var p=JSON.stringify(q);f=f+","+p}});f=f.substring(1);$("input[name="+c+"]").val("["+f+"]");Horn.Msg.alert("提示","删除成功")}else{Horn.Msg.error("提示",n)}})},function(){})};
$.fn.drag=function(n){var e={o:""};var h=$(this);var a=$.extend({},e,n);if(a.o==""){return false}var b=$(window);var d=$(document);var f="createTouch" in document;var i=document.documentElement;var g=!("minWidth" in i.style);var j=!g&&"onlosecapture" in i;var c="setCapture" in i;var k={start:f?"touchstart":"mousedown",over:f?"touchmove":"mousemove",end:f?"touchend":"mouseup"};var l=f?function(o){if(!o.touches){o=o.originalEvent.touches.item(0)}return o}:function(o){return o};var m=function(){this.start=$.proxy(this.start,this);this.over=$.proxy(this.over,this);this.end=$.proxy(this.end,this);this.onstart=this.onover=this.onend=$.noop};m.types=k;m.prototype={start:function(o){o=this.startFix(o);d.on(k.over,this.over).on(k.end,this.end);this.onstart(o);return false},over:function(o){o=this.overFix(o);this.onover(o);return false},end:function(o){o=this.endFix(o);d.off(k.over,this.over).off(k.end,this.end);this.onend(o);return false},startFix:function(o){o=l(o);this.target=$(o.target);this.selectstart=function(){return false};d.on("selectstart",this.selectstart).on("dblclick",this.end);if(j){this.target.on("losecapture",this.end)}else{b.on("blur",this.end)}if(c){this.target[0].setCapture()}return o},overFix:function(o){o=l(o);return o},endFix:function(o){o=l(o);d.off("selectstart",this.selectstart).off("dblclick",this.end);if(j){this.target.off("losecapture",this.end)}else{b.off("blur",this.end)}if(c){this.target[0].releaseCapture()}return o}};m.create=function(t,q){var r=$(t);var y=new m();var w=m.types.start;var z=function(){};var x=r.attr("class").replace(/^\s|\s.*/g,"")+"-drag-start";var u;var s;var p;var o;var v={onstart:z,onover:z,onend:z,off:function(){r.off(w,y.start)}};y.onstart=function(A){var C=r.css("position")==="fixed";var G=d.scrollLeft();var B=d.scrollTop();var I=r.width();var F=r.height();u=0;s=0;p=C?b.width()-I+u:d.width()-I;o=C?b.height()-F+s:d.height()-F;var E=r.offset();var D=this.startLeft=C?E.left-G:E.left;var H=this.startTop=C?E.top-B:E.top;this.clientX=A.clientX;this.clientY=A.clientY;r.addClass(x);v.onstart.call(t,A,D,H)};y.onover=function(B){var D=B.clientX-this.clientX+this.startLeft;var C=B.clientY-this.clientY+this.startTop;var A=r[0].style;D=Math.max(u,Math.min(p,D));C=Math.max(s,Math.min(o,C));A.left=D+"px";A.top=C+"px";v.onover.call(t,B,D,C)};y.onend=function(B){var A=r.position();var D=A.left;var C=A.top;r.removeClass(x);v.onend.call(t,B,D,C)};y.off=function(){r.off(w,y.start)};if(q){y.start(q)}else{r.on(w,y.start)}return v};h.on(m.types.start,a.o,function(o){m.create($(this).parent(),o)})};$(function(){});
Horn.emptyFn=function(){};(function(d){var b=["DOMMouseScroll","mousewheel"];if(d.event.fixHooks){for(var a=b.length;a;){d.event.fixHooks[b[--a]]=d.event.mouseHooks}}d.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var e=b.length;e;){this.addEventListener(b[--e],c,false)}}else{this.onmousewheel=c}},teardown:function(){if(this.removeEventListener){for(var e=b.length;e;){this.removeEventListener(b[--e],c,false)}}else{this.onmousewheel=null}}};d.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}});function c(i){var h=i||window.event,g=[].slice.call(arguments,1),j=0,f=0,e=0;i=d.event.fix(h);i.type="mousewheel";if(h.wheelDelta){j=h.wheelDelta/120}if(h.detail){j=-h.detail/3}e=j;if(h.axis!==undefined&&h.axis===h.HORIZONTAL_AXIS){e=0;f=-1*j}if(h.wheelDeltaY!==undefined){e=h.wheelDeltaY/120}if(h.wheelDeltaX!==undefined){f=-1*h.wheelDeltaX/120}g.unshift(i,j,f,e);return(d.event.dispatch||d.event.handle).apply(this,g)}})(jQuery);Horn.Window=Horn.extend(Horn.Base,{COMPONENT_CLASS:"Window",defConf:{closeable:true,backClickCloseable:false,title:"窗口",width:500,minWidth:250,maxWidth:1000,height:500,minHeight:300,maxHeight:600,scroll:false,isAuto:false},config:{},el:null,isShow:false,backdrop:null,wrapper:null,content:null,header:null,buttonBar:null,beforeClose:null,afterClose:null,beforeCloseFn:function(){return true},afterCloseFn:function(){},init:function(e){Horn.Window.superclass.init.apply(this,arguments);var d=$(e);this.el=d;var g=this;this.flag=false;this.config={};this.config=$.extend(this.config,this.defConf);var b=true;if(this.params){$.extend(this.config,this.params||{});if(!isNaN(this.el.attr("h_width"))){this.config.width=this.el.attr("h_width")}else{if(typeof this.el.attr("h_width")=="string"){this.config.width=parseInt(this.el.attr("h_width"))}}if(this.config.width<this.defConf.minWidth){this.config.width=this.defConf.minWidth}if(!isNaN(this.el.attr("h_height"))){this.config.height=this.el.attr("h_height")}else{if(typeof this.el.attr("h_height")=="string"){this.config.height=parseInt(this.el.attr("h_height"))}}if(typeof this.config.closeable=="string"){if(this.config.closeable=="true"){this.config.closeable=true}else{if(this.config.closeable=="false"){this.config.closeable=false}else{this.config.closeable=this.defConf.closeable}}}if(typeof this.config.closeable!="boolean"){this.config.closeable=this.defConf.closeable}if(this.config.beforeClose){this.beforeClose=this.config.beforeClose;var k=Horn.Util.getFunObj(this.beforeClose);if($.type(k.fn)=="function"){this.beforeCloseFn=k.fn}}if(this.config.afterClose){this.afterClose=this.config.afterClose;var f=Horn.Util.getFunObj(this.afterClose);if($.type(f.fn)=="function"){this.afterCloseFn=f.fn}}if(this.params.isDrag==false){b=false}}this.content=d.children(".h_floatdiv-con");this.header=d.children(".m-message-header").children(".h_floatdiv-title");this.buttonBar=d.children(".h_btndiv");if(this.buttonBar.length==0){this.buttonBar=undefined}if(this.buttonBar||true==this.config.scroll||"true"==this.config.scroll){this.config.scroll=true}this.backdrop=$("<div class='h_floatdiv-backdrop'></div>");var h=$("<div></div>");h.append(this.backdrop);h.append(this.el);this.wrapper=h;$(document.body).append(h);h.hide();if(this.config.width){d.css("width",this.config.width+"px")}if(this.config.height){d.css("height",this.config.height+"px")}var j=this.header.children("a");if(this.config.closeable){j.bind("click",function(){g.hide()})}else{j.hide()}if(this.config.autoShow){this.show()}if(this.config.backClickCloseable){this.backdrop.click(function(){g.hide()})}$(window).resize(function(){if(g.isShow&&!g.maximum){g.resize()}});if(b){var c=this.el.attr("id");$("#"+c).drag({o:".m-message-header"})}var a=this.header.outerHeight()==0?20:this.header.outerHeight();var i=this.el.height()-a+1;if(this.params.height&&!this.flag){i=this.params.height-a}if(this.buttonBar){i=i-this.buttonBar.outerHeight()}if(this.config.scroll){this.el.css("height","auto");this.content.css({padding:0,margin:0,border:0,height:i}).addClass("h-overflow-auto")}else{this.el.mousewheel(function(){return false});this.content.css({padding:0,margin:0,border:0,height:i}).addClass("h-overflow-hidden")}g.resize()},setMaximum:function(a){this.maximum=a},resize:function(j,r){var d=$(window),b=this.el,o=0,i=0;var e=$(this.el).find(".h-overflow-auto").scrollTop();if(e!=null&&e!=0){$(this.el).find(".h-overflow-auto").scrollTop(0)}var m=d.height();var c=d.width();var f=this.config.height;var l=this.config.width;if(j){l=j}if(r){f=r}var q=l;var g=f;o=m-f;i=c-l;if(o<38){o=38;g=m-38}if(i<38){i=38;q=c-38}var n=o/2+$(document).scrollTop();n=n-50;if(n<0){n=10}var s=i/2+$(document).scrollLeft();this.backdrop.css({top:$(document).scrollTop(),left:$(document).scrollLeft()});this.el.css({top:n,left:s});if(this.params.isAuto!=false){this.backdrop.css({height:$(window).height(),width:$(window).width()});var a=this.el.find(".h_floatdiv-con").outerHeight();var p=this.el.find(".h_floatdiv-con").width();var t=this.el.find(".h_floatdiv-title").outerHeight();var k=(this.params.scroll==true)?true:false;this.el.css({width:q,height:g});this.el.children("div.h_floatdiv-con").css({height:g-17})}},resetSizeWin:function(a,b){this.flag=true;this.resize(a,b)},show:function(b){if(!$("body").hasClass("h-overflow-hidden")){}if(!$("html").hasClass("h-overflow-hidden")){$("html").addClass("h-overflow-hidden")}Horn.Window.getNextOpen();this.wrapper.show();var a=this.el.width();var c=this.el.height();this.resize(a,c);this.backdrop.css("width","100%").css("height","100%").css("z-index",Horn.Window.getNextZIndex());this.el.css({"z-index":Horn.Window.getNextZIndex()});this.el.show();this.isShow=true},hide:function(){if(this.beforeCloseFn.call()){this.wrapper.hide();this.isShow=false;this.afterCloseFn.call();var a=true;$("div.h_floatdiv").each(function(c,e){var d=$(this).parent("div").css("display");if(d&&d=="block"){a=false}});if($("body").hasClass("h-overflow-hidden")){if(a){$("body").removeClass("h-overflow-hidden")}}if($("html").hasClass("h-overflow-hidden")){if(a){$("html").removeClass("h-overflow-hidden")}}}if(top.Horn&&top.Horn.Window){top.Horn.Window.MAX_ZINDEX=top.Horn.Window.MAX_ZINDEX-2}else{Horn.Window.MAX_ZINDEX=Horn.Window.MAX_ZINDEX-2}var b=$(".m-verify-tip");if(b){b.each(function(){var c=$(this).attr("msgInBody");if(c&&c=="true"){$(this).hide()}})}},setTitle:function(a){this.el.children(".m-message-header").children("h4").text(a);this.el.children(".m-message-header").children("h4").attr("title",a)},setButtonDisabled:function(b,d,a){var c=a+"";this.el.children(".m-message-footer").children("button").each(function(e,f){var g=c=="true"?$(this).attr("id"):$(this).attr("name");if(g==b){$(this).attr("disabled",d)}})},showButton:function(b,a){var c=a+"";this.el.children(".m-message-footer").children("button").each(function(d,e){var f=c=="true"?$(this).attr("id"):$(this).attr("name");if(f==b){$(this).show()}})},hideButton:function(b,a){var c=a+"";this.el.children(".m-message-footer").children("button").each(function(d,e){var f=c=="true"?$(this).attr("id"):$(this).attr("name");if(f==b){$(this).hide()}})}});$.extend(Horn.Window,{DATANAME:"h_window",MAX_ZINDEX:100,OPENED:0,getNextOpen:function(){if(top.Horn&&top.Horn.Window){top.Horn.Window.OPENED++}else{Horn.Window.OPENED++;return Horn.Window.OPENED}},getPrevOpen:function(){if(top.Horn&&top.Horn.Window){top.Horn.Window.OPENED--;return top.Horn.Window.OPENED}else{Horn.Window.OPENED--;return Horn.Window.OPENED}},getOpen:function(){if(top.Horn&&top.Horn.Window){return top.Horn.Window.OPENED}else{return Horn.Window.OPENED}},getNextZIndex:function(){if(top.Horn&&top.Horn.Window){top.Horn.Window.MAX_ZINDEX++;return top.Horn.Window.MAX_ZINDEX}else{Horn.Window.MAX_ZINDEX++;return Horn.Window.MAX_ZINDEX}},get:function(b){var a=Horn.data(Horn.Window.DATANAME);var c=a[b];return c}});Horn.regUI("div.h_floatdiv",Horn.Window);
Horn.Combox=Horn.extend(Horn.Select,{COMPONENT_CLASS:"Combox",pLabel:"",filterFlag:"",displayField:null,keyAttr:"label",pKeyAttr:"pkey",valueAttr:"value",defaultValue:"",defaultText:"",showLabel:false,init:function(e){Horn.Combox.superclass.init.apply(this,arguments);this.combInit();var d=this.el.find("input[ref]"),a=this.el.attr("keyfield"),b=this.el.attr("pkeyfield"),c=this.el.attr("titlefield");if(a){this.keyAttr=a}if(b){this.pkeyAttr=b}if(c){this.valueAttr=c}var f=this.params.dictName;if(f){this.field.attr("ref",f.split(",")[0]+(this.multipleline?"_m":"_s"))}this.displayField=d;this.defaultValue=this.params.value||this.hidden.val();if(this.params.readonly===true||this.params.readonly==="true"){this.el.attr("readonly",true);this.readonly=true;this.setEditable(false)}},combInit:function(){var a=this.hidden.attr("refname");if(a){this.field.bind("change",Horn.Util.apply(this.onCombChange,this))}},onCombChange:function(g,h){var b=this.hidden.attr("refname");var f=b.split(";");for(var c=0;c<f.length;c++){var d=f[c];if(d){var a=d.split(",");Horn.getComp(a[0],a[1]).filterByPLabel(this.hidden.val())}}},changeDict:function(b){var d=b;this.clearFliter();var g=Horn.getDict(d);var c=$('<div class="hc_checkboxdiv">');var a=$("<ul></ul>");var f=this;if((this.field.get(0)).getAttribute("multiple")=="true"){b+="_m";c.attr("multiple_line","true");c.attr("ref_target",b);var e="";$.each(g,function(h,j){if(f.params.showLabel){e=$("<li title="+j+" key="+h+'><label><input type="checkbox" class="combox_input"><span class="hce_dictlabel" >'+h+":</span>"+j+"</label></li>")}else{e=$("<li title="+j+" key="+h+'><label><input type="checkbox" class="combox_input">'+j+"</label></li>")}a.append(e)})}else{b+="_s";c.attr("multiple_line","false");c.attr("ref_target",b);var e="";$.each(g,function(h,j){if(f.params.showLabel){e=$("<li title="+j+" key="+h+'><label><span class="hce_dictlabel" >'+h+":</span>"+j+"</label></li>")}else{e=$("<li title="+j+" key="+h+"><label>"+j+"</label></li>")}a.append(e)})}c.append(a);this.field.attr("ref",b);this.listEl=c;this.multipleline=this.listEl.attr("multiple_line")=="true";if((this.field.get(0)).getAttribute("multiple")=="true"){this.field.val("")}else{this.field.val("请选择...")}this.hidden.val("")},selectFirst:function(){if(this.listEl&&this.listEl.length==0){this.listEl=this.field.parent().find("div.hc_checkboxdiv")}var a=this.listEl.children("ul").children("li[key]");var c="";var e="";var d=this.hidden.val();for(var b=0;b<a.length;b++){if($(a.get(b)).css("display")!="none"){c=$(a.get(b)).attr("key");e=jQuery.trim($(a.get(b)).text());if(c!=""){break}}}if(d==""){this.setValue({key:c,text:e},true)}},getPos:function(){return{left:0,top:0}},hideAllList:function(){var a=this.listEl;$("div.hc_checkboxdiv").each(function(b,c){if(a.get(0)!=c){$(c).hide();$(c).data("show_name","")}})},showList:function(d,c){var b=d.prev();var a=b.data("filter");if(a){this[a.name].apply(this,a.params)}else{this.clearFliter(b)}Horn.Combox.superclass.showList.apply(this,arguments)},filterByPLabel:function(a){if(this.pLabel!=a){this.reset(true);this.pLabel=a;this.hidden.data("filter",{name:"_filterByPLabel",params:arguments})}},_filterByPLabel:function(c,a){if(!c){return false}var b=this.listEl.children("ul");b.children("li[key][pKey!='"+c+"']").css("display","none");b.children("li[key][pKey='"+c+"']").css("display","block");if(this.defaultValue){this.setValue(this.defaultValue)}else{if(!(a===false)&&(!this.multipleline)){this.selectFirst()}else{this.setValue("")}}},filter:function(g,a,c){this.clearFliter();var e={name:"_filter",params:arguments};var d=this.hidden.data("filter");if(e!=d){this.hidden.data("filter",e);if(c){this.field.trigger("change",e)}}var h=this.hidden.val();var b=this;if(h){this._filter(g,a);setTimeout(function(){$(h.split(",")).each(function(f,i){if(b.listEl.children("ul").children("li[key="+i+"]").css("display")=="none"){b.reset(true)}})},200)}else{this._filter(g,a);setTimeout(function(){b.setValue("")},200)}},_filter:function(e,b){b=!!b;var d="block",c="none";if(b){d="none";c="block"}if(this.listEl&&this.listEl.length==0){this.listEl=this.field.parent().find("div.hc_checkboxdiv")}var a=this.listEl.children("ul").children("li[key]");a.css("display",d);var g=",";if($.type(e)=="string"){e+=g}a.each(function(h,j){var f=$(j);var i=f.attr("key");if($.type(e)=="function"){if(e.call(this,i)){f.css("display",c)}}else{if($.type(e)=="array"){if(jQuery.inArray(i,e)>=0){f.css("display",c)}}else{if($.type(e)=="string"){if(e.indexOf(i+g)>-1){f.css("display",c)}}}}})},clearFliter:function(){if(this.listEl&&this.listEl.length==0){this.listEl=this.field.parent().find("div.hc_checkboxdiv")}this.listEl.children("ul").children("li[key]").css("display","block");this.hidden.data("filter",null)},clearList:function(){if(this.listEl&&this.listEl.length==0){this.listEl=this.field.parent().find("div.hc_checkboxdiv")}this.reset(true);this.listEl.children("ul").children("li[key]").remove()},addItems:function(c,b,a){this.addDatas(c,b,a);this.clearOrResetTitle()},addDatas:function(x,r,a){var w=[],k=this.listEl,b=this.keyAttr,h=this.valueAttr,v=this.showLabel;if(screenShowLabel&&screenShowLabel=="true"){v=true}var q=this.hidden;var c=this.field;var o=this;if(k&&k.length==0){k=this.field.parent().find("div.hc_checkboxdiv")}var d={inputEl:this.field,listEl:k};if(jQuery.type(x)=="array"){w=x}else{if(jQuery.type(x)=="object"){if(jQuery.isPlainObject(x)){if(jQuery.isEmptyObject(x)){return}w.push(x)}}else{if(r===true){this.clearList()}return}}if(r===true){this.clearList()}if(w.length>0){var l=k.children("ul");var e=(k.attr("multiple_line")=="true");$.each(w,function(z,B){var A=B[b],C=B[h];if(!A){A=B.code;C=B.text}if(A){var i=l.children("li[key='"+A+"']");if(i.length==0){var i=$("<li key='"+A+"' title='"+C+"'></li>");var y=$("<label></label>");if(a==="false"||a===false){y.text(C)}else{y.text((v?A+":":"")+C)}if(e){y.prepend('<input type="checkbox" class="combox_input"/>')}i.append(y);l.append(i);if(k.data("show_name")==q.attr("name")){i.bind("click.li",d,Horn.Util.apply(o.listClick,o))}}}})}var f=o.params.value;var j=q.attr("value");var m=c.val();var t=",";if(o.params.delimiter){t=o.params.delimiter}var u=j;var s=m;var n=[];if(f&&f!=""){n=f.split(",")}var g=[];for(var p=0;p<n.length;p++){f=n[p];if(c.attr("selectMode")){if(c.attr("selectMode")=="true"){$.each(w,function(A,B){if(s.indexOf(B.text)<0){if(B.code==f){if(!g.indexOf(B.code)<0){g.push(B.code)}var z=u.split(t);var C=0;for(;C<z.length;C++){if(B.code==z[C]){break}}if(C==z.length){u=u+(u?",":"")+B.code}s=s+(s?t:"")+(v?B.code+":":"")+B.text}}})}else{$.each(w,function(y,z){if(z.code==f){u=z.code;s=(v?z.code+":":"")+z.text}})}}else{$.each(w,function(y,z){if(z.code==f){u=z.code;s=(v?z.code+":":"")+z.text}})}}this.setValue(u);c.val(s)},showError:function(){Horn.Combox.superclass.showError.apply(this,arguments);var a=this.msgDiv},setMultiple:function(c){var e=this;var d=e.listEl.attr("multiple_line");if(c){if(d=="false"){e.clearFliter();e.listEl.attr("multiple_line","true");e.multipleline=true;var b=e.listEl.find("ul>li");if(e.params.hasSelectAll){var a="<li key='-1' title='全选/反选'><label><input type='checkbox' name='checkall' class='combox_input'>全选/反选</label></li>";e.listEl.children("ul").prepend(a)}$.each(b,function(g,h){var f=$(h).find("label");var j=$(h).attr("headItem");if(j==undefined){f.prepend('<input type="checkbox" class="combox_input"/>')}});if((e.field.get(0)).getAttribute("multiple")=="true"){e.field.val("")}else{e.field.val("请选择...")}e.hidden.val("");e.tempCheckedKeyArray=[]}else{return false}}else{if(d=="true"){e.clearFliter();e.listEl.attr("multiple_line","false");e.multipleline=false;var b=e.listEl.find("ul>li");if(e.params.hasSelectAll){e.listEl.find('li[key="-1"]').remove()}$.each(b,function(g,h){var f=$(h).find("label");var j=$(h).attr("headItem");if(j===undefined){$(h).find("input").remove()}});if((e.field.get(0)).getAttribute("multiple")=="true"){e.field.val("")}else{e.field.val("请选择...")}e.hidden.val("");e.tempCheckedKeyArray=[]}else{return false}}}});Horn.Field.regFieldType("div.hc_combox",Horn.Combox);
var expandfirst=false;Horn.ZtreePanel=Horn.extend(Horn.Base,{COMPONENT_CLASS:"ZtreePanel",el:null,url:null,params:{},check:null,treedata:null,currentIndex:0,allNum:0,allMap:[],currentSpanNode:null,currentNodeText:"",beforeClick:function(){return true},onClick:function(){},onExpand:function(){},chkStyle:"checkbox",init:function(n){Horn.ZtreePanel.superclass.init.apply(this,arguments);Horn.apply(this,this.params);this.treeEl=this.el.find(".ztree");var b=this;if(this.el.attr("treeclick")){var e=this.el.attr("treeclick");if(e){e=window[e]}this.onClick=e}else{if(this.params.onClick){this.onClick=window[this.params.onClick]}}if(this.el.attr("beforetreeclick")){var e=this.el.attr("beforetreeclick");if(e){e=window[e]}this.beforeClick=e}else{if(this.params.beforeClick){this.beforeClick=window[this.params.beforeClick]}}if(this.el.attr("reRenderFn")){var e=this.el.attr("reRenderFn");if(e){e=window[e]}this.reRender=e}if(this.el.attr("onExpand")){var e=this.el.attr("onExpand");if(e){e=window[e]}this.onExpand=e}var d=false;if(this.params.async&&this.params.async==true){d=true}if(this.params.check&&this.params.check!=""){this.check=this.params.check}var h={data:{simpleData:{enable:true}},view:{nameIsHTML:true,showLine:false,showIcon:true,showTitle:true,selectedMulti:true,dblClickExpand:true,addDiyDom:function(u,t){var s="_a";var v=$("#"+t.tId+s);b.reRender(t,v)},fontCss:this.getFontCss},async:{enable:d,url:this.params.url?this.params.url:"",autoParam:this.params.otherParam?this.params.otherParam:[],otherParam:this.params.otherParam?this.params.otherParam:{},type:this.params.type?this.params.type:"post",dataFilter:this.params.dataFilter?window[this.params.dataFilter]:null},callback:{beforeClick:this.beforeClick,beforeCheck:this.params.beforeCheck?window[this.params.beforeCheck]:null,beforeAsync:this.params.beforeAsync?window[this.params.beforeAsync]:null,onAsyncSuccess:this.params.onAsyncSuccess?window[this.params.onAsyncSuccess]:this.onAsyncSuccess,onAsyncError:this.params.onAsyncError?window[this.params.onAsyncError]:null,beforeCollapse:this.params.beforeCollapse?window[this.params.beforeCollapse]:null,beforeDblClick:this.params.beforeDblClick?window[this.params.beforeDblClick]:null,beforeDrag:this.params.beforeDrag?window[this.params.beforeDrag]:null,beforeDragOpen:this.params.beforeDragOpen?window[this.params.beforeDragOpen]:null,beforeDrop:this.params.beforeDrop?window[this.params.beforeDrop]:null,beforeEditName:this.params.beforeEditName?window[this.params.beforeEditName]:null,beforeExpand:this.params.beforeExpand?window[this.params.beforeExpand]:null,beforeMouseDown:this.params.beforeMouseDown?window[this.params.beforeMouseDown]:null,beforeMouseUp:this.params.beforeMouseUp?window[this.params.beforeMouseUp]:null,beforeRemove:this.params.beforeRemove?window[this.params.beforeRemove]:null,beforeRename:this.params.beforeRename?window[this.params.beforeRename]:null,beforeRightClick:this.params.beforeRightClick?window[this.params.beforeRightClick]:null,onCheck:this.params.onCheck?window[this.params.onCheck]:null,onCollapse:this.params.onCollapse?window[this.params.onCollapse]:null,onDblClick:this.params.onDblClick?window[this.params.onDblClick]:null,onDrag:this.params.onDrag?window[this.params.onDrag]:null,onDragMove:this.params.onDragMove?window[this.params.onDragMove]:null,onExpand:this.params.onExpand?window[this.params.onExpand]:this.onExpand,onMouseDown:this.params.onMouseDown?window[this.params.onMouseDown]:null,onMouseUp:this.params.onMouseUp?window[this.params.onMouseUp]:null,onNodeCreated:this.params.onNodeCreated?window[this.params.onNodeCreated]:null,onRemove:this.params.onRemove?window[this.params.onRemove]:null,onRename:this.params.onRename?window[this.params.onRename]:null,onRightClick:this.params.onRightClick?window[this.params.onRightClick]:null,onClick:this.onClick}};if(this.check==null){var p=this.el.attr("checkMode");if(p&&p=="checkbox"){h.check={enable:true,chkStyle:p}}}else{h.check=this.check}var q=this.el.attr("items");if(q){q=$.parseJSON(q)}else{q=[]}var j=this.treeEl;var a=this.treeEl.attr("id");if(!a){a=Horn.id();this.treeEl.attr("id",a)}if(d){$.fn.zTree.init(j,h)}else{$.fn.zTree.init(j,h,q)}this.treedata=q;this.treeObj=$.fn.zTree.getZTreeObj(a);if(this.el.attr("expandfirst")){expandfirst=true;this.treeObj.expandAll(true)}var r=this.el.attr("name");var g=this.el.parent().parent().find("#expand_"+r);var f=this.el.parent().parent().find("#unexpand_"+r);var m=this.el.parent().parent().find("#refresh_"+r);var c=this.el.parent().parent().find("#search_"+r);var o=this.el.parent().parent().find("#pre_"+r);var l=this.el.parent().parent().find("#next_"+r);this.currentNodeText=this.el.parent().parent().find("#count_"+r);var k=this;g.bind("click",function(t){var s=k.getCheckedNodes(true);if(s!=null&&s.length>0){$.each(s,function(u,v){k.treeObj.expandNode(v.getParentNode(),true)})}else{k.expandAll(true)}});f.bind("click",function(t){var s=k.getCheckedNodes(true);if(s!=null&&s.length>0){$.each(s,function(u,v){k.treeObj.expandNode(v.getParentNode(),false)})}else{k.expandAll(false)}});m.bind("click",function(s){k.refresh()});var i=this.params.isShowPreOrNextBtn+"";if(i!="false"){var o=this.el.parent().parent().find("#pre_"+r);var l=this.el.parent().parent().find("#next_"+r);this.currentNodeText=this.el.parent().parent().find("#count_"+r);o.bind("click",function(s){k.pre()});l.bind("click",function(s){k.next()})}c.bind("keyup",function(v){var u=[];k.clearSearchStatu();var u=[];k.allNum=0;var t=k.getNodesByParamFuzzy("name",this.value,null);var s=k.getNodesByParamFuzzy("name","",null);if(this.value!=""){$.each(t,function(w,x){u.push(x.id)});$.each(s,function(w,x){if(u.indexOf(x.id)!=-1){if(i!="false"){k.allMap[k.allNum++]=x}x.highlight=true;k.treeObj.updateNode(x);k.treeObj.expandNode(x.getParentNode(),true)}else{x.highlight=false;k.treeObj.updateNode(x)}});if(i!="false"){if(k.allNum>0){k.currentNodeText.text("1/"+k.allNum);k.selectNodeByIndex(0)}}}else{$.each(t,function(w,x){x.highlight=false;k.treeObj.updateNode(x);k.treeObj.cancelSelectedNode(x)});k.clearSearchStatu();k.expandAll(false)}this.focus()})},selectNodeByIndex:function(a){var b=this.allMap[a];this.currentSpanNode=b;this.treeObj.selectNode(b)},clearSearchStatu:function(){this.allMap=[];this.currentIndex=0;this.allNum=0;this.currentNodeText.html("0/0");this.currentSpanNode=null},pre:function(){if(this.currentIndex<=0){return}this.currentNodeText.text(this.currentIndex+"/"+this.allNum);this.selectNodeByIndex(--this.currentIndex)},next:function(){if(this.currentIndex>=this.allMap.length-1){return}this.currentNodeText.text((this.currentIndex+2)+"/"+this.allNum);this.selectNodeByIndex(++this.currentIndex)},getFontCss:function(b,a){return(!!a.highlight)?{"font-weight":"bold"}:{color:"#333","font-weight":"normal"}},reRender:function(b,a){},onAsyncSuccess:function(b,d,c,e){if(expandfirst){var a=$.fn.zTree.getZTreeObj(d);a.expandAll(true)}},getTreeObj:function(){return this.treeObj},getNodes:function(){var a=this.treeObj.getNodes();return a},addNodes:function(a,c,b,d){this.treeObj.addNodes(a,c,b,d)},cancelEditName:function(a){this.treeObj.cancelEditName(a)},cancelSelectedNode:function(a){this.treeObj.cancelSelectedNode(a)},checkAllNodes:function(a){this.treeObj.checkAllNodes(a)},checkNode:function(c,b,d,a){this.treeObj.checkNode(c,b,d,a)},copyNode:function(c,b,a,d){this.treeObj.copyNode(c,b,a,d)},destroy:function(){this.treeObj.destroy()},editName:function(a){this.treeObj.editName(a)},expandAll:function(a){this.treeObj.expandAll(a)},expandNode:function(d,e,c,a,b){this.treeObj.expandNode(d,e,c,a,b)},getChangeCheckedNodes:function(){return this.treeObj.getChangeCheckedNodes()},getCheckedNodes:function(a){return this.treeObj.getCheckedNodes(a)},getNodesByParam:function(b,c,a){return this.treeObj.getNodeByParam(b,c,a)},getNodesByParamFuzzy:function(b,c,a){return this.treeObj.getNodesByParamFuzzy(b,c,a)},getSelectedNodes:function(){return this.treeObj.getSelectedNodes()},hideNode:function(a){this.treeObj.hideNode(a)},hideNodes:function(a){this.treeObj.hideNodes(a)},moveNode:function(c,b,a,d){return this.treeObj.moveNode(c,b,a,d)},reAsyncChildNodes:function(a,b,c){this.treeObj.reAsyncChildNodes(a,b,c)},refresh:function(){this.treeObj.refresh()},removeChildNodes:function(a){this.treeObj.removeChildNodes(a)},removeNode:function(b,a){this.treeObj.removeNode(b,a)},selectNode:function(b,a,c){this.treeObj.selectNode(b,a,c)},setChkDisabled:function(b,a,c,d){this.treeObj.setChkDisabled(b,a,c,d)},setEditable:function(a){this.treeObj.setEditable(a)},showNode:function(a){this.treeObj.showNode(a)},showNodes:function(a){this.treeObj.showNodes(a)},transformToArray:function(a){return this.treeObj.transformToArray(a)},transformTozTreeNodes:function(a){return this.treeObj.transformToArray(a)},updateNode:function(a,b){this.treeObj.updateNode(a,b)},getCheckedNodes:function(){return this.treeObj.getCheckedNodes()}});Horn.regUI("div.h_ztree",Horn.ZtreePanel);function jresplusUIZtreeOnExpand(a,c,b){};
/*!
 * jQuery UI 1.8.1
 *
 * Copyright (c) 2010 AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT (MIT-LICENSE.txt)
 * and GPL (GPL-LICENSE.txt) licenses.
 *
 * http://docs.jquery.com/UI
 */
jQuery.ui||(function(a){a.ui={version:"1.8.1",plugin:{add:function(c,d,f){var e=a.ui[c].prototype;for(var b in f){e.plugins[b]=e.plugins[b]||[];e.plugins[b].push([d,f[b]])}},call:function(b,d,c){var f=b.plugins[d];if(!f||!b.element[0].parentNode){return}for(var e=0;e<f.length;e++){if(b.options[f[e][0]]){f[e][1].apply(b.element,c)}}}},contains:function(d,c){return document.compareDocumentPosition?d.compareDocumentPosition(c)&16:d!==c&&d.contains(c)},hasScroll:function(e,c){if(a(e).css("overflow")=="hidden"){return false}var b=(c&&c=="left")?"scrollLeft":"scrollTop",d=false;if(e[b]>0){return true}e[b]=1;d=(e[b]>0);e[b]=0;return d},isOverAxis:function(c,b,d){return(c>b)&&(c<(b+d))},isOver:function(g,c,f,e,b,d){return a.ui.isOverAxis(g,f,b)&&a.ui.isOverAxis(c,e,d)},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38}};a.fn.extend({_focus:a.fn.focus,focus:function(b,c){return typeof b==="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus();(c&&c.call(d))},b)}):this._focus.apply(this,arguments)},enableSelection:function(){return this.attr("unselectable","off").css("MozUserSelect","")},disableSelection:function(){return this.attr("unselectable","on").css("MozUserSelect","none")},scrollParent:function(){var b;if((a.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){b=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(a.curCSS(this,"position",1))&&(/(auto|scroll)/).test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0)}else{b=this.parents().filter(function(){return(/(auto|scroll)/).test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0)}return(/fixed/).test(this.css("position"))||!b.length?a(document):b},zIndex:function(e){if(e!==undefined){return this.css("zIndex",e)}if(this.length){var c=a(this[0]),b,d;while(c.length&&c[0]!==document){b=c.css("position");if(b=="absolute"||b=="relative"||b=="fixed"){d=parseInt(c.css("zIndex"));if(!isNaN(d)&&d!=0){return d}}c=c.parent()}}return 0}});a.extend(a.expr[":"],{data:function(d,c,b){return !!a.data(d,b[3])},focusable:function(c){var d=c.nodeName.toLowerCase(),b=a.attr(c,"tabindex");return(/input|select|textarea|button|object/.test(d)?!c.disabled:"a"==d||"area"==d?c.href||!isNaN(b):!isNaN(b))&&!a(c)["area"==d?"parents":"closest"](":hidden").length},tabbable:function(c){var b=a.attr(c,"tabindex");return(isNaN(b)||b>=0)&&a(c).is(":focusable")}})})(jQuery);
/*!
 * jQuery UI Widget 1.8.1
 *
 * Copyright (c) 2010 AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT (MIT-LICENSE.txt)
 * and GPL (GPL-LICENSE.txt) licenses.
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(b){var a=b.fn.remove;b.fn.remove=function(c,d){return this.each(function(){if(!d){if(!c||b.filter(c,[this]).length){b("*",this).add(this).each(function(){b(this).triggerHandler("remove")})}}return a.call(b(this),c,d)})};b.widget=function(d,f,c){var e=d.split(".")[0],h;d=d.split(".")[1];h=e+"-"+d;if(!c){c=f;f=b.Widget}b.expr[":"][h]=function(i){return !!b.data(i,d)};b[e]=b[e]||{};b[e][d]=function(i,j){if(arguments.length){this._createWidget(i,j)}};var g=new f();g.options=b.extend({},g.options);b[e][d].prototype=b.extend(true,g,{namespace:e,widgetName:d,widgetEventPrefix:b[e][d].prototype.widgetEventPrefix||d,widgetBaseClass:h},c);b.widget.bridge(d,b[e][d])};b.widget.bridge=function(d,c){b.fn[d]=function(g){var e=typeof g==="string",f=Array.prototype.slice.call(arguments,1),h=this;g=!e&&f.length?b.extend.apply(null,[true,g].concat(f)):g;if(e&&g.substring(0,1)==="_"){return h}if(e){this.each(function(){var i=b.data(this,d),j=i&&b.isFunction(i[g])?i[g].apply(i,f):i;if(j!==i&&j!==undefined){h=j;return false}})}else{this.each(function(){var i=b.data(this,d);if(i){if(g){i.option(g)}i._init()}else{b.data(this,d,new c(g,this))}})}return h}};b.Widget=function(c,d){if(arguments.length){this._createWidget(c,d)}};b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(d,e){this.element=b(e).data(this.widgetName,this);this.options=b.extend(true,{},this.options,b.metadata&&b.metadata.get(e)[this.widgetName],d);var c=this;this.element.bind("remove."+this.widgetName,function(){c.destroy()});this._create();this._init()},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(e,f){var d=e,c=this;if(arguments.length===0){return b.extend({},c.options)}if(typeof e==="string"){if(f===undefined){return this.options[e]}d={};d[e]=f}b.each(d,function(g,h){c._setOption(g,h)});return c},_setOption:function(c,d){this.options[c]=d;if(c==="disabled"){this.widget()[d?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",d)}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(d,e,f){var h=this.options[d];e=b.Event(e);e.type=(d===this.widgetEventPrefix?d:this.widgetEventPrefix+d).toLowerCase();f=f||{};if(e.originalEvent){for(var c=b.event.props.length,g;c;){g=b.event.props[--c];e[g]=e.originalEvent[g]}}this.element.trigger(e,f);return !(b.isFunction(h)&&h.call(this.element[0],e,f)===false||e.isDefaultPrevented())}}})(jQuery);
/*!
 * jQuery UI Mouse 1.8.1
 *
 * Copyright (c) 2010 AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT (MIT-LICENSE.txt)
 * and GPL (GPL-LICENSE.txt) licenses.
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */
(function(a){a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(c){return b._mouseDown(c)}).bind("click."+this.widgetName,function(c){if(b._preventClickEvent){b._preventClickEvent=false;c.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(d){d.originalEvent=d.originalEvent||{};if(d.originalEvent.mouseHandled){return}(this._mouseStarted&&this._mouseUp(d));this._mouseDownEvent=d;var c=this,e=(d.which==1),b=(typeof this.options.cancel=="string"?a(d.target).parents().add(d.target).filter(this.options.cancel).length:false);if(!e||b||!this._mouseCapture(d)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(d)&&this._mouseDelayMet(d)){this._mouseStarted=(this._mouseStart(d)!==false);if(!this._mouseStarted){d.preventDefault();return true}}this._mouseMoveDelegate=function(f){return c._mouseMove(f)};this._mouseUpDelegate=function(f){return c._mouseUp(f)};a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);(a.browser.safari||d.preventDefault());d.originalEvent.mouseHandled=true;return true},_mouseMove:function(b){if(a.browser.msie&&!b.button){return this._mouseUp(b)}if(this._mouseStarted){this._mouseDrag(b);return b.preventDefault()}if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,b)!==false);(this._mouseStarted?this._mouseDrag(b):this._mouseUp(b))}return !this._mouseStarted},_mouseUp:function(b){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;this._preventClickEvent=(b.target==this._mouseDownEvent.target);this._mouseStop(b)}return false},_mouseDistanceMet:function(b){return(Math.max(Math.abs(this._mouseDownEvent.pageX-b.pageX),Math.abs(this._mouseDownEvent.pageY-b.pageY))>=this.options.distance)},_mouseDelayMet:function(b){return this.mouseDelayMet},_mouseStart:function(b){},_mouseDrag:function(b){},_mouseStop:function(b){},_mouseCapture:function(b){return true}})})(jQuery);(function(c,d){c.widget("ui.resizable",c.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){var f=this,k=this.options;this.element.addClass("ui-resizable");c.extend(this,{_aspectRatio:!!(k.aspectRatio),aspectRatio:k.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:k.helper||k.ghost||k.animate?k.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){if(/relative/.test(this.element.css("position"))&&c.browser.opera){this.element.css({position:"relative",top:"auto",left:"auto"})}this.element.wrap(c('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=k.handles||(!c(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all"){this.handles="n,e,s,w,se,sw,ne,nw"}var l=this.handles.split(",");this.handles={};for(var g=0;g<l.length;g++){var j=c.trim(l[g]),e="ui-resizable-"+j;var h=c('<div class="ui-resizable-handle '+e+'"></div>');if(/sw|se|ne|nw/.test(j)){h.css({zIndex:++k.zIndex})}if("se"==j){h.addClass("ui-icon ui-icon-gripsmall-diagonal-se")}this.handles[j]=".ui-resizable-"+j;this.element.append(h)}}this._renderAxis=function(q){q=q||this.element;for(var n in this.handles){if(this.handles[n].constructor==String){this.handles[n]=c(this.handles[n],this.element).show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var o=c(this.handles[n],this.element),p=0;p=/sw|ne|nw|se|n|s/.test(n)?o.outerHeight():o.outerWidth();var m=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join("");q.css(m,p);this._proportionallyResize()}if(!c(this.handles[n]).length){continue}}};this._renderAxis(this.element);this._handles=c(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!f.resizing){if(this.className){var i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}f.axis=i&&i[1]?i[1]:"se"}});if(k.autoHide){this._handles.hide();c(this.element).addClass("ui-resizable-autohide").hover(function(){c(this).removeClass("ui-resizable-autohide");f._handles.show()},function(){if(!f.resizing){c(this).addClass("ui-resizable-autohide");f._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var e=function(g){c(g).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){e(this.element);var f=this.element;f.after(this.originalElement.css({position:f.css("position"),width:f.outerWidth(),height:f.outerHeight(),top:f.css("top"),left:f.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);e(this.originalElement);return this},_mouseCapture:function(f){var g=false;for(var e in this.handles){if(c(this.handles[e])[0]==f.target){g=true}}return !this.options.disabled&&g},_mouseStart:function(g){var j=this.options,f=this.element.position(),e=this.element;this.resizing=true;this.documentScroll={top:c(document).scrollTop(),left:c(document).scrollLeft()};if(e.is(".ui-draggable")||(/absolute/).test(e.css("position"))){e.css({position:"absolute",top:f.top,left:f.left})}if(c.browser.opera&&(/relative/).test(e.css("position"))){e.css({position:"relative",top:"auto",left:"auto"})}this._renderProxy();var k=b(this.helper.css("left")),h=b(this.helper.css("top"));if(j.containment){k+=c(j.containment).scrollLeft()||0;h+=c(j.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:k,top:h};this.size=this._helper?{width:e.outerWidth(),height:e.outerHeight()}:{width:e.width(),height:e.height()};this.originalSize=this._helper?{width:e.outerWidth(),height:e.outerHeight()}:{width:e.width(),height:e.height()};this.originalPosition={left:k,top:h};this.sizeDiff={width:e.outerWidth()-e.width(),height:e.outerHeight()-e.height()};this.originalMousePosition={left:g.pageX,top:g.pageY};this.aspectRatio=(typeof j.aspectRatio=="number")?j.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);var i=c(".ui-resizable-"+this.axis).css("cursor");c("body").css("cursor",i=="auto"?this.axis+"-resize":i);e.addClass("ui-resizable-resizing");this._propagate("start",g);return true},_mouseDrag:function(e){var h=this.helper,g=this.options,m={},q=this,j=this.originalMousePosition,n=this.axis;var r=(e.pageX-j.left)||0,p=(e.pageY-j.top)||0;var i=this._change[n];if(!i){return false}var l=i.apply(this,[e,r,p]),k=c.browser.msie&&c.browser.version<7,f=this.sizeDiff;if(this._aspectRatio||e.shiftKey){l=this._updateRatio(l,e)}l=this._respectSize(l,e);this._propagate("resize",e);h.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}this._updateCache(l);this._trigger("resize",e,this.ui());return false},_mouseStop:function(h){this.resizing=false;var i=this.options,m=this;if(this._helper){var g=this._proportionallyResizeElements,e=g.length&&(/textarea/i).test(g[0].nodeName),f=e&&c.ui.hasScroll(g[0],"left")?0:m.sizeDiff.height,k=e?0:m.sizeDiff.width;var n={width:(m.size.width-k),height:(m.size.height-f)},j=(parseInt(m.element.css("left"),10)+(m.position.left-m.originalPosition.left))||null,l=(parseInt(m.element.css("top"),10)+(m.position.top-m.originalPosition.top))||null;if(!i.animate){this.element.css(c.extend(n,{top:l,left:j}))}m.helper.height(m.size.height);m.helper.width(m.size.width);if(this._helper&&!i.animate){this._proportionallyResize()}}c("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",h);if(this._helper){this.helper.remove()}return false},_updateCache:function(e){var f=this.options;this.offset=this.helper.offset();if(a(e.left)){this.position.left=e.left}if(a(e.top)){this.position.top=e.top}if(a(e.height)){this.size.height=e.height}if(a(e.width)){this.size.width=e.width}},_updateRatio:function(h,g){var i=this.options,j=this.position,f=this.size,e=this.axis;if(h.height){h.width=(f.height*this.aspectRatio)}else{if(h.width){h.height=(f.width/this.aspectRatio)}}if(e=="sw"){h.left=j.left+(f.width-h.width);h.top=null}if(e=="nw"){h.top=j.top+(f.height-h.height);h.left=j.left+(f.width-h.width)}return h},_respectSize:function(l,g){var j=this.helper,i=this.options,r=this._aspectRatio||g.shiftKey,q=this.axis,t=a(l.width)&&i.maxWidth&&(i.maxWidth<l.width),m=a(l.height)&&i.maxHeight&&(i.maxHeight<l.height),h=a(l.width)&&i.minWidth&&(i.minWidth>l.width),s=a(l.height)&&i.minHeight&&(i.minHeight>l.height);if(h){l.width=i.minWidth}if(s){l.height=i.minHeight}if(t){l.width=i.maxWidth}if(m){l.height=i.maxHeight}var f=this.originalPosition.left+this.originalSize.width,p=this.position.top+this.size.height;var k=/sw|nw|w/.test(q),e=/nw|ne|n/.test(q);if(h&&k){l.left=f-i.minWidth}if(t&&k){l.left=f-i.maxWidth}if(s&&e){l.top=p-i.minHeight}if(m&&e){l.top=p-i.maxHeight}var n=!l.width&&!l.height;if(n&&!l.left&&l.top){l.top=null}else{if(n&&!l.top&&l.left){l.left=null}}return l},_proportionallyResize:function(){var k=this.options;if(!this._proportionallyResizeElements.length){return}var g=this.helper||this.element;for(var f=0;f<this._proportionallyResizeElements.length;f++){var h=this._proportionallyResizeElements[f];if(!this.borderDif){var e=[h.css("borderTopWidth"),h.css("borderRightWidth"),h.css("borderBottomWidth"),h.css("borderLeftWidth")],j=[h.css("paddingTop"),h.css("paddingRight"),h.css("paddingBottom"),h.css("paddingLeft")];this.borderDif=c.map(e,function(l,n){var m=parseInt(l,10)||0,o=parseInt(j[n],10)||0;return m+o})}if(c.browser.msie&&!(!(c(g).is(":hidden")||c(g).parents(":hidden").length))){continue}h.css({height:(g.height()-this.borderDif[0]-this.borderDif[2])||0,width:(g.width()-this.borderDif[1]-this.borderDif[3])||0})}},_renderProxy:function(){var f=this.element,i=this.options;this.elementOffset=f.offset();if(this._helper){this.helper=this.helper||c('<div style="overflow:hidden;"></div>');var e=c.browser.msie&&c.browser.version<7,g=(e?1:0),h=(e?2:-1);this.helper.addClass(this._helper).css({width:this.element.outerWidth()+h,height:this.element.outerHeight()+h,position:"absolute",left:this.elementOffset.left-g+"px",top:this.elementOffset.top-g+"px",zIndex:++i.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(g,f,e){return{width:this.originalSize.width+f}},w:function(h,f,e){var j=this.options,g=this.originalSize,i=this.originalPosition;return{left:i.left+f,width:g.width-f}},n:function(h,f,e){var j=this.options,g=this.originalSize,i=this.originalPosition;return{top:i.top+e,height:g.height-e}},s:function(g,f,e){return{height:this.originalSize.height+e}},se:function(g,f,e){return c.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[g,f,e]))},sw:function(g,f,e){return c.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[g,f,e]))},ne:function(g,f,e){return c.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[g,f,e]))},nw:function(g,f,e){return c.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[g,f,e]))}},_propagate:function(f,e){c.ui.plugin.call(this,f,[e,this.ui()]);(f!="resize"&&this._trigger(f,e,this.ui()))},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});c.extend(c.ui.resizable,{version:"1.8.9"});c.ui.plugin.add("resizable","alsoResize",{start:function(f,g){var e=c(this).data("resizable"),i=e.options;var h=function(j){c(j).each(function(){var k=c(this);k.data("resizable-alsoresize",{width:parseInt(k.width(),10),height:parseInt(k.height(),10),left:parseInt(k.css("left"),10),top:parseInt(k.css("top"),10),position:k.css("position")})})};if(typeof(i.alsoResize)=="object"&&!i.alsoResize.parentNode){if(i.alsoResize.length){i.alsoResize=i.alsoResize[0];h(i.alsoResize)}else{c.each(i.alsoResize,function(j){h(j)})}}else{h(i.alsoResize)}},resize:function(g,i){var f=c(this).data("resizable"),j=f.options,h=f.originalSize,l=f.originalPosition;var k={height:(f.size.height-h.height)||0,width:(f.size.width-h.width)||0,top:(f.position.top-l.top)||0,left:(f.position.left-l.left)||0},e=function(m,n){c(m).each(function(){var q=c(this),r=c(this).data("resizable-alsoresize"),p={},o=n&&n.length?n:q.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];c.each(o,function(s,u){var t=(r[u]||0)+(k[u]||0);if(t&&t>=0){p[u]=t||null}});if(c.browser.opera&&/relative/.test(q.css("position"))){f._revertToRelativePosition=true;q.css({position:"absolute",top:"auto",left:"auto"})}q.css(p)})};if(typeof(j.alsoResize)=="object"&&!j.alsoResize.nodeType){c.each(j.alsoResize,function(m,n){e(m,n)})}else{e(j.alsoResize)}},stop:function(g,h){var f=c(this).data("resizable"),i=f.options;var e=function(j){c(j).each(function(){var k=c(this);k.css({position:k.data("resizable-alsoresize").position})})};if(f._revertToRelativePosition){f._revertToRelativePosition=false;if(typeof(i.alsoResize)=="object"&&!i.alsoResize.nodeType){c.each(i.alsoResize,function(j){e(j)})}else{e(i.alsoResize)}}c(this).removeData("resizable-alsoresize")}});c.ui.plugin.add("resizable","animate",{stop:function(i,n){var p=c(this).data("resizable"),j=p.options;var h=p._proportionallyResizeElements,e=h.length&&(/textarea/i).test(h[0].nodeName),f=e&&c.ui.hasScroll(h[0],"left")?0:p.sizeDiff.height,l=e?0:p.sizeDiff.width;var g={width:(p.size.width-l),height:(p.size.height-f)},k=(parseInt(p.element.css("left"),10)+(p.position.left-p.originalPosition.left))||null,m=(parseInt(p.element.css("top"),10)+(p.position.top-p.originalPosition.top))||null;p.element.animate(c.extend(g,m&&k?{top:m,left:k}:{}),{duration:j.animateDuration,easing:j.animateEasing,step:function(){var o={width:parseInt(p.element.css("width"),10),height:parseInt(p.element.css("height"),10),top:parseInt(p.element.css("top"),10),left:parseInt(p.element.css("left"),10)};if(h&&h.length){c(h[0]).css({width:o.width,height:o.height})}p._updateCache(o);p._propagate("resize",i)}})}});c.ui.plugin.add("resizable","containment",{start:function(f,r){var t=c(this).data("resizable"),j=t.options,l=t.element;var g=j.containment,k=(g instanceof c)?g.get(0):(/parent/.test(g))?l.parent().get(0):g;if(!k){return}t.containerElement=c(k);if(/document/.test(g)||g==document){t.containerOffset={left:0,top:0};t.containerPosition={left:0,top:0};t.parentData={element:c(document),left:0,top:0,width:c(document).width(),height:c(document).height()||document.body.parentNode.scrollHeight}}else{var n=c(k),i=[];c(["Top","Right","Left","Bottom"]).each(function(p,o){i[p]=b(n.css("padding"+o))});t.containerOffset=n.offset();t.containerPosition=n.position();t.containerSize={height:(n.innerHeight()-i[3]),width:(n.innerWidth()-i[1])};var q=t.containerOffset,e=t.containerSize.height,m=t.containerSize.width,h=(c.ui.hasScroll(k,"left")?k.scrollWidth:m),s=(c.ui.hasScroll(k)?k.scrollHeight:e);t.parentData={element:k,left:q.left,top:q.top,width:h,height:s}}},resize:function(g,q){var t=c(this).data("resizable"),i=t.options,f=t.containerSize,p=t.containerOffset,m=t.size,n=t.position,r=t._aspectRatio||g.shiftKey,e={top:0,left:0},h=t.containerElement;if(h[0]!=document&&(/static/).test(h.css("position"))){e=p}if(n.left<(t._helper?p.left:0)){t.size.width=t.size.width+(t._helper?(t.position.left-p.left):(t.position.left-e.left));if(r){t.size.height=t.size.width/i.aspectRatio}t.position.left=i.helper?p.left:0}if(n.top<(t._helper?p.top:0)){t.size.height=t.size.height+(t._helper?(t.position.top-p.top):t.position.top);if(r){t.size.width=t.size.height*i.aspectRatio}t.position.top=t._helper?p.top:0}t.offset.left=t.parentData.left+t.position.left;t.offset.top=t.parentData.top+t.position.top;var l=Math.abs((t._helper?t.offset.left-e.left:(t.offset.left-e.left))+t.sizeDiff.width),s=Math.abs((t._helper?t.offset.top-e.top:(t.offset.top-p.top))+t.sizeDiff.height);var k=t.containerElement.get(0)==t.element.parent().get(0),j=/relative|absolute/.test(t.containerElement.css("position"));if(k&&j){l-=t.parentData.left}if(l+t.size.width>=t.parentData.width){t.size.width=t.parentData.width-l;if(r){t.size.height=t.size.width/t.aspectRatio}}if(s+t.size.height>=t.parentData.height){t.size.height=t.parentData.height-s;if(r){t.size.width=t.size.height*t.aspectRatio}}},stop:function(f,n){var q=c(this).data("resizable"),g=q.options,l=q.position,m=q.containerOffset,e=q.containerPosition,i=q.containerElement;var j=c(q.helper),r=j.offset(),p=j.outerWidth()-q.sizeDiff.width,k=j.outerHeight()-q.sizeDiff.height;if(q._helper&&!g.animate&&(/relative/).test(i.css("position"))){c(this).css({left:r.left-e.left-m.left,width:p,height:k})}if(q._helper&&!g.animate&&(/static/).test(i.css("position"))){c(this).css({left:r.left-e.left-m.left,width:p,height:k})}}});c.ui.plugin.add("resizable","ghost",{start:function(g,h){var e=c(this).data("resizable"),i=e.options,f=e.size;e.ghost=e.originalElement.clone();e.ghost.css({opacity:0.25,display:"block",position:"relative",height:f.height,width:f.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof i.ghost=="string"?i.ghost:"");e.ghost.appendTo(e.helper)},resize:function(f,g){var e=c(this).data("resizable"),h=e.options;if(e.ghost){e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})}},stop:function(f,g){var e=c(this).data("resizable"),h=e.options;if(e.ghost&&e.helper){e.helper.get(0).removeChild(e.ghost.get(0))}}});c.ui.plugin.add("resizable","grid",{resize:function(e,m){var p=c(this).data("resizable"),h=p.options,k=p.size,i=p.originalSize,j=p.originalPosition,n=p.axis,l=h._aspectRatio||e.shiftKey;h.grid=typeof h.grid=="number"?[h.grid,h.grid]:h.grid;var g=Math.round((k.width-i.width)/(h.grid[0]||1))*(h.grid[0]||1),f=Math.round((k.height-i.height)/(h.grid[1]||1))*(h.grid[1]||1);if(/^(se|s|e)$/.test(n)){p.size.width=i.width+g;p.size.height=i.height+f}else{if(/^(ne)$/.test(n)){p.size.width=i.width+g;p.size.height=i.height+f;p.position.top=j.top-f}else{if(/^(sw)$/.test(n)){p.size.width=i.width+g;p.size.height=i.height+f;p.position.left=j.left-g}else{p.size.width=i.width+g;p.size.height=i.height+f;p.position.top=j.top-f;p.position.left=j.left-g}}}}});var b=function(e){return parseInt(e,10)||0};var a=function(e){return !isNaN(parseInt(e,10))}})(jQuery);
